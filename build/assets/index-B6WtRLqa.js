(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))a(d);new MutationObserver(d=>{for(const h of d)if(h.type==="childList")for(const p of h.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&a(p)}).observe(document,{childList:!0,subtree:!0});function r(d){const h={};return d.integrity&&(h.integrity=d.integrity),d.referrerPolicy&&(h.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?h.credentials="include":d.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function a(d){if(d.ep)return;d.ep=!0;const h=r(d);fetch(d.href,h)}})();var $p=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jf(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var pu={exports:{}},sa={},mu={exports:{}},Qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dh;function Up(){if(Dh)return Qe;Dh=1;var i=Symbol.for("react.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),h=Symbol.for("react.provider"),p=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),_=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),C=Symbol.iterator;function F(W){return W===null||typeof W!="object"?null:(W=C&&W[C]||W["@@iterator"],typeof W=="function"?W:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,q={};function M(W,re,Ve){this.props=W,this.context=re,this.refs=q,this.updater=Ve||T}M.prototype.isReactComponent={},M.prototype.setState=function(W,re){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,re,"setState")},M.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function U(){}U.prototype=M.prototype;function Z(W,re,Ve){this.props=W,this.context=re,this.refs=q,this.updater=Ve||T}var ne=Z.prototype=new U;ne.constructor=Z,A(ne,M.prototype),ne.isPureReactComponent=!0;var ie=Array.isArray,ee=Object.prototype.hasOwnProperty,me={current:null},fe={key:!0,ref:!0,__self:!0,__source:!0};function ye(W,re,Ve){var Ue,We={},Ge=null,et=null;if(re!=null)for(Ue in re.ref!==void 0&&(et=re.ref),re.key!==void 0&&(Ge=""+re.key),re)ee.call(re,Ue)&&!fe.hasOwnProperty(Ue)&&(We[Ue]=re[Ue]);var nt=arguments.length-2;if(nt===1)We.children=Ve;else if(1<nt){for(var pt=Array(nt),je=0;je<nt;je++)pt[je]=arguments[je+2];We.children=pt}if(W&&W.defaultProps)for(Ue in nt=W.defaultProps,nt)We[Ue]===void 0&&(We[Ue]=nt[Ue]);return{$$typeof:i,type:W,key:Ge,ref:et,props:We,_owner:me.current}}function $e(W,re){return{$$typeof:i,type:W.type,key:re,ref:W.ref,props:W.props,_owner:W._owner}}function Te(W){return typeof W=="object"&&W!==null&&W.$$typeof===i}function st(W){var re={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(Ve){return re[Ve]})}var De=/\/+/g;function lt(W,re){return typeof W=="object"&&W!==null&&W.key!=null?st(""+W.key):re.toString(36)}function jt(W,re,Ve,Ue,We){var Ge=typeof W;(Ge==="undefined"||Ge==="boolean")&&(W=null);var et=!1;if(W===null)et=!0;else switch(Ge){case"string":case"number":et=!0;break;case"object":switch(W.$$typeof){case i:case n:et=!0}}if(et)return et=W,We=We(et),W=Ue===""?"."+lt(et,0):Ue,ie(We)?(Ve="",W!=null&&(Ve=W.replace(De,"$&/")+"/"),jt(We,re,Ve,"",function(je){return je})):We!=null&&(Te(We)&&(We=$e(We,Ve+(!We.key||et&&et.key===We.key?"":(""+We.key).replace(De,"$&/")+"/")+W)),re.push(We)),1;if(et=0,Ue=Ue===""?".":Ue+":",ie(W))for(var nt=0;nt<W.length;nt++){Ge=W[nt];var pt=Ue+lt(Ge,nt);et+=jt(Ge,re,Ve,pt,We)}else if(pt=F(W),typeof pt=="function")for(W=pt.call(W),nt=0;!(Ge=W.next()).done;)Ge=Ge.value,pt=Ue+lt(Ge,nt++),et+=jt(Ge,re,Ve,pt,We);else if(Ge==="object")throw re=String(W),Error("Objects are not valid as a React child (found: "+(re==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":re)+"). If you meant to render a collection of children, use an array instead.");return et}function Tt(W,re,Ve){if(W==null)return W;var Ue=[],We=0;return jt(W,Ue,"","",function(Ge){return re.call(Ve,Ge,We++)}),Ue}function ft(W){if(W._status===-1){var re=W._result;re=re(),re.then(function(Ve){(W._status===0||W._status===-1)&&(W._status=1,W._result=Ve)},function(Ve){(W._status===0||W._status===-1)&&(W._status=2,W._result=Ve)}),W._status===-1&&(W._status=0,W._result=re)}if(W._status===1)return W._result.default;throw W._result}var Me={current:null},de={transition:null},Ce={ReactCurrentDispatcher:Me,ReactCurrentBatchConfig:de,ReactCurrentOwner:me};function se(){throw Error("act(...) is not supported in production builds of React.")}return Qe.Children={map:Tt,forEach:function(W,re,Ve){Tt(W,function(){re.apply(this,arguments)},Ve)},count:function(W){var re=0;return Tt(W,function(){re++}),re},toArray:function(W){return Tt(W,function(re){return re})||[]},only:function(W){if(!Te(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},Qe.Component=M,Qe.Fragment=r,Qe.Profiler=d,Qe.PureComponent=Z,Qe.StrictMode=a,Qe.Suspense=x,Qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ce,Qe.act=se,Qe.cloneElement=function(W,re,Ve){if(W==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+W+".");var Ue=A({},W.props),We=W.key,Ge=W.ref,et=W._owner;if(re!=null){if(re.ref!==void 0&&(Ge=re.ref,et=me.current),re.key!==void 0&&(We=""+re.key),W.type&&W.type.defaultProps)var nt=W.type.defaultProps;for(pt in re)ee.call(re,pt)&&!fe.hasOwnProperty(pt)&&(Ue[pt]=re[pt]===void 0&&nt!==void 0?nt[pt]:re[pt])}var pt=arguments.length-2;if(pt===1)Ue.children=Ve;else if(1<pt){nt=Array(pt);for(var je=0;je<pt;je++)nt[je]=arguments[je+2];Ue.children=nt}return{$$typeof:i,type:W.type,key:We,ref:Ge,props:Ue,_owner:et}},Qe.createContext=function(W){return W={$$typeof:p,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},W.Provider={$$typeof:h,_context:W},W.Consumer=W},Qe.createElement=ye,Qe.createFactory=function(W){var re=ye.bind(null,W);return re.type=W,re},Qe.createRef=function(){return{current:null}},Qe.forwardRef=function(W){return{$$typeof:v,render:W}},Qe.isValidElement=Te,Qe.lazy=function(W){return{$$typeof:j,_payload:{_status:-1,_result:W},_init:ft}},Qe.memo=function(W,re){return{$$typeof:_,type:W,compare:re===void 0?null:re}},Qe.startTransition=function(W){var re=de.transition;de.transition={};try{W()}finally{de.transition=re}},Qe.unstable_act=se,Qe.useCallback=function(W,re){return Me.current.useCallback(W,re)},Qe.useContext=function(W){return Me.current.useContext(W)},Qe.useDebugValue=function(){},Qe.useDeferredValue=function(W){return Me.current.useDeferredValue(W)},Qe.useEffect=function(W,re){return Me.current.useEffect(W,re)},Qe.useId=function(){return Me.current.useId()},Qe.useImperativeHandle=function(W,re,Ve){return Me.current.useImperativeHandle(W,re,Ve)},Qe.useInsertionEffect=function(W,re){return Me.current.useInsertionEffect(W,re)},Qe.useLayoutEffect=function(W,re){return Me.current.useLayoutEffect(W,re)},Qe.useMemo=function(W,re){return Me.current.useMemo(W,re)},Qe.useReducer=function(W,re,Ve){return Me.current.useReducer(W,re,Ve)},Qe.useRef=function(W){return Me.current.useRef(W)},Qe.useState=function(W){return Me.current.useState(W)},Qe.useSyncExternalStore=function(W,re,Ve){return Me.current.useSyncExternalStore(W,re,Ve)},Qe.useTransition=function(){return Me.current.useTransition()},Qe.version="18.3.1",Qe}var Ih;function zu(){return Ih||(Ih=1,mu.exports=Up()),mu.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mh;function zp(){if(Mh)return sa;Mh=1;var i=zu(),n=Symbol.for("react.element"),r=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,d=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,h={key:!0,ref:!0,__self:!0,__source:!0};function p(v,x,_){var j,C={},F=null,T=null;_!==void 0&&(F=""+_),x.key!==void 0&&(F=""+x.key),x.ref!==void 0&&(T=x.ref);for(j in x)a.call(x,j)&&!h.hasOwnProperty(j)&&(C[j]=x[j]);if(v&&v.defaultProps)for(j in x=v.defaultProps,x)C[j]===void 0&&(C[j]=x[j]);return{$$typeof:n,type:v,key:F,ref:T,props:C,_owner:d.current}}return sa.Fragment=r,sa.jsx=p,sa.jsxs=p,sa}var Lh;function qp(){return Lh||(Lh=1,pu.exports=zp()),pu.exports}var s=qp(),Al={},yu={exports:{}},vn={},gu={exports:{}},vu={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bh;function Wp(){return Bh||(Bh=1,(function(i){function n(de,Ce){var se=de.length;de.push(Ce);e:for(;0<se;){var W=se-1>>>1,re=de[W];if(0<d(re,Ce))de[W]=Ce,de[se]=re,se=W;else break e}}function r(de){return de.length===0?null:de[0]}function a(de){if(de.length===0)return null;var Ce=de[0],se=de.pop();if(se!==Ce){de[0]=se;e:for(var W=0,re=de.length,Ve=re>>>1;W<Ve;){var Ue=2*(W+1)-1,We=de[Ue],Ge=Ue+1,et=de[Ge];if(0>d(We,se))Ge<re&&0>d(et,We)?(de[W]=et,de[Ge]=se,W=Ge):(de[W]=We,de[Ue]=se,W=Ue);else if(Ge<re&&0>d(et,se))de[W]=et,de[Ge]=se,W=Ge;else break e}}return Ce}function d(de,Ce){var se=de.sortIndex-Ce.sortIndex;return se!==0?se:de.id-Ce.id}if(typeof performance=="object"&&typeof performance.now=="function"){var h=performance;i.unstable_now=function(){return h.now()}}else{var p=Date,v=p.now();i.unstable_now=function(){return p.now()-v}}var x=[],_=[],j=1,C=null,F=3,T=!1,A=!1,q=!1,M=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,Z=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ne(de){for(var Ce=r(_);Ce!==null;){if(Ce.callback===null)a(_);else if(Ce.startTime<=de)a(_),Ce.sortIndex=Ce.expirationTime,n(x,Ce);else break;Ce=r(_)}}function ie(de){if(q=!1,ne(de),!A)if(r(x)!==null)A=!0,ft(ee);else{var Ce=r(_);Ce!==null&&Me(ie,Ce.startTime-de)}}function ee(de,Ce){A=!1,q&&(q=!1,U(ye),ye=-1),T=!0;var se=F;try{for(ne(Ce),C=r(x);C!==null&&(!(C.expirationTime>Ce)||de&&!st());){var W=C.callback;if(typeof W=="function"){C.callback=null,F=C.priorityLevel;var re=W(C.expirationTime<=Ce);Ce=i.unstable_now(),typeof re=="function"?C.callback=re:C===r(x)&&a(x),ne(Ce)}else a(x);C=r(x)}if(C!==null)var Ve=!0;else{var Ue=r(_);Ue!==null&&Me(ie,Ue.startTime-Ce),Ve=!1}return Ve}finally{C=null,F=se,T=!1}}var me=!1,fe=null,ye=-1,$e=5,Te=-1;function st(){return!(i.unstable_now()-Te<$e)}function De(){if(fe!==null){var de=i.unstable_now();Te=de;var Ce=!0;try{Ce=fe(!0,de)}finally{Ce?lt():(me=!1,fe=null)}}else me=!1}var lt;if(typeof Z=="function")lt=function(){Z(De)};else if(typeof MessageChannel<"u"){var jt=new MessageChannel,Tt=jt.port2;jt.port1.onmessage=De,lt=function(){Tt.postMessage(null)}}else lt=function(){M(De,0)};function ft(de){fe=de,me||(me=!0,lt())}function Me(de,Ce){ye=M(function(){de(i.unstable_now())},Ce)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(de){de.callback=null},i.unstable_continueExecution=function(){A||T||(A=!0,ft(ee))},i.unstable_forceFrameRate=function(de){0>de||125<de?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$e=0<de?Math.floor(1e3/de):5},i.unstable_getCurrentPriorityLevel=function(){return F},i.unstable_getFirstCallbackNode=function(){return r(x)},i.unstable_next=function(de){switch(F){case 1:case 2:case 3:var Ce=3;break;default:Ce=F}var se=F;F=Ce;try{return de()}finally{F=se}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(de,Ce){switch(de){case 1:case 2:case 3:case 4:case 5:break;default:de=3}var se=F;F=de;try{return Ce()}finally{F=se}},i.unstable_scheduleCallback=function(de,Ce,se){var W=i.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?W+se:W):se=W,de){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=se+re,de={id:j++,callback:Ce,priorityLevel:de,startTime:se,expirationTime:re,sortIndex:-1},se>W?(de.sortIndex=se,n(_,de),r(x)===null&&de===r(_)&&(q?(U(ye),ye=-1):q=!0,Me(ie,se-W))):(de.sortIndex=re,n(x,de),A||T||(A=!0,ft(ee))),de},i.unstable_shouldYield=st,i.unstable_wrapCallback=function(de){var Ce=F;return function(){var se=F;F=Ce;try{return de.apply(this,arguments)}finally{F=se}}}})(vu)),vu}var $h;function Kp(){return $h||($h=1,gu.exports=Wp()),gu.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uh;function Hp(){if(Uh)return vn;Uh=1;var i=zu(),n=Kp();function r(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,o=1;o<arguments.length;o++)t+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,d={};function h(e,t){p(e,t),p(e+"Capture",t)}function p(e,t){for(d[e]=t,e=0;e<t.length;e++)a.add(t[e])}var v=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),x=Object.prototype.hasOwnProperty,_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,j={},C={};function F(e){return x.call(C,e)?!0:x.call(j,e)?!1:_.test(e)?C[e]=!0:(j[e]=!0,!1)}function T(e,t,o,c){if(o!==null&&o.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return c?!1:o!==null?!o.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function A(e,t,o,c){if(t===null||typeof t>"u"||T(e,t,o,c))return!0;if(c)return!1;if(o!==null)switch(o.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function q(e,t,o,c,f,y,k){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=c,this.attributeNamespace=f,this.mustUseProperty=o,this.propertyName=e,this.type=t,this.sanitizeURL=y,this.removeEmptyString=k}var M={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){M[e]=new q(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];M[t]=new q(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){M[e]=new q(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){M[e]=new q(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){M[e]=new q(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){M[e]=new q(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){M[e]=new q(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){M[e]=new q(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){M[e]=new q(e,5,!1,e.toLowerCase(),null,!1,!1)});var U=/[\-:]([a-z])/g;function Z(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(U,Z);M[t]=new q(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(U,Z);M[t]=new q(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(U,Z);M[t]=new q(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){M[e]=new q(e,1,!1,e.toLowerCase(),null,!1,!1)}),M.xlinkHref=new q("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){M[e]=new q(e,1,!1,e.toLowerCase(),null,!0,!0)});function ne(e,t,o,c){var f=M.hasOwnProperty(t)?M[t]:null;(f!==null?f.type!==0:c||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(A(t,o,f,c)&&(o=null),c||f===null?F(t)&&(o===null?e.removeAttribute(t):e.setAttribute(t,""+o)):f.mustUseProperty?e[f.propertyName]=o===null?f.type===3?!1:"":o:(t=f.attributeName,c=f.attributeNamespace,o===null?e.removeAttribute(t):(f=f.type,o=f===3||f===4&&o===!0?"":""+o,c?e.setAttributeNS(c,t,o):e.setAttribute(t,o))))}var ie=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ee=Symbol.for("react.element"),me=Symbol.for("react.portal"),fe=Symbol.for("react.fragment"),ye=Symbol.for("react.strict_mode"),$e=Symbol.for("react.profiler"),Te=Symbol.for("react.provider"),st=Symbol.for("react.context"),De=Symbol.for("react.forward_ref"),lt=Symbol.for("react.suspense"),jt=Symbol.for("react.suspense_list"),Tt=Symbol.for("react.memo"),ft=Symbol.for("react.lazy"),Me=Symbol.for("react.offscreen"),de=Symbol.iterator;function Ce(e){return e===null||typeof e!="object"?null:(e=de&&e[de]||e["@@iterator"],typeof e=="function"?e:null)}var se=Object.assign,W;function re(e){if(W===void 0)try{throw Error()}catch(o){var t=o.stack.trim().match(/\n( *(at )?)/);W=t&&t[1]||""}return`
`+W+e}var Ve=!1;function Ue(e,t){if(!e||Ve)return"";Ve=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(X){var c=X}Reflect.construct(e,[],t)}else{try{t.call()}catch(X){c=X}e.call(t.prototype)}else{try{throw Error()}catch(X){c=X}e()}}catch(X){if(X&&c&&typeof X.stack=="string"){for(var f=X.stack.split(`
`),y=c.stack.split(`
`),k=f.length-1,E=y.length-1;1<=k&&0<=E&&f[k]!==y[E];)E--;for(;1<=k&&0<=E;k--,E--)if(f[k]!==y[E]){if(k!==1||E!==1)do if(k--,E--,0>E||f[k]!==y[E]){var P=`
`+f[k].replace(" at new "," at ");return e.displayName&&P.includes("<anonymous>")&&(P=P.replace("<anonymous>",e.displayName)),P}while(1<=k&&0<=E);break}}}finally{Ve=!1,Error.prepareStackTrace=o}return(e=e?e.displayName||e.name:"")?re(e):""}function We(e){switch(e.tag){case 5:return re(e.type);case 16:return re("Lazy");case 13:return re("Suspense");case 19:return re("SuspenseList");case 0:case 2:case 15:return e=Ue(e.type,!1),e;case 11:return e=Ue(e.type.render,!1),e;case 1:return e=Ue(e.type,!0),e;default:return""}}function Ge(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case fe:return"Fragment";case me:return"Portal";case $e:return"Profiler";case ye:return"StrictMode";case lt:return"Suspense";case jt:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case st:return(e.displayName||"Context")+".Consumer";case Te:return(e._context.displayName||"Context")+".Provider";case De:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Tt:return t=e.displayName||null,t!==null?t:Ge(e.type)||"Memo";case ft:t=e._payload,e=e._init;try{return Ge(e(t))}catch{}}return null}function et(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ge(t);case 8:return t===ye?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function nt(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function pt(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function je(e){var t=pt(e)?"checked":"value",o=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),c=""+e[t];if(!e.hasOwnProperty(t)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var f=o.get,y=o.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return f.call(this)},set:function(k){c=""+k,y.call(this,k)}}),Object.defineProperty(e,t,{enumerable:o.enumerable}),{getValue:function(){return c},setValue:function(k){c=""+k},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function or(e){e._valueTracker||(e._valueTracker=je(e))}function it(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var o=t.getValue(),c="";return e&&(c=pt(e)?e.checked?"true":"false":e.value),e=c,e!==o?(t.setValue(e),!0):!1}function wn(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function es(e,t){var o=t.checked;return se({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??e._wrapperState.initialChecked})}function kn(e,t){var o=t.defaultValue==null?"":t.defaultValue,c=t.checked!=null?t.checked:t.defaultChecked;o=nt(t.value!=null?t.value:o),e._wrapperState={initialChecked:c,initialValue:o,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Bs(e,t){t=t.checked,t!=null&&ne(e,"checked",t,!1)}function ts(e,t){Bs(e,t);var o=nt(t.value),c=t.type;if(o!=null)c==="number"?(o===0&&e.value===""||e.value!=o)&&(e.value=""+o):e.value!==""+o&&(e.value=""+o);else if(c==="submit"||c==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?rs(e,t.type,o):t.hasOwnProperty("defaultValue")&&rs(e,t.type,nt(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function ns(e,t,o){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var c=t.type;if(!(c!=="submit"&&c!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,o||t===e.value||(e.value=t),e.defaultValue=t}o=e.name,o!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,o!==""&&(e.name=o)}function rs(e,t,o){(t!=="number"||wn(e.ownerDocument)!==e)&&(o==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+o&&(e.defaultValue=""+o))}var $n=Array.isArray;function Nt(e,t,o,c){if(e=e.options,t){t={};for(var f=0;f<o.length;f++)t["$"+o[f]]=!0;for(o=0;o<e.length;o++)f=t.hasOwnProperty("$"+e[o].value),e[o].selected!==f&&(e[o].selected=f),f&&c&&(e[o].defaultSelected=!0)}else{for(o=""+nt(o),t=null,f=0;f<e.length;f++){if(e[f].value===o){e[f].selected=!0,c&&(e[f].defaultSelected=!0);return}t!==null||e[f].disabled||(t=e[f])}t!==null&&(t.selected=!0)}}function $s(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(r(91));return se({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ar(e,t){var o=t.value;if(o==null){if(o=t.children,t=t.defaultValue,o!=null){if(t!=null)throw Error(r(92));if($n(o)){if(1<o.length)throw Error(r(93));o=o[0]}t=o}t==null&&(t=""),o=t}e._wrapperState={initialValue:nt(o)}}function Us(e,t){var o=nt(t.value),c=nt(t.defaultValue);o!=null&&(o=""+o,o!==e.value&&(e.value=o),t.defaultValue==null&&e.defaultValue!==o&&(e.defaultValue=o)),c!=null&&(e.defaultValue=""+c)}function en(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function wt(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _n(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?wt(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var lr,cr=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,o,c,f){MSApp.execUnsafeLocalFunction(function(){return e(t,o,c,f)})}:e})(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(lr=lr||document.createElement("div"),lr.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=lr.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Un(e,t){if(t){var o=e.firstChild;if(o&&o===e.lastChild&&o.nodeType===3){o.nodeValue=t;return}}e.textContent=t}var Tn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},zn=["Webkit","ms","Moz","O"];Object.keys(Tn).forEach(function(e){zn.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Tn[t]=Tn[e]})});function Cr(e,t,o){return t==null||typeof t=="boolean"||t===""?"":o||typeof t!="number"||t===0||Tn.hasOwnProperty(e)&&Tn[e]?(""+t).trim():t+"px"}function ss(e,t){e=e.style;for(var o in t)if(t.hasOwnProperty(o)){var c=o.indexOf("--")===0,f=Cr(o,t[o],c);o==="float"&&(o="cssFloat"),c?e.setProperty(o,f):e[o]=f}}var jn=se({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ee(e,t){if(t){if(jn[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(r(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(r(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(r(61))}if(t.style!=null&&typeof t.style!="object")throw Error(r(62))}}function qn(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var St=null;function tn(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var be=null,ge=null,Ye=null;function Vt(e){if(e=qo(e)){if(typeof be!="function")throw Error(r(280));var t=e.stateNode;t&&(t=Ka(t),be(e.stateNode,e.type,t))}}function Fr(e){ge?Ye?Ye.push(e):Ye=[e]:ge=e}function ur(){if(ge){var e=ge,t=Ye;if(Ye=ge=null,Vt(e),t)for(e=0;e<t.length;e++)Vt(t[e])}}function va(e,t){return e(t)}function xa(){}var dr=!1;function Er(e,t,o){if(dr)return e(t,o);dr=!0;try{return va(e,t,o)}finally{dr=!1,(ge!==null||Ye!==null)&&(xa(),ur())}}function Ar(e,t){var o=e.stateNode;if(o===null)return null;var c=Ka(o);if(c===null)return null;o=c[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(e=e.type,c=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!c;break e;default:e=!1}if(e)return null;if(o&&typeof o!="function")throw Error(r(231,t,typeof o));return o}var is=!1;if(v)try{var ht={};Object.defineProperty(ht,"passive",{get:function(){is=!0}}),window.addEventListener("test",ht,ht),window.removeEventListener("test",ht,ht)}catch{is=!1}function Dt(e,t,o,c,f,y,k,E,P){var X=Array.prototype.slice.call(arguments,3);try{t.apply(o,X)}catch(ce){this.onError(ce)}}var zs=!1,Tr=null,Rr=!1,os=null,Ql={onError:function(e){zs=!0,Tr=e}};function hr(e,t,o,c,f,y,k,E,P){zs=!1,Tr=null,Dt.apply(Ql,arguments)}function as(e,t,o,c,f,y,k,E,P){if(hr.apply(this,arguments),zs){if(zs){var X=Tr;zs=!1,Tr=null}else throw Error(r(198));Rr||(Rr=!0,os=X)}}function nn(e){var t=e,o=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(o=t.return),e=t.return;while(e)}return t.tag===3?o:null}function qs(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ba(e){if(nn(e)!==e)throw Error(r(188))}function fr(e){var t=e.alternate;if(!t){if(t=nn(e),t===null)throw Error(r(188));return t!==e?null:e}for(var o=e,c=t;;){var f=o.return;if(f===null)break;var y=f.alternate;if(y===null){if(c=f.return,c!==null){o=c;continue}break}if(f.child===y.child){for(y=f.child;y;){if(y===o)return ba(f),e;if(y===c)return ba(f),t;y=y.sibling}throw Error(r(188))}if(o.return!==c.return)o=f,c=y;else{for(var k=!1,E=f.child;E;){if(E===o){k=!0,o=f,c=y;break}if(E===c){k=!0,c=f,o=y;break}E=E.sibling}if(!k){for(E=y.child;E;){if(E===o){k=!0,o=y,c=f;break}if(E===c){k=!0,c=y,o=f;break}E=E.sibling}if(!k)throw Error(r(189))}}if(o.alternate!==c)throw Error(r(190))}if(o.tag!==3)throw Error(r(188));return o.stateNode.current===o?e:t}function bo(e){return e=fr(e),e!==null?pr(e):null}function pr(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=pr(e);if(t!==null)return t;e=e.sibling}return null}var wo=n.unstable_scheduleCallback,_i=n.unstable_cancelCallback,Ct=n.unstable_shouldYield,Pr=n.unstable_requestPaint,ut=n.unstable_now,wa=n.unstable_getCurrentPriorityLevel,mr=n.unstable_ImmediatePriority,Ws=n.unstable_UserBlockingPriority,ls=n.unstable_NormalPriority,ko=n.unstable_LowPriority,yr=n.unstable_IdlePriority,Ks=null,ln=null;function ka(e){if(ln&&typeof ln.onCommitFiberRoot=="function")try{ln.onCommitFiberRoot(Ks,e,void 0,(e.current.flags&128)===128)}catch{}}var Ke=Math.clz32?Math.clz32:ji,_a=Math.log,ja=Math.LN2;function ji(e){return e>>>=0,e===0?32:31-(_a(e)/ja|0)|0}var gr=64,Hs=4194304;function cs(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Vs(e,t){var o=e.pendingLanes;if(o===0)return 0;var c=0,f=e.suspendedLanes,y=e.pingedLanes,k=o&268435455;if(k!==0){var E=k&~f;E!==0?c=cs(E):(y&=k,y!==0&&(c=cs(y)))}else k=o&~f,k!==0?c=cs(k):y!==0&&(c=cs(y));if(c===0)return 0;if(t!==0&&t!==c&&(t&f)===0&&(f=c&-c,y=t&-t,f>=y||f===16&&(y&4194240)!==0))return t;if((c&4)!==0&&(c|=o&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=c;0<t;)o=31-Ke(t),f=1<<o,c|=e[o],t&=~f;return c}function mt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Gs(e,t){for(var o=e.suspendedLanes,c=e.pingedLanes,f=e.expirationTimes,y=e.pendingLanes;0<y;){var k=31-Ke(y),E=1<<k,P=f[k];P===-1?((E&o)===0||(E&c)!==0)&&(f[k]=mt(E,t)):P<=t&&(e.expiredLanes|=E),y&=~E}}function Or(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Dr(){var e=gr;return gr<<=1,(gr&4194240)===0&&(gr=64),e}function Js(e){for(var t=[],o=0;31>o;o++)t.push(e);return t}function Ir(e,t,o){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ke(t),e[t]=o}function Ni(e,t){var o=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var c=e.eventTimes;for(e=e.expirationTimes;0<o;){var f=31-Ke(o),y=1<<f;t[f]=0,c[f]=-1,e[f]=-1,o&=~y}}function Si(e,t){var o=e.entangledLanes|=t;for(e=e.entanglements;o;){var c=31-Ke(o),f=1<<c;f&t|e[c]&t&&(e[c]|=t),o&=~f}}var ot=0;function _o(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var Na,tt,jo,Sa,Ca,Gt=!1,Wn=[],Nn=null,Jt=null,Kn=null,us=new Map,kt=new Map,Lt=[],Ys="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ds(e,t){switch(e){case"focusin":case"focusout":Nn=null;break;case"dragenter":case"dragleave":Jt=null;break;case"mouseover":case"mouseout":Kn=null;break;case"pointerover":case"pointerout":us.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":kt.delete(t.pointerId)}}function Mr(e,t,o,c,f,y){return e===null||e.nativeEvent!==y?(e={blockedOn:t,domEventName:o,eventSystemFlags:c,nativeEvent:y,targetContainers:[f]},t!==null&&(t=qo(t),t!==null&&tt(t)),e):(e.eventSystemFlags|=c,t=e.targetContainers,f!==null&&t.indexOf(f)===-1&&t.push(f),e)}function vr(e,t,o,c,f){switch(t){case"focusin":return Nn=Mr(Nn,e,t,o,c,f),!0;case"dragenter":return Jt=Mr(Jt,e,t,o,c,f),!0;case"mouseover":return Kn=Mr(Kn,e,t,o,c,f),!0;case"pointerover":var y=f.pointerId;return us.set(y,Mr(us.get(y)||null,e,t,o,c,f)),!0;case"gotpointercapture":return y=f.pointerId,kt.set(y,Mr(kt.get(y)||null,e,t,o,c,f)),!0}return!1}function Fa(e){var t=si(e.target);if(t!==null){var o=nn(t);if(o!==null){if(t=o.tag,t===13){if(t=qs(o),t!==null){e.blockedOn=t,Ca(e.priority,function(){jo(o)});return}}else if(t===3&&o.stateNode.current.memoizedState.isDehydrated){e.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}e.blockedOn=null}function cn(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var o=hs(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(o===null){o=e.nativeEvent;var c=new o.constructor(o.type,o);St=c,o.target.dispatchEvent(c),St=null}else return t=qo(o),t!==null&&tt(t),e.blockedOn=o,!1;t.shift()}return!0}function Ci(e,t,o){cn(e)&&o.delete(t)}function Ea(){Gt=!1,Nn!==null&&cn(Nn)&&(Nn=null),Jt!==null&&cn(Jt)&&(Jt=null),Kn!==null&&cn(Kn)&&(Kn=null),us.forEach(Ci),kt.forEach(Ci)}function Lr(e,t){e.blockedOn===t&&(e.blockedOn=null,Gt||(Gt=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Ea)))}function Hn(e){function t(f){return Lr(f,e)}if(0<Wn.length){Lr(Wn[0],e);for(var o=1;o<Wn.length;o++){var c=Wn[o];c.blockedOn===e&&(c.blockedOn=null)}}for(Nn!==null&&Lr(Nn,e),Jt!==null&&Lr(Jt,e),Kn!==null&&Lr(Kn,e),us.forEach(t),kt.forEach(t),o=0;o<Lt.length;o++)c=Lt[o],c.blockedOn===e&&(c.blockedOn=null);for(;0<Lt.length&&(o=Lt[0],o.blockedOn===null);)Fa(o),o.blockedOn===null&&Lt.shift()}var xr=ie.ReactCurrentBatchConfig,Qs=!0;function Xl(e,t,o,c){var f=ot,y=xr.transition;xr.transition=null;try{ot=1,No(e,t,o,c)}finally{ot=f,xr.transition=y}}function Xs(e,t,o,c){var f=ot,y=xr.transition;xr.transition=null;try{ot=4,No(e,t,o,c)}finally{ot=f,xr.transition=y}}function No(e,t,o,c){if(Qs){var f=hs(e,t,o,c);if(f===null)sc(e,t,c,Fi,o),ds(e,c);else if(vr(f,e,t,o,c))c.stopPropagation();else if(ds(e,c),t&4&&-1<Ys.indexOf(e)){for(;f!==null;){var y=qo(f);if(y!==null&&Na(y),y=hs(e,t,o,c),y===null&&sc(e,t,c,Fi,o),y===f)break;f=y}f!==null&&c.stopPropagation()}else sc(e,t,c,null,o)}}var Fi=null;function hs(e,t,o,c){if(Fi=null,e=tn(c),e=si(e),e!==null)if(t=nn(e),t===null)e=null;else if(o=t.tag,o===13){if(e=qs(t),e!==null)return e;e=null}else if(o===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Fi=e,null}function Zs(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(wa()){case mr:return 1;case Ws:return 4;case ls:case ko:return 16;case yr:return 536870912;default:return 16}default:return 16}}var Rn=null,So=null,Ei=null;function Aa(){if(Ei)return Ei;var e,t=So,o=t.length,c,f="value"in Rn?Rn.value:Rn.textContent,y=f.length;for(e=0;e<o&&t[e]===f[e];e++);var k=o-e;for(c=1;c<=k&&t[o-c]===f[y-c];c++);return Ei=f.slice(e,1<c?1-c:void 0)}function fs(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ps(){return!0}function Co(){return!1}function zt(e){function t(o,c,f,y,k){this._reactName=o,this._targetInst=f,this.type=c,this.nativeEvent=y,this.target=k,this.currentTarget=null;for(var E in e)e.hasOwnProperty(E)&&(o=e[E],this[E]=o?o(y):y[E]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?ps:Co,this.isPropagationStopped=Co,this}return se(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=ps)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=ps)},persist:function(){},isPersistent:ps}),t}var Vn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ms=zt(Vn),ys=se({},Vn,{view:0,detail:0}),Zl=zt(ys),br,ei,Br,gs=se({},ys,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Di,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Br&&(Br&&e.type==="mousemove"?(br=e.screenX-Br.screenX,ei=e.screenY-Br.screenY):ei=br=0,Br=e),br)},movementY:function(e){return"movementY"in e?e.movementY:ei}}),Ai=zt(gs),qt=se({},gs,{dataTransfer:0}),ti=zt(qt),ni=se({},ys,{relatedTarget:0}),Ti=zt(ni),Ri=se({},Vn,{animationName:0,elapsedTime:0,pseudoElement:0}),Ta=zt(Ri),Ra=se({},Vn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Pi=zt(Ra),Fo=se({},Vn,{data:0}),wr=zt(Fo),Eo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ao={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Oi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function To(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Oi[e])?!!t[e]:!1}function Di(){return To}var ec=se({},ys,{key:function(e){if(e.key){var t=Eo[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=fs(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Ao[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Di,charCode:function(e){return e.type==="keypress"?fs(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?fs(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Ro=zt(ec),Ii=se({},gs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Pa=zt(Ii),Po=se({},ys,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Di}),Oo=zt(Po),tc=se({},Vn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Oa=zt(tc),nc=se({},gs,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Da=zt(nc),Ia=[9,13,27,32],Do=v&&"CompositionEvent"in window,vs=null;v&&"documentMode"in document&&(vs=document.documentMode);var Io=v&&"TextEvent"in window&&!vs,Mo=v&&(!Do||vs&&8<vs&&11>=vs),Lo=" ",Ma=!1;function La(e,t){switch(e){case"keyup":return Ia.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ba(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Gn=!1;function Jn(e,t){switch(e){case"compositionend":return Ba(t);case"keypress":return t.which!==32?null:(Ma=!0,Lo);case"textInput":return e=t.data,e===Lo&&Ma?null:e;default:return null}}function Ft(e,t){if(Gn)return e==="compositionend"||!Do&&La(e,t)?(e=Aa(),Ei=So=Rn=null,Gn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mo&&t.locale!=="ko"?null:t.data;default:return null}}var Mi={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $r(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Mi[e.type]:t==="textarea"}function $a(e,t,o,c){Fr(c),t=za(t,"onChange"),0<t.length&&(o=new ms("onChange","change",null,o,c),e.push({event:o,listeners:t}))}var Ur=null,xs=null;function zr(e){Qu(e,0)}function bs(e){var t=Ui(e);if(it(t))return e}function ws(e,t){if(e==="change")return t}var Yn=!1;if(v){var Li;if(v){var l="oninput"in document;if(!l){var u=document.createElement("div");u.setAttribute("oninput","return;"),l=typeof u.oninput=="function"}Li=l}else Li=!1;Yn=Li&&(!document.documentMode||9<document.documentMode)}function m(){Ur&&(Ur.detachEvent("onpropertychange",g),xs=Ur=null)}function g(e){if(e.propertyName==="value"&&bs(xs)){var t=[];$a(t,xs,e,tn(e)),Er(zr,t)}}function b(e,t,o){e==="focusin"?(m(),Ur=t,xs=o,Ur.attachEvent("onpropertychange",g)):e==="focusout"&&m()}function w(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return bs(xs)}function N(e,t){if(e==="click")return bs(t)}function S(e,t){if(e==="input"||e==="change")return bs(t)}function L(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var K=typeof Object.is=="function"?Object.is:L;function O(e,t){if(K(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var o=Object.keys(e),c=Object.keys(t);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var f=o[c];if(!x.call(t,f)||!K(e[f],t[f]))return!1}return!0}function R(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function B(e,t){var o=R(e);e=0;for(var c;o;){if(o.nodeType===3){if(c=e+o.textContent.length,e<=t&&c>=t)return{node:o,offset:t-e};e=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=R(o)}}function $(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?$(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function I(){for(var e=window,t=wn();t instanceof e.HTMLIFrameElement;){try{var o=typeof t.contentWindow.location.href=="string"}catch{o=!1}if(o)e=t.contentWindow;else break;t=wn(e.document)}return t}function D(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function J(e){var t=I(),o=e.focusedElem,c=e.selectionRange;if(t!==o&&o&&o.ownerDocument&&$(o.ownerDocument.documentElement,o)){if(c!==null&&D(o)){if(t=c.start,e=c.end,e===void 0&&(e=t),"selectionStart"in o)o.selectionStart=t,o.selectionEnd=Math.min(e,o.value.length);else if(e=(t=o.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var f=o.textContent.length,y=Math.min(c.start,f);c=c.end===void 0?y:Math.min(c.end,f),!e.extend&&y>c&&(f=c,c=y,y=f),f=B(o,y);var k=B(o,c);f&&k&&(e.rangeCount!==1||e.anchorNode!==f.node||e.anchorOffset!==f.offset||e.focusNode!==k.node||e.focusOffset!==k.offset)&&(t=t.createRange(),t.setStart(f.node,f.offset),e.removeAllRanges(),y>c?(e.addRange(t),e.extend(k.node,k.offset)):(t.setEnd(k.node,k.offset),e.addRange(t)))}}for(t=[],e=o;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<t.length;o++)e=t[o],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Q=v&&"documentMode"in document&&11>=document.documentMode,H=null,te=null,oe=null,ve=!1;function xe(e,t,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;ve||H==null||H!==wn(c)||(c=H,"selectionStart"in c&&D(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),oe&&O(oe,c)||(oe=c,c=za(te,"onSelect"),0<c.length&&(t=new ms("onSelect","select",null,t,o),e.push({event:t,listeners:c}),t.target=H)))}function le(e,t){var o={};return o[e.toLowerCase()]=t.toLowerCase(),o["Webkit"+e]="webkit"+t,o["Moz"+e]="moz"+t,o}var _e={animationend:le("Animation","AnimationEnd"),animationiteration:le("Animation","AnimationIteration"),animationstart:le("Animation","AnimationStart"),transitionend:le("Transition","TransitionEnd")},ke={},he={};v&&(he=document.createElement("div").style,"AnimationEvent"in window||(delete _e.animationend.animation,delete _e.animationiteration.animation,delete _e.animationstart.animation),"TransitionEvent"in window||delete _e.transitionend.transition);function Ne(e){if(ke[e])return ke[e];if(!_e[e])return e;var t=_e[e],o;for(o in t)if(t.hasOwnProperty(o)&&o in he)return ke[e]=t[o];return e}var Xe=Ne("animationend"),rt=Ne("animationiteration"),Ie=Ne("animationstart"),Je=Ne("transitionend"),yt=new Map,un="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function dt(e,t){yt.set(e,t),h(t,[e])}for(var Qn=0;Qn<un.length;Qn++){var ri=un[Qn],Jf=ri.toLowerCase(),Yf=ri[0].toUpperCase()+ri.slice(1);dt(Jf,"on"+Yf)}dt(Xe,"onAnimationEnd"),dt(rt,"onAnimationIteration"),dt(Ie,"onAnimationStart"),dt("dblclick","onDoubleClick"),dt("focusin","onFocus"),dt("focusout","onBlur"),dt(Je,"onTransitionEnd"),p("onMouseEnter",["mouseout","mouseover"]),p("onMouseLeave",["mouseout","mouseover"]),p("onPointerEnter",["pointerout","pointerover"]),p("onPointerLeave",["pointerout","pointerover"]),h("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),h("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),h("onBeforeInput",["compositionend","keypress","textInput","paste"]),h("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),h("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),h("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qf=new Set("cancel close invalid load scroll toggle".split(" ").concat(Bo));function Yu(e,t,o){var c=e.type||"unknown-event";e.currentTarget=o,as(c,t,void 0,e),e.currentTarget=null}function Qu(e,t){t=(t&4)!==0;for(var o=0;o<e.length;o++){var c=e[o],f=c.event;c=c.listeners;e:{var y=void 0;if(t)for(var k=c.length-1;0<=k;k--){var E=c[k],P=E.instance,X=E.currentTarget;if(E=E.listener,P!==y&&f.isPropagationStopped())break e;Yu(f,E,X),y=P}else for(k=0;k<c.length;k++){if(E=c[k],P=E.instance,X=E.currentTarget,E=E.listener,P!==y&&f.isPropagationStopped())break e;Yu(f,E,X),y=P}}}if(Rr)throw e=os,Rr=!1,os=null,e}function xt(e,t){var o=t[uc];o===void 0&&(o=t[uc]=new Set);var c=e+"__bubble";o.has(c)||(Xu(t,e,2,!1),o.add(c))}function rc(e,t,o){var c=0;t&&(c|=4),Xu(o,e,c,t)}var Ua="_reactListening"+Math.random().toString(36).slice(2);function $o(e){if(!e[Ua]){e[Ua]=!0,a.forEach(function(o){o!=="selectionchange"&&(Qf.has(o)||rc(o,!1,e),rc(o,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ua]||(t[Ua]=!0,rc("selectionchange",!1,t))}}function Xu(e,t,o,c){switch(Zs(t)){case 1:var f=Xl;break;case 4:f=Xs;break;default:f=No}o=f.bind(null,t,o,e),f=void 0,!is||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(f=!0),c?f!==void 0?e.addEventListener(t,o,{capture:!0,passive:f}):e.addEventListener(t,o,!0):f!==void 0?e.addEventListener(t,o,{passive:f}):e.addEventListener(t,o,!1)}function sc(e,t,o,c,f){var y=c;if((t&1)===0&&(t&2)===0&&c!==null)e:for(;;){if(c===null)return;var k=c.tag;if(k===3||k===4){var E=c.stateNode.containerInfo;if(E===f||E.nodeType===8&&E.parentNode===f)break;if(k===4)for(k=c.return;k!==null;){var P=k.tag;if((P===3||P===4)&&(P=k.stateNode.containerInfo,P===f||P.nodeType===8&&P.parentNode===f))return;k=k.return}for(;E!==null;){if(k=si(E),k===null)return;if(P=k.tag,P===5||P===6){c=y=k;continue e}E=E.parentNode}}c=c.return}Er(function(){var X=y,ce=tn(o),ue=[];e:{var ae=yt.get(e);if(ae!==void 0){var Se=ms,Ae=e;switch(e){case"keypress":if(fs(o)===0)break e;case"keydown":case"keyup":Se=Ro;break;case"focusin":Ae="focus",Se=Ti;break;case"focusout":Ae="blur",Se=Ti;break;case"beforeblur":case"afterblur":Se=Ti;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Se=Ai;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Se=ti;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Se=Oo;break;case Xe:case rt:case Ie:Se=Ta;break;case Je:Se=Oa;break;case"scroll":Se=Zl;break;case"wheel":Se=Da;break;case"copy":case"cut":case"paste":Se=Pi;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Se=Pa}var Re=(t&4)!==0,Ot=!Re&&e==="scroll",G=Re?ae!==null?ae+"Capture":null:ae;Re=[];for(var z=X,Y;z!==null;){Y=z;var pe=Y.stateNode;if(Y.tag===5&&pe!==null&&(Y=pe,G!==null&&(pe=Ar(z,G),pe!=null&&Re.push(Uo(z,pe,Y)))),Ot)break;z=z.return}0<Re.length&&(ae=new Se(ae,Ae,null,o,ce),ue.push({event:ae,listeners:Re}))}}if((t&7)===0){e:{if(ae=e==="mouseover"||e==="pointerover",Se=e==="mouseout"||e==="pointerout",ae&&o!==St&&(Ae=o.relatedTarget||o.fromElement)&&(si(Ae)||Ae[qr]))break e;if((Se||ae)&&(ae=ce.window===ce?ce:(ae=ce.ownerDocument)?ae.defaultView||ae.parentWindow:window,Se?(Ae=o.relatedTarget||o.toElement,Se=X,Ae=Ae?si(Ae):null,Ae!==null&&(Ot=nn(Ae),Ae!==Ot||Ae.tag!==5&&Ae.tag!==6)&&(Ae=null)):(Se=null,Ae=X),Se!==Ae)){if(Re=Ai,pe="onMouseLeave",G="onMouseEnter",z="mouse",(e==="pointerout"||e==="pointerover")&&(Re=Pa,pe="onPointerLeave",G="onPointerEnter",z="pointer"),Ot=Se==null?ae:Ui(Se),Y=Ae==null?ae:Ui(Ae),ae=new Re(pe,z+"leave",Se,o,ce),ae.target=Ot,ae.relatedTarget=Y,pe=null,si(ce)===X&&(Re=new Re(G,z+"enter",Ae,o,ce),Re.target=Y,Re.relatedTarget=Ot,pe=Re),Ot=pe,Se&&Ae)t:{for(Re=Se,G=Ae,z=0,Y=Re;Y;Y=Bi(Y))z++;for(Y=0,pe=G;pe;pe=Bi(pe))Y++;for(;0<z-Y;)Re=Bi(Re),z--;for(;0<Y-z;)G=Bi(G),Y--;for(;z--;){if(Re===G||G!==null&&Re===G.alternate)break t;Re=Bi(Re),G=Bi(G)}Re=null}else Re=null;Se!==null&&Zu(ue,ae,Se,Re,!1),Ae!==null&&Ot!==null&&Zu(ue,Ot,Ae,Re,!0)}}e:{if(ae=X?Ui(X):window,Se=ae.nodeName&&ae.nodeName.toLowerCase(),Se==="select"||Se==="input"&&ae.type==="file")var Pe=ws;else if($r(ae))if(Yn)Pe=S;else{Pe=w;var Le=b}else(Se=ae.nodeName)&&Se.toLowerCase()==="input"&&(ae.type==="checkbox"||ae.type==="radio")&&(Pe=N);if(Pe&&(Pe=Pe(e,X))){$a(ue,Pe,o,ce);break e}Le&&Le(e,ae,X),e==="focusout"&&(Le=ae._wrapperState)&&Le.controlled&&ae.type==="number"&&rs(ae,"number",ae.value)}switch(Le=X?Ui(X):window,e){case"focusin":($r(Le)||Le.contentEditable==="true")&&(H=Le,te=X,oe=null);break;case"focusout":oe=te=H=null;break;case"mousedown":ve=!0;break;case"contextmenu":case"mouseup":case"dragend":ve=!1,xe(ue,o,ce);break;case"selectionchange":if(Q)break;case"keydown":case"keyup":xe(ue,o,ce)}var Be;if(Do)e:{switch(e){case"compositionstart":var He="onCompositionStart";break e;case"compositionend":He="onCompositionEnd";break e;case"compositionupdate":He="onCompositionUpdate";break e}He=void 0}else Gn?La(e,o)&&(He="onCompositionEnd"):e==="keydown"&&o.keyCode===229&&(He="onCompositionStart");He&&(Mo&&o.locale!=="ko"&&(Gn||He!=="onCompositionStart"?He==="onCompositionEnd"&&Gn&&(Be=Aa()):(Rn=ce,So="value"in Rn?Rn.value:Rn.textContent,Gn=!0)),Le=za(X,He),0<Le.length&&(He=new wr(He,e,null,o,ce),ue.push({event:He,listeners:Le}),Be?He.data=Be:(Be=Ba(o),Be!==null&&(He.data=Be)))),(Be=Io?Jn(e,o):Ft(e,o))&&(X=za(X,"onBeforeInput"),0<X.length&&(ce=new wr("onBeforeInput","beforeinput",null,o,ce),ue.push({event:ce,listeners:X}),ce.data=Be))}Qu(ue,t)})}function Uo(e,t,o){return{instance:e,listener:t,currentTarget:o}}function za(e,t){for(var o=t+"Capture",c=[];e!==null;){var f=e,y=f.stateNode;f.tag===5&&y!==null&&(f=y,y=Ar(e,o),y!=null&&c.unshift(Uo(e,y,f)),y=Ar(e,t),y!=null&&c.push(Uo(e,y,f))),e=e.return}return c}function Bi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Zu(e,t,o,c,f){for(var y=t._reactName,k=[];o!==null&&o!==c;){var E=o,P=E.alternate,X=E.stateNode;if(P!==null&&P===c)break;E.tag===5&&X!==null&&(E=X,f?(P=Ar(o,y),P!=null&&k.unshift(Uo(o,P,E))):f||(P=Ar(o,y),P!=null&&k.push(Uo(o,P,E)))),o=o.return}k.length!==0&&e.push({event:t,listeners:k})}var Xf=/\r\n?/g,Zf=/\u0000|\uFFFD/g;function ed(e){return(typeof e=="string"?e:""+e).replace(Xf,`
`).replace(Zf,"")}function qa(e,t,o){if(t=ed(t),ed(e)!==t&&o)throw Error(r(425))}function Wa(){}var ic=null,oc=null;function ac(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var lc=typeof setTimeout=="function"?setTimeout:void 0,ep=typeof clearTimeout=="function"?clearTimeout:void 0,td=typeof Promise=="function"?Promise:void 0,tp=typeof queueMicrotask=="function"?queueMicrotask:typeof td<"u"?function(e){return td.resolve(null).then(e).catch(np)}:lc;function np(e){setTimeout(function(){throw e})}function cc(e,t){var o=t,c=0;do{var f=o.nextSibling;if(e.removeChild(o),f&&f.nodeType===8)if(o=f.data,o==="/$"){if(c===0){e.removeChild(f),Hn(t);return}c--}else o!=="$"&&o!=="$?"&&o!=="$!"||c++;o=f}while(o);Hn(t)}function ks(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function nd(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var o=e.data;if(o==="$"||o==="$!"||o==="$?"){if(t===0)return e;t--}else o==="/$"&&t++}e=e.previousSibling}return null}var $i=Math.random().toString(36).slice(2),kr="__reactFiber$"+$i,zo="__reactProps$"+$i,qr="__reactContainer$"+$i,uc="__reactEvents$"+$i,rp="__reactListeners$"+$i,sp="__reactHandles$"+$i;function si(e){var t=e[kr];if(t)return t;for(var o=e.parentNode;o;){if(t=o[qr]||o[kr]){if(o=t.alternate,t.child!==null||o!==null&&o.child!==null)for(e=nd(e);e!==null;){if(o=e[kr])return o;e=nd(e)}return t}e=o,o=e.parentNode}return null}function qo(e){return e=e[kr]||e[qr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ui(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(r(33))}function Ka(e){return e[zo]||null}var dc=[],zi=-1;function _s(e){return{current:e}}function bt(e){0>zi||(e.current=dc[zi],dc[zi]=null,zi--)}function gt(e,t){zi++,dc[zi]=e.current,e.current=t}var js={},rn=_s(js),fn=_s(!1),ii=js;function qi(e,t){var o=e.type.contextTypes;if(!o)return js;var c=e.stateNode;if(c&&c.__reactInternalMemoizedUnmaskedChildContext===t)return c.__reactInternalMemoizedMaskedChildContext;var f={},y;for(y in o)f[y]=t[y];return c&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=f),f}function pn(e){return e=e.childContextTypes,e!=null}function Ha(){bt(fn),bt(rn)}function rd(e,t,o){if(rn.current!==js)throw Error(r(168));gt(rn,t),gt(fn,o)}function sd(e,t,o){var c=e.stateNode;if(t=t.childContextTypes,typeof c.getChildContext!="function")return o;c=c.getChildContext();for(var f in c)if(!(f in t))throw Error(r(108,et(e)||"Unknown",f));return se({},o,c)}function Va(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||js,ii=rn.current,gt(rn,e),gt(fn,fn.current),!0}function id(e,t,o){var c=e.stateNode;if(!c)throw Error(r(169));o?(e=sd(e,t,ii),c.__reactInternalMemoizedMergedChildContext=e,bt(fn),bt(rn),gt(rn,e)):bt(fn),gt(fn,o)}var Wr=null,Ga=!1,hc=!1;function od(e){Wr===null?Wr=[e]:Wr.push(e)}function ip(e){Ga=!0,od(e)}function Ns(){if(!hc&&Wr!==null){hc=!0;var e=0,t=ot;try{var o=Wr;for(ot=1;e<o.length;e++){var c=o[e];do c=c(!0);while(c!==null)}Wr=null,Ga=!1}catch(f){throw Wr!==null&&(Wr=Wr.slice(e+1)),wo(mr,Ns),f}finally{ot=t,hc=!1}}return null}var Wi=[],Ki=0,Ja=null,Ya=0,Pn=[],On=0,oi=null,Kr=1,Hr="";function ai(e,t){Wi[Ki++]=Ya,Wi[Ki++]=Ja,Ja=e,Ya=t}function ad(e,t,o){Pn[On++]=Kr,Pn[On++]=Hr,Pn[On++]=oi,oi=e;var c=Kr;e=Hr;var f=32-Ke(c)-1;c&=~(1<<f),o+=1;var y=32-Ke(t)+f;if(30<y){var k=f-f%5;y=(c&(1<<k)-1).toString(32),c>>=k,f-=k,Kr=1<<32-Ke(t)+f|o<<f|c,Hr=y+e}else Kr=1<<y|o<<f|c,Hr=e}function fc(e){e.return!==null&&(ai(e,1),ad(e,1,0))}function pc(e){for(;e===Ja;)Ja=Wi[--Ki],Wi[Ki]=null,Ya=Wi[--Ki],Wi[Ki]=null;for(;e===oi;)oi=Pn[--On],Pn[On]=null,Hr=Pn[--On],Pn[On]=null,Kr=Pn[--On],Pn[On]=null}var Sn=null,Cn=null,_t=!1,Xn=null;function ld(e,t){var o=Ln(5,null,null,0);o.elementType="DELETED",o.stateNode=t,o.return=e,t=e.deletions,t===null?(e.deletions=[o],e.flags|=16):t.push(o)}function cd(e,t){switch(e.tag){case 5:var o=e.type;return t=t.nodeType!==1||o.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Sn=e,Cn=ks(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Sn=e,Cn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(o=oi!==null?{id:Kr,overflow:Hr}:null,e.memoizedState={dehydrated:t,treeContext:o,retryLane:1073741824},o=Ln(18,null,null,0),o.stateNode=t,o.return=e,e.child=o,Sn=e,Cn=null,!0):!1;default:return!1}}function mc(e){return(e.mode&1)!==0&&(e.flags&128)===0}function yc(e){if(_t){var t=Cn;if(t){var o=t;if(!cd(e,t)){if(mc(e))throw Error(r(418));t=ks(o.nextSibling);var c=Sn;t&&cd(e,t)?ld(c,o):(e.flags=e.flags&-4097|2,_t=!1,Sn=e)}}else{if(mc(e))throw Error(r(418));e.flags=e.flags&-4097|2,_t=!1,Sn=e}}}function ud(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Sn=e}function Qa(e){if(e!==Sn)return!1;if(!_t)return ud(e),_t=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ac(e.type,e.memoizedProps)),t&&(t=Cn)){if(mc(e))throw dd(),Error(r(418));for(;t;)ld(e,t),t=ks(t.nextSibling)}if(ud(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(r(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var o=e.data;if(o==="/$"){if(t===0){Cn=ks(e.nextSibling);break e}t--}else o!=="$"&&o!=="$!"&&o!=="$?"||t++}e=e.nextSibling}Cn=null}}else Cn=Sn?ks(e.stateNode.nextSibling):null;return!0}function dd(){for(var e=Cn;e;)e=ks(e.nextSibling)}function Hi(){Cn=Sn=null,_t=!1}function gc(e){Xn===null?Xn=[e]:Xn.push(e)}var op=ie.ReactCurrentBatchConfig;function Wo(e,t,o){if(e=o.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(r(309));var c=o.stateNode}if(!c)throw Error(r(147,e));var f=c,y=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===y?t.ref:(t=function(k){var E=f.refs;k===null?delete E[y]:E[y]=k},t._stringRef=y,t)}if(typeof e!="string")throw Error(r(284));if(!o._owner)throw Error(r(290,e))}return e}function Xa(e,t){throw e=Object.prototype.toString.call(t),Error(r(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function hd(e){var t=e._init;return t(e._payload)}function fd(e){function t(G,z){if(e){var Y=G.deletions;Y===null?(G.deletions=[z],G.flags|=16):Y.push(z)}}function o(G,z){if(!e)return null;for(;z!==null;)t(G,z),z=z.sibling;return null}function c(G,z){for(G=new Map;z!==null;)z.key!==null?G.set(z.key,z):G.set(z.index,z),z=z.sibling;return G}function f(G,z){return G=Ps(G,z),G.index=0,G.sibling=null,G}function y(G,z,Y){return G.index=Y,e?(Y=G.alternate,Y!==null?(Y=Y.index,Y<z?(G.flags|=2,z):Y):(G.flags|=2,z)):(G.flags|=1048576,z)}function k(G){return e&&G.alternate===null&&(G.flags|=2),G}function E(G,z,Y,pe){return z===null||z.tag!==6?(z=lu(Y,G.mode,pe),z.return=G,z):(z=f(z,Y),z.return=G,z)}function P(G,z,Y,pe){var Pe=Y.type;return Pe===fe?ce(G,z,Y.props.children,pe,Y.key):z!==null&&(z.elementType===Pe||typeof Pe=="object"&&Pe!==null&&Pe.$$typeof===ft&&hd(Pe)===z.type)?(pe=f(z,Y.props),pe.ref=Wo(G,z,Y),pe.return=G,pe):(pe=kl(Y.type,Y.key,Y.props,null,G.mode,pe),pe.ref=Wo(G,z,Y),pe.return=G,pe)}function X(G,z,Y,pe){return z===null||z.tag!==4||z.stateNode.containerInfo!==Y.containerInfo||z.stateNode.implementation!==Y.implementation?(z=cu(Y,G.mode,pe),z.return=G,z):(z=f(z,Y.children||[]),z.return=G,z)}function ce(G,z,Y,pe,Pe){return z===null||z.tag!==7?(z=mi(Y,G.mode,pe,Pe),z.return=G,z):(z=f(z,Y),z.return=G,z)}function ue(G,z,Y){if(typeof z=="string"&&z!==""||typeof z=="number")return z=lu(""+z,G.mode,Y),z.return=G,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case ee:return Y=kl(z.type,z.key,z.props,null,G.mode,Y),Y.ref=Wo(G,null,z),Y.return=G,Y;case me:return z=cu(z,G.mode,Y),z.return=G,z;case ft:var pe=z._init;return ue(G,pe(z._payload),Y)}if($n(z)||Ce(z))return z=mi(z,G.mode,Y,null),z.return=G,z;Xa(G,z)}return null}function ae(G,z,Y,pe){var Pe=z!==null?z.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Pe!==null?null:E(G,z,""+Y,pe);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case ee:return Y.key===Pe?P(G,z,Y,pe):null;case me:return Y.key===Pe?X(G,z,Y,pe):null;case ft:return Pe=Y._init,ae(G,z,Pe(Y._payload),pe)}if($n(Y)||Ce(Y))return Pe!==null?null:ce(G,z,Y,pe,null);Xa(G,Y)}return null}function Se(G,z,Y,pe,Pe){if(typeof pe=="string"&&pe!==""||typeof pe=="number")return G=G.get(Y)||null,E(z,G,""+pe,Pe);if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case ee:return G=G.get(pe.key===null?Y:pe.key)||null,P(z,G,pe,Pe);case me:return G=G.get(pe.key===null?Y:pe.key)||null,X(z,G,pe,Pe);case ft:var Le=pe._init;return Se(G,z,Y,Le(pe._payload),Pe)}if($n(pe)||Ce(pe))return G=G.get(Y)||null,ce(z,G,pe,Pe,null);Xa(z,pe)}return null}function Ae(G,z,Y,pe){for(var Pe=null,Le=null,Be=z,He=z=0,Ht=null;Be!==null&&He<Y.length;He++){Be.index>He?(Ht=Be,Be=null):Ht=Be.sibling;var ct=ae(G,Be,Y[He],pe);if(ct===null){Be===null&&(Be=Ht);break}e&&Be&&ct.alternate===null&&t(G,Be),z=y(ct,z,He),Le===null?Pe=ct:Le.sibling=ct,Le=ct,Be=Ht}if(He===Y.length)return o(G,Be),_t&&ai(G,He),Pe;if(Be===null){for(;He<Y.length;He++)Be=ue(G,Y[He],pe),Be!==null&&(z=y(Be,z,He),Le===null?Pe=Be:Le.sibling=Be,Le=Be);return _t&&ai(G,He),Pe}for(Be=c(G,Be);He<Y.length;He++)Ht=Se(Be,G,He,Y[He],pe),Ht!==null&&(e&&Ht.alternate!==null&&Be.delete(Ht.key===null?He:Ht.key),z=y(Ht,z,He),Le===null?Pe=Ht:Le.sibling=Ht,Le=Ht);return e&&Be.forEach(function(Os){return t(G,Os)}),_t&&ai(G,He),Pe}function Re(G,z,Y,pe){var Pe=Ce(Y);if(typeof Pe!="function")throw Error(r(150));if(Y=Pe.call(Y),Y==null)throw Error(r(151));for(var Le=Pe=null,Be=z,He=z=0,Ht=null,ct=Y.next();Be!==null&&!ct.done;He++,ct=Y.next()){Be.index>He?(Ht=Be,Be=null):Ht=Be.sibling;var Os=ae(G,Be,ct.value,pe);if(Os===null){Be===null&&(Be=Ht);break}e&&Be&&Os.alternate===null&&t(G,Be),z=y(Os,z,He),Le===null?Pe=Os:Le.sibling=Os,Le=Os,Be=Ht}if(ct.done)return o(G,Be),_t&&ai(G,He),Pe;if(Be===null){for(;!ct.done;He++,ct=Y.next())ct=ue(G,ct.value,pe),ct!==null&&(z=y(ct,z,He),Le===null?Pe=ct:Le.sibling=ct,Le=ct);return _t&&ai(G,He),Pe}for(Be=c(G,Be);!ct.done;He++,ct=Y.next())ct=Se(Be,G,He,ct.value,pe),ct!==null&&(e&&ct.alternate!==null&&Be.delete(ct.key===null?He:ct.key),z=y(ct,z,He),Le===null?Pe=ct:Le.sibling=ct,Le=ct);return e&&Be.forEach(function(Bp){return t(G,Bp)}),_t&&ai(G,He),Pe}function Ot(G,z,Y,pe){if(typeof Y=="object"&&Y!==null&&Y.type===fe&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case ee:e:{for(var Pe=Y.key,Le=z;Le!==null;){if(Le.key===Pe){if(Pe=Y.type,Pe===fe){if(Le.tag===7){o(G,Le.sibling),z=f(Le,Y.props.children),z.return=G,G=z;break e}}else if(Le.elementType===Pe||typeof Pe=="object"&&Pe!==null&&Pe.$$typeof===ft&&hd(Pe)===Le.type){o(G,Le.sibling),z=f(Le,Y.props),z.ref=Wo(G,Le,Y),z.return=G,G=z;break e}o(G,Le);break}else t(G,Le);Le=Le.sibling}Y.type===fe?(z=mi(Y.props.children,G.mode,pe,Y.key),z.return=G,G=z):(pe=kl(Y.type,Y.key,Y.props,null,G.mode,pe),pe.ref=Wo(G,z,Y),pe.return=G,G=pe)}return k(G);case me:e:{for(Le=Y.key;z!==null;){if(z.key===Le)if(z.tag===4&&z.stateNode.containerInfo===Y.containerInfo&&z.stateNode.implementation===Y.implementation){o(G,z.sibling),z=f(z,Y.children||[]),z.return=G,G=z;break e}else{o(G,z);break}else t(G,z);z=z.sibling}z=cu(Y,G.mode,pe),z.return=G,G=z}return k(G);case ft:return Le=Y._init,Ot(G,z,Le(Y._payload),pe)}if($n(Y))return Ae(G,z,Y,pe);if(Ce(Y))return Re(G,z,Y,pe);Xa(G,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"?(Y=""+Y,z!==null&&z.tag===6?(o(G,z.sibling),z=f(z,Y),z.return=G,G=z):(o(G,z),z=lu(Y,G.mode,pe),z.return=G,G=z),k(G)):o(G,z)}return Ot}var Vi=fd(!0),pd=fd(!1),Za=_s(null),el=null,Gi=null,vc=null;function xc(){vc=Gi=el=null}function bc(e){var t=Za.current;bt(Za),e._currentValue=t}function wc(e,t,o){for(;e!==null;){var c=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,c!==null&&(c.childLanes|=t)):c!==null&&(c.childLanes&t)!==t&&(c.childLanes|=t),e===o)break;e=e.return}}function Ji(e,t){el=e,vc=Gi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(mn=!0),e.firstContext=null)}function Dn(e){var t=e._currentValue;if(vc!==e)if(e={context:e,memoizedValue:t,next:null},Gi===null){if(el===null)throw Error(r(308));Gi=e,el.dependencies={lanes:0,firstContext:e}}else Gi=Gi.next=e;return t}var li=null;function kc(e){li===null?li=[e]:li.push(e)}function md(e,t,o,c){var f=t.interleaved;return f===null?(o.next=o,kc(t)):(o.next=f.next,f.next=o),t.interleaved=o,Vr(e,c)}function Vr(e,t){e.lanes|=t;var o=e.alternate;for(o!==null&&(o.lanes|=t),o=e,e=e.return;e!==null;)e.childLanes|=t,o=e.alternate,o!==null&&(o.childLanes|=t),o=e,e=e.return;return o.tag===3?o.stateNode:null}var Ss=!1;function _c(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function yd(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Gr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Cs(e,t,o){var c=e.updateQueue;if(c===null)return null;if(c=c.shared,(at&2)!==0){var f=c.pending;return f===null?t.next=t:(t.next=f.next,f.next=t),c.pending=t,Vr(e,o)}return f=c.interleaved,f===null?(t.next=t,kc(c)):(t.next=f.next,f.next=t),c.interleaved=t,Vr(e,o)}function tl(e,t,o){if(t=t.updateQueue,t!==null&&(t=t.shared,(o&4194240)!==0)){var c=t.lanes;c&=e.pendingLanes,o|=c,t.lanes=o,Si(e,o)}}function gd(e,t){var o=e.updateQueue,c=e.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var f=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var k={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};y===null?f=y=k:y=y.next=k,o=o.next}while(o!==null);y===null?f=y=t:y=y.next=t}else f=y=t;o={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:y,shared:c.shared,effects:c.effects},e.updateQueue=o;return}e=o.lastBaseUpdate,e===null?o.firstBaseUpdate=t:e.next=t,o.lastBaseUpdate=t}function nl(e,t,o,c){var f=e.updateQueue;Ss=!1;var y=f.firstBaseUpdate,k=f.lastBaseUpdate,E=f.shared.pending;if(E!==null){f.shared.pending=null;var P=E,X=P.next;P.next=null,k===null?y=X:k.next=X,k=P;var ce=e.alternate;ce!==null&&(ce=ce.updateQueue,E=ce.lastBaseUpdate,E!==k&&(E===null?ce.firstBaseUpdate=X:E.next=X,ce.lastBaseUpdate=P))}if(y!==null){var ue=f.baseState;k=0,ce=X=P=null,E=y;do{var ae=E.lane,Se=E.eventTime;if((c&ae)===ae){ce!==null&&(ce=ce.next={eventTime:Se,lane:0,tag:E.tag,payload:E.payload,callback:E.callback,next:null});e:{var Ae=e,Re=E;switch(ae=t,Se=o,Re.tag){case 1:if(Ae=Re.payload,typeof Ae=="function"){ue=Ae.call(Se,ue,ae);break e}ue=Ae;break e;case 3:Ae.flags=Ae.flags&-65537|128;case 0:if(Ae=Re.payload,ae=typeof Ae=="function"?Ae.call(Se,ue,ae):Ae,ae==null)break e;ue=se({},ue,ae);break e;case 2:Ss=!0}}E.callback!==null&&E.lane!==0&&(e.flags|=64,ae=f.effects,ae===null?f.effects=[E]:ae.push(E))}else Se={eventTime:Se,lane:ae,tag:E.tag,payload:E.payload,callback:E.callback,next:null},ce===null?(X=ce=Se,P=ue):ce=ce.next=Se,k|=ae;if(E=E.next,E===null){if(E=f.shared.pending,E===null)break;ae=E,E=ae.next,ae.next=null,f.lastBaseUpdate=ae,f.shared.pending=null}}while(!0);if(ce===null&&(P=ue),f.baseState=P,f.firstBaseUpdate=X,f.lastBaseUpdate=ce,t=f.shared.interleaved,t!==null){f=t;do k|=f.lane,f=f.next;while(f!==t)}else y===null&&(f.shared.lanes=0);di|=k,e.lanes=k,e.memoizedState=ue}}function vd(e,t,o){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var c=e[t],f=c.callback;if(f!==null){if(c.callback=null,c=o,typeof f!="function")throw Error(r(191,f));f.call(c)}}}var Ko={},_r=_s(Ko),Ho=_s(Ko),Vo=_s(Ko);function ci(e){if(e===Ko)throw Error(r(174));return e}function jc(e,t){switch(gt(Vo,t),gt(Ho,e),gt(_r,Ko),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:_n(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=_n(t,e)}bt(_r),gt(_r,t)}function Yi(){bt(_r),bt(Ho),bt(Vo)}function xd(e){ci(Vo.current);var t=ci(_r.current),o=_n(t,e.type);t!==o&&(gt(Ho,e),gt(_r,o))}function Nc(e){Ho.current===e&&(bt(_r),bt(Ho))}var Et=_s(0);function rl(e){for(var t=e;t!==null;){if(t.tag===13){var o=t.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Sc=[];function Cc(){for(var e=0;e<Sc.length;e++)Sc[e]._workInProgressVersionPrimary=null;Sc.length=0}var sl=ie.ReactCurrentDispatcher,Fc=ie.ReactCurrentBatchConfig,ui=0,At=null,Bt=null,Wt=null,il=!1,Go=!1,Jo=0,ap=0;function sn(){throw Error(r(321))}function Ec(e,t){if(t===null)return!1;for(var o=0;o<t.length&&o<e.length;o++)if(!K(e[o],t[o]))return!1;return!0}function Ac(e,t,o,c,f,y){if(ui=y,At=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,sl.current=e===null||e.memoizedState===null?dp:hp,e=o(c,f),Go){y=0;do{if(Go=!1,Jo=0,25<=y)throw Error(r(301));y+=1,Wt=Bt=null,t.updateQueue=null,sl.current=fp,e=o(c,f)}while(Go)}if(sl.current=ll,t=Bt!==null&&Bt.next!==null,ui=0,Wt=Bt=At=null,il=!1,t)throw Error(r(300));return e}function Tc(){var e=Jo!==0;return Jo=0,e}function jr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wt===null?At.memoizedState=Wt=e:Wt=Wt.next=e,Wt}function In(){if(Bt===null){var e=At.alternate;e=e!==null?e.memoizedState:null}else e=Bt.next;var t=Wt===null?At.memoizedState:Wt.next;if(t!==null)Wt=t,Bt=e;else{if(e===null)throw Error(r(310));Bt=e,e={memoizedState:Bt.memoizedState,baseState:Bt.baseState,baseQueue:Bt.baseQueue,queue:Bt.queue,next:null},Wt===null?At.memoizedState=Wt=e:Wt=Wt.next=e}return Wt}function Yo(e,t){return typeof t=="function"?t(e):t}function Rc(e){var t=In(),o=t.queue;if(o===null)throw Error(r(311));o.lastRenderedReducer=e;var c=Bt,f=c.baseQueue,y=o.pending;if(y!==null){if(f!==null){var k=f.next;f.next=y.next,y.next=k}c.baseQueue=f=y,o.pending=null}if(f!==null){y=f.next,c=c.baseState;var E=k=null,P=null,X=y;do{var ce=X.lane;if((ui&ce)===ce)P!==null&&(P=P.next={lane:0,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null}),c=X.hasEagerState?X.eagerState:e(c,X.action);else{var ue={lane:ce,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null};P===null?(E=P=ue,k=c):P=P.next=ue,At.lanes|=ce,di|=ce}X=X.next}while(X!==null&&X!==y);P===null?k=c:P.next=E,K(c,t.memoizedState)||(mn=!0),t.memoizedState=c,t.baseState=k,t.baseQueue=P,o.lastRenderedState=c}if(e=o.interleaved,e!==null){f=e;do y=f.lane,At.lanes|=y,di|=y,f=f.next;while(f!==e)}else f===null&&(o.lanes=0);return[t.memoizedState,o.dispatch]}function Pc(e){var t=In(),o=t.queue;if(o===null)throw Error(r(311));o.lastRenderedReducer=e;var c=o.dispatch,f=o.pending,y=t.memoizedState;if(f!==null){o.pending=null;var k=f=f.next;do y=e(y,k.action),k=k.next;while(k!==f);K(y,t.memoizedState)||(mn=!0),t.memoizedState=y,t.baseQueue===null&&(t.baseState=y),o.lastRenderedState=y}return[y,c]}function bd(){}function wd(e,t){var o=At,c=In(),f=t(),y=!K(c.memoizedState,f);if(y&&(c.memoizedState=f,mn=!0),c=c.queue,Oc(jd.bind(null,o,c,e),[e]),c.getSnapshot!==t||y||Wt!==null&&Wt.memoizedState.tag&1){if(o.flags|=2048,Qo(9,_d.bind(null,o,c,f,t),void 0,null),Kt===null)throw Error(r(349));(ui&30)!==0||kd(o,t,f)}return f}function kd(e,t,o){e.flags|=16384,e={getSnapshot:t,value:o},t=At.updateQueue,t===null?(t={lastEffect:null,stores:null},At.updateQueue=t,t.stores=[e]):(o=t.stores,o===null?t.stores=[e]:o.push(e))}function _d(e,t,o,c){t.value=o,t.getSnapshot=c,Nd(t)&&Sd(e)}function jd(e,t,o){return o(function(){Nd(t)&&Sd(e)})}function Nd(e){var t=e.getSnapshot;e=e.value;try{var o=t();return!K(e,o)}catch{return!0}}function Sd(e){var t=Vr(e,1);t!==null&&nr(t,e,1,-1)}function Cd(e){var t=jr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Yo,lastRenderedState:e},t.queue=e,e=e.dispatch=up.bind(null,At,e),[t.memoizedState,e]}function Qo(e,t,o,c){return e={tag:e,create:t,destroy:o,deps:c,next:null},t=At.updateQueue,t===null?(t={lastEffect:null,stores:null},At.updateQueue=t,t.lastEffect=e.next=e):(o=t.lastEffect,o===null?t.lastEffect=e.next=e:(c=o.next,o.next=e,e.next=c,t.lastEffect=e)),e}function Fd(){return In().memoizedState}function ol(e,t,o,c){var f=jr();At.flags|=e,f.memoizedState=Qo(1|t,o,void 0,c===void 0?null:c)}function al(e,t,o,c){var f=In();c=c===void 0?null:c;var y=void 0;if(Bt!==null){var k=Bt.memoizedState;if(y=k.destroy,c!==null&&Ec(c,k.deps)){f.memoizedState=Qo(t,o,y,c);return}}At.flags|=e,f.memoizedState=Qo(1|t,o,y,c)}function Ed(e,t){return ol(8390656,8,e,t)}function Oc(e,t){return al(2048,8,e,t)}function Ad(e,t){return al(4,2,e,t)}function Td(e,t){return al(4,4,e,t)}function Rd(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Pd(e,t,o){return o=o!=null?o.concat([e]):null,al(4,4,Rd.bind(null,t,e),o)}function Dc(){}function Od(e,t){var o=In();t=t===void 0?null:t;var c=o.memoizedState;return c!==null&&t!==null&&Ec(t,c[1])?c[0]:(o.memoizedState=[e,t],e)}function Dd(e,t){var o=In();t=t===void 0?null:t;var c=o.memoizedState;return c!==null&&t!==null&&Ec(t,c[1])?c[0]:(e=e(),o.memoizedState=[e,t],e)}function Id(e,t,o){return(ui&21)===0?(e.baseState&&(e.baseState=!1,mn=!0),e.memoizedState=o):(K(o,t)||(o=Dr(),At.lanes|=o,di|=o,e.baseState=!0),t)}function lp(e,t){var o=ot;ot=o!==0&&4>o?o:4,e(!0);var c=Fc.transition;Fc.transition={};try{e(!1),t()}finally{ot=o,Fc.transition=c}}function Md(){return In().memoizedState}function cp(e,t,o){var c=Ts(e);if(o={lane:c,action:o,hasEagerState:!1,eagerState:null,next:null},Ld(e))Bd(t,o);else if(o=md(e,t,o,c),o!==null){var f=hn();nr(o,e,c,f),$d(o,t,c)}}function up(e,t,o){var c=Ts(e),f={lane:c,action:o,hasEagerState:!1,eagerState:null,next:null};if(Ld(e))Bd(t,f);else{var y=e.alternate;if(e.lanes===0&&(y===null||y.lanes===0)&&(y=t.lastRenderedReducer,y!==null))try{var k=t.lastRenderedState,E=y(k,o);if(f.hasEagerState=!0,f.eagerState=E,K(E,k)){var P=t.interleaved;P===null?(f.next=f,kc(t)):(f.next=P.next,P.next=f),t.interleaved=f;return}}catch{}finally{}o=md(e,t,f,c),o!==null&&(f=hn(),nr(o,e,c,f),$d(o,t,c))}}function Ld(e){var t=e.alternate;return e===At||t!==null&&t===At}function Bd(e,t){Go=il=!0;var o=e.pending;o===null?t.next=t:(t.next=o.next,o.next=t),e.pending=t}function $d(e,t,o){if((o&4194240)!==0){var c=t.lanes;c&=e.pendingLanes,o|=c,t.lanes=o,Si(e,o)}}var ll={readContext:Dn,useCallback:sn,useContext:sn,useEffect:sn,useImperativeHandle:sn,useInsertionEffect:sn,useLayoutEffect:sn,useMemo:sn,useReducer:sn,useRef:sn,useState:sn,useDebugValue:sn,useDeferredValue:sn,useTransition:sn,useMutableSource:sn,useSyncExternalStore:sn,useId:sn,unstable_isNewReconciler:!1},dp={readContext:Dn,useCallback:function(e,t){return jr().memoizedState=[e,t===void 0?null:t],e},useContext:Dn,useEffect:Ed,useImperativeHandle:function(e,t,o){return o=o!=null?o.concat([e]):null,ol(4194308,4,Rd.bind(null,t,e),o)},useLayoutEffect:function(e,t){return ol(4194308,4,e,t)},useInsertionEffect:function(e,t){return ol(4,2,e,t)},useMemo:function(e,t){var o=jr();return t=t===void 0?null:t,e=e(),o.memoizedState=[e,t],e},useReducer:function(e,t,o){var c=jr();return t=o!==void 0?o(t):t,c.memoizedState=c.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},c.queue=e,e=e.dispatch=cp.bind(null,At,e),[c.memoizedState,e]},useRef:function(e){var t=jr();return e={current:e},t.memoizedState=e},useState:Cd,useDebugValue:Dc,useDeferredValue:function(e){return jr().memoizedState=e},useTransition:function(){var e=Cd(!1),t=e[0];return e=lp.bind(null,e[1]),jr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,o){var c=At,f=jr();if(_t){if(o===void 0)throw Error(r(407));o=o()}else{if(o=t(),Kt===null)throw Error(r(349));(ui&30)!==0||kd(c,t,o)}f.memoizedState=o;var y={value:o,getSnapshot:t};return f.queue=y,Ed(jd.bind(null,c,y,e),[e]),c.flags|=2048,Qo(9,_d.bind(null,c,y,o,t),void 0,null),o},useId:function(){var e=jr(),t=Kt.identifierPrefix;if(_t){var o=Hr,c=Kr;o=(c&~(1<<32-Ke(c)-1)).toString(32)+o,t=":"+t+"R"+o,o=Jo++,0<o&&(t+="H"+o.toString(32)),t+=":"}else o=ap++,t=":"+t+"r"+o.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},hp={readContext:Dn,useCallback:Od,useContext:Dn,useEffect:Oc,useImperativeHandle:Pd,useInsertionEffect:Ad,useLayoutEffect:Td,useMemo:Dd,useReducer:Rc,useRef:Fd,useState:function(){return Rc(Yo)},useDebugValue:Dc,useDeferredValue:function(e){var t=In();return Id(t,Bt.memoizedState,e)},useTransition:function(){var e=Rc(Yo)[0],t=In().memoizedState;return[e,t]},useMutableSource:bd,useSyncExternalStore:wd,useId:Md,unstable_isNewReconciler:!1},fp={readContext:Dn,useCallback:Od,useContext:Dn,useEffect:Oc,useImperativeHandle:Pd,useInsertionEffect:Ad,useLayoutEffect:Td,useMemo:Dd,useReducer:Pc,useRef:Fd,useState:function(){return Pc(Yo)},useDebugValue:Dc,useDeferredValue:function(e){var t=In();return Bt===null?t.memoizedState=e:Id(t,Bt.memoizedState,e)},useTransition:function(){var e=Pc(Yo)[0],t=In().memoizedState;return[e,t]},useMutableSource:bd,useSyncExternalStore:wd,useId:Md,unstable_isNewReconciler:!1};function Zn(e,t){if(e&&e.defaultProps){t=se({},t),e=e.defaultProps;for(var o in e)t[o]===void 0&&(t[o]=e[o]);return t}return t}function Ic(e,t,o,c){t=e.memoizedState,o=o(c,t),o=o==null?t:se({},t,o),e.memoizedState=o,e.lanes===0&&(e.updateQueue.baseState=o)}var cl={isMounted:function(e){return(e=e._reactInternals)?nn(e)===e:!1},enqueueSetState:function(e,t,o){e=e._reactInternals;var c=hn(),f=Ts(e),y=Gr(c,f);y.payload=t,o!=null&&(y.callback=o),t=Cs(e,y,f),t!==null&&(nr(t,e,f,c),tl(t,e,f))},enqueueReplaceState:function(e,t,o){e=e._reactInternals;var c=hn(),f=Ts(e),y=Gr(c,f);y.tag=1,y.payload=t,o!=null&&(y.callback=o),t=Cs(e,y,f),t!==null&&(nr(t,e,f,c),tl(t,e,f))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var o=hn(),c=Ts(e),f=Gr(o,c);f.tag=2,t!=null&&(f.callback=t),t=Cs(e,f,c),t!==null&&(nr(t,e,c,o),tl(t,e,c))}};function Ud(e,t,o,c,f,y,k){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(c,y,k):t.prototype&&t.prototype.isPureReactComponent?!O(o,c)||!O(f,y):!0}function zd(e,t,o){var c=!1,f=js,y=t.contextType;return typeof y=="object"&&y!==null?y=Dn(y):(f=pn(t)?ii:rn.current,c=t.contextTypes,y=(c=c!=null)?qi(e,f):js),t=new t(o,y),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=cl,e.stateNode=t,t._reactInternals=e,c&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=f,e.__reactInternalMemoizedMaskedChildContext=y),t}function qd(e,t,o,c){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(o,c),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(o,c),t.state!==e&&cl.enqueueReplaceState(t,t.state,null)}function Mc(e,t,o,c){var f=e.stateNode;f.props=o,f.state=e.memoizedState,f.refs={},_c(e);var y=t.contextType;typeof y=="object"&&y!==null?f.context=Dn(y):(y=pn(t)?ii:rn.current,f.context=qi(e,y)),f.state=e.memoizedState,y=t.getDerivedStateFromProps,typeof y=="function"&&(Ic(e,t,y,o),f.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(t=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),t!==f.state&&cl.enqueueReplaceState(f,f.state,null),nl(e,o,f,c),f.state=e.memoizedState),typeof f.componentDidMount=="function"&&(e.flags|=4194308)}function Qi(e,t){try{var o="",c=t;do o+=We(c),c=c.return;while(c);var f=o}catch(y){f=`
Error generating stack: `+y.message+`
`+y.stack}return{value:e,source:t,stack:f,digest:null}}function Lc(e,t,o){return{value:e,source:null,stack:o??null,digest:t??null}}function Bc(e,t){try{console.error(t.value)}catch(o){setTimeout(function(){throw o})}}var pp=typeof WeakMap=="function"?WeakMap:Map;function Wd(e,t,o){o=Gr(-1,o),o.tag=3,o.payload={element:null};var c=t.value;return o.callback=function(){yl||(yl=!0,eu=c),Bc(e,t)},o}function Kd(e,t,o){o=Gr(-1,o),o.tag=3;var c=e.type.getDerivedStateFromError;if(typeof c=="function"){var f=t.value;o.payload=function(){return c(f)},o.callback=function(){Bc(e,t)}}var y=e.stateNode;return y!==null&&typeof y.componentDidCatch=="function"&&(o.callback=function(){Bc(e,t),typeof c!="function"&&(Es===null?Es=new Set([this]):Es.add(this));var k=t.stack;this.componentDidCatch(t.value,{componentStack:k!==null?k:""})}),o}function Hd(e,t,o){var c=e.pingCache;if(c===null){c=e.pingCache=new pp;var f=new Set;c.set(t,f)}else f=c.get(t),f===void 0&&(f=new Set,c.set(t,f));f.has(o)||(f.add(o),e=Fp.bind(null,e,t,o),t.then(e,e))}function Vd(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Gd(e,t,o,c,f){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(t=Gr(-1,1),t.tag=2,Cs(o,t,1))),o.lanes|=1),e):(e.flags|=65536,e.lanes=f,e)}var mp=ie.ReactCurrentOwner,mn=!1;function dn(e,t,o,c){t.child=e===null?pd(t,null,o,c):Vi(t,e.child,o,c)}function Jd(e,t,o,c,f){o=o.render;var y=t.ref;return Ji(t,f),c=Ac(e,t,o,c,y,f),o=Tc(),e!==null&&!mn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~f,Jr(e,t,f)):(_t&&o&&fc(t),t.flags|=1,dn(e,t,c,f),t.child)}function Yd(e,t,o,c,f){if(e===null){var y=o.type;return typeof y=="function"&&!au(y)&&y.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(t.tag=15,t.type=y,Qd(e,t,y,c,f)):(e=kl(o.type,null,c,t,t.mode,f),e.ref=t.ref,e.return=t,t.child=e)}if(y=e.child,(e.lanes&f)===0){var k=y.memoizedProps;if(o=o.compare,o=o!==null?o:O,o(k,c)&&e.ref===t.ref)return Jr(e,t,f)}return t.flags|=1,e=Ps(y,c),e.ref=t.ref,e.return=t,t.child=e}function Qd(e,t,o,c,f){if(e!==null){var y=e.memoizedProps;if(O(y,c)&&e.ref===t.ref)if(mn=!1,t.pendingProps=c=y,(e.lanes&f)!==0)(e.flags&131072)!==0&&(mn=!0);else return t.lanes=e.lanes,Jr(e,t,f)}return $c(e,t,o,c,f)}function Xd(e,t,o){var c=t.pendingProps,f=c.children,y=e!==null?e.memoizedState:null;if(c.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},gt(Zi,Fn),Fn|=o;else{if((o&1073741824)===0)return e=y!==null?y.baseLanes|o:o,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,gt(Zi,Fn),Fn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},c=y!==null?y.baseLanes:o,gt(Zi,Fn),Fn|=c}else y!==null?(c=y.baseLanes|o,t.memoizedState=null):c=o,gt(Zi,Fn),Fn|=c;return dn(e,t,f,o),t.child}function Zd(e,t){var o=t.ref;(e===null&&o!==null||e!==null&&e.ref!==o)&&(t.flags|=512,t.flags|=2097152)}function $c(e,t,o,c,f){var y=pn(o)?ii:rn.current;return y=qi(t,y),Ji(t,f),o=Ac(e,t,o,c,y,f),c=Tc(),e!==null&&!mn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~f,Jr(e,t,f)):(_t&&c&&fc(t),t.flags|=1,dn(e,t,o,f),t.child)}function eh(e,t,o,c,f){if(pn(o)){var y=!0;Va(t)}else y=!1;if(Ji(t,f),t.stateNode===null)dl(e,t),zd(t,o,c),Mc(t,o,c,f),c=!0;else if(e===null){var k=t.stateNode,E=t.memoizedProps;k.props=E;var P=k.context,X=o.contextType;typeof X=="object"&&X!==null?X=Dn(X):(X=pn(o)?ii:rn.current,X=qi(t,X));var ce=o.getDerivedStateFromProps,ue=typeof ce=="function"||typeof k.getSnapshotBeforeUpdate=="function";ue||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(E!==c||P!==X)&&qd(t,k,c,X),Ss=!1;var ae=t.memoizedState;k.state=ae,nl(t,c,k,f),P=t.memoizedState,E!==c||ae!==P||fn.current||Ss?(typeof ce=="function"&&(Ic(t,o,ce,c),P=t.memoizedState),(E=Ss||Ud(t,o,E,c,ae,P,X))?(ue||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(t.flags|=4194308)):(typeof k.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=c,t.memoizedState=P),k.props=c,k.state=P,k.context=X,c=E):(typeof k.componentDidMount=="function"&&(t.flags|=4194308),c=!1)}else{k=t.stateNode,yd(e,t),E=t.memoizedProps,X=t.type===t.elementType?E:Zn(t.type,E),k.props=X,ue=t.pendingProps,ae=k.context,P=o.contextType,typeof P=="object"&&P!==null?P=Dn(P):(P=pn(o)?ii:rn.current,P=qi(t,P));var Se=o.getDerivedStateFromProps;(ce=typeof Se=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(E!==ue||ae!==P)&&qd(t,k,c,P),Ss=!1,ae=t.memoizedState,k.state=ae,nl(t,c,k,f);var Ae=t.memoizedState;E!==ue||ae!==Ae||fn.current||Ss?(typeof Se=="function"&&(Ic(t,o,Se,c),Ae=t.memoizedState),(X=Ss||Ud(t,o,X,c,ae,Ae,P)||!1)?(ce||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(c,Ae,P),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(c,Ae,P)),typeof k.componentDidUpdate=="function"&&(t.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof k.componentDidUpdate!="function"||E===e.memoizedProps&&ae===e.memoizedState||(t.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||E===e.memoizedProps&&ae===e.memoizedState||(t.flags|=1024),t.memoizedProps=c,t.memoizedState=Ae),k.props=c,k.state=Ae,k.context=P,c=X):(typeof k.componentDidUpdate!="function"||E===e.memoizedProps&&ae===e.memoizedState||(t.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||E===e.memoizedProps&&ae===e.memoizedState||(t.flags|=1024),c=!1)}return Uc(e,t,o,c,y,f)}function Uc(e,t,o,c,f,y){Zd(e,t);var k=(t.flags&128)!==0;if(!c&&!k)return f&&id(t,o,!1),Jr(e,t,y);c=t.stateNode,mp.current=t;var E=k&&typeof o.getDerivedStateFromError!="function"?null:c.render();return t.flags|=1,e!==null&&k?(t.child=Vi(t,e.child,null,y),t.child=Vi(t,null,E,y)):dn(e,t,E,y),t.memoizedState=c.state,f&&id(t,o,!0),t.child}function th(e){var t=e.stateNode;t.pendingContext?rd(e,t.pendingContext,t.pendingContext!==t.context):t.context&&rd(e,t.context,!1),jc(e,t.containerInfo)}function nh(e,t,o,c,f){return Hi(),gc(f),t.flags|=256,dn(e,t,o,c),t.child}var zc={dehydrated:null,treeContext:null,retryLane:0};function qc(e){return{baseLanes:e,cachePool:null,transitions:null}}function rh(e,t,o){var c=t.pendingProps,f=Et.current,y=!1,k=(t.flags&128)!==0,E;if((E=k)||(E=e!==null&&e.memoizedState===null?!1:(f&2)!==0),E?(y=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(f|=1),gt(Et,f&1),e===null)return yc(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(k=c.children,e=c.fallback,y?(c=t.mode,y=t.child,k={mode:"hidden",children:k},(c&1)===0&&y!==null?(y.childLanes=0,y.pendingProps=k):y=_l(k,c,0,null),e=mi(e,c,o,null),y.return=t,e.return=t,y.sibling=e,t.child=y,t.child.memoizedState=qc(o),t.memoizedState=zc,e):Wc(t,k));if(f=e.memoizedState,f!==null&&(E=f.dehydrated,E!==null))return yp(e,t,k,c,E,f,o);if(y){y=c.fallback,k=t.mode,f=e.child,E=f.sibling;var P={mode:"hidden",children:c.children};return(k&1)===0&&t.child!==f?(c=t.child,c.childLanes=0,c.pendingProps=P,t.deletions=null):(c=Ps(f,P),c.subtreeFlags=f.subtreeFlags&14680064),E!==null?y=Ps(E,y):(y=mi(y,k,o,null),y.flags|=2),y.return=t,c.return=t,c.sibling=y,t.child=c,c=y,y=t.child,k=e.child.memoizedState,k=k===null?qc(o):{baseLanes:k.baseLanes|o,cachePool:null,transitions:k.transitions},y.memoizedState=k,y.childLanes=e.childLanes&~o,t.memoizedState=zc,c}return y=e.child,e=y.sibling,c=Ps(y,{mode:"visible",children:c.children}),(t.mode&1)===0&&(c.lanes=o),c.return=t,c.sibling=null,e!==null&&(o=t.deletions,o===null?(t.deletions=[e],t.flags|=16):o.push(e)),t.child=c,t.memoizedState=null,c}function Wc(e,t){return t=_l({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ul(e,t,o,c){return c!==null&&gc(c),Vi(t,e.child,null,o),e=Wc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function yp(e,t,o,c,f,y,k){if(o)return t.flags&256?(t.flags&=-257,c=Lc(Error(r(422))),ul(e,t,k,c)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(y=c.fallback,f=t.mode,c=_l({mode:"visible",children:c.children},f,0,null),y=mi(y,f,k,null),y.flags|=2,c.return=t,y.return=t,c.sibling=y,t.child=c,(t.mode&1)!==0&&Vi(t,e.child,null,k),t.child.memoizedState=qc(k),t.memoizedState=zc,y);if((t.mode&1)===0)return ul(e,t,k,null);if(f.data==="$!"){if(c=f.nextSibling&&f.nextSibling.dataset,c)var E=c.dgst;return c=E,y=Error(r(419)),c=Lc(y,c,void 0),ul(e,t,k,c)}if(E=(k&e.childLanes)!==0,mn||E){if(c=Kt,c!==null){switch(k&-k){case 4:f=2;break;case 16:f=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:f=32;break;case 536870912:f=268435456;break;default:f=0}f=(f&(c.suspendedLanes|k))!==0?0:f,f!==0&&f!==y.retryLane&&(y.retryLane=f,Vr(e,f),nr(c,e,f,-1))}return ou(),c=Lc(Error(r(421))),ul(e,t,k,c)}return f.data==="$?"?(t.flags|=128,t.child=e.child,t=Ep.bind(null,e),f._reactRetry=t,null):(e=y.treeContext,Cn=ks(f.nextSibling),Sn=t,_t=!0,Xn=null,e!==null&&(Pn[On++]=Kr,Pn[On++]=Hr,Pn[On++]=oi,Kr=e.id,Hr=e.overflow,oi=t),t=Wc(t,c.children),t.flags|=4096,t)}function sh(e,t,o){e.lanes|=t;var c=e.alternate;c!==null&&(c.lanes|=t),wc(e.return,t,o)}function Kc(e,t,o,c,f){var y=e.memoizedState;y===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:f}:(y.isBackwards=t,y.rendering=null,y.renderingStartTime=0,y.last=c,y.tail=o,y.tailMode=f)}function ih(e,t,o){var c=t.pendingProps,f=c.revealOrder,y=c.tail;if(dn(e,t,c.children,o),c=Et.current,(c&2)!==0)c=c&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&sh(e,o,t);else if(e.tag===19)sh(e,o,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}c&=1}if(gt(Et,c),(t.mode&1)===0)t.memoizedState=null;else switch(f){case"forwards":for(o=t.child,f=null;o!==null;)e=o.alternate,e!==null&&rl(e)===null&&(f=o),o=o.sibling;o=f,o===null?(f=t.child,t.child=null):(f=o.sibling,o.sibling=null),Kc(t,!1,f,o,y);break;case"backwards":for(o=null,f=t.child,t.child=null;f!==null;){if(e=f.alternate,e!==null&&rl(e)===null){t.child=f;break}e=f.sibling,f.sibling=o,o=f,f=e}Kc(t,!0,o,null,y);break;case"together":Kc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function dl(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Jr(e,t,o){if(e!==null&&(t.dependencies=e.dependencies),di|=t.lanes,(o&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(r(153));if(t.child!==null){for(e=t.child,o=Ps(e,e.pendingProps),t.child=o,o.return=t;e.sibling!==null;)e=e.sibling,o=o.sibling=Ps(e,e.pendingProps),o.return=t;o.sibling=null}return t.child}function gp(e,t,o){switch(t.tag){case 3:th(t),Hi();break;case 5:xd(t);break;case 1:pn(t.type)&&Va(t);break;case 4:jc(t,t.stateNode.containerInfo);break;case 10:var c=t.type._context,f=t.memoizedProps.value;gt(Za,c._currentValue),c._currentValue=f;break;case 13:if(c=t.memoizedState,c!==null)return c.dehydrated!==null?(gt(Et,Et.current&1),t.flags|=128,null):(o&t.child.childLanes)!==0?rh(e,t,o):(gt(Et,Et.current&1),e=Jr(e,t,o),e!==null?e.sibling:null);gt(Et,Et.current&1);break;case 19:if(c=(o&t.childLanes)!==0,(e.flags&128)!==0){if(c)return ih(e,t,o);t.flags|=128}if(f=t.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),gt(Et,Et.current),c)break;return null;case 22:case 23:return t.lanes=0,Xd(e,t,o)}return Jr(e,t,o)}var oh,Hc,ah,lh;oh=function(e,t){for(var o=t.child;o!==null;){if(o.tag===5||o.tag===6)e.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===t)break;for(;o.sibling===null;){if(o.return===null||o.return===t)return;o=o.return}o.sibling.return=o.return,o=o.sibling}},Hc=function(){},ah=function(e,t,o,c){var f=e.memoizedProps;if(f!==c){e=t.stateNode,ci(_r.current);var y=null;switch(o){case"input":f=es(e,f),c=es(e,c),y=[];break;case"select":f=se({},f,{value:void 0}),c=se({},c,{value:void 0}),y=[];break;case"textarea":f=$s(e,f),c=$s(e,c),y=[];break;default:typeof f.onClick!="function"&&typeof c.onClick=="function"&&(e.onclick=Wa)}Ee(o,c);var k;o=null;for(X in f)if(!c.hasOwnProperty(X)&&f.hasOwnProperty(X)&&f[X]!=null)if(X==="style"){var E=f[X];for(k in E)E.hasOwnProperty(k)&&(o||(o={}),o[k]="")}else X!=="dangerouslySetInnerHTML"&&X!=="children"&&X!=="suppressContentEditableWarning"&&X!=="suppressHydrationWarning"&&X!=="autoFocus"&&(d.hasOwnProperty(X)?y||(y=[]):(y=y||[]).push(X,null));for(X in c){var P=c[X];if(E=f?.[X],c.hasOwnProperty(X)&&P!==E&&(P!=null||E!=null))if(X==="style")if(E){for(k in E)!E.hasOwnProperty(k)||P&&P.hasOwnProperty(k)||(o||(o={}),o[k]="");for(k in P)P.hasOwnProperty(k)&&E[k]!==P[k]&&(o||(o={}),o[k]=P[k])}else o||(y||(y=[]),y.push(X,o)),o=P;else X==="dangerouslySetInnerHTML"?(P=P?P.__html:void 0,E=E?E.__html:void 0,P!=null&&E!==P&&(y=y||[]).push(X,P)):X==="children"?typeof P!="string"&&typeof P!="number"||(y=y||[]).push(X,""+P):X!=="suppressContentEditableWarning"&&X!=="suppressHydrationWarning"&&(d.hasOwnProperty(X)?(P!=null&&X==="onScroll"&&xt("scroll",e),y||E===P||(y=[])):(y=y||[]).push(X,P))}o&&(y=y||[]).push("style",o);var X=y;(t.updateQueue=X)&&(t.flags|=4)}},lh=function(e,t,o,c){o!==c&&(t.flags|=4)};function Xo(e,t){if(!_t)switch(e.tailMode){case"hidden":t=e.tail;for(var o=null;t!==null;)t.alternate!==null&&(o=t),t=t.sibling;o===null?e.tail=null:o.sibling=null;break;case"collapsed":o=e.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:c.sibling=null}}function on(e){var t=e.alternate!==null&&e.alternate.child===e.child,o=0,c=0;if(t)for(var f=e.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags&14680064,c|=f.flags&14680064,f.return=e,f=f.sibling;else for(f=e.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=e,f=f.sibling;return e.subtreeFlags|=c,e.childLanes=o,t}function vp(e,t,o){var c=t.pendingProps;switch(pc(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return on(t),null;case 1:return pn(t.type)&&Ha(),on(t),null;case 3:return c=t.stateNode,Yi(),bt(fn),bt(rn),Cc(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(e===null||e.child===null)&&(Qa(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Xn!==null&&(ru(Xn),Xn=null))),Hc(e,t),on(t),null;case 5:Nc(t);var f=ci(Vo.current);if(o=t.type,e!==null&&t.stateNode!=null)ah(e,t,o,c,f),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!c){if(t.stateNode===null)throw Error(r(166));return on(t),null}if(e=ci(_r.current),Qa(t)){c=t.stateNode,o=t.type;var y=t.memoizedProps;switch(c[kr]=t,c[zo]=y,e=(t.mode&1)!==0,o){case"dialog":xt("cancel",c),xt("close",c);break;case"iframe":case"object":case"embed":xt("load",c);break;case"video":case"audio":for(f=0;f<Bo.length;f++)xt(Bo[f],c);break;case"source":xt("error",c);break;case"img":case"image":case"link":xt("error",c),xt("load",c);break;case"details":xt("toggle",c);break;case"input":kn(c,y),xt("invalid",c);break;case"select":c._wrapperState={wasMultiple:!!y.multiple},xt("invalid",c);break;case"textarea":ar(c,y),xt("invalid",c)}Ee(o,y),f=null;for(var k in y)if(y.hasOwnProperty(k)){var E=y[k];k==="children"?typeof E=="string"?c.textContent!==E&&(y.suppressHydrationWarning!==!0&&qa(c.textContent,E,e),f=["children",E]):typeof E=="number"&&c.textContent!==""+E&&(y.suppressHydrationWarning!==!0&&qa(c.textContent,E,e),f=["children",""+E]):d.hasOwnProperty(k)&&E!=null&&k==="onScroll"&&xt("scroll",c)}switch(o){case"input":or(c),ns(c,y,!0);break;case"textarea":or(c),en(c);break;case"select":case"option":break;default:typeof y.onClick=="function"&&(c.onclick=Wa)}c=f,t.updateQueue=c,c!==null&&(t.flags|=4)}else{k=f.nodeType===9?f:f.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=wt(o)),e==="http://www.w3.org/1999/xhtml"?o==="script"?(e=k.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof c.is=="string"?e=k.createElement(o,{is:c.is}):(e=k.createElement(o),o==="select"&&(k=e,c.multiple?k.multiple=!0:c.size&&(k.size=c.size))):e=k.createElementNS(e,o),e[kr]=t,e[zo]=c,oh(e,t,!1,!1),t.stateNode=e;e:{switch(k=qn(o,c),o){case"dialog":xt("cancel",e),xt("close",e),f=c;break;case"iframe":case"object":case"embed":xt("load",e),f=c;break;case"video":case"audio":for(f=0;f<Bo.length;f++)xt(Bo[f],e);f=c;break;case"source":xt("error",e),f=c;break;case"img":case"image":case"link":xt("error",e),xt("load",e),f=c;break;case"details":xt("toggle",e),f=c;break;case"input":kn(e,c),f=es(e,c),xt("invalid",e);break;case"option":f=c;break;case"select":e._wrapperState={wasMultiple:!!c.multiple},f=se({},c,{value:void 0}),xt("invalid",e);break;case"textarea":ar(e,c),f=$s(e,c),xt("invalid",e);break;default:f=c}Ee(o,f),E=f;for(y in E)if(E.hasOwnProperty(y)){var P=E[y];y==="style"?ss(e,P):y==="dangerouslySetInnerHTML"?(P=P?P.__html:void 0,P!=null&&cr(e,P)):y==="children"?typeof P=="string"?(o!=="textarea"||P!=="")&&Un(e,P):typeof P=="number"&&Un(e,""+P):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(d.hasOwnProperty(y)?P!=null&&y==="onScroll"&&xt("scroll",e):P!=null&&ne(e,y,P,k))}switch(o){case"input":or(e),ns(e,c,!1);break;case"textarea":or(e),en(e);break;case"option":c.value!=null&&e.setAttribute("value",""+nt(c.value));break;case"select":e.multiple=!!c.multiple,y=c.value,y!=null?Nt(e,!!c.multiple,y,!1):c.defaultValue!=null&&Nt(e,!!c.multiple,c.defaultValue,!0);break;default:typeof f.onClick=="function"&&(e.onclick=Wa)}switch(o){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}}c&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return on(t),null;case 6:if(e&&t.stateNode!=null)lh(e,t,e.memoizedProps,c);else{if(typeof c!="string"&&t.stateNode===null)throw Error(r(166));if(o=ci(Vo.current),ci(_r.current),Qa(t)){if(c=t.stateNode,o=t.memoizedProps,c[kr]=t,(y=c.nodeValue!==o)&&(e=Sn,e!==null))switch(e.tag){case 3:qa(c.nodeValue,o,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&qa(c.nodeValue,o,(e.mode&1)!==0)}y&&(t.flags|=4)}else c=(o.nodeType===9?o:o.ownerDocument).createTextNode(c),c[kr]=t,t.stateNode=c}return on(t),null;case 13:if(bt(Et),c=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(_t&&Cn!==null&&(t.mode&1)!==0&&(t.flags&128)===0)dd(),Hi(),t.flags|=98560,y=!1;else if(y=Qa(t),c!==null&&c.dehydrated!==null){if(e===null){if(!y)throw Error(r(318));if(y=t.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(r(317));y[kr]=t}else Hi(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;on(t),y=!1}else Xn!==null&&(ru(Xn),Xn=null),y=!0;if(!y)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=o,t):(c=c!==null,c!==(e!==null&&e.memoizedState!==null)&&c&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(Et.current&1)!==0?$t===0&&($t=3):ou())),t.updateQueue!==null&&(t.flags|=4),on(t),null);case 4:return Yi(),Hc(e,t),e===null&&$o(t.stateNode.containerInfo),on(t),null;case 10:return bc(t.type._context),on(t),null;case 17:return pn(t.type)&&Ha(),on(t),null;case 19:if(bt(Et),y=t.memoizedState,y===null)return on(t),null;if(c=(t.flags&128)!==0,k=y.rendering,k===null)if(c)Xo(y,!1);else{if($t!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(k=rl(e),k!==null){for(t.flags|=128,Xo(y,!1),c=k.updateQueue,c!==null&&(t.updateQueue=c,t.flags|=4),t.subtreeFlags=0,c=o,o=t.child;o!==null;)y=o,e=c,y.flags&=14680066,k=y.alternate,k===null?(y.childLanes=0,y.lanes=e,y.child=null,y.subtreeFlags=0,y.memoizedProps=null,y.memoizedState=null,y.updateQueue=null,y.dependencies=null,y.stateNode=null):(y.childLanes=k.childLanes,y.lanes=k.lanes,y.child=k.child,y.subtreeFlags=0,y.deletions=null,y.memoizedProps=k.memoizedProps,y.memoizedState=k.memoizedState,y.updateQueue=k.updateQueue,y.type=k.type,e=k.dependencies,y.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),o=o.sibling;return gt(Et,Et.current&1|2),t.child}e=e.sibling}y.tail!==null&&ut()>eo&&(t.flags|=128,c=!0,Xo(y,!1),t.lanes=4194304)}else{if(!c)if(e=rl(k),e!==null){if(t.flags|=128,c=!0,o=e.updateQueue,o!==null&&(t.updateQueue=o,t.flags|=4),Xo(y,!0),y.tail===null&&y.tailMode==="hidden"&&!k.alternate&&!_t)return on(t),null}else 2*ut()-y.renderingStartTime>eo&&o!==1073741824&&(t.flags|=128,c=!0,Xo(y,!1),t.lanes=4194304);y.isBackwards?(k.sibling=t.child,t.child=k):(o=y.last,o!==null?o.sibling=k:t.child=k,y.last=k)}return y.tail!==null?(t=y.tail,y.rendering=t,y.tail=t.sibling,y.renderingStartTime=ut(),t.sibling=null,o=Et.current,gt(Et,c?o&1|2:o&1),t):(on(t),null);case 22:case 23:return iu(),c=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==c&&(t.flags|=8192),c&&(t.mode&1)!==0?(Fn&1073741824)!==0&&(on(t),t.subtreeFlags&6&&(t.flags|=8192)):on(t),null;case 24:return null;case 25:return null}throw Error(r(156,t.tag))}function xp(e,t){switch(pc(t),t.tag){case 1:return pn(t.type)&&Ha(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Yi(),bt(fn),bt(rn),Cc(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return Nc(t),null;case 13:if(bt(Et),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(r(340));Hi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return bt(Et),null;case 4:return Yi(),null;case 10:return bc(t.type._context),null;case 22:case 23:return iu(),null;case 24:return null;default:return null}}var hl=!1,an=!1,bp=typeof WeakSet=="function"?WeakSet:Set,Fe=null;function Xi(e,t){var o=e.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(c){Rt(e,t,c)}else o.current=null}function Vc(e,t,o){try{o()}catch(c){Rt(e,t,c)}}var ch=!1;function wp(e,t){if(ic=Qs,e=I(),D(e)){if("selectionStart"in e)var o={start:e.selectionStart,end:e.selectionEnd};else e:{o=(o=e.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var f=c.anchorOffset,y=c.focusNode;c=c.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var k=0,E=-1,P=-1,X=0,ce=0,ue=e,ae=null;t:for(;;){for(var Se;ue!==o||f!==0&&ue.nodeType!==3||(E=k+f),ue!==y||c!==0&&ue.nodeType!==3||(P=k+c),ue.nodeType===3&&(k+=ue.nodeValue.length),(Se=ue.firstChild)!==null;)ae=ue,ue=Se;for(;;){if(ue===e)break t;if(ae===o&&++X===f&&(E=k),ae===y&&++ce===c&&(P=k),(Se=ue.nextSibling)!==null)break;ue=ae,ae=ue.parentNode}ue=Se}o=E===-1||P===-1?null:{start:E,end:P}}else o=null}o=o||{start:0,end:0}}else o=null;for(oc={focusedElem:e,selectionRange:o},Qs=!1,Fe=t;Fe!==null;)if(t=Fe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Fe=e;else for(;Fe!==null;){t=Fe;try{var Ae=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(Ae!==null){var Re=Ae.memoizedProps,Ot=Ae.memoizedState,G=t.stateNode,z=G.getSnapshotBeforeUpdate(t.elementType===t.type?Re:Zn(t.type,Re),Ot);G.__reactInternalSnapshotBeforeUpdate=z}break;case 3:var Y=t.stateNode.containerInfo;Y.nodeType===1?Y.textContent="":Y.nodeType===9&&Y.documentElement&&Y.removeChild(Y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(pe){Rt(t,t.return,pe)}if(e=t.sibling,e!==null){e.return=t.return,Fe=e;break}Fe=t.return}return Ae=ch,ch=!1,Ae}function Zo(e,t,o){var c=t.updateQueue;if(c=c!==null?c.lastEffect:null,c!==null){var f=c=c.next;do{if((f.tag&e)===e){var y=f.destroy;f.destroy=void 0,y!==void 0&&Vc(t,o,y)}f=f.next}while(f!==c)}}function fl(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var o=t=t.next;do{if((o.tag&e)===e){var c=o.create;o.destroy=c()}o=o.next}while(o!==t)}}function Gc(e){var t=e.ref;if(t!==null){var o=e.stateNode;switch(e.tag){case 5:e=o;break;default:e=o}typeof t=="function"?t(e):t.current=e}}function uh(e){var t=e.alternate;t!==null&&(e.alternate=null,uh(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[kr],delete t[zo],delete t[uc],delete t[rp],delete t[sp])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function dh(e){return e.tag===5||e.tag===3||e.tag===4}function hh(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||dh(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Jc(e,t,o){var c=e.tag;if(c===5||c===6)e=e.stateNode,t?o.nodeType===8?o.parentNode.insertBefore(e,t):o.insertBefore(e,t):(o.nodeType===8?(t=o.parentNode,t.insertBefore(e,o)):(t=o,t.appendChild(e)),o=o._reactRootContainer,o!=null||t.onclick!==null||(t.onclick=Wa));else if(c!==4&&(e=e.child,e!==null))for(Jc(e,t,o),e=e.sibling;e!==null;)Jc(e,t,o),e=e.sibling}function Yc(e,t,o){var c=e.tag;if(c===5||c===6)e=e.stateNode,t?o.insertBefore(e,t):o.appendChild(e);else if(c!==4&&(e=e.child,e!==null))for(Yc(e,t,o),e=e.sibling;e!==null;)Yc(e,t,o),e=e.sibling}var Yt=null,er=!1;function Fs(e,t,o){for(o=o.child;o!==null;)fh(e,t,o),o=o.sibling}function fh(e,t,o){if(ln&&typeof ln.onCommitFiberUnmount=="function")try{ln.onCommitFiberUnmount(Ks,o)}catch{}switch(o.tag){case 5:an||Xi(o,t);case 6:var c=Yt,f=er;Yt=null,Fs(e,t,o),Yt=c,er=f,Yt!==null&&(er?(e=Yt,o=o.stateNode,e.nodeType===8?e.parentNode.removeChild(o):e.removeChild(o)):Yt.removeChild(o.stateNode));break;case 18:Yt!==null&&(er?(e=Yt,o=o.stateNode,e.nodeType===8?cc(e.parentNode,o):e.nodeType===1&&cc(e,o),Hn(e)):cc(Yt,o.stateNode));break;case 4:c=Yt,f=er,Yt=o.stateNode.containerInfo,er=!0,Fs(e,t,o),Yt=c,er=f;break;case 0:case 11:case 14:case 15:if(!an&&(c=o.updateQueue,c!==null&&(c=c.lastEffect,c!==null))){f=c=c.next;do{var y=f,k=y.destroy;y=y.tag,k!==void 0&&((y&2)!==0||(y&4)!==0)&&Vc(o,t,k),f=f.next}while(f!==c)}Fs(e,t,o);break;case 1:if(!an&&(Xi(o,t),c=o.stateNode,typeof c.componentWillUnmount=="function"))try{c.props=o.memoizedProps,c.state=o.memoizedState,c.componentWillUnmount()}catch(E){Rt(o,t,E)}Fs(e,t,o);break;case 21:Fs(e,t,o);break;case 22:o.mode&1?(an=(c=an)||o.memoizedState!==null,Fs(e,t,o),an=c):Fs(e,t,o);break;default:Fs(e,t,o)}}function ph(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var o=e.stateNode;o===null&&(o=e.stateNode=new bp),t.forEach(function(c){var f=Ap.bind(null,e,c);o.has(c)||(o.add(c),c.then(f,f))})}}function tr(e,t){var o=t.deletions;if(o!==null)for(var c=0;c<o.length;c++){var f=o[c];try{var y=e,k=t,E=k;e:for(;E!==null;){switch(E.tag){case 5:Yt=E.stateNode,er=!1;break e;case 3:Yt=E.stateNode.containerInfo,er=!0;break e;case 4:Yt=E.stateNode.containerInfo,er=!0;break e}E=E.return}if(Yt===null)throw Error(r(160));fh(y,k,f),Yt=null,er=!1;var P=f.alternate;P!==null&&(P.return=null),f.return=null}catch(X){Rt(f,t,X)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)mh(t,e),t=t.sibling}function mh(e,t){var o=e.alternate,c=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(tr(t,e),Nr(e),c&4){try{Zo(3,e,e.return),fl(3,e)}catch(Re){Rt(e,e.return,Re)}try{Zo(5,e,e.return)}catch(Re){Rt(e,e.return,Re)}}break;case 1:tr(t,e),Nr(e),c&512&&o!==null&&Xi(o,o.return);break;case 5:if(tr(t,e),Nr(e),c&512&&o!==null&&Xi(o,o.return),e.flags&32){var f=e.stateNode;try{Un(f,"")}catch(Re){Rt(e,e.return,Re)}}if(c&4&&(f=e.stateNode,f!=null)){var y=e.memoizedProps,k=o!==null?o.memoizedProps:y,E=e.type,P=e.updateQueue;if(e.updateQueue=null,P!==null)try{E==="input"&&y.type==="radio"&&y.name!=null&&Bs(f,y),qn(E,k);var X=qn(E,y);for(k=0;k<P.length;k+=2){var ce=P[k],ue=P[k+1];ce==="style"?ss(f,ue):ce==="dangerouslySetInnerHTML"?cr(f,ue):ce==="children"?Un(f,ue):ne(f,ce,ue,X)}switch(E){case"input":ts(f,y);break;case"textarea":Us(f,y);break;case"select":var ae=f._wrapperState.wasMultiple;f._wrapperState.wasMultiple=!!y.multiple;var Se=y.value;Se!=null?Nt(f,!!y.multiple,Se,!1):ae!==!!y.multiple&&(y.defaultValue!=null?Nt(f,!!y.multiple,y.defaultValue,!0):Nt(f,!!y.multiple,y.multiple?[]:"",!1))}f[zo]=y}catch(Re){Rt(e,e.return,Re)}}break;case 6:if(tr(t,e),Nr(e),c&4){if(e.stateNode===null)throw Error(r(162));f=e.stateNode,y=e.memoizedProps;try{f.nodeValue=y}catch(Re){Rt(e,e.return,Re)}}break;case 3:if(tr(t,e),Nr(e),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Hn(t.containerInfo)}catch(Re){Rt(e,e.return,Re)}break;case 4:tr(t,e),Nr(e);break;case 13:tr(t,e),Nr(e),f=e.child,f.flags&8192&&(y=f.memoizedState!==null,f.stateNode.isHidden=y,!y||f.alternate!==null&&f.alternate.memoizedState!==null||(Zc=ut())),c&4&&ph(e);break;case 22:if(ce=o!==null&&o.memoizedState!==null,e.mode&1?(an=(X=an)||ce,tr(t,e),an=X):tr(t,e),Nr(e),c&8192){if(X=e.memoizedState!==null,(e.stateNode.isHidden=X)&&!ce&&(e.mode&1)!==0)for(Fe=e,ce=e.child;ce!==null;){for(ue=Fe=ce;Fe!==null;){switch(ae=Fe,Se=ae.child,ae.tag){case 0:case 11:case 14:case 15:Zo(4,ae,ae.return);break;case 1:Xi(ae,ae.return);var Ae=ae.stateNode;if(typeof Ae.componentWillUnmount=="function"){c=ae,o=ae.return;try{t=c,Ae.props=t.memoizedProps,Ae.state=t.memoizedState,Ae.componentWillUnmount()}catch(Re){Rt(c,o,Re)}}break;case 5:Xi(ae,ae.return);break;case 22:if(ae.memoizedState!==null){vh(ue);continue}}Se!==null?(Se.return=ae,Fe=Se):vh(ue)}ce=ce.sibling}e:for(ce=null,ue=e;;){if(ue.tag===5){if(ce===null){ce=ue;try{f=ue.stateNode,X?(y=f.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none"):(E=ue.stateNode,P=ue.memoizedProps.style,k=P!=null&&P.hasOwnProperty("display")?P.display:null,E.style.display=Cr("display",k))}catch(Re){Rt(e,e.return,Re)}}}else if(ue.tag===6){if(ce===null)try{ue.stateNode.nodeValue=X?"":ue.memoizedProps}catch(Re){Rt(e,e.return,Re)}}else if((ue.tag!==22&&ue.tag!==23||ue.memoizedState===null||ue===e)&&ue.child!==null){ue.child.return=ue,ue=ue.child;continue}if(ue===e)break e;for(;ue.sibling===null;){if(ue.return===null||ue.return===e)break e;ce===ue&&(ce=null),ue=ue.return}ce===ue&&(ce=null),ue.sibling.return=ue.return,ue=ue.sibling}}break;case 19:tr(t,e),Nr(e),c&4&&ph(e);break;case 21:break;default:tr(t,e),Nr(e)}}function Nr(e){var t=e.flags;if(t&2){try{e:{for(var o=e.return;o!==null;){if(dh(o)){var c=o;break e}o=o.return}throw Error(r(160))}switch(c.tag){case 5:var f=c.stateNode;c.flags&32&&(Un(f,""),c.flags&=-33);var y=hh(e);Yc(e,y,f);break;case 3:case 4:var k=c.stateNode.containerInfo,E=hh(e);Jc(e,E,k);break;default:throw Error(r(161))}}catch(P){Rt(e,e.return,P)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function kp(e,t,o){Fe=e,yh(e)}function yh(e,t,o){for(var c=(e.mode&1)!==0;Fe!==null;){var f=Fe,y=f.child;if(f.tag===22&&c){var k=f.memoizedState!==null||hl;if(!k){var E=f.alternate,P=E!==null&&E.memoizedState!==null||an;E=hl;var X=an;if(hl=k,(an=P)&&!X)for(Fe=f;Fe!==null;)k=Fe,P=k.child,k.tag===22&&k.memoizedState!==null?xh(f):P!==null?(P.return=k,Fe=P):xh(f);for(;y!==null;)Fe=y,yh(y),y=y.sibling;Fe=f,hl=E,an=X}gh(e)}else(f.subtreeFlags&8772)!==0&&y!==null?(y.return=f,Fe=y):gh(e)}}function gh(e){for(;Fe!==null;){var t=Fe;if((t.flags&8772)!==0){var o=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:an||fl(5,t);break;case 1:var c=t.stateNode;if(t.flags&4&&!an)if(o===null)c.componentDidMount();else{var f=t.elementType===t.type?o.memoizedProps:Zn(t.type,o.memoizedProps);c.componentDidUpdate(f,o.memoizedState,c.__reactInternalSnapshotBeforeUpdate)}var y=t.updateQueue;y!==null&&vd(t,y,c);break;case 3:var k=t.updateQueue;if(k!==null){if(o=null,t.child!==null)switch(t.child.tag){case 5:o=t.child.stateNode;break;case 1:o=t.child.stateNode}vd(t,k,o)}break;case 5:var E=t.stateNode;if(o===null&&t.flags&4){o=E;var P=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":P.autoFocus&&o.focus();break;case"img":P.src&&(o.src=P.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var X=t.alternate;if(X!==null){var ce=X.memoizedState;if(ce!==null){var ue=ce.dehydrated;ue!==null&&Hn(ue)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}an||t.flags&512&&Gc(t)}catch(ae){Rt(t,t.return,ae)}}if(t===e){Fe=null;break}if(o=t.sibling,o!==null){o.return=t.return,Fe=o;break}Fe=t.return}}function vh(e){for(;Fe!==null;){var t=Fe;if(t===e){Fe=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Fe=o;break}Fe=t.return}}function xh(e){for(;Fe!==null;){var t=Fe;try{switch(t.tag){case 0:case 11:case 15:var o=t.return;try{fl(4,t)}catch(P){Rt(t,o,P)}break;case 1:var c=t.stateNode;if(typeof c.componentDidMount=="function"){var f=t.return;try{c.componentDidMount()}catch(P){Rt(t,f,P)}}var y=t.return;try{Gc(t)}catch(P){Rt(t,y,P)}break;case 5:var k=t.return;try{Gc(t)}catch(P){Rt(t,k,P)}}}catch(P){Rt(t,t.return,P)}if(t===e){Fe=null;break}var E=t.sibling;if(E!==null){E.return=t.return,Fe=E;break}Fe=t.return}}var _p=Math.ceil,pl=ie.ReactCurrentDispatcher,Qc=ie.ReactCurrentOwner,Mn=ie.ReactCurrentBatchConfig,at=0,Kt=null,It=null,Qt=0,Fn=0,Zi=_s(0),$t=0,ea=null,di=0,ml=0,Xc=0,ta=null,yn=null,Zc=0,eo=1/0,Yr=null,yl=!1,eu=null,Es=null,gl=!1,As=null,vl=0,na=0,tu=null,xl=-1,bl=0;function hn(){return(at&6)!==0?ut():xl!==-1?xl:xl=ut()}function Ts(e){return(e.mode&1)===0?1:(at&2)!==0&&Qt!==0?Qt&-Qt:op.transition!==null?(bl===0&&(bl=Dr()),bl):(e=ot,e!==0||(e=window.event,e=e===void 0?16:Zs(e.type)),e)}function nr(e,t,o,c){if(50<na)throw na=0,tu=null,Error(r(185));Ir(e,o,c),((at&2)===0||e!==Kt)&&(e===Kt&&((at&2)===0&&(ml|=o),$t===4&&Rs(e,Qt)),gn(e,c),o===1&&at===0&&(t.mode&1)===0&&(eo=ut()+500,Ga&&Ns()))}function gn(e,t){var o=e.callbackNode;Gs(e,t);var c=Vs(e,e===Kt?Qt:0);if(c===0)o!==null&&_i(o),e.callbackNode=null,e.callbackPriority=0;else if(t=c&-c,e.callbackPriority!==t){if(o!=null&&_i(o),t===1)e.tag===0?ip(wh.bind(null,e)):od(wh.bind(null,e)),tp(function(){(at&6)===0&&Ns()}),o=null;else{switch(_o(c)){case 1:o=mr;break;case 4:o=Ws;break;case 16:o=ls;break;case 536870912:o=yr;break;default:o=ls}o=Eh(o,bh.bind(null,e))}e.callbackPriority=t,e.callbackNode=o}}function bh(e,t){if(xl=-1,bl=0,(at&6)!==0)throw Error(r(327));var o=e.callbackNode;if(to()&&e.callbackNode!==o)return null;var c=Vs(e,e===Kt?Qt:0);if(c===0)return null;if((c&30)!==0||(c&e.expiredLanes)!==0||t)t=wl(e,c);else{t=c;var f=at;at|=2;var y=_h();(Kt!==e||Qt!==t)&&(Yr=null,eo=ut()+500,fi(e,t));do try{Sp();break}catch(E){kh(e,E)}while(!0);xc(),pl.current=y,at=f,It!==null?t=0:(Kt=null,Qt=0,t=$t)}if(t!==0){if(t===2&&(f=Or(e),f!==0&&(c=f,t=nu(e,f))),t===1)throw o=ea,fi(e,0),Rs(e,c),gn(e,ut()),o;if(t===6)Rs(e,c);else{if(f=e.current.alternate,(c&30)===0&&!jp(f)&&(t=wl(e,c),t===2&&(y=Or(e),y!==0&&(c=y,t=nu(e,y))),t===1))throw o=ea,fi(e,0),Rs(e,c),gn(e,ut()),o;switch(e.finishedWork=f,e.finishedLanes=c,t){case 0:case 1:throw Error(r(345));case 2:pi(e,yn,Yr);break;case 3:if(Rs(e,c),(c&130023424)===c&&(t=Zc+500-ut(),10<t)){if(Vs(e,0)!==0)break;if(f=e.suspendedLanes,(f&c)!==c){hn(),e.pingedLanes|=e.suspendedLanes&f;break}e.timeoutHandle=lc(pi.bind(null,e,yn,Yr),t);break}pi(e,yn,Yr);break;case 4:if(Rs(e,c),(c&4194240)===c)break;for(t=e.eventTimes,f=-1;0<c;){var k=31-Ke(c);y=1<<k,k=t[k],k>f&&(f=k),c&=~y}if(c=f,c=ut()-c,c=(120>c?120:480>c?480:1080>c?1080:1920>c?1920:3e3>c?3e3:4320>c?4320:1960*_p(c/1960))-c,10<c){e.timeoutHandle=lc(pi.bind(null,e,yn,Yr),c);break}pi(e,yn,Yr);break;case 5:pi(e,yn,Yr);break;default:throw Error(r(329))}}}return gn(e,ut()),e.callbackNode===o?bh.bind(null,e):null}function nu(e,t){var o=ta;return e.current.memoizedState.isDehydrated&&(fi(e,t).flags|=256),e=wl(e,t),e!==2&&(t=yn,yn=o,t!==null&&ru(t)),e}function ru(e){yn===null?yn=e:yn.push.apply(yn,e)}function jp(e){for(var t=e;;){if(t.flags&16384){var o=t.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var c=0;c<o.length;c++){var f=o[c],y=f.getSnapshot;f=f.value;try{if(!K(y(),f))return!1}catch{return!1}}}if(o=t.child,t.subtreeFlags&16384&&o!==null)o.return=t,t=o;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Rs(e,t){for(t&=~Xc,t&=~ml,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var o=31-Ke(t),c=1<<o;e[o]=-1,t&=~c}}function wh(e){if((at&6)!==0)throw Error(r(327));to();var t=Vs(e,0);if((t&1)===0)return gn(e,ut()),null;var o=wl(e,t);if(e.tag!==0&&o===2){var c=Or(e);c!==0&&(t=c,o=nu(e,c))}if(o===1)throw o=ea,fi(e,0),Rs(e,t),gn(e,ut()),o;if(o===6)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,pi(e,yn,Yr),gn(e,ut()),null}function su(e,t){var o=at;at|=1;try{return e(t)}finally{at=o,at===0&&(eo=ut()+500,Ga&&Ns())}}function hi(e){As!==null&&As.tag===0&&(at&6)===0&&to();var t=at;at|=1;var o=Mn.transition,c=ot;try{if(Mn.transition=null,ot=1,e)return e()}finally{ot=c,Mn.transition=o,at=t,(at&6)===0&&Ns()}}function iu(){Fn=Zi.current,bt(Zi)}function fi(e,t){e.finishedWork=null,e.finishedLanes=0;var o=e.timeoutHandle;if(o!==-1&&(e.timeoutHandle=-1,ep(o)),It!==null)for(o=It.return;o!==null;){var c=o;switch(pc(c),c.tag){case 1:c=c.type.childContextTypes,c!=null&&Ha();break;case 3:Yi(),bt(fn),bt(rn),Cc();break;case 5:Nc(c);break;case 4:Yi();break;case 13:bt(Et);break;case 19:bt(Et);break;case 10:bc(c.type._context);break;case 22:case 23:iu()}o=o.return}if(Kt=e,It=e=Ps(e.current,null),Qt=Fn=t,$t=0,ea=null,Xc=ml=di=0,yn=ta=null,li!==null){for(t=0;t<li.length;t++)if(o=li[t],c=o.interleaved,c!==null){o.interleaved=null;var f=c.next,y=o.pending;if(y!==null){var k=y.next;y.next=f,c.next=k}o.pending=c}li=null}return e}function kh(e,t){do{var o=It;try{if(xc(),sl.current=ll,il){for(var c=At.memoizedState;c!==null;){var f=c.queue;f!==null&&(f.pending=null),c=c.next}il=!1}if(ui=0,Wt=Bt=At=null,Go=!1,Jo=0,Qc.current=null,o===null||o.return===null){$t=1,ea=t,It=null;break}e:{var y=e,k=o.return,E=o,P=t;if(t=Qt,E.flags|=32768,P!==null&&typeof P=="object"&&typeof P.then=="function"){var X=P,ce=E,ue=ce.tag;if((ce.mode&1)===0&&(ue===0||ue===11||ue===15)){var ae=ce.alternate;ae?(ce.updateQueue=ae.updateQueue,ce.memoizedState=ae.memoizedState,ce.lanes=ae.lanes):(ce.updateQueue=null,ce.memoizedState=null)}var Se=Vd(k);if(Se!==null){Se.flags&=-257,Gd(Se,k,E,y,t),Se.mode&1&&Hd(y,X,t),t=Se,P=X;var Ae=t.updateQueue;if(Ae===null){var Re=new Set;Re.add(P),t.updateQueue=Re}else Ae.add(P);break e}else{if((t&1)===0){Hd(y,X,t),ou();break e}P=Error(r(426))}}else if(_t&&E.mode&1){var Ot=Vd(k);if(Ot!==null){(Ot.flags&65536)===0&&(Ot.flags|=256),Gd(Ot,k,E,y,t),gc(Qi(P,E));break e}}y=P=Qi(P,E),$t!==4&&($t=2),ta===null?ta=[y]:ta.push(y),y=k;do{switch(y.tag){case 3:y.flags|=65536,t&=-t,y.lanes|=t;var G=Wd(y,P,t);gd(y,G);break e;case 1:E=P;var z=y.type,Y=y.stateNode;if((y.flags&128)===0&&(typeof z.getDerivedStateFromError=="function"||Y!==null&&typeof Y.componentDidCatch=="function"&&(Es===null||!Es.has(Y)))){y.flags|=65536,t&=-t,y.lanes|=t;var pe=Kd(y,E,t);gd(y,pe);break e}}y=y.return}while(y!==null)}Nh(o)}catch(Pe){t=Pe,It===o&&o!==null&&(It=o=o.return);continue}break}while(!0)}function _h(){var e=pl.current;return pl.current=ll,e===null?ll:e}function ou(){($t===0||$t===3||$t===2)&&($t=4),Kt===null||(di&268435455)===0&&(ml&268435455)===0||Rs(Kt,Qt)}function wl(e,t){var o=at;at|=2;var c=_h();(Kt!==e||Qt!==t)&&(Yr=null,fi(e,t));do try{Np();break}catch(f){kh(e,f)}while(!0);if(xc(),at=o,pl.current=c,It!==null)throw Error(r(261));return Kt=null,Qt=0,$t}function Np(){for(;It!==null;)jh(It)}function Sp(){for(;It!==null&&!Ct();)jh(It)}function jh(e){var t=Fh(e.alternate,e,Fn);e.memoizedProps=e.pendingProps,t===null?Nh(e):It=t,Qc.current=null}function Nh(e){var t=e;do{var o=t.alternate;if(e=t.return,(t.flags&32768)===0){if(o=vp(o,t,Fn),o!==null){It=o;return}}else{if(o=xp(o,t),o!==null){o.flags&=32767,It=o;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{$t=6,It=null;return}}if(t=t.sibling,t!==null){It=t;return}It=t=e}while(t!==null);$t===0&&($t=5)}function pi(e,t,o){var c=ot,f=Mn.transition;try{Mn.transition=null,ot=1,Cp(e,t,o,c)}finally{Mn.transition=f,ot=c}return null}function Cp(e,t,o,c){do to();while(As!==null);if((at&6)!==0)throw Error(r(327));o=e.finishedWork;var f=e.finishedLanes;if(o===null)return null;if(e.finishedWork=null,e.finishedLanes=0,o===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var y=o.lanes|o.childLanes;if(Ni(e,y),e===Kt&&(It=Kt=null,Qt=0),(o.subtreeFlags&2064)===0&&(o.flags&2064)===0||gl||(gl=!0,Eh(ls,function(){return to(),null})),y=(o.flags&15990)!==0,(o.subtreeFlags&15990)!==0||y){y=Mn.transition,Mn.transition=null;var k=ot;ot=1;var E=at;at|=4,Qc.current=null,wp(e,o),mh(o,e),J(oc),Qs=!!ic,oc=ic=null,e.current=o,kp(o),Pr(),at=E,ot=k,Mn.transition=y}else e.current=o;if(gl&&(gl=!1,As=e,vl=f),y=e.pendingLanes,y===0&&(Es=null),ka(o.stateNode),gn(e,ut()),t!==null)for(c=e.onRecoverableError,o=0;o<t.length;o++)f=t[o],c(f.value,{componentStack:f.stack,digest:f.digest});if(yl)throw yl=!1,e=eu,eu=null,e;return(vl&1)!==0&&e.tag!==0&&to(),y=e.pendingLanes,(y&1)!==0?e===tu?na++:(na=0,tu=e):na=0,Ns(),null}function to(){if(As!==null){var e=_o(vl),t=Mn.transition,o=ot;try{if(Mn.transition=null,ot=16>e?16:e,As===null)var c=!1;else{if(e=As,As=null,vl=0,(at&6)!==0)throw Error(r(331));var f=at;for(at|=4,Fe=e.current;Fe!==null;){var y=Fe,k=y.child;if((Fe.flags&16)!==0){var E=y.deletions;if(E!==null){for(var P=0;P<E.length;P++){var X=E[P];for(Fe=X;Fe!==null;){var ce=Fe;switch(ce.tag){case 0:case 11:case 15:Zo(8,ce,y)}var ue=ce.child;if(ue!==null)ue.return=ce,Fe=ue;else for(;Fe!==null;){ce=Fe;var ae=ce.sibling,Se=ce.return;if(uh(ce),ce===X){Fe=null;break}if(ae!==null){ae.return=Se,Fe=ae;break}Fe=Se}}}var Ae=y.alternate;if(Ae!==null){var Re=Ae.child;if(Re!==null){Ae.child=null;do{var Ot=Re.sibling;Re.sibling=null,Re=Ot}while(Re!==null)}}Fe=y}}if((y.subtreeFlags&2064)!==0&&k!==null)k.return=y,Fe=k;else e:for(;Fe!==null;){if(y=Fe,(y.flags&2048)!==0)switch(y.tag){case 0:case 11:case 15:Zo(9,y,y.return)}var G=y.sibling;if(G!==null){G.return=y.return,Fe=G;break e}Fe=y.return}}var z=e.current;for(Fe=z;Fe!==null;){k=Fe;var Y=k.child;if((k.subtreeFlags&2064)!==0&&Y!==null)Y.return=k,Fe=Y;else e:for(k=z;Fe!==null;){if(E=Fe,(E.flags&2048)!==0)try{switch(E.tag){case 0:case 11:case 15:fl(9,E)}}catch(Pe){Rt(E,E.return,Pe)}if(E===k){Fe=null;break e}var pe=E.sibling;if(pe!==null){pe.return=E.return,Fe=pe;break e}Fe=E.return}}if(at=f,Ns(),ln&&typeof ln.onPostCommitFiberRoot=="function")try{ln.onPostCommitFiberRoot(Ks,e)}catch{}c=!0}return c}finally{ot=o,Mn.transition=t}}return!1}function Sh(e,t,o){t=Qi(o,t),t=Wd(e,t,1),e=Cs(e,t,1),t=hn(),e!==null&&(Ir(e,1,t),gn(e,t))}function Rt(e,t,o){if(e.tag===3)Sh(e,e,o);else for(;t!==null;){if(t.tag===3){Sh(t,e,o);break}else if(t.tag===1){var c=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Es===null||!Es.has(c))){e=Qi(o,e),e=Kd(t,e,1),t=Cs(t,e,1),e=hn(),t!==null&&(Ir(t,1,e),gn(t,e));break}}t=t.return}}function Fp(e,t,o){var c=e.pingCache;c!==null&&c.delete(t),t=hn(),e.pingedLanes|=e.suspendedLanes&o,Kt===e&&(Qt&o)===o&&($t===4||$t===3&&(Qt&130023424)===Qt&&500>ut()-Zc?fi(e,0):Xc|=o),gn(e,t)}function Ch(e,t){t===0&&((e.mode&1)===0?t=1:(t=Hs,Hs<<=1,(Hs&130023424)===0&&(Hs=4194304)));var o=hn();e=Vr(e,t),e!==null&&(Ir(e,t,o),gn(e,o))}function Ep(e){var t=e.memoizedState,o=0;t!==null&&(o=t.retryLane),Ch(e,o)}function Ap(e,t){var o=0;switch(e.tag){case 13:var c=e.stateNode,f=e.memoizedState;f!==null&&(o=f.retryLane);break;case 19:c=e.stateNode;break;default:throw Error(r(314))}c!==null&&c.delete(t),Ch(e,o)}var Fh;Fh=function(e,t,o){if(e!==null)if(e.memoizedProps!==t.pendingProps||fn.current)mn=!0;else{if((e.lanes&o)===0&&(t.flags&128)===0)return mn=!1,gp(e,t,o);mn=(e.flags&131072)!==0}else mn=!1,_t&&(t.flags&1048576)!==0&&ad(t,Ya,t.index);switch(t.lanes=0,t.tag){case 2:var c=t.type;dl(e,t),e=t.pendingProps;var f=qi(t,rn.current);Ji(t,o),f=Ac(null,t,c,e,f,o);var y=Tc();return t.flags|=1,typeof f=="object"&&f!==null&&typeof f.render=="function"&&f.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,pn(c)?(y=!0,Va(t)):y=!1,t.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,_c(t),f.updater=cl,t.stateNode=f,f._reactInternals=t,Mc(t,c,e,o),t=Uc(null,t,c,!0,y,o)):(t.tag=0,_t&&y&&fc(t),dn(null,t,f,o),t=t.child),t;case 16:c=t.elementType;e:{switch(dl(e,t),e=t.pendingProps,f=c._init,c=f(c._payload),t.type=c,f=t.tag=Rp(c),e=Zn(c,e),f){case 0:t=$c(null,t,c,e,o);break e;case 1:t=eh(null,t,c,e,o);break e;case 11:t=Jd(null,t,c,e,o);break e;case 14:t=Yd(null,t,c,Zn(c.type,e),o);break e}throw Error(r(306,c,""))}return t;case 0:return c=t.type,f=t.pendingProps,f=t.elementType===c?f:Zn(c,f),$c(e,t,c,f,o);case 1:return c=t.type,f=t.pendingProps,f=t.elementType===c?f:Zn(c,f),eh(e,t,c,f,o);case 3:e:{if(th(t),e===null)throw Error(r(387));c=t.pendingProps,y=t.memoizedState,f=y.element,yd(e,t),nl(t,c,null,o);var k=t.memoizedState;if(c=k.element,y.isDehydrated)if(y={element:c,isDehydrated:!1,cache:k.cache,pendingSuspenseBoundaries:k.pendingSuspenseBoundaries,transitions:k.transitions},t.updateQueue.baseState=y,t.memoizedState=y,t.flags&256){f=Qi(Error(r(423)),t),t=nh(e,t,c,o,f);break e}else if(c!==f){f=Qi(Error(r(424)),t),t=nh(e,t,c,o,f);break e}else for(Cn=ks(t.stateNode.containerInfo.firstChild),Sn=t,_t=!0,Xn=null,o=pd(t,null,c,o),t.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Hi(),c===f){t=Jr(e,t,o);break e}dn(e,t,c,o)}t=t.child}return t;case 5:return xd(t),e===null&&yc(t),c=t.type,f=t.pendingProps,y=e!==null?e.memoizedProps:null,k=f.children,ac(c,f)?k=null:y!==null&&ac(c,y)&&(t.flags|=32),Zd(e,t),dn(e,t,k,o),t.child;case 6:return e===null&&yc(t),null;case 13:return rh(e,t,o);case 4:return jc(t,t.stateNode.containerInfo),c=t.pendingProps,e===null?t.child=Vi(t,null,c,o):dn(e,t,c,o),t.child;case 11:return c=t.type,f=t.pendingProps,f=t.elementType===c?f:Zn(c,f),Jd(e,t,c,f,o);case 7:return dn(e,t,t.pendingProps,o),t.child;case 8:return dn(e,t,t.pendingProps.children,o),t.child;case 12:return dn(e,t,t.pendingProps.children,o),t.child;case 10:e:{if(c=t.type._context,f=t.pendingProps,y=t.memoizedProps,k=f.value,gt(Za,c._currentValue),c._currentValue=k,y!==null)if(K(y.value,k)){if(y.children===f.children&&!fn.current){t=Jr(e,t,o);break e}}else for(y=t.child,y!==null&&(y.return=t);y!==null;){var E=y.dependencies;if(E!==null){k=y.child;for(var P=E.firstContext;P!==null;){if(P.context===c){if(y.tag===1){P=Gr(-1,o&-o),P.tag=2;var X=y.updateQueue;if(X!==null){X=X.shared;var ce=X.pending;ce===null?P.next=P:(P.next=ce.next,ce.next=P),X.pending=P}}y.lanes|=o,P=y.alternate,P!==null&&(P.lanes|=o),wc(y.return,o,t),E.lanes|=o;break}P=P.next}}else if(y.tag===10)k=y.type===t.type?null:y.child;else if(y.tag===18){if(k=y.return,k===null)throw Error(r(341));k.lanes|=o,E=k.alternate,E!==null&&(E.lanes|=o),wc(k,o,t),k=y.sibling}else k=y.child;if(k!==null)k.return=y;else for(k=y;k!==null;){if(k===t){k=null;break}if(y=k.sibling,y!==null){y.return=k.return,k=y;break}k=k.return}y=k}dn(e,t,f.children,o),t=t.child}return t;case 9:return f=t.type,c=t.pendingProps.children,Ji(t,o),f=Dn(f),c=c(f),t.flags|=1,dn(e,t,c,o),t.child;case 14:return c=t.type,f=Zn(c,t.pendingProps),f=Zn(c.type,f),Yd(e,t,c,f,o);case 15:return Qd(e,t,t.type,t.pendingProps,o);case 17:return c=t.type,f=t.pendingProps,f=t.elementType===c?f:Zn(c,f),dl(e,t),t.tag=1,pn(c)?(e=!0,Va(t)):e=!1,Ji(t,o),zd(t,c,f),Mc(t,c,f,o),Uc(null,t,c,!0,e,o);case 19:return ih(e,t,o);case 22:return Xd(e,t,o)}throw Error(r(156,t.tag))};function Eh(e,t){return wo(e,t)}function Tp(e,t,o,c){this.tag=e,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ln(e,t,o,c){return new Tp(e,t,o,c)}function au(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Rp(e){if(typeof e=="function")return au(e)?1:0;if(e!=null){if(e=e.$$typeof,e===De)return 11;if(e===Tt)return 14}return 2}function Ps(e,t){var o=e.alternate;return o===null?(o=Ln(e.tag,t,e.key,e.mode),o.elementType=e.elementType,o.type=e.type,o.stateNode=e.stateNode,o.alternate=e,e.alternate=o):(o.pendingProps=t,o.type=e.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=e.flags&14680064,o.childLanes=e.childLanes,o.lanes=e.lanes,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,t=e.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},o.sibling=e.sibling,o.index=e.index,o.ref=e.ref,o}function kl(e,t,o,c,f,y){var k=2;if(c=e,typeof e=="function")au(e)&&(k=1);else if(typeof e=="string")k=5;else e:switch(e){case fe:return mi(o.children,f,y,t);case ye:k=8,f|=8;break;case $e:return e=Ln(12,o,t,f|2),e.elementType=$e,e.lanes=y,e;case lt:return e=Ln(13,o,t,f),e.elementType=lt,e.lanes=y,e;case jt:return e=Ln(19,o,t,f),e.elementType=jt,e.lanes=y,e;case Me:return _l(o,f,y,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Te:k=10;break e;case st:k=9;break e;case De:k=11;break e;case Tt:k=14;break e;case ft:k=16,c=null;break e}throw Error(r(130,e==null?e:typeof e,""))}return t=Ln(k,o,t,f),t.elementType=e,t.type=c,t.lanes=y,t}function mi(e,t,o,c){return e=Ln(7,e,c,t),e.lanes=o,e}function _l(e,t,o,c){return e=Ln(22,e,c,t),e.elementType=Me,e.lanes=o,e.stateNode={isHidden:!1},e}function lu(e,t,o){return e=Ln(6,e,null,t),e.lanes=o,e}function cu(e,t,o){return t=Ln(4,e.children!==null?e.children:[],e.key,t),t.lanes=o,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Pp(e,t,o,c,f){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Js(0),this.expirationTimes=Js(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Js(0),this.identifierPrefix=c,this.onRecoverableError=f,this.mutableSourceEagerHydrationData=null}function uu(e,t,o,c,f,y,k,E,P){return e=new Pp(e,t,o,E,P),t===1?(t=1,y===!0&&(t|=8)):t=0,y=Ln(3,null,null,t),e.current=y,y.stateNode=e,y.memoizedState={element:c,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},_c(y),e}function Op(e,t,o){var c=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:me,key:c==null?null:""+c,children:e,containerInfo:t,implementation:o}}function Ah(e){if(!e)return js;e=e._reactInternals;e:{if(nn(e)!==e||e.tag!==1)throw Error(r(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(pn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(r(171))}if(e.tag===1){var o=e.type;if(pn(o))return sd(e,o,t)}return t}function Th(e,t,o,c,f,y,k,E,P){return e=uu(o,c,!0,e,f,y,k,E,P),e.context=Ah(null),o=e.current,c=hn(),f=Ts(o),y=Gr(c,f),y.callback=t??null,Cs(o,y,f),e.current.lanes=f,Ir(e,f,c),gn(e,c),e}function jl(e,t,o,c){var f=t.current,y=hn(),k=Ts(f);return o=Ah(o),t.context===null?t.context=o:t.pendingContext=o,t=Gr(y,k),t.payload={element:e},c=c===void 0?null:c,c!==null&&(t.callback=c),e=Cs(f,t,k),e!==null&&(nr(e,f,k,y),tl(e,f,k)),k}function Nl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Rh(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var o=e.retryLane;e.retryLane=o!==0&&o<t?o:t}}function du(e,t){Rh(e,t),(e=e.alternate)&&Rh(e,t)}function Dp(){return null}var Ph=typeof reportError=="function"?reportError:function(e){console.error(e)};function hu(e){this._internalRoot=e}Sl.prototype.render=hu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(r(409));jl(e,t,null,null)},Sl.prototype.unmount=hu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;hi(function(){jl(null,e,null,null)}),t[qr]=null}};function Sl(e){this._internalRoot=e}Sl.prototype.unstable_scheduleHydration=function(e){if(e){var t=Sa();e={blockedOn:null,target:e,priority:t};for(var o=0;o<Lt.length&&t!==0&&t<Lt[o].priority;o++);Lt.splice(o,0,e),o===0&&Fa(e)}};function fu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Cl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Oh(){}function Ip(e,t,o,c,f){if(f){if(typeof c=="function"){var y=c;c=function(){var X=Nl(k);y.call(X)}}var k=Th(t,c,e,0,null,!1,!1,"",Oh);return e._reactRootContainer=k,e[qr]=k.current,$o(e.nodeType===8?e.parentNode:e),hi(),k}for(;f=e.lastChild;)e.removeChild(f);if(typeof c=="function"){var E=c;c=function(){var X=Nl(P);E.call(X)}}var P=uu(e,0,!1,null,null,!1,!1,"",Oh);return e._reactRootContainer=P,e[qr]=P.current,$o(e.nodeType===8?e.parentNode:e),hi(function(){jl(t,P,o,c)}),P}function Fl(e,t,o,c,f){var y=o._reactRootContainer;if(y){var k=y;if(typeof f=="function"){var E=f;f=function(){var P=Nl(k);E.call(P)}}jl(t,k,e,f)}else k=Ip(o,t,e,f,c);return Nl(k)}Na=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var o=cs(t.pendingLanes);o!==0&&(Si(t,o|1),gn(t,ut()),(at&6)===0&&(eo=ut()+500,Ns()))}break;case 13:hi(function(){var c=Vr(e,1);if(c!==null){var f=hn();nr(c,e,1,f)}}),du(e,1)}},tt=function(e){if(e.tag===13){var t=Vr(e,134217728);if(t!==null){var o=hn();nr(t,e,134217728,o)}du(e,134217728)}},jo=function(e){if(e.tag===13){var t=Ts(e),o=Vr(e,t);if(o!==null){var c=hn();nr(o,e,t,c)}du(e,t)}},Sa=function(){return ot},Ca=function(e,t){var o=ot;try{return ot=e,t()}finally{ot=o}},be=function(e,t,o){switch(t){case"input":if(ts(e,o),t=o.name,o.type==="radio"&&t!=null){for(o=e;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<o.length;t++){var c=o[t];if(c!==e&&c.form===e.form){var f=Ka(c);if(!f)throw Error(r(90));it(c),ts(c,f)}}}break;case"textarea":Us(e,o);break;case"select":t=o.value,t!=null&&Nt(e,!!o.multiple,t,!1)}},va=su,xa=hi;var Mp={usingClientEntryPoint:!1,Events:[qo,Ui,Ka,Fr,ur,su]},ra={findFiberByHostInstance:si,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Lp={bundleType:ra.bundleType,version:ra.version,rendererPackageName:ra.rendererPackageName,rendererConfig:ra.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ie.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=bo(e),e===null?null:e.stateNode},findFiberByHostInstance:ra.findFiberByHostInstance||Dp,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var El=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!El.isDisabled&&El.supportsFiber)try{Ks=El.inject(Lp),ln=El}catch{}}return vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Mp,vn.createPortal=function(e,t){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!fu(t))throw Error(r(200));return Op(e,t,null,o)},vn.createRoot=function(e,t){if(!fu(e))throw Error(r(299));var o=!1,c="",f=Ph;return t!=null&&(t.unstable_strictMode===!0&&(o=!0),t.identifierPrefix!==void 0&&(c=t.identifierPrefix),t.onRecoverableError!==void 0&&(f=t.onRecoverableError)),t=uu(e,1,!1,null,null,o,!1,c,f),e[qr]=t.current,$o(e.nodeType===8?e.parentNode:e),new hu(t)},vn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(r(188)):(e=Object.keys(e).join(","),Error(r(268,e)));return e=bo(t),e=e===null?null:e.stateNode,e},vn.flushSync=function(e){return hi(e)},vn.hydrate=function(e,t,o){if(!Cl(t))throw Error(r(200));return Fl(null,e,t,!0,o)},vn.hydrateRoot=function(e,t,o){if(!fu(e))throw Error(r(405));var c=o!=null&&o.hydratedSources||null,f=!1,y="",k=Ph;if(o!=null&&(o.unstable_strictMode===!0&&(f=!0),o.identifierPrefix!==void 0&&(y=o.identifierPrefix),o.onRecoverableError!==void 0&&(k=o.onRecoverableError)),t=Th(t,null,e,1,o??null,f,!1,y,k),e[qr]=t.current,$o(e),c)for(e=0;e<c.length;e++)o=c[e],f=o._getVersion,f=f(o._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[o,f]:t.mutableSourceEagerHydrationData.push(o,f);return new Sl(t)},vn.render=function(e,t,o){if(!Cl(t))throw Error(r(200));return Fl(null,e,t,!1,o)},vn.unmountComponentAtNode=function(e){if(!Cl(e))throw Error(r(40));return e._reactRootContainer?(hi(function(){Fl(null,null,e,!1,function(){e._reactRootContainer=null,e[qr]=null})}),!0):!1},vn.unstable_batchedUpdates=su,vn.unstable_renderSubtreeIntoContainer=function(e,t,o,c){if(!Cl(o))throw Error(r(200));if(e==null||e._reactInternals===void 0)throw Error(r(38));return Fl(e,t,o,!1,c)},vn.version="18.3.1-next-f1338f8080-20240426",vn}var zh;function Nf(){if(zh)return yu.exports;zh=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(n){console.error(n)}}return i(),yu.exports=Hp(),yu.exports}var qh;function Vp(){if(qh)return Al;qh=1;var i=Nf();return Al.createRoot=i.createRoot,Al.hydrateRoot=i.hydrateRoot,Al}var Gp=Vp(),V=zu();const co=jf(V);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jp=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Yp=i=>i.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,r,a)=>a?a.toUpperCase():r.toLowerCase()),Wh=i=>{const n=Yp(i);return n.charAt(0).toUpperCase()+n.slice(1)},Sf=(...i)=>i.filter((n,r,a)=>!!n&&n.trim()!==""&&a.indexOf(n)===r).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Qp={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xp=V.forwardRef(({color:i="currentColor",size:n=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:d="",children:h,iconNode:p,...v},x)=>V.createElement("svg",{ref:x,...Qp,width:n,height:n,stroke:i,strokeWidth:a?Number(r)*24/Number(n):r,className:Sf("lucide",d),...v},[...p.map(([_,j])=>V.createElement(_,j)),...Array.isArray(h)?h:[h]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=(i,n)=>{const r=V.forwardRef(({className:a,...d},h)=>V.createElement(Xp,{ref:h,iconNode:n,className:Sf(`lucide-${Jp(Wh(i))}`,`lucide-${i}`,a),...d}));return r.displayName=Wh(i),r};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zp=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],em=Ze("arrow-down",Zp);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tm=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],nm=Ze("arrow-left",tm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rm=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],sm=Ze("arrow-up",rm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const im=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],qu=Ze("book-open",im);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const om=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Wu=Ze("check",om);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const am=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],lm=Ze("chevron-down",am);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cm=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],go=Ze("chevron-left",cm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const um=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Ls=Ze("chevron-right",um);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dm=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],hm=Ze("chevron-up",dm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fm=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Ku=Ze("circle-alert",fm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pm=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Xr=Ze("circle-check-big",pm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mm=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],ym=Ze("clipboard-list",mm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gm=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],vm=Ze("copy",gm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xm=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],zl=Ze("download",xm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bm=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],mo=Ze("file-text",bm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wm=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Kh=Ze("globe",wm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const km=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],_m=Ze("house",km);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jm=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Nm=Ze("info",jm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sm=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],Cm=Ze("lightbulb",Sm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fm=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],Em=Ze("loader",Fm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Am=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Tm=Ze("lock",Am);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rm=[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]],Pm=Ze("mail",Rm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Om=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Cf=Ze("map-pin",Om);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dm=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],xu=Ze("play",Dm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Im=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ff=Ze("plus",Im);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mm=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Hh=Ze("refresh-cw",Mm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lm=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],Hu=Ze("search",Lm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bm=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],$m=Ze("settings",Bm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Um=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],zm=Ze("shield",Um);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qm=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Ef=Ze("trash-2",qm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wm=[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]],Km=Ze("trending-down",Wm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hm=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],Vm=Ze("upload",Hm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gm=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Vu=Ze("user",Gm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jm=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],Ym=Ze("users",Jm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qm=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Xm=Ze("wifi-off",Qm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zm=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],ey=Ze("wifi",Zm);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ty=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Sr=Ze("x",ty),ny="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODgiIGhlaWdodD0iODgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBvcGFjaXR5PSIuMyIgZmlsbD0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIzLjciPjxyZWN0IHg9IjE2IiB5PSIxNiIgd2lkdGg9IjU2IiBoZWlnaHQ9IjU2IiByeD0iNiIvPjxwYXRoIGQ9Im0xNiA1OCAxNi0xOCAzMiAzMiIvPjxjaXJjbGUgY3g9IjUzIiBjeT0iMzUiIHI9IjciLz48L3N2Zz4KCg==";function ki(i){const[n,r]=V.useState(!1),a=()=>{r(!0)},{src:d,alt:h,style:p,className:v,...x}=i;return n?s.jsx("div",{className:`inline-block bg-gray-100 text-center align-middle ${v??""}`,style:p,children:s.jsx("div",{className:"flex items-center justify-center w-full h-full",children:s.jsx("img",{src:ny,alt:"Error loading image",...x,"data-original-url":d})})}):s.jsx("img",{src:d,alt:h,className:v,style:p,...x,onError:a})}function ry({onComplete:i,onClose:n}){const[r,a]=V.useState(1),[d,h]=V.useState({}),[p,v]=V.useState(!1),x=7;V.useEffect(()=>{const M=localStorage.getItem("mockProgress");if(M){const U=JSON.parse(M);a(U.currentScreen||1),h(U.choices||{})}},[]);const _=(M,U)=>{localStorage.setItem("mockProgress",JSON.stringify({currentScreen:M,choices:U}))},j=(M,U)=>{const Z={...d,[M]:U};h(Z),_(r,Z),v(!0),setTimeout(()=>v(!1),1500)},C=()=>{if(r<x){const M=r+1;a(M),_(M,d),window.scrollTo(0,0)}else localStorage.setItem("mockCompleted","true"),localStorage.removeItem("mockProgress"),i()},F=()=>{if(r>1){const M=r-1;a(M),_(M,d),window.scrollTo(0,0)}},T=d[r]!==void 0||r===3||r===7,q=r<=3?{step:1,label:"Step 1: Eligibility",color:"#60A5FA",bg:"rgba(96, 165, 250, 0.15)"}:r<=5?{step:2,label:"Step 2: Preliminary",color:"#34D399",bg:"rgba(52, 211, 153, 0.15)"}:{step:3,label:"Step 3: Adjustment",color:"#A78BFA",bg:"rgba(167, 139, 250, 0.15)"};return s.jsxs("div",{className:"fixed inset-0 z-50 flex flex-col",style:{background:"linear-gradient(180deg, #0B0B0D 0%, #0F1013 100%)"},children:[s.jsxs("div",{className:"sticky top-0 z-20 px-4 py-4 safe-area-top backdrop-blur-sm bg-black/60",style:{borderBottom:"1px solid #242632"},children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("button",{onClick:n,className:"p-2 -ml-2",children:s.jsx(Sr,{className:"w-5 h-5",style:{color:"#8E91A3"}})}),s.jsxs("span",{className:"text-xs font-semibold",style:{color:"#8E91A3"},children:["Screen ",r," of ",x]})]}),s.jsx("div",{className:"w-full h-1 rounded-full overflow-hidden",style:{background:"#1A1C22"},children:s.jsx("div",{className:"h-full transition-all duration-300",style:{width:`${r/x*100}%`,background:q.color}})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-6",style:{paddingBottom:"140px"},children:[r!==7&&s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx("div",{className:"px-3 py-1.5 rounded-full",style:{background:q.bg},children:s.jsx("span",{className:"text-sm font-semibold",style:{color:q.color},children:q.label})}),s.jsx("div",{className:"px-3 py-1.5 rounded-full",style:{background:"rgba(142, 145, 163, 0.15)"},children:s.jsx("span",{className:"text-xs font-semibold",style:{color:"#8E91A3"},children:"Mock Assessment (Training)"})})]}),r===1&&s.jsx(sy,{choice:d[1],onChoice:M=>j(1,M)}),r===2&&s.jsx(iy,{choice:d[2],onChoice:M=>j(2,M)}),r===3&&s.jsx(oy,{}),r===4&&s.jsx(ay,{choice:d[4],onChoice:M=>j(4,M)}),r===5&&s.jsx(ly,{choice:d[5],onChoice:M=>j(5,M)}),r===6&&s.jsx(cy,{choice:d[6],onChoice:M=>j(6,M)}),r===7&&s.jsx(uy,{})]}),s.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-20 px-4 py-4 safe-area-bottom backdrop-blur-sm bg-black/80",style:{borderTop:"1px solid #242632"},children:s.jsxs("div",{className:"flex gap-3",children:[r>1&&s.jsx("button",{onClick:F,className:"flex-1 py-3 px-4 rounded-xl text-base font-semibold transition-all",style:{background:"transparent",border:"2px solid #242632",color:"#FFFFFF"},children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx(go,{className:"w-5 h-5"}),"Back"]})}),s.jsx("button",{onClick:C,disabled:!T,className:"flex-1 py-3 px-4 rounded-xl text-base font-semibold transition-all disabled:opacity-50",style:{background:T?"#D2110C":"#8E91A3",color:"#FFFFFF"},children:r===7?"Start Using the App":"Continue"})]})}),p&&s.jsx("div",{className:"fixed top-20 left-1/2 -translate-x-1/2 z-30 px-4 py-2 rounded-full shadow-lg animate-slide-down",style:{background:"#10B981",color:"#FFFFFF"},children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Xr,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-semibold",children:"Saved"})]})})]})}function sy({choice:i,onChoice:n}){return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("p",{className:"text-sm mb-2",style:{color:"#8E91A3"},children:"Mock assessment  Golden Frog"}),s.jsx("h2",{className:"text-xl font-bold",style:{color:"#FFFFFF"},children:"Is the population native or a benign introduction?"})]}),s.jsx(bn,{selected:i==="native",onSelect:()=>n("native"),title:"Native population",subtitle:"Within natural range",recommended:!0}),s.jsx(bn,{selected:i==="benign",onSelect:()=>n("benign"),title:"Benign introduction",subtitle:"Conservation-driven, suitable habitat"}),s.jsx(bn,{selected:i==="harmful",onSelect:()=>n("harmful"),title:"Harmful introduction",subtitle:"Cannot assess (NA)"}),s.jsxs(vo,{children:["Only eligible wild/natural-range (or benign introduction) populations can be assessed. Harmful introductions should be recorded as ",s.jsx("strong",{children:"NA"}),", not assigned a threat category."]})]})}function iy({choice:i,onChoice:n}){return s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"mb-6",children:s.jsx("h2",{className:"text-xl font-bold",style:{color:"#FFFFFF"},children:"Is this taxon a vagrant in the region?"})}),s.jsx(bn,{selected:i==="no",onSelect:()=>n("no"),title:"No  established breeding population",recommended:!0}),s.jsx(bn,{selected:i==="yes",onSelect:()=>n("yes"),title:"Yes  occasional accidental records (vagrant)",subtitle:"Teaching branch: this would lead to NA"}),s.jsx(vo,{children:"Vagrants are not assessed because they do not represent an established regional population."})]})}function oy(){return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h2",{className:"text-xl font-bold mb-2",style:{color:"#FFFFFF"},children:"Step 1 Outcome"}),s.jsx("p",{className:"text-sm",style:{color:"#C9CBD6"},children:"Summary before proceeding to Step 2"})]}),s.jsx("div",{className:"rounded-xl p-5",style:{background:"#14151A",border:"1px solid #242632"},children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Xr,{className:"w-5 h-5",style:{color:"#10B981"}}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold",style:{color:"#8E91A3"},children:"Eligibility"}),s.jsx("p",{className:"text-base font-bold",style:{color:"#FFFFFF"},children:"Eligible"})]})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-5 h-5 flex items-center justify-center",children:s.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:"#60A5FA"}})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold",style:{color:"#8E91A3"},children:"Population type"}),s.jsx("p",{className:"text-base font-bold",style:{color:"#FFFFFF"},children:"Breeding population"})]})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-5 h-5 flex items-center justify-center",children:s.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:"#60A5FA"}})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold",style:{color:"#8E91A3"},children:"Next step"}),s.jsx("p",{className:"text-base font-bold",style:{color:"#FFFFFF"},children:"Preliminary category (regional data only)"})]})]})]})}),s.jsx(vo,{children:"Step 1 must be clean and explicit so Step 2 applies to the correct regional population."})]})}function ay({choice:i,onChoice:n}){return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("div",{className:"flex items-center gap-2 mb-2",children:s.jsx("span",{className:"px-2 py-1 rounded text-xs font-semibold",style:{background:"rgba(52, 211, 153, 0.15)",color:"#34D399"},children:"Regional data only"})}),s.jsx("h2",{className:"text-xl font-bold",style:{color:"#FFFFFF"},children:"What is the estimated regional population size (mature individuals)?"})]}),s.jsx(bn,{selected:i==="8000",onSelect:()=>n("8000"),title:"~8,000 mature individuals",subtitle:"Moderate population size (not automatically threatened by D)",recommended:!0}),s.jsx(bn,{selected:i==="unknown",onSelect:()=>n("unknown"),title:"Unknown",subtitle:"May lead to DD if key data are missing"}),s.jsx(bn,{selected:i==="<250",onSelect:()=>n("<250"),title:"<250 mature individuals",subtitle:"Very small population (high risk)"}),s.jsxs(vo,{children:["Step 2 uses ",s.jsx("em",{children:"regional"})," estimates. Unknown values increase uncertainty and may prevent assigning a category confidently."]})]})}function ly({choice:i,onChoice:n}){const r=i==="restricted";return s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"mb-6",children:s.jsx("h2",{className:"text-xl font-bold",style:{color:"#FFFFFF"},children:"Which best describes the regional range and trend?"})}),s.jsx(bn,{selected:i==="restricted",onSelect:()=>n("restricted"),title:"Restricted AOO + ongoing habitat quality decline",recommended:!0}),i==="restricted"&&s.jsxs("div",{className:"rounded-xl p-4 ml-4",style:{background:"rgba(52, 211, 153, 0.1)",border:"1px solid rgba(52, 211, 153, 0.3)"},children:[s.jsx("p",{className:"text-xs font-semibold mb-2",style:{color:"#34D399"},children:"Example values (read-only)"}),s.jsxs("div",{className:"space-y-1.5 text-sm",style:{color:"#C9CBD6"},children:[s.jsxs("p",{children:[" Regional AOO: ",s.jsx("strong",{children:"~120 km"})]}),s.jsxs("p",{children:[" Locations: ",s.jsx("strong",{children:"~6"})]}),s.jsxs("p",{children:[" Continuing decline: ",s.jsx("strong",{children:"Yes (habitat quality)"})]})]})]}),s.jsx(bn,{selected:i==="wide",onSelect:()=>n("wide"),title:"Wide range + stable habitat"}),s.jsx(bn,{selected:i==="unknown-range",onSelect:()=>n("unknown-range"),title:"Unknown / insufficient data"}),r&&s.jsxs("div",{className:"rounded-xl p-5",style:{background:"#14151A",border:"2px solid #34D399"},children:[s.jsx("p",{className:"text-xs font-semibold mb-3",style:{color:"#34D399"},children:"Preliminary result (Step 2)"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold",style:{color:"#8E91A3"},children:"Preliminary category"}),s.jsx("p",{className:"text-xl font-bold",style:{color:"#FFFFFF"},children:"Vulnerable (VU)  example"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold",style:{color:"#8E91A3"},children:"Example criteria string (training)"}),s.jsx("p",{className:"text-base font-bold",style:{color:"#C9CBD6"},children:"B2ab(iii)"}),s.jsx("p",{className:"text-xs mt-1",style:{color:"#8E91A3"},children:"AOO restricted + continuing decline in habitat quality"})]})]})]}),s.jsx(vo,{children:"This demonstrates how restricted range and continuing decline can produce a threatened preliminary category using regional evidence."})]})}function cy({choice:i,onChoice:n}){const r=i==="yes";return s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"mb-6",children:s.jsx("h2",{className:"text-xl font-bold",style:{color:"#FFFFFF"},children:"Is rescue effect likely from extra-regional conspecific populations?"})}),s.jsx(bn,{selected:i==="yes",onSelect:()=>n("yes"),title:"Yes  rescue likely",subtitle:"Nearby source populations are stable; immigration is plausible",recommended:!0}),i==="yes"&&s.jsxs("div",{className:"rounded-xl p-4 ml-4",style:{background:"rgba(167, 139, 250, 0.1)",border:"1px solid rgba(167, 139, 250, 0.3)"},children:[s.jsx("p",{className:"text-xs font-semibold mb-2",style:{color:"#A78BFA"},children:"Prefilled evidence (read-only)"}),s.jsxs("div",{className:"space-y-1.5 text-sm",style:{color:"#C9CBD6"},children:[s.jsxs("p",{children:[" Connectivity: ",s.jsx("strong",{children:"Present (adjacent habitat corridor)"})]}),s.jsxs("p",{children:[" Source populations: ",s.jsx("strong",{children:"Stable"})]}),s.jsxs("p",{children:[" Suitable habitat in region: ",s.jsx("strong",{children:"Available"})]})]})]}),s.jsx(bn,{selected:i==="no",onSelect:()=>n("no"),title:"No  isolated population",subtitle:"No change from Step 2"}),s.jsx(bn,{selected:i==="unknown",onSelect:()=>n("unknown"),title:"Unknown",subtitle:"Keep Step 2 unchanged (do not adjust)"}),r&&s.jsxs("div",{className:"rounded-xl p-5",style:{background:"#14151A",border:"2px solid #A78BFA"},children:[s.jsx("p",{className:"text-xs font-semibold mb-3",style:{color:"#A78BFA"},children:"System adjustment (read-only)"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold",style:{color:"#8E91A3"},children:"Downlist by 1 step (example)"}),s.jsx("p",{className:"text-xl font-bold",style:{color:"#FFFFFF"},children:"VU  NT"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold",style:{color:"#8E91A3"},children:"Mark as adjusted"}),s.jsx("p",{className:"text-base font-bold",style:{color:"#C9CBD6"},children:"NT"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold",style:{color:"#8E91A3"},children:"Steps changed"}),s.jsx("p",{className:"text-base font-bold",style:{color:"#C9CBD6"},children:"1"})]})]})]}),s.jsx(vo,{children:"Step 3 can reduce extinction risk when immigration is plausible. If influence is unknown, you must keep Step 2 unchanged (no guessing)."})]})}function uy(){return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"rgba(16, 185, 129, 0.15)"},children:s.jsx(Xr,{className:"w-8 h-8",style:{color:"#10B981"}})}),s.jsx("h1",{className:"text-2xl font-bold mb-2",style:{color:"#FFFFFF"},children:"Congratulations!"}),s.jsx("p",{className:"text-base",style:{color:"#C9CBD6"},children:"You completed your first guided regional assessment"})]}),s.jsx("div",{className:"rounded-xl p-6",style:{background:"#14151A",border:"2px solid #D2110C"},children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-semibold mb-1",style:{color:"#8E91A3"},children:"Mock taxon"}),s.jsxs("p",{className:"text-lg font-bold",style:{color:"#FFFFFF"},children:["Golden Frog ",s.jsx("em",{children:"(Rana auratus)"})]}),s.jsx("p",{className:"text-xs",style:{color:"#8E91A3"},children:"Training example"})]}),s.jsx("div",{className:"h-px",style:{background:"#242632"}}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-semibold mb-1",style:{color:"#8E91A3"},children:"Step 2 (Preliminary)"}),s.jsx("p",{className:"text-lg font-bold",style:{color:"#FFFFFF"},children:"Vulnerable (VU)"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-semibold mb-1",style:{color:"#8E91A3"},children:"Step 3 (Final regional)"}),s.jsx("p",{className:"text-lg font-bold",style:{color:"#10B981"},children:"Near Threatened (NT)"})]})]}),s.jsx("div",{className:"h-px",style:{background:"#242632"}}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-semibold mb-1",style:{color:"#8E91A3"},children:"Adjusted?"}),s.jsx("p",{className:"text-base font-bold",style:{color:"#FFFFFF"},children:"Yes"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-semibold mb-1",style:{color:"#8E91A3"},children:"Steps changed"}),s.jsx("p",{className:"text-base font-bold",style:{color:"#FFFFFF"},children:"1 (downlisted)"})]})]})]})}),s.jsxs("div",{className:"rounded-xl p-5",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsx("p",{className:"text-xs font-semibold mb-3",style:{color:"#D2110C"},children:"Plain-language rationale"}),s.jsx("p",{className:"text-sm leading-relaxed",style:{color:"#C9CBD6"},children:"Within the region, the population shows restricted occupancy and ongoing habitat quality decline, supporting a threatened preliminary category. However, immigration from stable extra-regional populations is likely and suitable habitat remains available, reducing extinction risk within the region. The preliminary category is therefore downlisted by one step as a best-estimate."})]}),s.jsxs("div",{className:"rounded-xl p-5",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("p",{className:"text-xs font-semibold mb-1",style:{color:"#8E91A3"},children:"Confidence"}),s.jsx("p",{className:"text-base font-bold",style:{color:"#FFFFFF"},children:"Medium"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-semibold mb-2",style:{color:"#8E91A3"},children:"Drivers"}),s.jsxs("div",{className:"space-y-1.5 text-sm",style:{color:"#C9CBD6"},children:[s.jsx("p",{children:" Regional AOO and locations are approximate (example values)"}),s.jsx("p",{children:" Decline mechanism is clear (habitat quality)"}),s.jsx("p",{children:" Rescue effect is plausible due to connectivity and stable sources"})]})]})]}),s.jsx("div",{className:"rounded-xl p-4",style:{background:"rgba(142, 145, 163, 0.1)",border:"1px solid rgba(142, 145, 163, 0.3)"},children:s.jsx("p",{className:"text-xs",style:{color:"#8E91A3"},children:"This guided mock uses example data to teach the regional 3-step method. It provides a best-estimate demonstration and does not guarantee accuracy for real assessments."})})]})}function bn({selected:i,onSelect:n,title:r,subtitle:a,badge:d,recommended:h}){return s.jsx("button",{onClick:n,className:"w-full rounded-xl p-4 text-left transition-all active:scale-98",style:{background:i?"rgba(210, 17, 12, 0.1)":"#14151A",border:`2px solid ${i?"#D2110C":"#242632"}`},children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"flex-shrink-0 w-5 h-5 rounded-full border-2 mt-0.5 flex items-center justify-center",style:{borderColor:i?"#D2110C":"#242632"},children:i&&s.jsx("div",{className:"w-2.5 h-2.5 rounded-full",style:{background:"#D2110C"}})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("p",{className:"font-bold mb-1",style:{color:"#FFFFFF"},children:[r," ",d&&s.jsx("span",{className:"ml-2",children:d})]}),a&&s.jsx("p",{className:"text-sm",style:{color:"#8E91A3"},children:a}),h&&s.jsx("p",{className:"text-xs font-semibold mt-1",style:{color:"#34D399"},children:"Recommended"})]})]})})}function vo({children:i}){return s.jsx("div",{className:"rounded-xl p-4 mt-6",style:{background:"rgba(210, 17, 12, 0.05)",border:"1px solid rgba(210, 17, 12, 0.2)"},children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Cm,{className:"w-5 h-5 flex-shrink-0 mt-0.5",style:{color:"#D2110C"}}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-semibold mb-1",style:{color:"#D2110C"},children:"Why this matters"}),s.jsx("p",{className:"text-sm",style:{color:"#C9CBD6"},children:i})]})]})})}function dy({onStartAssessment:i,onNavigate:n}){const[r,a]=V.useState([]),[d,h]=V.useState(navigator.onLine),[p,v]=V.useState(!1),[x,_]=V.useState(!1),[j,C]=V.useState(!1),[F,T]=V.useState(!1),[A,q]=V.useState(!1),[M,U]=V.useState("Good morning"),[Z,ne]=V.useState(""),[ie,ee]=V.useState({step1:0,step2:0,step3:0});V.useEffect(()=>{const st=localStorage.getItem("userName")||"";ne(st);const De=new Date().getHours();De<12?U("Good morning"):De<18?U("Good afternoon"):U("Good evening");const lt=localStorage.getItem("assessments");lt&&a(JSON.parse(lt));const jt=localStorage.getItem("moduleProgress");jt&&ee(JSON.parse(jt));const Tt=()=>h(!0),ft=()=>h(!1);window.addEventListener("online",Tt),window.addEventListener("offline",ft);const Me=()=>v(!0);return window.addEventListener("openNewAssessment",Me),()=>{window.removeEventListener("online",Tt),window.removeEventListener("offline",ft),window.removeEventListener("openNewAssessment",Me)}},[]);const me=()=>{v(!0)},fe=(st,De)=>{const lt={id:`assessment-${Date.now()}`,taxonName:st,scientificName:De,status:"draft",currentStep:1,lastModified:new Date().toISOString()},jt=[...r,lt];a(jt),localStorage.setItem("assessments",JSON.stringify(jt)),v(!1),i(lt.id)},ye=st=>{n("library"),setTimeout(()=>{const De=new CustomEvent("openModule",{detail:{moduleId:st}});window.dispatchEvent(De)},100)},Te=ie.step1<100?{step:1,title:"Step 1  Eligibility",subtitle:"Taxon & population inclusion rules",progress:ie.step1}:ie.step2<100?{step:2,title:"Step 2  Preliminary Category",subtitle:"Apply criteria using regional data",progress:ie.step2}:ie.step3<100?{step:3,title:"Step 3  Adjustment",subtitle:"Rescue effect & sink logic",progress:ie.step3}:{step:1,title:"Step 1  Eligibility",subtitle:"Taxon & population inclusion rules",progress:ie.step1};return s.jsxs("div",{className:"min-h-screen",style:{background:"linear-gradient(180deg, #0B0B0D 0%, #0F1013 100%)"},children:[s.jsx("header",{className:"px-4 py-4 safe-area-top sticky top-0 z-20 backdrop-blur-sm bg-black/30",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h1",{className:"text-xl font-bold tracking-tight",style:{color:"#FFFFFF"},children:"RedList Buddy"}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex items-center gap-2",children:d?s.jsx(ey,{className:"w-4 h-4",style:{color:"#6EE7B7"}}):s.jsx(Xm,{className:"w-4 h-4",style:{color:"#8E91A3"}})}),s.jsx("button",{onClick:()=>n("profile"),className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:"#1A1C22"},children:s.jsx(Vu,{className:"w-5 h-5",style:{color:"#C9CBD6"}})})]})]})}),s.jsxs("div",{className:"px-4 py-6 content-safe-bottom space-y-6",children:[s.jsx("section",{className:"space-y-0",children:s.jsxs("div",{children:[s.jsxs("p",{className:"text-lg font-semibold",style:{color:"rgba(255, 255, 255, 0.9)",lineHeight:1.2},children:[M,","]}),s.jsxs("h2",{className:"text-3xl font-bold",style:{color:"#FFFFFF",lineHeight:1.15},children:[Z,"."]})]})}),s.jsxs("section",{className:"relative overflow-hidden rounded-[22px] card-shadow-raised",children:[s.jsx(ki,{src:"https://images.unsplash.com/photo-1768737829317-8458524c7053?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxlbmRhbmdlcmVkJTIwd2lsZGxpZmUlMjBjb25zZXJ2YXRpb24lMjBuYXR1cmV8ZW58MXx8fHwxNzcwNTk0MTc2fDA&ixlib=rb-4.1.0&q=80&w=1080",alt:"Wildlife conservation",className:"absolute inset-0 w-full h-full object-cover"}),s.jsx("div",{className:"absolute inset-0 image-overlay-dark"}),s.jsxs("div",{className:"relative z-10 p-6 min-h-[280px] flex flex-col justify-end",children:[s.jsx("h3",{className:"text-xl font-bold mb-2",style:{color:"#FFFFFF"},children:"Start a new assessment"}),s.jsx("p",{className:"text-sm mb-6",style:{color:"#C9CBD6"},children:"Guided Step 1  Step 3 workflow with audit-ready outputs."}),s.jsxs("div",{className:"flex flex-col gap-3",children:[s.jsxs("button",{onClick:me,className:"btn-primary flex items-center justify-center gap-2",children:[s.jsx(xu,{className:"w-5 h-5"}),"Start Assessment"]}),s.jsx("button",{onClick:()=>_(!0),className:"w-full py-3 px-4 rounded-xl text-base font-semibold transition-all",style:{background:"transparent",border:"2px solid rgba(255, 255, 255, 0.2)",color:"#FFFFFF"},children:"View Step-by-Step Tutorial"})]})]})]}),s.jsxs("section",{className:"space-y-4",children:[s.jsx("div",{children:s.jsx("h3",{className:"text-lg font-bold mb-1",style:{color:"#FFFFFF"},children:"Next Learning Module"})}),s.jsxs("div",{className:"relative overflow-hidden rounded-[22px] card-shadow-raised",children:[s.jsx(ki,{src:"https://images.unsplash.com/photo-1759429114703-bfe85822d33d?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHx3aWxkbGlmZSUyMGxlYXJuaW5nJTIwbmF0dXJlJTIwY29uc2VydmF0aW9ufGVufDF8fHx8MTc3MDYxNDU1MHww&ixlib=rb-4.1.0&q=80&w=1080&utm_source=figma&utm_medium=referral",alt:"Learning module",className:"absolute inset-0 w-full h-full object-cover"}),s.jsx("div",{className:"absolute inset-0 image-overlay-dark"}),s.jsxs("div",{className:"relative z-10 p-6 min-h-[240px] flex flex-col justify-end",children:[s.jsx("h3",{className:"text-xl font-bold mb-2",style:{color:"#FFFFFF"},children:Te.title}),s.jsx("p",{className:"text-sm mb-4",style:{color:"rgba(255, 255, 255, 0.7)"},children:Te.subtitle}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-xs font-semibold",style:{color:"rgba(255, 255, 255, 0.7)"},children:"Progress"}),s.jsxs("span",{className:"text-xs font-semibold",style:{color:"#FFFFFF"},children:[Te.progress,"%"]})]}),s.jsx("div",{className:"w-full h-1.5 rounded-full overflow-hidden",style:{background:"rgba(255, 255, 255, 0.15)"},children:s.jsx("div",{className:"h-full transition-all duration-300 rounded-full",style:{width:`${Te.progress}%`,background:"#FFFFFF"}})})]}),s.jsxs("div",{className:"flex flex-col gap-3",children:[s.jsxs("button",{onClick:()=>ye(Te.step),className:"btn-primary flex items-center justify-center gap-2",children:[s.jsx(xu,{className:"w-5 h-5"}),Te.progress===0?"Start Module":Te.progress>=100?"Review Module":"Continue Module"]}),s.jsx("button",{onClick:()=>n("library"),className:"w-full py-3 px-4 rounded-xl text-base font-semibold transition-all",style:{background:"transparent",border:"2px solid rgba(255, 255, 255, 0.2)",color:"#FFFFFF"},children:"View all modules"})]})]})]}),s.jsx("button",{onClick:()=>C(!0),className:"w-full py-3 px-4 rounded-xl text-base font-semibold transition-all",style:{background:"#D2110C",color:"#FFFFFF"},children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx(xu,{className:"w-5 h-5"}),"Start Guided Mock Assessment"]})})]}),s.jsxs("section",{className:"relative overflow-hidden rounded-[22px] card-shadow-raised",children:[s.jsx(ki,{src:"https://images.unsplash.com/photo-1769269431046-533799ab0079?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxmb3Jlc3QlMjBiaW9kaXZlcnNpdHklMjBlbmRhbmdlcmVkJTIwc3BlY2llc3xlbnwxfHx8fDE3NzA1OTQxNzd8MA&ixlib=rb-4.1.0&q=80&w=1080",alt:"Reference library",className:"absolute inset-0 w-full h-full object-cover"}),s.jsx("div",{className:"absolute inset-0 image-overlay-dark"}),s.jsxs("div",{className:"relative z-10 p-6 min-h-[240px] flex flex-col justify-end",children:[s.jsx("h3",{className:"text-xl font-bold mb-2",style:{color:"#FFFFFF"},children:"Reference Library"}),s.jsx("p",{className:"text-sm mb-6",style:{color:"#C9CBD6"},children:"Regional rules and definitions you'll use during assessments"}),s.jsxs("div",{className:"flex flex-col gap-3",children:[s.jsxs("button",{onClick:()=>{n("library"),setTimeout(()=>{const st=new CustomEvent("scrollToRegionModules");window.dispatchEvent(st)},100)},className:"btn-primary flex items-center justify-center gap-2",children:[s.jsx(qu,{className:"w-5 h-5"}),"Open Region Modules"]}),s.jsx("button",{onClick:()=>{n("library"),setTimeout(()=>{const st=new CustomEvent("openGlossary");window.dispatchEvent(st)},100)},className:"w-full py-3 px-4 rounded-xl text-base font-semibold transition-all",style:{background:"transparent",border:"2px solid rgba(255, 255, 255, 0.2)",color:"#FFFFFF"},children:"Open Glossary"})]})]})]})]}),p&&s.jsx(hy,{onClose:()=>v(!1),onCreate:fe}),x&&s.jsx(fy,{onClose:()=>_(!1)}),j&&s.jsx(py,{onClose:()=>C(!1),onStartMock:()=>{C(!1),T(!0)}}),F&&s.jsx(ry,{onComplete:()=>{T(!1),q(!0),setTimeout(()=>q(!1),3e3)},onClose:()=>T(!1)}),A&&s.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 z-[60] px-6 py-3 rounded-full shadow-lg animate-slide-down",style:{background:"#10B981",color:"#FFFFFF"},children:s.jsx("p",{className:"text-sm font-semibold",children:" Mock complete  you're ready to draft real assessments"})})]})}function hy({onClose:i,onCreate:n}){const[r,a]=V.useState(""),[d,h]=V.useState(""),p=v=>{v.preventDefault(),r&&d&&n(r,d)};return s.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in",children:s.jsxs("div",{className:"rounded-[22px] card-shadow-raised max-w-md w-full p-6 animate-slide-up",style:{background:"#1A1C22"},children:[s.jsx("h2",{className:"text-xl font-bold mb-4",style:{color:"#FFFFFF"},children:"New Assessment"}),s.jsxs("form",{onSubmit:p,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"taxonName",className:"block text-sm font-semibold mb-2",style:{color:"#C9CBD6"},children:"Common Name"}),s.jsx("input",{type:"text",id:"taxonName",value:r,onChange:v=>a(v.target.value),placeholder:"e.g., Mountain Bluebird",className:"w-full px-4 py-3 rounded-lg transition-all",style:{background:"#14151A",border:"1px solid #242632",color:"#FFFFFF"},required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"scientificName",className:"block text-sm font-semibold mb-2",style:{color:"#C9CBD6"},children:"Scientific Name"}),s.jsx("input",{type:"text",id:"scientificName",value:d,onChange:v=>h(v.target.value),placeholder:"e.g., Sialia currucoides",className:"w-full px-4 py-3 rounded-lg italic transition-all",style:{background:"#14151A",border:"1px solid #242632",color:"#FFFFFF"},required:!0})]}),s.jsxs("div",{className:"flex gap-3 mt-6",children:[s.jsx("button",{type:"button",onClick:i,className:"flex-1 btn-secondary py-3",children:"Cancel"}),s.jsx("button",{type:"submit",className:"flex-1 btn-primary py-3",children:"Create"})]})]})]})})}function fy({onClose:i}){const[n,r]=V.useState(1),a=12,h=[{step:1,title:"Step 1: Eligibility  Introduction",content:"In Step 1, you decide whether the taxon (and which population) is eligible for a regional assessment. You must confirm the population is within its natural range (or a benign introduction) and that the occurrence is not a vagrant.",fields:[{label:"Tutorial taxon",value:"Mountain Bluebird (Sialia currucoides)"},{label:"Assessment region",value:"North America (example region profile)"},{label:"Population status",value:"Native  within natural range"}],callout:"Only wild populations within natural range (and some benign introductions) are eligible for regional assessment. Ineligible taxa should be recorded as NA (Not Applicable), not forced into a threat category."},{step:2,title:"Step 1: Eligibility  Wild Population Check",content:"Confirm the individuals in the region represent a wild population (natural reproduction), rather than an introduced or captive-derived occurrence.",fields:[{label:"Occurrence type",value:"Wild population"},{label:"Evidence basis",value:"Breeding-season records across multiple years (monitoring summaries)"}],callout:"Introduced populations outside natural range are usually NA. You must document why the population qualifies as wild and eligible."},{step:3,title:"Step 1: Eligibility  Breeding vs Visiting Populations",content:"Decide whether the taxon occurs as a breeding population, a visiting population, or both. If they can be distinguished, they should be assessed separately.",fields:[{label:"Breeding population present in region?",value:"Yes  confirmed nesting"},{label:"Visiting (non-breeding) population present?",value:"No"},{label:"Assessment population type",value:"Breeding population (this tutorial)"}],callout:"Breeding and visiting populations can have different dynamics and risks. Mixing them can invalidate later steps."},{step:4,title:"Step 1: Eligibility  Vagrant Check",content:"Verify the taxon is not a vagrant (only occasional accidental occurrences). Vagrants are not assessed.",fields:[{label:"Is this a vagrant?",value:"No"},{label:"Occurrence pattern",value:"Regular seasonal breeder at established sites"}],callout:"Vagrants have no established regional population to assess and should be recorded as NA."},{step:5,title:"Step 1: Eligibility  Recent Colonizer Rule",content:"If the taxon recently colonised the region, it should not be assessed until it has reproduced consistently for several years (policy-dependent).",fields:[{label:"Recent colonizer?",value:"No"},{label:"Continuous reproduction (years)",value:"15+ years documented"},{label:"Decision",value:"Eligible to assess now"}],callout:"Assessing very newly established populations can misrepresent true risk before the population stabilises."},{step:6,title:"Step 1: Eligibility  Optional Regional Filter",content:'Some processes apply a pre-assessment filter (e.g., "assess only if 1% of global population occurs in the region"). If a filter is used, it must be documented transparently.',fields:[{label:"Filter enabled by authority?",value:"Yes"},{label:"Filter rule",value:"Include taxa only if  1% of global population occurs in region"},{label:"Estimated % global population in region",value:"12% (example)"},{label:"Meets filter?",value:"Yes  continue assessment"}],callout:"If the taxon fails the filter, it must be recorded as NA with the filter rationale captured."},{step:7,title:"Step 1: Eligibility  Step 1 Outcome",content:"Step 1 ends with a clear eligibility outcome. This tutorial proceeds with an eligible breeding population.",fields:[{label:"Step 1 outcome",value:"Eligible  proceed to Step 2"},{label:"Population assessed",value:"Breeding population only"},{label:"NA/RE assigned?",value:"No"}],callout:"A clean Step 1 outcome ensures Step 2 is applied to the correct population using correct scope."},{step:8,title:"Step 2: Preliminary Category  Regional Data Only",content:"Step 2 applies the IUCN criteria to the regional population. All inputs here describe the regional population (not the global total).",fields:[{label:"Data scope confirmation",value:"Regional population only "},{label:"Assessment basis",value:"Best-estimate using available evidence + uncertainty ranges"}],callout:"If Step 2 uses global data, the preliminary category is not a valid regional preliminary result."},{step:9,title:"Step 2: Preliminary Category  Example Regional Inputs",content:"Here are the kinds of regional inputs recorded for criteria evaluation. In real work, each value must be supported by evidence and methods.",fields:[{label:"Regional mature individuals (best estimate)",value:"1,200"},{label:"Uncertainty range",value:"9001,600"},{label:"Regional EOO (km)",value:"4,800"},{label:"Regional AOO (km)",value:"120"},{label:"Number of locations (regional)",value:"6"},{label:"Severe fragmentation suspected?",value:"No"},{label:"Continuing decline (regional)?",value:"Yes  habitat quality"},{label:"Primary threat (regional)",value:"Ongoing habitat degradation (example)"}],callout:"Recording ranges and the reason behind decline improves transparency and reviewer confidence."},{step:10,title:"Step 2: Preliminary Category  Preliminary Result (Example)",content:"Using the regional inputs, the system produces a preliminary category and a criteria string (example shown). This is not final until Step 3 is considered.",outputFields:[{label:"Preliminary category (Step 2)",value:"EN (Endangered)  example"},{label:"Criteria string (example)",value:"B2ab(iii)"},{label:"Data certainty",value:"Medium"},{label:"Reason summary (locked)",value:"Restricted AOO with continuing habitat quality decline; multiple locations."}],callout:"Your Step 2 result is the starting point. Step 3 only changes it when extra-regional populations plausibly reduce or increase extinction risk in the region."},{step:11,title:"Step 3: Adjustment  Rescue Effect Check (Breeding Population)",content:"Step 3 considers whether conspecific populations outside the region influence extinction risk inside the region via immigration (rescue effect) or sink dependence.",fields:[{label:"Is the regional population isolated?",value:"No"},{label:"Is immigration of propagules likely?",value:"Yes  connectivity present"},{label:"Is suitable habitat available for immigrants?",value:"Yes"},{label:"Are source populations expected to decline?",value:"No (stable)"},{label:"Adjustment decision",value:"Downlist by 1 step (example)"}],callout:"Rescue effect typically results in a one-step downlist when immigration is plausible and sources are stable. If influence is unknown, keep Step 2 unchanged."},{step:12,title:"Final Output  Best-Estimate (Explained + Transparent)",content:"This is the best-estimate final regional classification after Step 3. Real-world listings require expert review and full documentation.",outputFields:[{label:"Final regional category",value:"VU (Vulnerable, adjusted)  example"},{label:"Adjusted from Step 2",value:"Yes"},{label:"Steps changed",value:"1 (downlisted)"},{label:"Final criteria string (example)",value:"B2ab(iii)"},{label:"Plain-language rationale (locked)",value:"Within the region, the population has a restricted area of occupancy and ongoing habitat quality decline. However, immigration from stable conspecific populations outside the region is likely and reduces extinction risk within the region. The preliminary category is therefore downlisted by one step as a best-estimate."},{label:"Confidence (locked)",value:"Medium"},{label:"Top confidence drivers (locked)",value:` Regional abundance has uncertainty (9001,600)
 Threat mechanism is clear, but trend rate is imprecise
 Rescue effect plausibility is moderate-to-high`}],callout:"A strong output always shows: the final category, the criteria string, whether adjustment occurred, how many steps changed, and a rationale that can be audited."}][n-1];return s.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in",children:s.jsxs("div",{className:"rounded-[22px] card-shadow-raised max-w-2xl w-full max-h-[90vh] overflow-hidden",style:{background:"#1A1C22"},children:[s.jsxs("div",{className:"px-6 py-4 border-b",style:{borderColor:"#242632"},children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h2",{className:"text-xl font-bold",style:{color:"#FFFFFF"},children:"Step-by-Step Tutorial"}),s.jsx("button",{onClick:i,className:"text-sm font-semibold px-3 py-1 rounded-lg transition-all",style:{color:"#8E91A3"},children:"Close"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"text-sm",style:{color:"#8E91A3"},children:["Step ",n," of ",a]}),s.jsx("div",{className:"flex-1 h-1.5 rounded-full overflow-hidden",style:{background:"#14151A"},children:s.jsx("div",{className:"h-full transition-all duration-300",style:{width:`${n/a*100}%`,background:"#D2110C"}})})]})]}),s.jsx("div",{className:"px-6 py-6 overflow-y-auto",style:{maxHeight:"calc(90vh - 200px)"},children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold mb-2",style:{color:"#FFFFFF"},children:h?.title||"Tutorial Step"}),s.jsx("p",{className:"text-sm",style:{color:"#C9CBD6"},children:h?.content||"Tutorial content goes here."})]}),s.jsxs("div",{className:"rounded-xl p-4",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsx("label",{className:"block text-sm font-semibold mb-2",style:{color:"#C9CBD6"},children:h?.fieldLabel||"Field Label"}),s.jsx("div",{className:"w-full px-4 py-3 rounded-lg",style:{background:"rgba(96, 165, 250, 0.1)",border:"1px solid rgba(96, 165, 250, 0.3)"},children:s.jsx("p",{className:"text-base font-semibold",style:{color:"#FFFFFF"},children:h?.fieldValue||"Pre-filled value"})})]}),h?.fields&&s.jsx("div",{className:"rounded-xl p-4",style:{background:"#14151A",border:"1px solid #242632"},children:h.fields.map((p,v)=>s.jsxs("div",{className:"mb-2",children:[s.jsx("label",{className:"block text-sm font-semibold mb-2",style:{color:"#C9CBD6"},children:p.label}),s.jsx("div",{className:"w-full px-4 py-3 rounded-lg",style:{background:"rgba(96, 165, 250, 0.1)",border:"1px solid rgba(96, 165, 250, 0.3)"},children:s.jsx("p",{className:"text-base font-semibold",style:{color:"#FFFFFF"},children:p.value})})]},v))}),h?.outputFields&&s.jsx("div",{className:"rounded-xl p-4",style:{background:"#14151A",border:"1px solid #242632"},children:h.outputFields.map((p,v)=>s.jsxs("div",{className:"mb-2",children:[s.jsx("label",{className:"block text-sm font-semibold mb-2",style:{color:"#C9CBD6"},children:p.label}),s.jsx("div",{className:"w-full px-4 py-3 rounded-lg",style:{background:"rgba(96, 165, 250, 0.1)",border:"1px solid rgba(96, 165, 250, 0.3)"},children:s.jsx("p",{className:"text-base font-semibold",style:{color:"#FFFFFF"},children:p.value})})]},v))}),s.jsxs("div",{className:"rounded-xl p-4",style:{background:"rgba(210, 17, 12, 0.1)",border:"1px solid rgba(210, 17, 12, 0.3)"},children:[s.jsx("p",{className:"text-xs font-semibold mb-1",style:{color:"#D2110C"},children:" Why This Matters"}),s.jsx("p",{className:"text-sm",style:{color:"#C9CBD6"},children:h?.callout||"Educational callout goes here."})]}),h?.importantCallout&&s.jsxs("div",{className:"rounded-xl p-4",style:{background:"rgba(210, 17, 12, 0.1)",border:"1px solid rgba(210, 17, 12, 0.3)"},children:[s.jsx("p",{className:"text-xs font-semibold mb-1",style:{color:"#D2110C"},children:" Important Rule"}),s.jsx("p",{className:"text-sm",style:{color:"#C9CBD6"},children:h.importantCallout})]}),s.jsx("div",{className:"pt-4 border-t",style:{borderColor:"#242632"},children:s.jsx("p",{className:"text-xs",style:{color:"#8E91A3"},children:"This tutorial is read-only and uses example data to demonstrate the regional 3-step process. It does not guarantee accuracy for real-world assessments."})})]})}),s.jsx("div",{className:"px-6 py-4 border-t",style:{borderColor:"#242632"},children:s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>r(Math.max(1,n-1)),disabled:n===1,className:"flex-1 py-3 px-4 rounded-xl text-base font-semibold transition-all",style:{background:"transparent",border:"2px solid #242632",color:"#FFFFFF",opacity:n===1?.5:1},children:"Back"}),s.jsx("button",{onClick:()=>{n<a?r(n+1):i()},className:"flex-1 py-3 px-4 rounded-xl text-base font-semibold transition-all",style:{background:"#D2110C",color:"#FFFFFF"},children:n<a?"Next":"Finish"})]})})]})})}function py({onClose:i,onStartMock:n}){return s.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in",children:s.jsxs("div",{className:"rounded-[22px] card-shadow-raised max-w-md w-full p-6 animate-slide-up",style:{background:"#1A1C22"},children:[s.jsx("h2",{className:"text-xl font-bold mb-4",style:{color:"#FFFFFF"},children:"Mock Assessment Entry"}),s.jsx("p",{className:"text-sm mb-6",style:{color:"#C9CBD6"},children:"This mock assessment will guide you through the 3-step process using example data. It will help you understand the workflow and the criteria applied."}),s.jsxs("div",{className:"flex gap-3 mt-6",children:[s.jsx("button",{type:"button",onClick:i,className:"flex-1 btn-secondary py-3",children:"Cancel"}),s.jsx("button",{type:"button",onClick:n,className:"flex-1 btn-primary py-3",children:"Start Mock"})]})]})})}function my({onComplete:i,onClose:n,onSkip:r}){const[a,d]=V.useState(0),[h,p]=V.useState(!0),v=[{step:1,stepTitle:"Step 1: Eligibility",screenNumber:1,totalScreens:7,question:"Is the population native or a benign introduction?",lockedSelection:"Native population",lockedDetail:"Within natural range",whyMatters:"Only eligible wild/natural-range (or benign introduction) populations can be assessed; otherwise record NA."},{step:1,stepTitle:"Step 1: Eligibility",screenNumber:2,totalScreens:7,question:"Is this taxon a vagrant in the region?",lockedSelection:"No",lockedDetail:"Established regional population",whyMatters:"Vagrants are not assessed because they are only occasional occurrences."},{step:1,stepTitle:"Step 1: Eligibility",screenNumber:3,totalScreens:7,question:"Which population are you assessing?",lockedSelection:"Breeding population",lockedDetail:"Reproduces in region",whyMatters:"Breeding vs visiting populations can require separate assessments when distinguishable."},{step:2,stepTitle:"Step 2: Preliminary Category",screenNumber:4,totalScreens:7,question:"Estimated regional population size (mature individuals)?",lockedSelection:"~8,000 (example)",lockedDetail:"Range recorded to capture uncertainty",whyMatters:"Step 2 uses regional data only; record uncertainty when needed."},{step:2,stepTitle:"Step 2: Preliminary Category",screenNumber:5,totalScreens:7,question:"Regional range and trend summary",lockedSelection:"Multiple values",lockedValues:[{label:"Regional AOO",value:"~120 km"},{label:"Locations",value:"~6"},{label:"Continuing decline",value:"Yes (habitat quality)"}],preliminaryResult:{category:"VU",criteriaString:"B2ab(iii)"},whyMatters:"This shows how restricted AOO + continuing decline can drive a preliminary threatened category."},{step:3,stepTitle:"Step 3: Adjustment",screenNumber:6,totalScreens:7,question:"Is rescue effect likely from extra-regional populations?",lockedSelection:"Yes",lockedDetail:"Rescue likely (example)",adjustmentResult:{adjustment:"Downlist by 1 step",finalCategory:"NT",stepsChanged:1},whyMatters:"If rescue is plausible, category may be downlisted; if influence is unknown, keep Step 2 unchanged."}],x=v[a],_=()=>{a<v.length-1?d(a+1):d(v.length)},j=()=>{a>0&&d(a-1)};if(h)return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"w-full max-w-lg rounded-[22px] card-shadow-raised overflow-hidden",style:{background:"#1A1C22"},children:[s.jsxs("div",{className:"p-6 border-b",style:{borderColor:"#242632"},children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsx("h2",{className:"text-2xl font-bold",style:{color:"#FFFFFF"},children:"Guided Mock Assessment"}),s.jsx("button",{onClick:n,className:"p-2 rounded-lg transition-all hover:bg-white/5",style:{color:"#8E91A3"},children:s.jsx(Sr,{className:"w-5 h-5"})})]}),s.jsx("p",{className:"text-base",style:{color:"#C9CBD6"},children:"A read-only walkthrough of the full 3-step regional process"})]}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-3",style:{color:"#FFFFFF"},children:"What you'll do:"}),s.jsxs("ul",{className:"space-y-3",children:[s.jsxs("li",{className:"flex gap-3",children:[s.jsx("div",{className:"flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center",style:{background:"rgba(96, 165, 250, 0.15)"},children:s.jsx("span",{className:"text-xs font-bold",style:{color:"#60A5FA"},children:"1"})}),s.jsx("div",{className:"flex-1",children:s.jsxs("p",{className:"text-sm",style:{color:"#C9CBD6"},children:[s.jsx("strong",{style:{color:"#FFFFFF"},children:"Step 1:"})," Confirm eligibility (native/benign intro, vagrant rule, population type)"]})})]}),s.jsxs("li",{className:"flex gap-3",children:[s.jsx("div",{className:"flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center",style:{background:"rgba(52, 211, 153, 0.15)"},children:s.jsx("span",{className:"text-xs font-bold",style:{color:"#34D399"},children:"2"})}),s.jsx("div",{className:"flex-1",children:s.jsxs("p",{className:"text-sm",style:{color:"#C9CBD6"},children:[s.jsx("strong",{style:{color:"#FFFFFF"},children:"Step 2:"})," Review regional data inputs and see a preliminary category (example)"]})})]}),s.jsxs("li",{className:"flex gap-3",children:[s.jsx("div",{className:"flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center",style:{background:"rgba(167, 139, 250, 0.15)"},children:s.jsx("span",{className:"text-xs font-bold",style:{color:"#A78BFA"},children:"3"})}),s.jsx("div",{className:"flex-1",children:s.jsxs("p",{className:"text-sm",style:{color:"#C9CBD6"},children:[s.jsx("strong",{style:{color:"#FFFFFF"},children:"Step 3:"})," Apply rescue/sink logic and see how/when adjustment is made (example)"]})})]})]})]}),s.jsx("div",{className:"rounded-xl p-4",style:{background:"rgba(210, 17, 12, 0.1)",border:"1px solid rgba(210, 17, 12, 0.3)"},children:s.jsxs("p",{className:"text-sm",style:{color:"#C9CBD6"},children:[s.jsx("strong",{style:{color:"#D2110C"},children:"Training only:"})," All selections are pre-filled and read-only. This is for learning the process flow."]})})]}),s.jsx("div",{className:"p-6 border-t",style:{borderColor:"#242632"},children:s.jsxs("div",{className:"flex flex-col gap-3",children:[s.jsxs("button",{onClick:()=>p(!1),className:"btn-primary py-3 flex items-center justify-center gap-2",children:["Start Guided Mock",s.jsx(Ls,{className:"w-5 h-5"})]}),s.jsx("button",{onClick:r||n,className:"w-full py-3 px-4 rounded-xl text-base font-semibold transition-all",style:{background:"transparent",border:"2px solid #242632",color:"#FFFFFF"},children:"Skip for now"})]})})]})});if(a>=v.length)return s.jsx("div",{className:"fixed inset-0 z-50 flex flex-col bg-black/90 backdrop-blur-sm animate-fade-in",style:{height:"100vh",overflow:"hidden"},children:s.jsxs("div",{className:"w-full max-w-lg mx-auto h-full flex flex-col",children:[s.jsx("div",{className:"flex-1 overflow-y-auto",style:{WebkitOverflowScrolling:"touch",paddingBottom:"140px"},children:s.jsx("div",{className:"p-4 pt-8",children:s.jsxs("div",{className:"rounded-[22px] card-shadow-raised overflow-hidden",style:{background:"#1A1C22"},children:[s.jsxs("div",{className:"p-6 border-b",style:{borderColor:"#242632"},children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsx("h2",{className:"text-2xl font-bold",style:{color:"#FFFFFF"},children:"Guided Mock Complete"}),s.jsx("button",{onClick:n,className:"p-2 rounded-lg transition-all hover:bg-white/5",style:{color:"#8E91A3"},children:s.jsx(Sr,{className:"w-5 h-5"})})]}),s.jsx("p",{className:"text-base",style:{color:"#C9CBD6"},children:"You've walked through all three steps"})]}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"rounded-xl p-4",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsx("p",{className:"text-xs font-semibold mb-2",style:{color:"#8E91A3"},children:"Step 2 Preliminary"}),s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsx("p",{className:"text-3xl font-bold",style:{color:"#FFFFFF"},children:"VU"}),s.jsx("p",{className:"text-sm",style:{color:"#8E91A3"},children:"B2ab(iii)"})]}),s.jsx("p",{className:"text-xs mt-2",style:{color:"#C9CBD6"},children:"Vulnerable (example)"})]}),s.jsxs("div",{className:"rounded-xl p-4",style:{background:"rgba(167, 139, 250, 0.1)",border:"1px solid rgba(167, 139, 250, 0.3)"},children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("p",{className:"text-xs font-semibold",style:{color:"#A78BFA"},children:"Step 3 Final (Adjusted)"}),s.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-semibold",style:{background:"rgba(167, 139, 250, 0.15)",color:"#A78BFA"},children:"Adjusted"})]}),s.jsxs("div",{className:"flex items-baseline gap-2 mb-3",children:[s.jsx("p",{className:"text-3xl font-bold",style:{color:"#FFFFFF"},children:"NT"}),s.jsx("p",{className:"text-sm",style:{color:"#8E91A3"},children:"B2ab(iii)"})]}),s.jsx("p",{className:"text-xs mb-2",style:{color:"#C9CBD6"},children:"Near Threatened (example, adjusted)"}),s.jsxs("div",{className:"pt-3 border-t",style:{borderColor:"rgba(167, 139, 250, 0.2)"},children:[s.jsx("p",{className:"text-xs font-semibold mb-1",style:{color:"#A78BFA"},children:"Adjustment: Downlist by 1 step"}),s.jsx("p",{className:"text-xs",style:{color:"#C9CBD6"},children:"Rescue effect from extra-regional populations likely reduces extinction risk in the region"})]})]})]}),s.jsxs("div",{className:"rounded-xl p-4",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsx("p",{className:"text-xs font-semibold mb-2",style:{color:"#8E91A3"},children:"Plain-language rationale"}),s.jsx("p",{className:"text-sm",style:{color:"#C9CBD6"},children:"Within the region, the population has a restricted area of occupancy and ongoing habitat quality decline. However, immigration from stable conspecific populations outside the region is likely and reduces extinction risk within the region. The preliminary category is therefore downlisted by one step as a best-estimate."})]}),s.jsx("div",{className:"rounded-xl p-4",style:{background:"rgba(52, 211, 153, 0.1)",border:"1px solid rgba(52, 211, 153, 0.3)"},children:s.jsxs("div",{className:"flex gap-3",children:[s.jsx(Xr,{className:"w-5 h-5 flex-shrink-0",style:{color:"#34D399"}}),s.jsx("p",{className:"text-sm",style:{color:"#C9CBD6"},children:"You're now familiar with the full 3-step process. Ready to create your first real assessment?"})]})})]})]})})}),s.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-20 px-4 py-4",style:{background:"#14151A",borderTop:"1px solid #242632",paddingBottom:"calc(16px + env(safe-area-inset-bottom))"},children:s.jsxs("div",{className:"w-full max-w-lg mx-auto flex flex-col gap-3",children:[s.jsx("button",{onClick:i,className:"btn-primary py-3",children:"Go to Home"}),s.jsx("button",{onClick:()=>{d(0),p(!0)},className:"w-full py-3 px-4 rounded-xl text-base font-semibold transition-all",style:{background:"transparent",border:"2px solid #242632",color:"#FFFFFF"},children:"Repeat Guided Mock"})]})})]})});const F={1:"#60A5FA",2:"#34D399",3:"#A78BFA"}[x.step];return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm p-4 animate-fade-in",children:s.jsxs("div",{className:"w-full max-w-lg rounded-[22px] card-shadow-raised overflow-hidden",style:{background:"#1A1C22"},children:[s.jsxs("div",{className:"p-6 border-b",style:{borderColor:"#242632"},children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"flex items-center gap-2 mb-1",children:s.jsx("div",{className:"px-3 py-1 rounded-full",style:{background:`${F}20`,border:`1px solid ${F}50`},children:s.jsx("p",{className:"text-xs font-semibold",style:{color:F},children:x.stepTitle})})}),s.jsxs("p",{className:"text-xs",style:{color:"#8E91A3"},children:["Guided Mock Assessment (Training)  Screen ",x.screenNumber," of ",x.totalScreens]})]}),s.jsx("button",{onClick:n,className:"p-2 rounded-lg transition-all hover:bg-white/5",style:{color:"#8E91A3"},children:s.jsx(Sr,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"w-full h-1.5 rounded-full overflow-hidden",style:{background:"#14151A"},children:s.jsx("div",{className:"h-full transition-all duration-300",style:{width:`${x.screenNumber/x.totalScreens*100}%`,background:F}})})]}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsx("div",{children:s.jsx("h3",{className:"text-xl font-bold mb-2",style:{color:"#FFFFFF"},children:x.question})}),x.lockedValues?s.jsxs("div",{className:"space-y-3",children:[x.lockedValues.map((T,A)=>s.jsx("div",{className:"rounded-xl p-4",style:{background:"#14151A",border:`2px solid ${F}`},children:s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-xs font-semibold mb-1",style:{color:"#8E91A3"},children:T.label}),s.jsx("p",{className:"font-semibold",style:{color:"#FFFFFF"},children:T.value})]}),s.jsx("div",{className:"flex-shrink-0 w-5 h-5 rounded-full flex items-center justify-center",style:{background:F},children:s.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})})]})},A)),x.preliminaryResult&&s.jsxs("div",{className:"rounded-xl p-4 mt-4",style:{background:"rgba(52, 211, 153, 0.1)",border:"1px solid rgba(52, 211, 153, 0.3)"},children:[s.jsx("p",{className:"text-xs font-semibold mb-2",style:{color:"#34D399"},children:"Preliminary Category (Example)"}),s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsx("p",{className:"text-2xl font-bold",style:{color:"#FFFFFF"},children:x.preliminaryResult.category}),s.jsx("p",{className:"text-sm",style:{color:"#8E91A3"},children:x.preliminaryResult.criteriaString})]})]})]}):s.jsx("div",{className:"rounded-xl p-4",style:{background:"#14151A",border:`2px solid ${F}`},children:s.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-semibold mb-1",style:{color:"#FFFFFF"},children:x.lockedSelection}),x.lockedDetail&&s.jsx("p",{className:"text-sm",style:{color:"#8E91A3"},children:x.lockedDetail})]}),s.jsx("div",{className:"flex-shrink-0 w-5 h-5 rounded-full flex items-center justify-center",style:{background:F},children:s.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})})]})}),x.adjustmentResult&&s.jsxs("div",{className:"rounded-xl p-4",style:{background:"rgba(167, 139, 250, 0.1)",border:"1px solid rgba(167, 139, 250, 0.3)"},children:[s.jsx("p",{className:"text-xs font-semibold mb-2",style:{color:"#A78BFA"},children:"Adjustment Applied"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-sm",style:{color:"#C9CBD6"},children:"Action:"}),s.jsx("p",{className:"text-sm font-semibold",style:{color:"#FFFFFF"},children:x.adjustmentResult.adjustment})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-sm",style:{color:"#C9CBD6"},children:"Final Category:"}),s.jsx("p",{className:"text-lg font-bold",style:{color:"#FFFFFF"},children:x.adjustmentResult.finalCategory})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-sm",style:{color:"#C9CBD6"},children:"Steps Changed:"}),s.jsx("p",{className:"text-sm font-semibold",style:{color:"#FFFFFF"},children:x.adjustmentResult.stepsChanged})]})]})]}),s.jsxs("div",{className:"rounded-xl p-4",style:{background:"rgba(210, 17, 12, 0.1)",border:"1px solid rgba(210, 17, 12, 0.3)"},children:[s.jsx("p",{className:"text-xs font-semibold mb-2",style:{color:"#D2110C"},children:"Why this matters"}),s.jsx("p",{className:"text-sm",style:{color:"#C9CBD6"},children:x.whyMatters})]})]}),s.jsx("div",{className:"p-6 border-t",style:{borderColor:"#242632"},children:s.jsxs("div",{className:"flex gap-3",children:[a>0&&s.jsxs("button",{onClick:j,className:"flex-1 py-3 px-4 rounded-xl text-base font-semibold transition-all flex items-center justify-center gap-2",style:{background:"transparent",border:"2px solid #242632",color:"#FFFFFF"},children:[s.jsx(go,{className:"w-5 h-5"}),"Back"]}),s.jsxs("button",{onClick:_,className:"flex-1 btn-primary py-3 flex items-center justify-center gap-2",children:[a<v.length-1?"Next":"View Results",s.jsx(Ls,{className:"w-5 h-5"})]})]})})]})})}const Af=[{id:"north-america",name:"North America",authority:"NatureServe",rules:{visitorDef:"Non-breeding populations present seasonally (e.g., wintering waterfowl)",reTimeLimit:"Not before 1500 AD",optionalFilter:"Taxa with <1% global population may be excluded at assessor discretion",additionalNotes:"Must coordinate with state/provincial authorities for subnational assessments"}},{id:"central-america",name:"Central America",authority:"Regional Authority",rules:{visitorDef:"Non-breeding populations present seasonally",reTimeLimit:"Not before 1500 AD",optionalFilter:"Taxa with <1% global population",additionalNotes:"Cross-border species require consultation with neighboring countries"}},{id:"south-america",name:"South America",authority:"IUCN Americas",rules:{visitorDef:"Non-breeding populations present seasonally (includes Austral migrants)",reTimeLimit:"Not before 1500 AD",optionalFilter:"Taxa with <0.5% global population may be considered marginal",additionalNotes:"Andean and Amazonian transboundary species require regional coordination"}},{id:"europe",name:"Europe",authority:"European Red List",rules:{visitorDef:"Non-breeding populations (wintering, passage migrants)",reTimeLimit:"Not before 1500 AD",optionalFilter:"Taxa with <1% global population",additionalNotes:"Must follow EU Birds & Habitats Directive requirements where applicable"}},{id:"africa",name:"Africa",authority:"IUCN Africa",rules:{visitorDef:"Non-breeding populations present seasonally (includes Palearctic migrants)",reTimeLimit:"Not before 1500 AD",optionalFilter:"Taxa with <1% global population",additionalNotes:"Transfrontier conservation areas may use shared assessment protocols"}},{id:"middle-east",name:"Middle East",authority:"Regional Authority",rules:{visitorDef:"Non-breeding populations (wintering birds, passage migrants)",reTimeLimit:"Not before 1500 AD",optionalFilter:"Taxa with <1% global population",additionalNotes:"Desert species may have ephemeral populations requiring special consideration"}},{id:"central-asia",name:"Central Asia",authority:"Regional Authority",rules:{visitorDef:"Non-breeding populations present seasonally",reTimeLimit:"Not before 1500 AD",optionalFilter:"Taxa with <1% global population",additionalNotes:"Mountain species distributed across elevation zones require careful range delimitation"}},{id:"south-asia",name:"South Asia",authority:"IUCN Asia",rules:{visitorDef:"Non-breeding populations (winter visitors, altitudinal migrants)",reTimeLimit:"Not before 1500 AD",optionalFilter:"Taxa with <1% global population",additionalNotes:"Endemic species in biodiversity hotspots require rigorous documentation"}},{id:"southeast-asia",name:"Southeast Asia",authority:"ASEAN Centre",rules:{visitorDef:"Non-breeding populations present seasonally",reTimeLimit:"Not before 1500 AD",optionalFilter:"Taxa with <0.5% global population",additionalNotes:"Island endemics and transboundary species require ASEAN coordination protocols"}},{id:"east-asia",name:"East Asia",authority:"Regional Authority",rules:{visitorDef:"Non-breeding populations (wintering, passage migrants)",reTimeLimit:"Not before 1500 AD",optionalFilter:"Taxa with <1% global population",additionalNotes:"Migratory species using East Asian-Australasian Flyway require flyway-wide context"}},{id:"australia-nz",name:"Australia & New Zealand",authority:"EPBC Act / DOC NZ",rules:{visitorDef:"Non-breeding visitors (e.g., trans-Tasman vagrants vs. regular visitors)",reTimeLimit:"Not before 1788 AD (Australia) / 1769 AD (New Zealand)",optionalFilter:"Taxa with <1% global population",additionalNotes:"Must distinguish introduced species vs. natural colonizers. Self-introduced species after 10 years may be assessed."}},{id:"oceania",name:"Oceania & Pacific Islands",authority:"SPREP",rules:{visitorDef:"Non-breeding populations present seasonally (rare for island taxa)",reTimeLimit:"Not before 1500 AD",optionalFilter:"Taxa with <1% global population",additionalNotes:"Island endemics require careful extinction risk assessment due to small ranges and vulnerability"}},{id:"arctic",name:"Arctic",authority:"CAFF",rules:{visitorDef:"Non-breeding summer visitors vs. breeding Arctic specialists",reTimeLimit:"Not before 1500 AD",optionalFilter:"Taxa with <1% global population",additionalNotes:"Climate-sensitive species require trend documentation. Migratory species breeding in Arctic assessed as breeding populations."}},{id:"antarctica",name:"Antarctica",authority:"SCAR",rules:{visitorDef:"Rare (most taxa are breeding residents or do not occur)",reTimeLimit:"Not before 1500 AD",optionalFilter:"Taxa with <1% global population",additionalNotes:"Marine taxa following CCAMLR protocols. Seabirds breeding on sub-Antarctic islands treated as breeding populations."}}];function yy({onComplete:i}){const[n,r]=V.useState(1),[a,d]=V.useState(""),[h,p]=V.useState(""),[v,x]=V.useState(""),[_,j]=V.useState(!1),C=()=>{h&&a&&(localStorage.setItem("userName",a),localStorage.setItem("userEmail",h),localStorage.setItem("offlineEnabled","true"),r(2))},F=()=>{v&&(localStorage.setItem("selectedRegion",v),r(3))},T=()=>{j(!0)},A=Af.find(q=>q.id===v);return s.jsxs("div",{className:"min-h-screen flex flex-col overflow-hidden",style:{background:"linear-gradient(180deg, #0B0B0D 0%, #0F1013 100%)"},children:[s.jsxs("div",{className:"px-4 py-3 safe-area-top flex items-center justify-between",style:{background:"rgba(20, 21, 26, 0.8)"},children:[s.jsx("h1",{className:"text-sm font-semibold",style:{color:"#FFFFFF"},children:"RedList Buddy"}),s.jsxs("div",{className:"flex gap-1.5",children:[s.jsx("div",{className:"w-1.5 h-1.5 rounded-full transition-all",style:{background:n>=1?"#D2110C":"rgba(255, 255, 255, 0.2)"}}),s.jsx("div",{className:"w-1.5 h-1.5 rounded-full transition-all",style:{background:n>=2?"#D2110C":"rgba(255, 255, 255, 0.2)"}}),s.jsx("div",{className:"w-1.5 h-1.5 rounded-full transition-all",style:{background:n>=3?"#D2110C":"rgba(255, 255, 255, 0.2)"}})]})]}),s.jsxs("div",{className:"flex-1 overflow-hidden",children:[n===1&&s.jsx(gy,{name:a,setName:d,email:h,setEmail:p,onNext:C}),n===2&&s.jsx(vy,{selectedRegion:v,setSelectedRegion:x,selectedRegionData:A,onNext:F,onBack:()=>r(1)}),n===3&&s.jsx(xy,{mockAssessmentComplete:_,onComplete:T,onFinish:i,onBack:()=>r(2)})]})]})}function gy({name:i,setName:n,email:r,setEmail:a,onNext:d}){const[h,p]=V.useState(0),[v,x]=V.useState(!1);return V.useEffect(()=>{const _=setTimeout(()=>{if(v)return;const j=908434,C=1500,F=Date.now(),T=()=>{const A=Date.now()-F,q=Math.min(A/C,1),M=1-Math.pow(1-q,3),U=Math.floor(M*j);p(U),q<1?requestAnimationFrame(T):(p(j),x(!0))};requestAnimationFrame(T)},2e3);return()=>clearTimeout(_)},[v]),s.jsxs("div",{className:"h-full flex flex-col overflow-hidden relative",children:[s.jsxs("div",{className:"absolute inset-0 z-0",children:[s.jsx(ki,{src:"https://images.unsplash.com/photo-1651707265633-6043d4606339?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHx3aWxkbGlmZSUyMGhhYml0YXQlMjBuYXR1cmFsJTIwZW52aXJvbm1lbnR8ZW58MXx8fHwxNzcwNTk1MTQwfDA&ixlib=rb-4.1.0&q=80&w=1080",alt:"Wildlife habitat",className:"w-full h-full object-cover"}),s.jsx("div",{className:"absolute inset-0 image-overlay-dark"})]}),s.jsx("div",{className:"flex-1 overflow-y-auto relative z-10",style:{paddingBottom:"140px"},children:s.jsx("div",{className:"px-6 pt-12 pb-8",children:s.jsxs("div",{className:"w-full max-w-md mx-auto space-y-6 mt-12",children:[s.jsxs("div",{className:"text-center mb-10 space-y-3",children:[s.jsx("p",{className:"text-sm font-semibold",style:{color:"#C9CBD6"},children:"Enabling Assessment of"}),s.jsx("p",{className:"text-6xl font-bold tracking-tight",style:{color:"#FFFFFF",textShadow:"0 0 30px rgba(255, 255, 255, 0.15), 0 2px 8px rgba(0, 0, 0, 0.5)"},children:h.toLocaleString()}),s.jsx("p",{className:"text-base",style:{color:"#C9CBD6"},children:"Species on this Planet"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"name",className:"block text-sm font-semibold mb-2",style:{color:"#C9CBD6"},children:"Full Name"}),s.jsx("input",{type:"text",id:"name",value:i,onChange:_=>n(_.target.value),placeholder:"John Doe",className:"w-full px-4 py-3 rounded-xl text-base",style:{background:"rgba(20, 21, 26, 0.95)",border:"1px solid #242632",color:"#FFFFFF"}})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-semibold mb-2",style:{color:"#C9CBD6"},children:"Email Address"}),s.jsx("input",{type:"email",id:"email",value:r,onChange:_=>a(_.target.value),placeholder:"assessor@example.org",className:"w-full px-4 py-3 rounded-xl text-base",style:{background:"rgba(20, 21, 26, 0.95)",border:"1px solid #242632",color:"#FFFFFF"}})]}),s.jsx("p",{className:"text-xs text-center pt-2",style:{color:"#6B6E7D",opacity:.7},children:"Important: This app provides best-estimate classifications. All assessments require expert review."})]})})}),s.jsx("div",{className:"fixed left-0 right-0 bottom-0 px-4 py-4 z-20",style:{background:"#14151A",borderTop:"1px solid #242632",paddingBottom:"max(16px, env(safe-area-inset-bottom))"},children:s.jsx("div",{className:"w-full max-w-md mx-auto",children:s.jsx("button",{onClick:d,disabled:!r||!i,className:"w-full py-3.5 rounded-2xl text-base font-semibold transition-all",style:{background:!r||!i?"#4A4A4A":"#D2110C",color:"#FFFFFF",opacity:!r||!i?.5:1},children:"Continue"})})})]})}function vy({selectedRegion:i,setSelectedRegion:n,selectedRegionData:r,onNext:a,onBack:d}){const h=p=>{n(i===p?"":p)};return s.jsxs("div",{className:"h-full flex flex-col overflow-hidden relative",children:[s.jsxs("div",{className:"absolute inset-0 z-0",children:[s.jsx(ki,{src:"https://images.unsplash.com/photo-1759503408355-4de1b4ee51c8?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxiZWF1dGlmdWwlMjB3aGFsZXMlMjBvY2VhbiUyMHVuZGVyd2F0ZXJ8ZW58MXx8fHwxNzcwNTk4MTgwfDA&ixlib=rb-4.1.0&q=80&w=1080",alt:"Beautiful whales",className:"w-full h-full object-cover"}),s.jsx("div",{className:"absolute inset-0 image-overlay-dark"})]}),s.jsx("div",{className:"flex-1 overflow-y-auto relative z-10",style:{paddingBottom:"140px"},children:s.jsx("div",{className:"px-6 pt-12 pb-8",children:s.jsxs("div",{className:"w-full max-w-md mx-auto space-y-6 mt-8",children:[s.jsx("div",{className:"text-center mb-4",children:s.jsx("h2",{className:"text-3xl font-bold mb-2",style:{color:"#FFFFFF"},children:"Choose Your Region"})}),s.jsxs("div",{className:"rounded-2xl p-4",style:{background:"rgba(26, 28, 34, 0.95)",border:"1px solid rgba(96, 165, 250, 0.3)"},children:[s.jsx("p",{className:"text-sm font-semibold",style:{color:"#FFFFFF"},children:"Red List  Conservation Priority"}),s.jsxs("p",{className:"text-xs mt-1",style:{color:"#C9CBD6"},children:["The IUCN Red List measures ",s.jsx("em",{children:"extinction risk"}),", not conservation priority. These are separate processes."]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold mb-2",style:{color:"#C9CBD6"},children:"Select Assessment Region"}),s.jsx("div",{className:"space-y-2",children:Af.map(p=>s.jsxs("button",{onClick:()=>h(p.id),className:"w-full text-left px-4 py-3 rounded-xl transition-all",style:{background:i===p.id?"rgba(210, 17, 12, 0.25)":"rgba(20, 21, 26, 0.95)",border:i===p.id?"2px solid #D2110C":"1px solid #242632"},children:[s.jsx("div",{className:"font-semibold",style:{color:"#FFFFFF"},children:p.name}),s.jsx("div",{className:"text-sm",style:{color:"#8E91A3"},children:p.authority})]},p.id))})]}),r&&s.jsxs("div",{className:"rounded-2xl p-4",style:{background:"rgba(20, 21, 26, 0.95)",border:"1px solid #242632"},children:[s.jsxs("h3",{className:"font-semibold mb-2 text-sm",style:{color:"#FFFFFF"},children:["Regional Rules: ",r.name]}),s.jsxs("ul",{className:"text-xs space-y-1",style:{color:"#C9CBD6"},children:[s.jsxs("li",{children:[" ",s.jsx("strong",{children:"Visitor:"})," ",r.rules.visitorDef]}),s.jsxs("li",{children:[" ",s.jsx("strong",{children:"RE limit:"})," ",r.rules.reTimeLimit]}),s.jsxs("li",{children:[" ",s.jsx("strong",{children:"Filter:"})," ",r.rules.optionalFilter]})]})]})]})})}),s.jsx("div",{className:"fixed left-0 right-0 bottom-0 px-4 py-4 z-20",style:{background:"#14151A",borderTop:"1px solid #242632",paddingBottom:"max(16px, env(safe-area-inset-bottom))"},children:s.jsxs("div",{className:"w-full max-w-md mx-auto grid grid-cols-2 gap-3",children:[s.jsx("button",{onClick:d,className:"w-full py-3.5 rounded-2xl text-base font-semibold transition-all",style:{background:"transparent",border:"2px solid #242632",color:"#FFFFFF"},children:"Back"}),s.jsx("button",{onClick:a,disabled:!i,className:"w-full py-3.5 rounded-2xl text-base font-semibold transition-all",style:{background:i?"#D2110C":"#4A4A4A",color:"#FFFFFF",opacity:i?1:.5},children:"Continue"})]})})]})}function xy({mockAssessmentComplete:i,onComplete:n,onFinish:r,onBack:a}){const[d,h]=V.useState(!1);return d?s.jsx(my,{onComplete:()=>{h(!1),n(),r()},onClose:()=>h(!1),onSkip:()=>{h(!1),n(),r()}}):s.jsxs("div",{className:"h-full flex flex-col overflow-hidden relative",children:[s.jsxs("div",{className:"absolute inset-0 z-0",children:[s.jsx(ki,{src:"https://images.unsplash.com/photo-1738328604803-5c8df1657620?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxlbmRhbmdlcmVkJTIwYW1waGliaWFuJTIwZnJvZyUyMGNvbnNlcnZhdGlvbnxlbnwxfHx8fDE3NzA1OTUxNDB8MA&ixlib=rb-4.1.0&q=80&w=1080",alt:"Conservation",className:"w-full h-full object-cover"}),s.jsx("div",{className:"absolute inset-0 image-overlay-dark"})]}),s.jsx("div",{className:"flex-1 overflow-y-auto relative z-10",style:{paddingBottom:"140px"},children:s.jsx("div",{className:"px-6 pt-12 pb-8",children:s.jsxs("div",{className:"w-full max-w-md mx-auto space-y-8 mt-12",children:[s.jsx("div",{className:"text-center",children:s.jsx("h2",{className:"text-3xl font-bold mb-4",style:{color:"#FFFFFF"},children:"First Guided Assessment"})}),s.jsxs("div",{className:"space-y-6",children:[s.jsx("h3",{className:"font-semibold text-lg text-center",style:{color:"#FFFFFF"},children:"Learn the 3-step process"}),s.jsx("div",{className:"space-y-4",children:[{num:1,title:"Eligibility",color:"#60A5FA"},{num:2,title:"Preliminary",color:"#34D399"},{num:3,title:"Adjustment",color:"#A78BFA"}].map(({num:p,title:v,color:x})=>s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 font-bold",style:{background:`${x}30`,color:x},children:p}),s.jsx("p",{className:"font-semibold",style:{color:"#FFFFFF"},children:v})]},p))})]})]})})}),s.jsx("div",{className:"fixed left-0 right-0 bottom-0 px-4 py-4 z-20",style:{background:"#14151A",borderTop:"1px solid #242632",paddingBottom:"max(16px, env(safe-area-inset-bottom))"},children:s.jsxs("div",{className:"w-full max-w-md mx-auto grid grid-cols-2 gap-3",children:[s.jsx("button",{onClick:a,className:"w-full py-3.5 rounded-2xl text-base font-semibold transition-all",style:{background:"transparent",border:"2px solid #242632",color:"#FFFFFF"},children:"Back"}),s.jsx("button",{onClick:()=>h(!0),className:"w-full py-3.5 rounded-2xl text-base font-semibold transition-all",style:{background:"#D2110C",color:"#FFFFFF"},children:"Start Guided Mock Assessment"})]})})]})}var $l={exports:{}},by=$l.exports,Vh;function wy(){return Vh||(Vh=1,(function(i,n){((r,a)=>{i.exports=a()})(by,function(){var r=function(l,u){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(m,g){m.__proto__=g}:function(m,g){for(var b in g)Object.prototype.hasOwnProperty.call(g,b)&&(m[b]=g[b])}))(l,u)},a=function(){return(a=Object.assign||function(l){for(var u,m=1,g=arguments.length;m<g;m++)for(var b in u=arguments[m])Object.prototype.hasOwnProperty.call(u,b)&&(l[b]=u[b]);return l}).apply(this,arguments)};function d(l,u,m){for(var g,b=0,w=u.length;b<w;b++)!g&&b in u||((g=g||Array.prototype.slice.call(u,0,b))[b]=u[b]);return l.concat(g||Array.prototype.slice.call(u))}var h=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:$p,p=Object.keys,v=Array.isArray;function x(l,u){return typeof u=="object"&&p(u).forEach(function(m){l[m]=u[m]}),l}typeof Promise>"u"||h.Promise||(h.Promise=Promise);var _=Object.getPrototypeOf,j={}.hasOwnProperty;function C(l,u){return j.call(l,u)}function F(l,u){typeof u=="function"&&(u=u(_(l))),(typeof Reflect>"u"?p:Reflect.ownKeys)(u).forEach(function(m){A(l,m,u[m])})}var T=Object.defineProperty;function A(l,u,m,g){T(l,u,x(m&&C(m,"get")&&typeof m.get=="function"?{get:m.get,set:m.set,configurable:!0}:{value:m,configurable:!0,writable:!0},g))}function q(l){return{from:function(u){return l.prototype=Object.create(u.prototype),A(l.prototype,"constructor",l),{extend:F.bind(null,l.prototype)}}}}var M=Object.getOwnPropertyDescriptor,U=[].slice;function Z(l,u,m){return U.call(l,u,m)}function ne(l,u){return u(l)}function ie(l){if(!l)throw new Error("Assertion Failed")}function ee(l){h.setImmediate?setImmediate(l):setTimeout(l,0)}function me(l,u){if(typeof u=="string"&&C(l,u))return l[u];if(!u)return l;if(typeof u!="string"){for(var m=[],g=0,b=u.length;g<b;++g){var w=me(l,u[g]);m.push(w)}return m}var N,S=u.indexOf(".");return S===-1||(N=l[u.substr(0,S)])==null?void 0:me(N,u.substr(S+1))}function fe(l,u,m){if(l&&u!==void 0&&!("isFrozen"in Object&&Object.isFrozen(l)))if(typeof u!="string"&&"length"in u){ie(typeof m!="string"&&"length"in m);for(var g=0,b=u.length;g<b;++g)fe(l,u[g],m[g])}else{var w,N,S=u.indexOf(".");S!==-1?(w=u.substr(0,S),(S=u.substr(S+1))===""?m===void 0?v(l)&&!isNaN(parseInt(w))?l.splice(w,1):delete l[w]:l[w]=m:fe(N=(N=l[w])&&C(l,w)?N:l[w]={},S,m)):m===void 0?v(l)&&!isNaN(parseInt(u))?l.splice(u,1):delete l[u]:l[u]=m}}function ye(l){var u,m={};for(u in l)C(l,u)&&(m[u]=l[u]);return m}var $e=[].concat;function Te(l){return $e.apply([],l)}var re="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Te([8,16,32,64].map(function(l){return["Int","Uint","Float"].map(function(u){return u+l+"Array"})}))).filter(function(l){return h[l]}),st=new Set(re.map(function(l){return h[l]})),De=null;function lt(l){return De=new WeakMap,l=(function u(m){if(!m||typeof m!="object")return m;var g=De.get(m);if(g)return g;if(v(m)){g=[],De.set(m,g);for(var b=0,w=m.length;b<w;++b)g.push(u(m[b]))}else if(st.has(m.constructor))g=m;else{var N,S=_(m);for(N in g=S===Object.prototype?{}:Object.create(S),De.set(m,g),m)C(m,N)&&(g[N]=u(m[N]))}return g})(l),De=null,l}var jt={}.toString;function Tt(l){return jt.call(l).slice(8,-1)}var ft=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Me=typeof ft=="symbol"?function(l){var u;return l!=null&&(u=l[ft])&&u.apply(l)}:function(){return null};function de(l,u){u=l.indexOf(u),0<=u&&l.splice(u,1)}var Ce={};function se(l){var u,m,g,b;if(arguments.length===1){if(v(l))return l.slice();if(this===Ce&&typeof l=="string")return[l];if(b=Me(l))for(m=[];!(g=b.next()).done;)m.push(g.value);else{if(l==null)return[l];if(typeof(u=l.length)!="number")return[l];for(m=new Array(u);u--;)m[u]=l[u]}}else for(u=arguments.length,m=new Array(u);u--;)m[u]=arguments[u];return m}var W=typeof Symbol<"u"?function(l){return l[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},re=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],wt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(re),Ve={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ue(l,u){this.name=l,this.message=u}function We(l,u){return l+". Errors: "+Object.keys(u).map(function(m){return u[m].toString()}).filter(function(m,g,b){return b.indexOf(m)===g}).join(`
`)}function Ge(l,u,m,g){this.failures=u,this.failedKeys=g,this.successCount=m,this.message=We(l,u)}function et(l,u){this.name="BulkError",this.failures=Object.keys(u).map(function(m){return u[m]}),this.failuresByPos=u,this.message=We(l,this.failures)}q(Ue).from(Error).extend({toString:function(){return this.name+": "+this.message}}),q(Ge).from(Ue),q(et).from(Ue);var nt=wt.reduce(function(l,u){return l[u]=u+"Error",l},{}),pt=Ue,je=wt.reduce(function(l,u){var m=u+"Error";function g(b,w){this.name=m,b?typeof b=="string"?(this.message="".concat(b).concat(w?`
 `+w:""),this.inner=w||null):typeof b=="object"&&(this.message="".concat(b.name," ").concat(b.message),this.inner=b):(this.message=Ve[u]||m,this.inner=null)}return q(g).from(pt),l[u]=g,l},{}),or=(je.Syntax=SyntaxError,je.Type=TypeError,je.Range=RangeError,re.reduce(function(l,u){return l[u+"Error"]=je[u],l},{}));re=wt.reduce(function(l,u){return["Syntax","Type","Range"].indexOf(u)===-1&&(l[u+"Error"]=je[u]),l},{});function it(){}function wn(l){return l}function es(l,u){return l==null||l===wn?u:function(m){return u(l(m))}}function kn(l,u){return function(){l.apply(this,arguments),u.apply(this,arguments)}}function Bs(l,u){return l===it?u:function(){var m=l.apply(this,arguments),g=(m!==void 0&&(arguments[0]=m),this.onsuccess),b=this.onerror,w=(this.onsuccess=null,this.onerror=null,u.apply(this,arguments));return g&&(this.onsuccess=this.onsuccess?kn(g,this.onsuccess):g),b&&(this.onerror=this.onerror?kn(b,this.onerror):b),w!==void 0?w:m}}function ts(l,u){return l===it?u:function(){l.apply(this,arguments);var m=this.onsuccess,g=this.onerror;this.onsuccess=this.onerror=null,u.apply(this,arguments),m&&(this.onsuccess=this.onsuccess?kn(m,this.onsuccess):m),g&&(this.onerror=this.onerror?kn(g,this.onerror):g)}}function ns(l,u){return l===it?u:function(b){var g=l.apply(this,arguments),b=(x(b,g),this.onsuccess),w=this.onerror,N=(this.onsuccess=null,this.onerror=null,u.apply(this,arguments));return b&&(this.onsuccess=this.onsuccess?kn(b,this.onsuccess):b),w&&(this.onerror=this.onerror?kn(w,this.onerror):w),g===void 0?N===void 0?void 0:N:x(g,N)}}function rs(l,u){return l===it?u:function(){return u.apply(this,arguments)!==!1&&l.apply(this,arguments)}}function $n(l,u){return l===it?u:function(){var m=l.apply(this,arguments);if(m&&typeof m.then=="function"){for(var g=this,b=arguments.length,w=new Array(b);b--;)w[b]=arguments[b];return m.then(function(){return u.apply(g,w)})}return u.apply(this,arguments)}}re.ModifyError=Ge,re.DexieError=Ue,re.BulkError=et;var Nt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function $s(l){Nt=l}var ar={},Us=100,en=typeof Promise>"u"?[]:(wt=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[en=crypto.subtle.digest("SHA-512",new Uint8Array([0])),_(en),wt]:[wt,_(wt),wt]),wt=en[0],$r=en[1],$r=$r&&$r.then,_n=wt&&wt.constructor,lr=!!en[2],cr=function(l,u){qn.push([l,u]),Tn&&(queueMicrotask(xa),Tn=!1)},Un=!0,Tn=!0,zn=[],Cr=[],ss=wn,jn={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:it,pgp:!1,env:{},finalize:it},Ee=jn,qn=[],St=0,tn=[];function be(l){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var u=this._PSD=Ee;if(typeof l!="function"){if(l!==ar)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Vt(this,this._value)}else this._state=null,this._value=null,++u.ref,(function m(g,b){try{b(function(w){if(g._state===null){if(w===g)throw new TypeError("A promise cannot be resolved with itself.");var N=g._lib&&dr();w&&typeof w.then=="function"?m(g,function(S,L){w instanceof be?w._then(S,L):w.then(S,L)}):(g._state=!0,g._value=w,Fr(g)),N&&Er()}},Vt.bind(null,g))}catch(w){Vt(g,w)}})(this,l)}var ge={get:function(){var l=Ee,u=os;function m(g,b){var w=this,N=!l.global&&(l!==Ee||u!==os),S=N&&!nn(),L=new be(function(K,O){ur(w,new Ye(wo(g,l,N,S),wo(b,l,N,S),K,O,l))});return this._consoleTask&&(L._consoleTask=this._consoleTask),L}return m.prototype=ar,m},set:function(l){A(this,"then",l&&l.prototype===ar?ge:{get:function(){return l},set:ge.set})}};function Ye(l,u,m,g,b){this.onFulfilled=typeof l=="function"?l:null,this.onRejected=typeof u=="function"?u:null,this.resolve=m,this.reject=g,this.psd=b}function Vt(l,u){var m,g;Cr.push(u),l._state===null&&(m=l._lib&&dr(),u=ss(u),l._state=!1,l._value=u,g=l,zn.some(function(b){return b._value===g._value})||zn.push(g),Fr(l),m)&&Er()}function Fr(l){var u=l._listeners;l._listeners=[];for(var m=0,g=u.length;m<g;++m)ur(l,u[m]);var b=l._PSD;--b.ref||b.finalize(),St===0&&(++St,cr(function(){--St==0&&Ar()},[]))}function ur(l,u){if(l._state===null)l._listeners.push(u);else{var m=l._state?u.onFulfilled:u.onRejected;if(m===null)return(l._state?u.resolve:u.reject)(l._value);++u.psd.ref,++St,cr(va,[m,l,u])}}function va(l,u,m){try{var g,b=u._value;!u._state&&Cr.length&&(Cr=[]),g=Nt&&u._consoleTask?u._consoleTask.run(function(){return l(b)}):l(b),u._state||Cr.indexOf(b)!==-1||(w=>{for(var N=zn.length;N;)if(zn[--N]._value===w._value)return zn.splice(N,1)})(u),m.resolve(g)}catch(w){m.reject(w)}finally{--St==0&&Ar(),--m.psd.ref||m.psd.finalize()}}function xa(){pr(jn,function(){dr()&&Er()})}function dr(){var l=Un;return Tn=Un=!1,l}function Er(){var l,u,m;do for(;0<qn.length;)for(l=qn,qn=[],m=l.length,u=0;u<m;++u){var g=l[u];g[0].apply(null,g[1])}while(0<qn.length);Tn=Un=!0}function Ar(){for(var l=zn,u=(zn=[],l.forEach(function(g){g._PSD.onunhandled.call(null,g._value,g)}),tn.slice(0)),m=u.length;m;)u[--m]()}function is(l){return new be(ar,!1,l)}function ht(l,u){var m=Ee;return function(){var g=dr(),b=Ee;try{return fr(m,!0),l.apply(this,arguments)}catch(w){u&&u(w)}finally{fr(b,!1),g&&Er()}}}F(be.prototype,{then:ge,_then:function(l,u){ur(this,new Ye(null,null,l,u,Ee))},catch:function(l){var u,m;return arguments.length===1?this.then(null,l):(u=l,m=arguments[1],typeof u=="function"?this.then(null,function(g){return(g instanceof u?m:is)(g)}):this.then(null,function(g){return(g&&g.name===u?m:is)(g)}))},finally:function(l){return this.then(function(u){return be.resolve(l()).then(function(){return u})},function(u){return be.resolve(l()).then(function(){return is(u)})})},timeout:function(l,u){var m=this;return l<1/0?new be(function(g,b){var w=setTimeout(function(){return b(new je.Timeout(u))},l);m.then(g,b).finally(clearTimeout.bind(null,w))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&A(be.prototype,Symbol.toStringTag,"Dexie.Promise"),jn.env=bo(),F(be,{all:function(){var l=se.apply(null,arguments).map(qs);return new be(function(u,m){l.length===0&&u([]);var g=l.length;l.forEach(function(b,w){return be.resolve(b).then(function(N){l[w]=N,--g||u(l)},m)})})},resolve:function(l){return l instanceof be?l:l&&typeof l.then=="function"?new be(function(u,m){l.then(u,m)}):new be(ar,!0,l)},reject:is,race:function(){var l=se.apply(null,arguments).map(qs);return new be(function(u,m){l.map(function(g){return be.resolve(g).then(u,m)})})},PSD:{get:function(){return Ee},set:function(l){return Ee=l}},totalEchoes:{get:function(){return os}},newPSD:hr,usePSD:pr,scheduler:{get:function(){return cr},set:function(l){cr=l}},rejectionMapper:{get:function(){return ss},set:function(l){ss=l}},follow:function(l,u){return new be(function(m,g){return hr(function(b,w){var N=Ee;N.unhandleds=[],N.onunhandled=w,N.finalize=kn(function(){var S,L=this;S=function(){L.unhandleds.length===0?b():w(L.unhandleds[0])},tn.push(function K(){S(),tn.splice(tn.indexOf(K),1)}),++St,cr(function(){--St==0&&Ar()},[])},N.finalize),l()},u,m,g)})}}),_n&&(_n.allSettled&&A(be,"allSettled",function(){var l=se.apply(null,arguments).map(qs);return new be(function(u){l.length===0&&u([]);var m=l.length,g=new Array(m);l.forEach(function(b,w){return be.resolve(b).then(function(N){return g[w]={status:"fulfilled",value:N}},function(N){return g[w]={status:"rejected",reason:N}}).then(function(){return--m||u(g)})})})}),_n.any&&typeof AggregateError<"u"&&A(be,"any",function(){var l=se.apply(null,arguments).map(qs);return new be(function(u,m){l.length===0&&m(new AggregateError([]));var g=l.length,b=new Array(g);l.forEach(function(w,N){return be.resolve(w).then(function(S){return u(S)},function(S){b[N]=S,--g||m(new AggregateError(b))})})})}),_n.withResolvers)&&(be.withResolvers=_n.withResolvers);var Dt={awaits:0,echoes:0,id:0},zs=0,Tr=[],Rr=0,os=0,Ql=0;function hr(l,N,m,g){var b=Ee,w=Object.create(b),N=(w.parent=b,w.ref=0,w.global=!1,w.id=++Ql,jn.env,w.env=lr?{Promise:be,PromiseProp:{value:be,configurable:!0,writable:!0},all:be.all,race:be.race,allSettled:be.allSettled,any:be.any,resolve:be.resolve,reject:be.reject}:{},N&&x(w,N),++b.ref,w.finalize=function(){--this.parent.ref||this.parent.finalize()},pr(w,l,m,g));return w.ref===0&&w.finalize(),N}function as(){return Dt.id||(Dt.id=++zs),++Dt.awaits,Dt.echoes+=Us,Dt.id}function nn(){return!!Dt.awaits&&(--Dt.awaits==0&&(Dt.id=0),Dt.echoes=Dt.awaits*Us,!0)}function qs(l){return Dt.echoes&&l&&l.constructor===_n?(as(),l.then(function(u){return nn(),u},function(u){return nn(),Ct(u)})):l}function ba(){var l=Tr[Tr.length-1];Tr.pop(),fr(l,!1)}function fr(l,u){var m,g,b=Ee;(u?!Dt.echoes||Rr++&&l===Ee:!Rr||--Rr&&l===Ee)||queueMicrotask(u?function(w){++os,Dt.echoes&&--Dt.echoes!=0||(Dt.echoes=Dt.awaits=Dt.id=0),Tr.push(Ee),fr(w,!0)}.bind(null,l):ba),l!==Ee&&(Ee=l,b===jn&&(jn.env=bo()),lr)&&(m=jn.env.Promise,g=l.env,b.global||l.global)&&(Object.defineProperty(h,"Promise",g.PromiseProp),m.all=g.all,m.race=g.race,m.resolve=g.resolve,m.reject=g.reject,g.allSettled&&(m.allSettled=g.allSettled),g.any)&&(m.any=g.any)}function bo(){var l=h.Promise;return lr?{Promise:l,PromiseProp:Object.getOwnPropertyDescriptor(h,"Promise"),all:l.all,race:l.race,allSettled:l.allSettled,any:l.any,resolve:l.resolve,reject:l.reject}:{}}function pr(l,u,m,g,b){var w=Ee;try{return fr(l,!0),u(m,g,b)}finally{fr(w,!1)}}function wo(l,u,m,g){return typeof l!="function"?l:function(){var b=Ee;m&&as(),fr(u,!0);try{return l.apply(this,arguments)}finally{fr(b,!1),g&&queueMicrotask(nn)}}}function _i(l){Promise===_n&&Dt.echoes===0?Rr===0?l():enqueueNativeMicroTask(l):setTimeout(l,0)}(""+$r).indexOf("[native code]")===-1&&(as=nn=it);var Ct=be.reject,Pr="",ut="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",wa="String expected.",mr=[],Ws="__dbnames",ls="readonly",ko="readwrite";function yr(l,u){return l?u?function(){return l.apply(this,arguments)&&u.apply(this,arguments)}:l:u}var Ks={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function ln(l){return typeof l!="string"||/\./.test(l)?function(u){return u}:function(u){return u[l]===void 0&&l in u&&delete(u=lt(u))[l],u}}function ka(){throw je.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Ke(l,u){try{var m=_a(l),g=_a(u);if(m!==g)return m==="Array"?1:g==="Array"?-1:m==="binary"?1:g==="binary"?-1:m==="string"?1:g==="string"?-1:m==="Date"?1:g!=="Date"?NaN:-1;switch(m){case"number":case"Date":case"string":return u<l?1:l<u?-1:0;case"binary":for(var b=ja(l),w=ja(u),N=b.length,S=w.length,L=N<S?N:S,K=0;K<L;++K)if(b[K]!==w[K])return b[K]<w[K]?-1:1;return N===S?0:N<S?-1:1;case"Array":for(var O=l,R=u,B=O.length,$=R.length,I=B<$?B:$,D=0;D<I;++D){var J=Ke(O[D],R[D]);if(J!==0)return J}return B===$?0:B<$?-1:1}}catch{}return NaN}function _a(l){var u=typeof l;return u=="object"&&(ArrayBuffer.isView(l)||(u=Tt(l))==="ArrayBuffer")?"binary":u}function ja(l){return l instanceof Uint8Array?l:ArrayBuffer.isView(l)?new Uint8Array(l.buffer,l.byteOffset,l.byteLength):new Uint8Array(l)}function ji(l,u,m){var g=l.schema.yProps;return g?(u&&0<m.numFailures&&(u=u.filter(function(b,w){return!m.failures[w]})),Promise.all(g.map(function(b){return b=b.updatesTable,u?l.db.table(b).where("k").anyOf(u).delete():l.db.table(b).clear()})).then(function(){return m})):m}Hs.prototype.execute=function(l){var u=this["@@propmod"];if(u.add!==void 0){var m=u.add;if(v(m))return d(d([],v(l)?l:[],!0),m).sort();if(typeof m=="number")return(Number(l)||0)+m;if(typeof m=="bigint")try{return BigInt(l)+m}catch{return BigInt(0)+m}throw new TypeError("Invalid term ".concat(m))}if(u.remove!==void 0){var g=u.remove;if(v(g))return v(l)?l.filter(function(b){return!g.includes(b)}).sort():[];if(typeof g=="number")return Number(l)-g;if(typeof g=="bigint")try{return BigInt(l)-g}catch{return BigInt(0)-g}throw new TypeError("Invalid subtrahend ".concat(g))}return m=(m=u.replacePrefix)==null?void 0:m[0],m&&typeof l=="string"&&l.startsWith(m)?u.replacePrefix[1]+l.substring(m.length):l};var gr=Hs;function Hs(l){this["@@propmod"]=l}function cs(l,u){for(var m=p(u),g=m.length,b=!1,w=0;w<g;++w){var N=m[w],S=u[N],L=me(l,N);S instanceof gr?(fe(l,N,S.execute(L)),b=!0):L!==S&&(fe(l,N,S),b=!0)}return b}mt.prototype._trans=function(l,u,m){var g=this._tx||Ee.trans,b=this.name,w=Nt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(l==="readonly"?"read":"write"," ").concat(this.name));function N(K,O,R){if(R.schema[b])return u(R.idbtrans,R);throw new je.NotFound("Table "+b+" not part of transaction")}var S=dr();try{var L=g&&g.db._novip===this.db._novip?g===Ee.trans?g._promise(l,N,m):hr(function(){return g._promise(l,N,m)},{trans:g,transless:Ee.transless||Ee}):(function K(O,R,B,$){if(O.idbdb&&(O._state.openComplete||Ee.letThrough||O._vip)){var I=O._createTransaction(R,B,O._dbSchema);try{I.create(),O._state.PR1398_maxLoop=3}catch(D){return D.name===nt.InvalidState&&O.isOpen()&&0<--O._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),O.close({disableAutoOpen:!1}),O.open().then(function(){return K(O,R,B,$)})):Ct(D)}return I._promise(R,function(D,J){return hr(function(){return Ee.trans=I,$(D,J,I)})}).then(function(D){if(R==="readwrite")try{I.idbtrans.commit()}catch{}return R==="readonly"?D:I._completion.then(function(){return D})})}if(O._state.openComplete)return Ct(new je.DatabaseClosed(O._state.dbOpenError));if(!O._state.isBeingOpened){if(!O._state.autoOpen)return Ct(new je.DatabaseClosed);O.open().catch(it)}return O._state.dbReadyPromise.then(function(){return K(O,R,B,$)})})(this.db,l,[this.name],N);return w&&(L._consoleTask=w,L=L.catch(function(K){return console.trace(K),Ct(K)})),L}finally{S&&Er()}},mt.prototype.get=function(l,u){var m=this;return l&&l.constructor===Object?this.where(l).first(u):l==null?Ct(new je.Type("Invalid argument to Table.get()")):this._trans("readonly",function(g){return m.core.get({trans:g,key:l}).then(function(b){return m.hook.reading.fire(b)})}).then(u)},mt.prototype.where=function(l){if(typeof l=="string")return new this.db.WhereClause(this,l);if(v(l))return new this.db.WhereClause(this,"[".concat(l.join("+"),"]"));var u=p(l);if(u.length===1)return this.where(u[0]).equals(l[u[0]]);var m=this.schema.indexes.concat(this.schema.primKey).filter(function(S){if(S.compound&&u.every(function(K){return 0<=S.keyPath.indexOf(K)})){for(var L=0;L<u.length;++L)if(u.indexOf(S.keyPath[L])===-1)return!1;return!0}return!1}).sort(function(S,L){return S.keyPath.length-L.keyPath.length})[0];if(m&&this.db._maxKey!==Pr)return N=m.keyPath.slice(0,u.length),this.where(N).equals(N.map(function(S){return l[S]}));!m&&Nt&&console.warn("The query ".concat(JSON.stringify(l)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(u.join("+"),"]"));var g=this.schema.idxByName;function b(S,L){return Ke(S,L)===0}var N=u.reduce(function(O,L){var K=O[0],O=O[1],R=g[L],B=l[L];return[K||R,K||!R?yr(O,R&&R.multi?function($){return $=me($,L),v($)&&$.some(function(I){return b(B,I)})}:function($){return b(B,me($,L))}):O]},[null,null]),w=N[0],N=N[1];return w?this.where(w.name).equals(l[w.keyPath]).filter(N):m?this.filter(N):this.where(u).equals("")},mt.prototype.filter=function(l){return this.toCollection().and(l)},mt.prototype.count=function(l){return this.toCollection().count(l)},mt.prototype.offset=function(l){return this.toCollection().offset(l)},mt.prototype.limit=function(l){return this.toCollection().limit(l)},mt.prototype.each=function(l){return this.toCollection().each(l)},mt.prototype.toArray=function(l){return this.toCollection().toArray(l)},mt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},mt.prototype.orderBy=function(l){return new this.db.Collection(new this.db.WhereClause(this,v(l)?"[".concat(l.join("+"),"]"):l))},mt.prototype.reverse=function(){return this.toCollection().reverse()},mt.prototype.mapToClass=function(l){for(var u=this.db,m=this.name,g=((this.schema.mappedClass=l).prototype instanceof ka&&(l=(N=>{var S=O,L=N;if(typeof L!="function"&&L!==null)throw new TypeError("Class extends value "+String(L)+" is not a constructor or null");function K(){this.constructor=S}function O(){return N!==null&&N.apply(this,arguments)||this}return r(S,L),S.prototype=L===null?Object.create(L):(K.prototype=L.prototype,new K),Object.defineProperty(O.prototype,"db",{get:function(){return u},enumerable:!1,configurable:!0}),O.prototype.table=function(){return m},O})(l)),new Set),b=l.prototype;b;b=_(b))Object.getOwnPropertyNames(b).forEach(function(N){return g.add(N)});function w(N){if(!N)return N;var S,L=Object.create(l.prototype);for(S in N)if(!g.has(S))try{L[S]=N[S]}catch{}return L}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=w,this.hook("reading",w),l},mt.prototype.defineClass=function(){return this.mapToClass(function(l){x(this,l)})},mt.prototype.add=function(l,u){var m=this,g=this.schema.primKey,b=g.auto,w=g.keyPath,N=l;return w&&b&&(N=ln(w)(l)),this._trans("readwrite",function(S){return m.core.mutate({trans:S,type:"add",keys:u!=null?[u]:null,values:[N]})}).then(function(S){return S.numFailures?be.reject(S.failures[0]):S.lastResult}).then(function(S){if(w)try{fe(l,w,S)}catch{}return S})},mt.prototype.upsert=function(l,u){var m=this,g=this.schema.primKey.keyPath;return this._trans("readwrite",function(b){return m.core.get({trans:b,key:l}).then(function(w){var N=w??{};return cs(N,u),g&&fe(N,g,l),m.core.mutate({trans:b,type:"put",values:[N],keys:[l],upsert:!0,updates:{keys:[l],changeSpecs:[u]}}).then(function(S){return S.numFailures?be.reject(S.failures[0]):!!w})})})},mt.prototype.update=function(l,u){return typeof l!="object"||v(l)?this.where(":id").equals(l).modify(u):(l=me(l,this.schema.primKey.keyPath))===void 0?Ct(new je.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(l).modify(u)},mt.prototype.put=function(l,u){var m=this,g=this.schema.primKey,b=g.auto,w=g.keyPath,N=l;return w&&b&&(N=ln(w)(l)),this._trans("readwrite",function(S){return m.core.mutate({trans:S,type:"put",values:[N],keys:u!=null?[u]:null})}).then(function(S){return S.numFailures?be.reject(S.failures[0]):S.lastResult}).then(function(S){if(w)try{fe(l,w,S)}catch{}return S})},mt.prototype.delete=function(l){var u=this;return this._trans("readwrite",function(m){return u.core.mutate({trans:m,type:"delete",keys:[l]}).then(function(g){return ji(u,[l],g)}).then(function(g){return g.numFailures?be.reject(g.failures[0]):void 0})})},mt.prototype.clear=function(){var l=this;return this._trans("readwrite",function(u){return l.core.mutate({trans:u,type:"deleteRange",range:Ks}).then(function(m){return ji(l,null,m)})}).then(function(u){return u.numFailures?be.reject(u.failures[0]):void 0})},mt.prototype.bulkGet=function(l){var u=this;return this._trans("readonly",function(m){return u.core.getMany({keys:l,trans:m}).then(function(g){return g.map(function(b){return u.hook.reading.fire(b)})})})},mt.prototype.bulkAdd=function(l,u,m){var g=this,b=Array.isArray(u)?u:void 0,w=(m=m||(b?void 0:u))?m.allKeys:void 0;return this._trans("readwrite",function(N){var S=g.schema.primKey,K=S.auto,S=S.keyPath;if(S&&b)throw new je.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(b&&b.length!==l.length)throw new je.InvalidArgument("Arguments objects and keys must have the same length");var L=l.length,K=S&&K?l.map(ln(S)):l;return g.core.mutate({trans:N,type:"add",keys:b,values:K,wantResults:w}).then(function(O){var R=O.numFailures,B=O.failures;if(R===0)return w?O.results:O.lastResult;throw new et("".concat(g.name,".bulkAdd(): ").concat(R," of ").concat(L," operations failed"),B)})})},mt.prototype.bulkPut=function(l,u,m){var g=this,b=Array.isArray(u)?u:void 0,w=(m=m||(b?void 0:u))?m.allKeys:void 0;return this._trans("readwrite",function(N){var S=g.schema.primKey,K=S.auto,S=S.keyPath;if(S&&b)throw new je.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(b&&b.length!==l.length)throw new je.InvalidArgument("Arguments objects and keys must have the same length");var L=l.length,K=S&&K?l.map(ln(S)):l;return g.core.mutate({trans:N,type:"put",keys:b,values:K,wantResults:w}).then(function(O){var R=O.numFailures,B=O.failures;if(R===0)return w?O.results:O.lastResult;throw new et("".concat(g.name,".bulkPut(): ").concat(R," of ").concat(L," operations failed"),B)})})},mt.prototype.bulkUpdate=function(l){var u=this,m=this.core,g=l.map(function(N){return N.key}),b=l.map(function(N){return N.changes}),w=[];return this._trans("readwrite",function(N){return m.getMany({trans:N,keys:g,cache:"clone"}).then(function(S){var L=[],K=[],O=(l.forEach(function(R,B){var $=R.key,I=R.changes,D=S[B];if(D){for(var J=0,Q=Object.keys(I);J<Q.length;J++){var H=Q[J],te=I[H];if(H===u.schema.primKey.keyPath){if(Ke(te,$)!==0)throw new je.Constraint("Cannot update primary key in bulkUpdate()")}else fe(D,H,te)}w.push(B),L.push($),K.push(D)}}),L.length);return m.mutate({trans:N,type:"put",keys:L,values:K,updates:{keys:g,changeSpecs:b}}).then(function(R){var B=R.numFailures,$=R.failures;if(B===0)return O;for(var I=0,D=Object.keys($);I<D.length;I++){var J,Q=D[I],H=w[Number(Q)];H!=null&&(J=$[Q],delete $[Q],$[H]=J)}throw new et("".concat(u.name,".bulkUpdate(): ").concat(B," of ").concat(O," operations failed"),$)})})})},mt.prototype.bulkDelete=function(l){var u=this,m=l.length;return this._trans("readwrite",function(g){return u.core.mutate({trans:g,type:"delete",keys:l}).then(function(b){return ji(u,l,b)})}).then(function(g){var b=g.numFailures,w=g.failures;if(b===0)return g.lastResult;throw new et("".concat(u.name,".bulkDelete(): ").concat(b," of ").concat(m," operations failed"),w)})};var Vs=mt;function mt(){}function Gs(l){function u(N,S){if(S){for(var L=arguments.length,K=new Array(L-1);--L;)K[L-1]=arguments[L];return m[N].subscribe.apply(null,K),l}if(typeof N=="string")return m[N]}var m={};u.addEventType=w;for(var g=1,b=arguments.length;g<b;++g)w(arguments[g]);return u;function w(N,S,L){var K,O;if(typeof N!="object")return S=S||rs,O={subscribers:[],fire:L=L||it,subscribe:function(R){O.subscribers.indexOf(R)===-1&&(O.subscribers.push(R),O.fire=S(O.fire,R))},unsubscribe:function(R){O.subscribers=O.subscribers.filter(function(B){return B!==R}),O.fire=O.subscribers.reduce(S,L)}},m[N]=u[N]=O;p(K=N).forEach(function(R){var B=K[R];if(v(B))w(R,K[R][0],K[R][1]);else{if(B!=="asap")throw new je.InvalidArgument("Invalid event config");var $=w(R,wn,function(){for(var I=arguments.length,D=new Array(I);I--;)D[I]=arguments[I];$.subscribers.forEach(function(J){ee(function(){J.apply(null,D)})})})}})}}function Or(l,u){return q(u).from({prototype:l}),u}function Dr(l,u){return!(l.filter||l.algorithm||l.or)&&(u?l.justLimit:!l.replayFilter)}function Js(l,u){l.filter=yr(l.filter,u)}function Ir(l,u,m){var g=l.replayFilter;l.replayFilter=g?function(){return yr(g(),u())}:u,l.justLimit=m&&!g}function Ni(l,u){if(l.isPrimKey)return u.primaryKey;var m=u.getIndexByKeyPath(l.index);if(m)return m;throw new je.Schema("KeyPath "+l.index+" on object store "+u.name+" is not indexed")}function Si(l,u,m){var g=Ni(l,u.schema);return u.openCursor({trans:m,values:!l.keysOnly,reverse:l.dir==="prev",unique:!!l.unique,query:{index:g,range:l.range}})}function ot(l,u,m,g){var b,w,N=l.replayFilter?yr(l.filter,l.replayFilter()):l.filter;return l.or?(b={},w=function(S,L,K){var O,R;N&&!N(L,K,function(B){return L.stop(B)},function(B){return L.fail(B)})||((R=""+(O=L.primaryKey))=="[object ArrayBuffer]"&&(R=""+new Uint8Array(O)),C(b,R))||(b[R]=!0,u(S,L,K))},Promise.all([l.or._iterate(w,m),_o(Si(l,g,m),l.algorithm,w,!l.keysOnly&&l.valueMapper)])):_o(Si(l,g,m),yr(l.algorithm,N),u,!l.keysOnly&&l.valueMapper)}function _o(l,u,m,g){var b=ht(g?function(w,N,S){return m(g(w),N,S)}:m);return l.then(function(w){if(w)return w.start(function(){var N=function(){return w.continue()};u&&!u(w,function(S){return N=S},function(S){w.stop(S),N=it},function(S){w.fail(S),N=it})||b(w.value,w,function(S){return N=S}),N()})})}tt.prototype._read=function(l,u){var m=this._ctx;return m.error?m.table._trans(null,Ct.bind(null,m.error)):m.table._trans("readonly",l).then(u)},tt.prototype._write=function(l){var u=this._ctx;return u.error?u.table._trans(null,Ct.bind(null,u.error)):u.table._trans("readwrite",l,"locked")},tt.prototype._addAlgorithm=function(l){var u=this._ctx;u.algorithm=yr(u.algorithm,l)},tt.prototype._iterate=function(l,u){return ot(this._ctx,l,u,this._ctx.table.core)},tt.prototype.clone=function(l){var u=Object.create(this.constructor.prototype),m=Object.create(this._ctx);return l&&x(m,l),u._ctx=m,u},tt.prototype.raw=function(){return this._ctx.valueMapper=null,this},tt.prototype.each=function(l){var u=this._ctx;return this._read(function(m){return ot(u,l,m,u.table.core)})},tt.prototype.count=function(l){var u=this;return this._read(function(m){var g,b=u._ctx,w=b.table.core;return Dr(b,!0)?w.count({trans:m,query:{index:Ni(b,w.schema),range:b.range}}).then(function(N){return Math.min(N,b.limit)}):(g=0,ot(b,function(){return++g,!1},m,w).then(function(){return g}))}).then(l)},tt.prototype.sortBy=function(l,u){var m=l.split(".").reverse(),g=m[0],b=m.length-1;function w(L,K){return K?w(L[m[K]],K-1):L[g]}var N=this._ctx.dir==="next"?1:-1;function S(L,K){return Ke(w(L,b),w(K,b))*N}return this.toArray(function(L){return L.sort(S)}).then(u)},tt.prototype.toArray=function(l){var u=this;return this._read(function(m){var g,b,w,N=u._ctx;return N.dir==="next"&&Dr(N,!0)&&0<N.limit?(g=N.valueMapper,b=Ni(N,N.table.core.schema),N.table.core.query({trans:m,limit:N.limit,values:!0,query:{index:b,range:N.range}}).then(function(S){return S=S.result,g?S.map(g):S})):(w=[],ot(N,function(S){return w.push(S)},m,N.table.core).then(function(){return w}))},l)},tt.prototype.offset=function(l){var u=this._ctx;return l<=0||(u.offset+=l,Dr(u)?Ir(u,function(){var m=l;return function(g,b){return m===0||(m===1?--m:b(function(){g.advance(m),m=0}),!1)}}):Ir(u,function(){var m=l;return function(){return--m<0}})),this},tt.prototype.limit=function(l){return this._ctx.limit=Math.min(this._ctx.limit,l),Ir(this._ctx,function(){var u=l;return function(m,g,b){return--u<=0&&g(b),0<=u}},!0),this},tt.prototype.until=function(l,u){return Js(this._ctx,function(m,g,b){return!l(m.value)||(g(b),u)}),this},tt.prototype.first=function(l){return this.limit(1).toArray(function(u){return u[0]}).then(l)},tt.prototype.last=function(l){return this.reverse().first(l)},tt.prototype.filter=function(l){var u;return Js(this._ctx,function(m){return l(m.value)}),(u=this._ctx).isMatch=yr(u.isMatch,l),this},tt.prototype.and=function(l){return this.filter(l)},tt.prototype.or=function(l){return new this.db.WhereClause(this._ctx.table,l,this)},tt.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},tt.prototype.desc=function(){return this.reverse()},tt.prototype.eachKey=function(l){var u=this._ctx;return u.keysOnly=!u.isMatch,this.each(function(m,g){l(g.key,g)})},tt.prototype.eachUniqueKey=function(l){return this._ctx.unique="unique",this.eachKey(l)},tt.prototype.eachPrimaryKey=function(l){var u=this._ctx;return u.keysOnly=!u.isMatch,this.each(function(m,g){l(g.primaryKey,g)})},tt.prototype.keys=function(l){var u=this._ctx,m=(u.keysOnly=!u.isMatch,[]);return this.each(function(g,b){m.push(b.key)}).then(function(){return m}).then(l)},tt.prototype.primaryKeys=function(l){var u=this._ctx;if(u.dir==="next"&&Dr(u,!0)&&0<u.limit)return this._read(function(g){var b=Ni(u,u.table.core.schema);return u.table.core.query({trans:g,values:!1,limit:u.limit,query:{index:b,range:u.range}})}).then(function(g){return g.result}).then(l);u.keysOnly=!u.isMatch;var m=[];return this.each(function(g,b){m.push(b.primaryKey)}).then(function(){return m}).then(l)},tt.prototype.uniqueKeys=function(l){return this._ctx.unique="unique",this.keys(l)},tt.prototype.firstKey=function(l){return this.limit(1).keys(function(u){return u[0]}).then(l)},tt.prototype.lastKey=function(l){return this.reverse().firstKey(l)},tt.prototype.distinct=function(){var l,u=this._ctx,u=u.index&&u.table.schema.idxByName[u.index];return u&&u.multi&&(l={},Js(this._ctx,function(g){var g=g.primaryKey.toString(),b=C(l,g);return l[g]=!0,!b})),this},tt.prototype.modify=function(l){var u=this,m=this._ctx;return this._write(function(g){function b(D,J){var Q=J.failures;B+=D-J.numFailures;for(var H=0,te=p(Q);H<te.length;H++){var oe=te[H];R.push(Q[oe])}}var w=typeof l=="function"?l:function(D){return cs(D,l)},N=m.table.core,O=N.schema.primaryKey,S=O.outbound,L=O.extractKey,K=200,O=u.db._options.modifyChunkSize,R=(O&&(K=typeof O=="object"?O[N.name]||O["*"]||200:O),[]),B=0,$=[],I=l===jo;return u.clone().primaryKeys().then(function(D){function J(H){var te=Math.min(K,D.length-H),oe=D.slice(H,H+te);return(I?Promise.resolve([]):N.getMany({trans:g,keys:oe,cache:"immutable"})).then(function(ve){var xe=[],le=[],_e=S?[]:null,ke=I?oe:[];if(!I)for(var he=0;he<te;++he){var Ne=ve[he],Xe={value:lt(Ne),primKey:D[H+he]};w.call(Xe,Xe.value,Xe)!==!1&&(Xe.value==null?ke.push(D[H+he]):S||Ke(L(Ne),L(Xe.value))===0?(le.push(Xe.value),S&&_e.push(D[H+he])):(ke.push(D[H+he]),xe.push(Xe.value)))}return Promise.resolve(0<xe.length&&N.mutate({trans:g,type:"add",values:xe}).then(function(rt){for(var Ie in rt.failures)ke.splice(parseInt(Ie),1);b(xe.length,rt)})).then(function(){return(0<le.length||Q&&typeof l=="object")&&N.mutate({trans:g,type:"put",keys:_e,values:le,criteria:Q,changeSpec:typeof l!="function"&&l,isAdditionalChunk:0<H}).then(function(rt){return b(le.length,rt)})}).then(function(){return(0<ke.length||Q&&I)&&N.mutate({trans:g,type:"delete",keys:ke,criteria:Q,isAdditionalChunk:0<H}).then(function(rt){return ji(m.table,ke,rt)}).then(function(rt){return b(ke.length,rt)})}).then(function(){return D.length>H+te&&J(H+K)})})}var Q=Dr(m)&&m.limit===1/0&&(typeof l!="function"||I)&&{index:m.index,range:m.range};return J(0).then(function(){if(0<R.length)throw new Ge("Error modifying one or more objects",R,B,$);return D.length})})})},tt.prototype.delete=function(){var l=this._ctx,u=l.range;return!Dr(l)||l.table.schema.yProps||!l.isPrimKey&&u.type!==3?this.modify(jo):this._write(function(m){var g=l.table.core.schema.primaryKey,b=u;return l.table.core.count({trans:m,query:{index:g,range:b}}).then(function(w){return l.table.core.mutate({trans:m,type:"deleteRange",range:b}).then(function(L){var S=L.failures,L=L.numFailures;if(L)throw new Ge("Could not delete some values",Object.keys(S).map(function(K){return S[K]}),w-L);return w-L})})})};var Na=tt;function tt(){}var jo=function(l,u){return u.value=null};function Sa(l,u){return l<u?-1:l===u?0:1}function Ca(l,u){return u<l?-1:l===u?0:1}function Gt(l,u,m){return l=l instanceof us?new l.Collection(l):l,l._ctx.error=new(m||TypeError)(u),l}function Wn(l){return new l.Collection(l,function(){return Kn("")}).limit(0)}function Nn($,u,m,g){var b,w,N,S,L,K,O,R=m.length;if(!m.every(function(D){return typeof D=="string"}))return Gt($,wa);function B(D){b=D==="next"?function(Q){return Q.toUpperCase()}:function(Q){return Q.toLowerCase()},w=D==="next"?function(Q){return Q.toLowerCase()}:function(Q){return Q.toUpperCase()},N=D==="next"?Sa:Ca;var J=m.map(function(Q){return{lower:w(Q),upper:b(Q)}}).sort(function(Q,H){return N(Q.lower,H.lower)});S=J.map(function(Q){return Q.upper}),L=J.map(function(Q){return Q.lower}),O=(K=D)==="next"?"":g}B("next");var $=new $.Collection($,function(){return Jt(S[0],L[R-1]+g)}),I=($._ondirectionchange=function(D){B(D)},0);return $._addAlgorithm(function(D,J,Q){var H=D.key;if(typeof H=="string"){var te=w(H);if(u(te,L,I))return!0;for(var oe=null,ve=I;ve<R;++ve){var xe=((le,_e,ke,he,Ne,Xe)=>{for(var rt=Math.min(le.length,he.length),Ie=-1,Je=0;Je<rt;++Je){var yt=_e[Je];if(yt!==he[Je])return Ne(le[Je],ke[Je])<0?le.substr(0,Je)+ke[Je]+ke.substr(Je+1):Ne(le[Je],he[Je])<0?le.substr(0,Je)+he[Je]+ke.substr(Je+1):0<=Ie?le.substr(0,Ie)+_e[Ie]+ke.substr(Ie+1):null;Ne(le[Je],yt)<0&&(Ie=Je)}return rt<he.length&&Xe==="next"?le+ke.substr(le.length):rt<le.length&&Xe==="prev"?le.substr(0,ke.length):Ie<0?null:le.substr(0,Ie)+he[Ie]+ke.substr(Ie+1)})(H,te,S[ve],L[ve],N,K);xe===null&&oe===null?I=ve+1:(oe===null||0<N(oe,xe))&&(oe=xe)}J(oe!==null?function(){D.continue(oe+O)}:Q)}return!1}),$}function Jt(l,u,m,g){return{type:2,lower:l,upper:u,lowerOpen:m,upperOpen:g}}function Kn(l){return{type:1,lower:l,upper:l}}Object.defineProperty(kt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),kt.prototype.between=function(l,u,m,g){m=m!==!1,g=g===!0;try{return 0<this._cmp(l,u)||this._cmp(l,u)===0&&(m||g)&&(!m||!g)?Wn(this):new this.Collection(this,function(){return Jt(l,u,!m,!g)})}catch{return Gt(this,ut)}},kt.prototype.equals=function(l){return l==null?Gt(this,ut):new this.Collection(this,function(){return Kn(l)})},kt.prototype.above=function(l){return l==null?Gt(this,ut):new this.Collection(this,function(){return Jt(l,void 0,!0)})},kt.prototype.aboveOrEqual=function(l){return l==null?Gt(this,ut):new this.Collection(this,function(){return Jt(l,void 0,!1)})},kt.prototype.below=function(l){return l==null?Gt(this,ut):new this.Collection(this,function(){return Jt(void 0,l,!1,!0)})},kt.prototype.belowOrEqual=function(l){return l==null?Gt(this,ut):new this.Collection(this,function(){return Jt(void 0,l)})},kt.prototype.startsWith=function(l){return typeof l!="string"?Gt(this,wa):this.between(l,l+Pr,!0,!0)},kt.prototype.startsWithIgnoreCase=function(l){return l===""?this.startsWith(l):Nn(this,function(u,m){return u.indexOf(m[0])===0},[l],Pr)},kt.prototype.equalsIgnoreCase=function(l){return Nn(this,function(u,m){return u===m[0]},[l],"")},kt.prototype.anyOfIgnoreCase=function(){var l=se.apply(Ce,arguments);return l.length===0?Wn(this):Nn(this,function(u,m){return m.indexOf(u)!==-1},l,"")},kt.prototype.startsWithAnyOfIgnoreCase=function(){var l=se.apply(Ce,arguments);return l.length===0?Wn(this):Nn(this,function(u,m){return m.some(function(g){return u.indexOf(g)===0})},l,Pr)},kt.prototype.anyOf=function(){var l,u,m=this,g=se.apply(Ce,arguments),b=this._cmp;try{g.sort(b)}catch{return Gt(this,ut)}return g.length===0?Wn(this):((l=new this.Collection(this,function(){return Jt(g[0],g[g.length-1])}))._ondirectionchange=function(w){b=w==="next"?m._ascending:m._descending,g.sort(b)},u=0,l._addAlgorithm(function(w,N,S){for(var L=w.key;0<b(L,g[u]);)if(++u===g.length)return N(S),!1;return b(L,g[u])===0||(N(function(){w.continue(g[u])}),!1)}),l)},kt.prototype.notEqual=function(l){return this.inAnyRange([[-1/0,l],[l,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},kt.prototype.noneOf=function(){var l=se.apply(Ce,arguments);if(l.length===0)return new this.Collection(this);try{l.sort(this._ascending)}catch{return Gt(this,ut)}var u=l.reduce(function(m,g){return m?m.concat([[m[m.length-1][1],g]]):[[-1/0,g]]},null);return u.push([l[l.length-1],this.db._maxKey]),this.inAnyRange(u,{includeLowers:!1,includeUppers:!1})},kt.prototype.inAnyRange=function(l,Q){var m=this,g=this._cmp,b=this._ascending,w=this._descending,N=this._min,S=this._max;if(l.length===0)return Wn(this);if(!l.every(function(H){return H[0]!==void 0&&H[1]!==void 0&&b(H[0],H[1])<=0}))return Gt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",je.InvalidArgument);var L=!Q||Q.includeLowers!==!1,K=Q&&Q.includeUppers===!0,O,R=b;function B(H,te){return R(H[0],te[0])}try{(O=l.reduce(function(H,te){for(var oe=0,ve=H.length;oe<ve;++oe){var xe=H[oe];if(g(te[0],xe[1])<0&&0<g(te[1],xe[0])){xe[0]=N(xe[0],te[0]),xe[1]=S(xe[1],te[1]);break}}return oe===ve&&H.push(te),H},[])).sort(B)}catch{return Gt(this,ut)}var $=0,I=K?function(H){return 0<b(H,O[$][1])}:function(H){return 0<=b(H,O[$][1])},D=L?function(H){return 0<w(H,O[$][0])}:function(H){return 0<=w(H,O[$][0])},J=I,Q=new this.Collection(this,function(){return Jt(O[0][0],O[O.length-1][1],!L,!K)});return Q._ondirectionchange=function(H){R=H==="next"?(J=I,b):(J=D,w),O.sort(B)},Q._addAlgorithm(function(H,te,oe){for(var ve,xe=H.key;J(xe);)if(++$===O.length)return te(oe),!1;return!I(ve=xe)&&!D(ve)||(m._cmp(xe,O[$][1])===0||m._cmp(xe,O[$][0])===0||te(function(){R===b?H.continue(O[$][0]):H.continue(O[$][1])}),!1)}),Q},kt.prototype.startsWithAnyOf=function(){var l=se.apply(Ce,arguments);return l.every(function(u){return typeof u=="string"})?l.length===0?Wn(this):this.inAnyRange(l.map(function(u){return[u,u+Pr]})):Gt(this,"startsWithAnyOf() only works with strings")};var us=kt;function kt(){}function Lt(l){return ht(function(u){return Ys(u),l(u.target.error),!1})}function Ys(l){l.stopPropagation&&l.stopPropagation(),l.preventDefault&&l.preventDefault()}var ds="storagemutated",Mr="x-storagemutated-1",vr=Gs(null,ds),Fa=(cn.prototype._lock=function(){return ie(!Ee.global),++this._reculock,this._reculock!==1||Ee.global||(Ee.lockOwnerFor=this),this},cn.prototype._unlock=function(){if(ie(!Ee.global),--this._reculock==0)for(Ee.global||(Ee.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var l=this._blockedFuncs.shift();try{pr(l[1],l[0])}catch{}}return this},cn.prototype._locked=function(){return this._reculock&&Ee.lockOwnerFor!==this},cn.prototype.create=function(l){var u=this;if(this.mode){var m=this.db.idbdb,g=this.db._state.dbOpenError;if(ie(!this.idbtrans),!l&&!m)switch(g&&g.name){case"DatabaseClosedError":throw new je.DatabaseClosed(g);case"MissingAPIError":throw new je.MissingAPI(g.message,g);default:throw new je.OpenFailed(g)}if(!this.active)throw new je.TransactionInactive;ie(this._completion._state===null),(l=this.idbtrans=l||(this.db.core||m).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=ht(function(b){Ys(b),u._reject(l.error)}),l.onabort=ht(function(b){Ys(b),u.active&&u._reject(new je.Abort(l.error)),u.active=!1,u.on("abort").fire(b)}),l.oncomplete=ht(function(){u.active=!1,u._resolve(),"mutatedParts"in l&&vr.storagemutated.fire(l.mutatedParts)})}return this},cn.prototype._promise=function(l,u,m){var g,b=this;return l==="readwrite"&&this.mode!=="readwrite"?Ct(new je.ReadOnly("Transaction is readonly")):this.active?this._locked()?new be(function(w,N){b._blockedFuncs.push([function(){b._promise(l,u,m).then(w,N)},Ee])}):m?hr(function(){var w=new be(function(N,S){b._lock();var L=u(N,S,b);L&&L.then&&L.then(N,S)});return w.finally(function(){return b._unlock()}),w._lib=!0,w}):((g=new be(function(w,N){var S=u(w,N,b);S&&S.then&&S.then(w,N)}))._lib=!0,g):Ct(new je.TransactionInactive)},cn.prototype._root=function(){return this.parent?this.parent._root():this},cn.prototype.waitFor=function(l){var u,m=this._root(),g=be.resolve(l),b=(m._waitingFor?m._waitingFor=m._waitingFor.then(function(){return g}):(m._waitingFor=g,m._waitingQueue=[],u=m.idbtrans.objectStore(m.storeNames[0]),(function w(){for(++m._spinCount;m._waitingQueue.length;)m._waitingQueue.shift()();m._waitingFor&&(u.get(-1/0).onsuccess=w)})()),m._waitingFor);return new be(function(w,N){g.then(function(S){return m._waitingQueue.push(ht(w.bind(null,S)))},function(S){return m._waitingQueue.push(ht(N.bind(null,S)))}).finally(function(){m._waitingFor===b&&(m._waitingFor=null)})})},cn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new je.Abort))},cn.prototype.table=function(l){var u=this._memoizedTables||(this._memoizedTables={});if(C(u,l))return u[l];var m=this.schema[l];if(m)return(m=new this.db.Table(l,m,this)).core=this.db.core.table(l),u[l]=m;throw new je.NotFound("Table "+l+" not part of transaction")},cn);function cn(){}function Ci(l,u,m,g,b,w,N,S){return{name:l,keyPath:u,unique:m,multi:g,auto:b,compound:w,src:(m&&!N?"&":"")+(g?"*":"")+(b?"++":"")+Ea(u),type:S}}function Ea(l){return typeof l=="string"?l:l?"["+[].join.call(l,"+")+"]":""}function Lr(l,u,m){return{name:l,primKey:u,indexes:m,mappedClass:null,idxByName:(g=function(b){return[b.name,b]},m.reduce(function(b,w,N){return w=g(w,N),w&&(b[w[0]]=w[1]),b},{}))};var g}var Hn=function(l){try{return l.only([[]]),Hn=function(){return[[]]},[[]]}catch{return Hn=function(){return Pr},Pr}};function xr(l){return l==null?function(){}:typeof l=="string"?(u=l).split(".").length===1?function(m){return m[u]}:function(m){return me(m,u)}:function(m){return me(m,l)};var u}function Qs(l){return[].slice.call(l)}var Xl=0;function Xs(l){return l==null?":id":typeof l=="string"?l:"[".concat(l.join("+"),"]")}function No(l,u,L){function g(I){if(I.type===3)return null;if(I.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var R=I.lower,B=I.upper,$=I.lowerOpen,I=I.upperOpen;return R===void 0?B===void 0?null:u.upperBound(B,!!I):B===void 0?u.lowerBound(R,!!$):u.bound(R,B,!!$,!!I)}function b(O){var R,B=O.name;return{name:B,schema:O,mutate:function($){var I=$.trans,D=$.type,J=$.keys,Q=$.values,H=$.range;return new Promise(function(te,oe){te=ht(te);var ve=I.objectStore(B),xe=ve.keyPath==null,le=D==="put"||D==="add";if(!le&&D!=="delete"&&D!=="deleteRange")throw new Error("Invalid operation type: "+D);var _e,ke=(J||Q||{length:1}).length;if(J&&Q&&J.length!==Q.length)throw new Error("Given keys array must have same length as given values array.");if(ke===0)return te({numFailures:0,failures:{},results:[],lastResult:void 0});function he(dt){++rt,Ys(dt)}var Ne=[],Xe=[],rt=0;if(D==="deleteRange"){if(H.type===4)return te({numFailures:rt,failures:Xe,results:[],lastResult:void 0});H.type===3?Ne.push(_e=ve.clear()):Ne.push(_e=ve.delete(g(H)))}else{var xe=le?xe?[Q,J]:[Q,null]:[J,null],Ie=xe[0],Je=xe[1];if(le)for(var yt=0;yt<ke;++yt)Ne.push(_e=Je&&Je[yt]!==void 0?ve[D](Ie[yt],Je[yt]):ve[D](Ie[yt])),_e.onerror=he;else for(yt=0;yt<ke;++yt)Ne.push(_e=ve[D](Ie[yt])),_e.onerror=he}function un(dt){dt=dt.target.result,Ne.forEach(function(Qn,ri){return Qn.error!=null&&(Xe[ri]=Qn.error)}),te({numFailures:rt,failures:Xe,results:D==="delete"?J:Ne.map(function(Qn){return Qn.result}),lastResult:dt})}_e.onerror=function(dt){he(dt),un(dt)},_e.onsuccess=un})},getMany:function($){var I=$.trans,D=$.keys;return new Promise(function(J,Q){J=ht(J);for(var H,te=I.objectStore(B),oe=D.length,ve=new Array(oe),xe=0,le=0,_e=function(Ne){Ne=Ne.target,ve[Ne._pos]=Ne.result,++le===xe&&J(ve)},ke=Lt(Q),he=0;he<oe;++he)D[he]!=null&&((H=te.get(D[he]))._pos=he,H.onsuccess=_e,H.onerror=ke,++xe);xe===0&&J(ve)})},get:function($){var I=$.trans,D=$.key;return new Promise(function(J,Q){J=ht(J);var H=I.objectStore(B).get(D);H.onsuccess=function(te){return J(te.target.result)},H.onerror=Lt(Q)})},query:(R=S,function($){return new Promise(function(I,D){I=ht(I);var J,Q,H,le=$.trans,te=$.values,oe=$.limit,xe=$.query,ve=oe===1/0?void 0:oe,_e=xe.index,xe=xe.range,le=le.objectStore(B),le=_e.isPrimaryKey?le:le.index(_e.name),_e=g(xe);if(oe===0)return I({result:[]});R?((xe=te?le.getAll(_e,ve):le.getAllKeys(_e,ve)).onsuccess=function(ke){return I({result:ke.target.result})},xe.onerror=Lt(D)):(J=0,Q=!te&&"openKeyCursor"in le?le.openKeyCursor(_e):le.openCursor(_e),H=[],Q.onsuccess=function(ke){var he=Q.result;return!he||(H.push(te?he.value:he.primaryKey),++J===oe)?I({result:H}):void he.continue()},Q.onerror=Lt(D))})}),openCursor:function($){var I=$.trans,D=$.values,J=$.query,Q=$.reverse,H=$.unique;return new Promise(function(te,oe){te=ht(te);var le=J.index,ve=J.range,xe=I.objectStore(B),xe=le.isPrimaryKey?xe:xe.index(le.name),le=Q?H?"prevunique":"prev":H?"nextunique":"next",_e=!D&&"openKeyCursor"in xe?xe.openKeyCursor(g(ve),le):xe.openCursor(g(ve),le);_e.onerror=Lt(oe),_e.onsuccess=ht(function(ke){var he,Ne,Xe,rt,Ie=_e.result;Ie?(Ie.___id=++Xl,Ie.done=!1,he=Ie.continue.bind(Ie),Ne=(Ne=Ie.continuePrimaryKey)&&Ne.bind(Ie),Xe=Ie.advance.bind(Ie),rt=function(){throw new Error("Cursor not stopped")},Ie.trans=I,Ie.stop=Ie.continue=Ie.continuePrimaryKey=Ie.advance=function(){throw new Error("Cursor not started")},Ie.fail=ht(oe),Ie.next=function(){var Je=this,yt=1;return this.start(function(){return yt--?Je.continue():Je.stop()}).then(function(){return Je})},Ie.start=function(Je){function yt(){if(_e.result)try{Je()}catch(dt){Ie.fail(dt)}else Ie.done=!0,Ie.start=function(){throw new Error("Cursor behind last entry")},Ie.stop()}var un=new Promise(function(dt,Qn){dt=ht(dt),_e.onerror=Lt(Qn),Ie.fail=Qn,Ie.stop=function(ri){Ie.stop=Ie.continue=Ie.continuePrimaryKey=Ie.advance=rt,dt(ri)}});return _e.onsuccess=ht(function(dt){_e.onsuccess=yt,yt()}),Ie.continue=he,Ie.continuePrimaryKey=Ne,Ie.advance=Xe,yt(),un},te(Ie)):te(null)},oe)})},count:function($){var I=$.query,D=$.trans,J=I.index,Q=I.range;return new Promise(function(H,te){var oe=D.objectStore(B),oe=J.isPrimaryKey?oe:oe.index(J.name),ve=g(Q),ve=ve?oe.count(ve):oe.count();ve.onsuccess=ht(function(xe){return H(xe.target.result)}),ve.onerror=Lt(te)})}}}w=L,N=Qs((L=l).objectStoreNames);var w,L={schema:{name:L.name,tables:N.map(function(O){return w.objectStore(O)}).map(function(O){var R=O.keyPath,B=O.autoIncrement,I=v(R),$={},I={name:O.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:R==null,compound:I,keyPath:R,autoIncrement:B,unique:!0,extractKey:xr(R)},indexes:Qs(O.indexNames).map(function(D){return O.index(D)}).map(function(H){var te=H.name,J=H.unique,Q=H.multiEntry,H=H.keyPath,te={name:te,compound:v(H),keyPath:H,unique:J,multiEntry:Q,extractKey:xr(H)};return $[Xs(H)]=te}),getIndexByKeyPath:function(D){return $[Xs(D)]}};return $[":id"]=I.primaryKey,R!=null&&($[Xs(R)]=I.primaryKey),I})},hasGetAll:0<N.length&&"getAll"in w.objectStore(N[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},N=L.schema,S=L.hasGetAll,L=N.tables.map(b),K={};return L.forEach(function(O){return K[O.name]=O}),{stack:"dbcore",transaction:l.transaction.bind(l),table:function(O){if(K[O])return K[O];throw new Error("Table '".concat(O,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Hn(u),schema:N}}function Fi(l,u,m,g){return m=m.IDBKeyRange,u=No(u,m,g),{dbcore:l.dbcore.reduce(function(b,w){return w=w.create,a(a({},b),w(b))},u)}}function hs(l,u){var m=u.db,m=Fi(l._middlewares,m,l._deps,u);l.core=m.dbcore,l.tables.forEach(function(g){var b=g.name;l.core.schema.tables.some(function(w){return w.name===b})&&(g.core=l.core.table(b),l[b]instanceof l.Table)&&(l[b].core=g.core)})}function Zs(l,u,m,g){m.forEach(function(b){var w=g[b];u.forEach(function(N){var S=(function L(K,O){return M(K,O)||(K=_(K))&&L(K,O)})(N,b);(!S||"value"in S&&S.value===void 0)&&(N===l.Transaction.prototype||N instanceof l.Transaction?A(N,b,{get:function(){return this.table(b)},set:function(L){T(this,b,{value:L,writable:!0,configurable:!0,enumerable:!0})}}):N[b]=new l.Table(b,w))})})}function Rn(l,u){u.forEach(function(m){for(var g in m)m[g]instanceof l.Table&&delete m[g]})}function So(l,u){return l._cfg.version-u._cfg.version}function Ei(l,u,m,g){var b=l._dbSchema,w=(m.objectStoreNames.contains("$meta")&&!b.$meta&&(b.$meta=Lr("$meta",ys("")[0],[]),l._storeNames.push("$meta")),l._createTransaction("readwrite",l._storeNames,b)),N=(w.create(m),w._completion.catch(g),w._reject.bind(w)),S=Ee.transless||Ee;hr(function(){if(Ee.trans=w,Ee.transless=S,u!==0)return hs(l,m),K=u,((L=w).storeNames.includes("$meta")?L.table("$meta").get("version").then(function(O){return O??K}):be.resolve(K)).then(function(J){var R=l,B=J,$=w,I=m,D=[],J=R._versions,Q=R._dbSchema=Vn(0,R.idbdb,I);return(J=J.filter(function(H){return H._cfg.version>=B})).length===0?be.resolve():(J.forEach(function(H){D.push(function(){var te,oe,ve,xe=Q,le=H._cfg.dbschema,_e=(ms(R,xe,I),ms(R,le,I),Q=R._dbSchema=le,fs(xe,le)),ke=(_e.add.forEach(function(he){ps(I,he[0],he[1].primKey,he[1].indexes)}),_e.change.forEach(function(he){if(he.recreate)throw new je.Upgrade("Not yet support for changing primary key");var Ne=I.objectStore(he.name);he.add.forEach(function(Xe){return zt(Ne,Xe)}),he.change.forEach(function(Xe){Ne.deleteIndex(Xe.name),zt(Ne,Xe)}),he.del.forEach(function(Xe){return Ne.deleteIndex(Xe)})}),H._cfg.contentUpgrade);if(ke&&H._cfg.version>B)return hs(R,I),$._memoizedTables={},te=ye(le),_e.del.forEach(function(he){te[he]=xe[he]}),Rn(R,[R.Transaction.prototype]),Zs(R,[R.Transaction.prototype],p(te),te),$.schema=te,(oe=W(ke))&&as(),le=be.follow(function(){var he;(ve=ke($))&&oe&&(he=nn.bind(null,null),ve.then(he,he))}),ve&&typeof ve.then=="function"?be.resolve(ve):le.then(function(){return ve})}),D.push(function(te){var oe,ve,xe=H._cfg.dbschema;oe=xe,ve=te,[].slice.call(ve.db.objectStoreNames).forEach(function(le){return oe[le]==null&&ve.db.deleteObjectStore(le)}),Rn(R,[R.Transaction.prototype]),Zs(R,[R.Transaction.prototype],R._storeNames,R._dbSchema),$.schema=R._dbSchema}),D.push(function(te){R.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(R.idbdb.version/10)===H._cfg.version?(R.idbdb.deleteObjectStore("$meta"),delete R._dbSchema.$meta,R._storeNames=R._storeNames.filter(function(oe){return oe!=="$meta"})):te.objectStore("$meta").put(H._cfg.version,"version"))})}),(function H(){return D.length?be.resolve(D.shift()($.idbtrans)).then(H):be.resolve()})().then(function(){Co(Q,I)}))}).catch(N);var L,K;p(b).forEach(function(O){ps(m,O,b[O].primKey,b[O].indexes)}),hs(l,m),be.follow(function(){return l.on.populate.fire(w)}).catch(N)})}function Aa(l,u){Co(l._dbSchema,u),u.db.version%10!=0||u.objectStoreNames.contains("$meta")||u.db.createObjectStore("$meta").add(Math.ceil(u.db.version/10-1),"version");var m=Vn(0,l.idbdb,u);ms(l,l._dbSchema,u);for(var g=0,b=fs(m,l._dbSchema).change;g<b.length;g++){var w=(N=>{if(N.change.length||N.recreate)return console.warn("Unable to patch indexes of table ".concat(N.name," because it has changes on the type of index or primary key.")),{value:void 0};var S=u.objectStore(N.name);N.add.forEach(function(L){Nt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(N.name,".").concat(L.src)),zt(S,L)})})(b[g]);if(typeof w=="object")return w.value}}function fs(l,u){var m,g={del:[],add:[],change:[]};for(m in l)u[m]||g.del.push(m);for(m in u){var b=l[m],w=u[m];if(b){var N={name:m,def:w,recreate:!1,del:[],add:[],change:[]};if(""+(b.primKey.keyPath||"")!=""+(w.primKey.keyPath||"")||b.primKey.auto!==w.primKey.auto)N.recreate=!0,g.change.push(N);else{var S=b.idxByName,L=w.idxByName,K=void 0;for(K in S)L[K]||N.del.push(K);for(K in L){var O=S[K],R=L[K];O?O.src!==R.src&&N.change.push(R):N.add.push(R)}(0<N.del.length||0<N.add.length||0<N.change.length)&&g.change.push(N)}}else g.add.push([m,w])}return g}function ps(l,u,m,g){var b=l.db.createObjectStore(u,m.keyPath?{keyPath:m.keyPath,autoIncrement:m.auto}:{autoIncrement:m.auto});g.forEach(function(w){return zt(b,w)})}function Co(l,u){p(l).forEach(function(m){u.db.objectStoreNames.contains(m)||(Nt&&console.debug("Dexie: Creating missing table",m),ps(u,m,l[m].primKey,l[m].indexes))})}function zt(l,u){l.createIndex(u.name,u.keyPath,{unique:u.unique,multiEntry:u.multi})}function Vn(l,u,m){var g={};return Z(u.objectStoreNames,0).forEach(function(b){for(var w=m.objectStore(b),N=Ci(Ea(K=w.keyPath),K||"",!0,!1,!!w.autoIncrement,K&&typeof K!="string",!0),S=[],L=0;L<w.indexNames.length;++L){var O=w.index(w.indexNames[L]),K=O.keyPath,O=Ci(O.name,K,!!O.unique,!!O.multiEntry,!1,K&&typeof K!="string",!1);S.push(O)}g[b]=Lr(b,N,S)}),g}function ms(l,u,m){for(var g=m.db.objectStoreNames,b=0;b<g.length;++b){var w=g[b],N=m.objectStore(w);l._hasGetAll="getAll"in N;for(var S=0;S<N.indexNames.length;++S){var L,K=N.indexNames[S],O=N.index(K).keyPath,O=typeof O=="string"?O:"["+Z(O).join("+")+"]";u[w]&&(L=u[w].idxByName[O])&&(L.name=K,delete u[w].idxByName[O],u[w].idxByName[K]=L)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&h.WorkerGlobalScope&&h instanceof h.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(l._hasGetAll=!1)}function ys(l){return l.split(",").map(function(u,m){var b=u.split(":"),g=(g=b[1])==null?void 0:g.trim(),b=(u=b[0].trim()).replace(/([&*]|\+\+)/g,""),w=/^\[/.test(b)?b.match(/^\[(.*)\]$/)[1].split("+"):b;return Ci(b,w||null,/\&/.test(u),/\*/.test(u),/\+\+/.test(u),v(w),m===0,g)})}br.prototype._createTableSchema=Lr,br.prototype._parseIndexSyntax=ys,br.prototype._parseStoresSpec=function(l,u){var m=this;p(l).forEach(function(g){if(l[g]!==null){var b=m._parseIndexSyntax(l[g]),w=b.shift();if(!w)throw new je.Schema("Invalid schema for table "+g+": "+l[g]);if(w.unique=!0,w.multi)throw new je.Schema("Primary key cannot be multiEntry*");b.forEach(function(N){if(N.auto)throw new je.Schema("Only primary key can be marked as autoIncrement (++)");if(!N.keyPath)throw new je.Schema("Index must have a name and cannot be an empty string")}),w=m._createTableSchema(g,w,b),u[g]=w}})},br.prototype.stores=function(m){var u=this.db,m=(this._cfg.storesSource=this._cfg.storesSource?x(this._cfg.storesSource,m):m,u._versions),g={},b={};return m.forEach(function(w){x(g,w._cfg.storesSource),b=w._cfg.dbschema={},w._parseStoresSpec(g,b)}),u._dbSchema=b,Rn(u,[u._allTables,u,u.Transaction.prototype]),Zs(u,[u._allTables,u,u.Transaction.prototype,this._cfg.tables],p(b),b),u._storeNames=p(b),this},br.prototype.upgrade=function(l){return this._cfg.contentUpgrade=$n(this._cfg.contentUpgrade||it,l),this};var Zl=br;function br(){}function ei(l,u){var m=l._dbNamesDB;return m||(m=l._dbNamesDB=new Jn(Ws,{addons:[],indexedDB:l,IDBKeyRange:u})).version(1).stores({dbnames:"name"}),m.table("dbnames")}function Br(l){return l&&typeof l.databases=="function"}function gs(l){return hr(function(){return Ee.letThrough=!0,l()})}function Ai(l){return!("from"in l)}var qt=function(l,u){var m;if(!this)return m=new qt,l&&"d"in l&&x(m,l),m;x(this,arguments.length?{d:1,from:l,to:1<arguments.length?u:l}:{d:0})};function ti(l,u,m){var g=Ke(u,m);if(!isNaN(g)){if(0<g)throw RangeError();if(Ai(l))return x(l,{from:u,to:m,d:1});var g=l.l,b=l.r;if(Ke(m,l.from)<0)return g?ti(g,u,m):l.l={from:u,to:m,d:1,l:null,r:null},Ta(l);if(0<Ke(u,l.to))return b?ti(b,u,m):l.r={from:u,to:m,d:1,l:null,r:null},Ta(l);Ke(u,l.from)<0&&(l.from=u,l.l=null,l.d=b?b.d+1:1),0<Ke(m,l.to)&&(l.to=m,l.r=null,l.d=l.l?l.l.d+1:1),u=!l.r,g&&!l.l&&ni(l,g),b&&u&&ni(l,b)}}function ni(l,u){Ai(u)||(function m(g,b){var w=b.from,N=b.l,S=b.r;ti(g,w,b.to),N&&m(g,N),S&&m(g,S)})(l,u)}function Ti(l,u){var m=Ri(u),g=m.next();if(!g.done)for(var b=g.value,w=Ri(l),N=w.next(b.from),S=N.value;!g.done&&!N.done;){if(Ke(S.from,b.to)<=0&&0<=Ke(S.to,b.from))return!0;Ke(b.from,S.from)<0?b=(g=m.next(S.from)).value:S=(N=w.next(b.from)).value}return!1}function Ri(l){var u=Ai(l)?null:{s:0,n:l};return{next:function(m){for(var g=0<arguments.length;u;)switch(u.s){case 0:if(u.s=1,g)for(;u.n.l&&Ke(m,u.n.from)<0;)u={up:u,n:u.n.l,s:1};else for(;u.n.l;)u={up:u,n:u.n.l,s:1};case 1:if(u.s=2,!g||Ke(m,u.n.to)<=0)return{value:u.n,done:!1};case 2:if(u.n.r){u.s=3,u={up:u,n:u.n.r,s:0};continue}case 3:u=u.up}return{done:!0}}}}function Ta(l){var u,m,g,b=(((b=l.r)==null?void 0:b.d)||0)-(((b=l.l)==null?void 0:b.d)||0),b=1<b?"r":b<-1?"l":"";b&&(u=b=="r"?"l":"r",m=a({},l),g=l[b],l.from=g.from,l.to=g.to,l[b]=g[b],m[b]=g[u],(l[u]=m).d=Ra(m)),l.d=Ra(l)}function Ra(m){var u=m.r,m=m.l;return(u?m?Math.max(u.d,m.d):u.d:m?m.d:0)+1}function Pi(l,u){return p(u).forEach(function(m){l[m]?ni(l[m],u[m]):l[m]=(function g(b){var w,N,S={};for(w in b)C(b,w)&&(N=b[w],S[w]=!N||typeof N!="object"||st.has(N.constructor)?N:g(N));return S})(u[m])}),l}function Fo(l,u){return l.all||u.all||Object.keys(l).some(function(m){return u[m]&&Ti(u[m],l[m])})}F(qt.prototype,((wt={add:function(l){return ni(this,l),this},addKey:function(l){return ti(this,l,l),this},addKeys:function(l){var u=this;return l.forEach(function(m){return ti(u,m,m)}),this},hasKey:function(l){var u=Ri(this).next(l).value;return u&&Ke(u.from,l)<=0&&0<=Ke(u.to,l)}})[ft]=function(){return Ri(this)},wt));var wr={},Eo={},Ao=!1;function Oi(l){Pi(Eo,l),Ao||(Ao=!0,setTimeout(function(){Ao=!1,To(Eo,!(Eo={}))},0))}function To(l,u){u===void 0&&(u=!1);var m=new Set;if(l.all)for(var g=0,b=Object.values(wr);g<b.length;g++)Di(S=b[g],l,m,u);else for(var w in l){var N,S,w=/^idb\:\/\/(.*)\/(.*)\//.exec(w);w&&(N=w[1],w=w[2],S=wr["idb://".concat(N,"/").concat(w)])&&Di(S,l,m,u)}m.forEach(function(L){return L()})}function Di(l,u,m,g){for(var b=[],w=0,N=Object.entries(l.queries.query);w<N.length;w++){for(var S=N[w],L=S[0],K=[],O=0,R=S[1];O<R.length;O++){var B=R[O];Fo(u,B.obsSet)?B.subscribers.forEach(function(J){return m.add(J)}):g&&K.push(B)}g&&b.push([L,K])}if(g)for(var $=0,I=b;$<I.length;$++){var D=I[$],L=D[0],K=D[1];l.queries.query[L]=K}}function ec(l){var u=l._state,m=l._deps.indexedDB;if(u.isBeingOpened||l.idbdb)return u.dbReadyPromise.then(function(){return u.dbOpenError?Ct(u.dbOpenError):l});u.isBeingOpened=!0,u.dbOpenError=null,u.openComplete=!1;var g=u.openCanceller,b=Math.round(10*l.verno),w=!1;function N(){if(u.openCanceller!==g)throw new je.DatabaseClosed("db.open() was cancelled")}function S(){return new be(function(B,$){if(N(),!m)throw new je.MissingAPI;var I=l.name,D=u.autoSchema||!b?m.open(I):m.open(I,b);if(!D)throw new je.MissingAPI;D.onerror=Lt($),D.onblocked=ht(l._fireOnBlocked),D.onupgradeneeded=ht(function(J){var Q;O=D.transaction,u.autoSchema&&!l._options.allowEmptyDB?(D.onerror=Ys,O.abort(),D.result.close(),(Q=m.deleteDatabase(I)).onsuccess=Q.onerror=ht(function(){$(new je.NoSuchDatabase("Database ".concat(I," doesnt exist")))})):(O.onerror=Lt($),Q=J.oldVersion>Math.pow(2,62)?0:J.oldVersion,R=Q<1,l.idbdb=D.result,w&&Aa(l,O),Ei(l,Q/10,O,$))},$),D.onsuccess=ht(function(){O=null;var J,Q,H,te,oe,ve,xe=l.idbdb=D.result,le=Z(xe.objectStoreNames);if(0<le.length)try{var _e=xe.transaction((oe=le).length===1?oe[0]:oe,"readonly");if(u.autoSchema)ve=xe,te=_e,(H=l).verno=ve.version/10,te=H._dbSchema=Vn(0,ve,te),H._storeNames=Z(ve.objectStoreNames,0),Zs(H,[H._allTables],p(te),te);else if(ms(l,l._dbSchema,_e),Q=_e,((Q=fs(Vn(0,(J=l).idbdb,Q),J._dbSchema)).add.length||Q.change.some(function(ke){return ke.add.length||ke.change.length}))&&!w)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),xe.close(),b=xe.version+1,w=!0,B(S());hs(l,_e)}catch{}mr.push(l),xe.onversionchange=ht(function(ke){u.vcFired=!0,l.on("versionchange").fire(ke)}),xe.onclose=ht(function(){l.close({disableAutoOpen:!1})}),R&&(le=l._deps,oe=I,Br(ve=le.indexedDB)||oe===Ws||ei(ve,le.IDBKeyRange).put({name:oe}).catch(it)),B()},$)}).catch(function(B){switch(B?.name){case"UnknownError":if(0<u.PR1398_maxLoop)return u.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),S();break;case"VersionError":if(0<b)return b=0,S()}return be.reject(B)})}var L,K=u.dbReadyResolve,O=null,R=!1;return be.race([g,(typeof navigator>"u"?be.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(B){function $(){return indexedDB.databases().finally(B)}L=setInterval($,100),$()}).finally(function(){return clearInterval(L)}):Promise.resolve()).then(S)]).then(function(){return N(),u.onReadyBeingFired=[],be.resolve(gs(function(){return l.on.ready.fire(l.vip)})).then(function B(){var $;if(0<u.onReadyBeingFired.length)return $=u.onReadyBeingFired.reduce($n,it),u.onReadyBeingFired=[],be.resolve(gs(function(){return $(l.vip)})).then(B)})}).finally(function(){u.openCanceller===g&&(u.onReadyBeingFired=null,u.isBeingOpened=!1)}).catch(function(B){u.dbOpenError=B;try{O&&O.abort()}catch{}return g===u.openCanceller&&l._close(),Ct(B)}).finally(function(){u.openComplete=!0,K()}).then(function(){var B;return R&&(B={},l.tables.forEach(function($){$.schema.indexes.forEach(function(I){I.name&&(B["idb://".concat(l.name,"/").concat($.name,"/").concat(I.name)]=new qt(-1/0,[[[]]]))}),B["idb://".concat(l.name,"/").concat($.name,"/")]=B["idb://".concat(l.name,"/").concat($.name,"/:dels")]=new qt(-1/0,[[[]]])}),vr(ds).fire(B),To(B,!0)),l})}function Ro(l){function u(w){return l.next(w)}var m=b(u),g=b(function(w){return l.throw(w)});function b(w){return function(S){var S=w(S),L=S.value;return S.done?L:L&&typeof L.then=="function"?L.then(m,g):v(L)?Promise.all(L).then(m,g):m(L)}}return b(u)()}function Ii(l,u,m){for(var g=v(l)?l.slice():[l],b=0;b<m;++b)g.push(u);return g}var Pa={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(l){return a(a({},l),{table:function(g){var m=l.table(g),g=m.schema,b={},w=[];function N(B,$,I){var H=Xs(B),D=b[H]=b[H]||[],J=B==null?0:typeof B=="string"?1:B.length,Q=0<$,H=a(a({},I),{name:Q?"".concat(H,"(virtual-from:").concat(I.name,")"):I.name,lowLevelIndex:I,isVirtual:Q,keyTail:$,keyLength:J,extractKey:xr(B),unique:!Q&&I.unique});return D.push(H),H.isPrimaryKey||w.push(H),1<J&&N(J===2?B[0]:B.slice(0,J-1),$+1,I),D.sort(function(te,oe){return te.keyTail-oe.keyTail}),H}var S=N(g.primaryKey.keyPath,0,g.primaryKey);b[":id"]=[S];for(var L=0,K=g.indexes;L<K.length;L++){var O=K[L];N(O.keyPath,0,O)}function R(B){var $,I=B.query.index;return I.isVirtual?a(a({},B),{query:{index:I.lowLevelIndex,range:($=B.query.range,I=I.keyTail,{type:$.type===1?2:$.type,lower:Ii($.lower,$.lowerOpen?l.MAX_KEY:l.MIN_KEY,I),lowerOpen:!0,upper:Ii($.upper,$.upperOpen?l.MIN_KEY:l.MAX_KEY,I),upperOpen:!0})}}):B}return a(a({},m),{schema:a(a({},g),{primaryKey:S,indexes:w,getIndexByKeyPath:function(B){return(B=b[Xs(B)])&&B[0]}}),count:function(B){return m.count(R(B))},query:function(B){return m.query(R(B))},openCursor:function(B){var $=B.query.index,I=$.keyTail,D=$.keyLength;return $.isVirtual?m.openCursor(R(B)).then(function(Q){return Q&&J(Q)}):m.openCursor(B);function J(Q){return Object.create(Q,{continue:{value:function(H){H!=null?Q.continue(Ii(H,B.reverse?l.MAX_KEY:l.MIN_KEY,I)):B.unique?Q.continue(Q.key.slice(0,D).concat(B.reverse?l.MIN_KEY:l.MAX_KEY,I)):Q.continue()}},continuePrimaryKey:{value:function(H,te){Q.continuePrimaryKey(Ii(H,l.MAX_KEY,I),te)}},primaryKey:{get:function(){return Q.primaryKey}},key:{get:function(){var H=Q.key;return D===1?H[0]:H.slice(0,D)}},value:{get:function(){return Q.value}}})}}})}})}};function Po(l,u,m,g){return m=m||{},g=g||"",p(l).forEach(function(b){var w,N,S;C(u,b)?(w=l[b],N=u[b],typeof w=="object"&&typeof N=="object"&&w&&N?(S=Tt(w))!==Tt(N)?m[g+b]=u[b]:S==="Object"?Po(w,N,m,g+b+"."):w!==N&&(m[g+b]=u[b]):w!==N&&(m[g+b]=u[b])):m[g+b]=void 0}),p(u).forEach(function(b){C(l,b)||(m[g+b]=u[b])}),m}function Oo(l,u){return u.type==="delete"?u.keys:u.keys||u.values.map(l.extractKey)}var tc={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(l){return a(a({},l),{table:function(u){var m=l.table(u),g=m.schema.primaryKey;return a(a({},m),{mutate:function(b){var w=Ee.trans,N=w.table(u).hook,S=N.deleting,L=N.creating,K=N.updating;switch(b.type){case"add":if(L.fire===it)break;return w._promise("readwrite",function(){return O(b)},!0);case"put":if(L.fire===it&&K.fire===it)break;return w._promise("readwrite",function(){return O(b)},!0);case"delete":if(S.fire===it)break;return w._promise("readwrite",function(){return O(b)},!0);case"deleteRange":if(S.fire===it)break;return w._promise("readwrite",function(){return(function R(B,$,I){return m.query({trans:B,values:!1,query:{index:g,range:$},limit:I}).then(function(D){var J=D.result;return O({type:"delete",keys:J,trans:B}).then(function(Q){return 0<Q.numFailures?Promise.reject(Q.failures[0]):J.length<I?{failures:[],numFailures:0,lastResult:void 0}:R(B,a(a({},$),{lower:J[J.length-1],lowerOpen:!0}),I)})})})(b.trans,b.range,1e4)},!0)}return m.mutate(b);function O(R){var B,$,I,D=Ee.trans,J=R.keys||Oo(g,R);if(J)return(R=R.type==="add"||R.type==="put"?a(a({},R),{keys:J}):a({},R)).type!=="delete"&&(R.values=d([],R.values)),R.keys&&(R.keys=d([],R.keys)),B=m,I=J,(($=R).type==="add"?Promise.resolve([]):B.getMany({trans:$.trans,keys:I,cache:"immutable"})).then(function(Q){var H=J.map(function(te,oe){var ve,xe,le,_e=Q[oe],ke={onerror:null,onsuccess:null};return R.type==="delete"?S.fire.call(ke,te,_e,D):R.type==="add"||_e===void 0?(ve=L.fire.call(ke,te,R.values[oe],D),te==null&&ve!=null&&(R.keys[oe]=te=ve,g.outbound||fe(R.values[oe],g.keyPath,te))):(ve=Po(_e,R.values[oe]),(xe=K.fire.call(ke,ve,te,_e,D))&&(le=R.values[oe],Object.keys(xe).forEach(function(he){C(le,he)?le[he]=xe[he]:fe(le,he,xe[he])}))),ke});return m.mutate(R).then(function(te){for(var oe=te.failures,ve=te.results,xe=te.numFailures,te=te.lastResult,le=0;le<J.length;++le){var _e=(ve||J)[le],ke=H[le];_e==null?ke.onerror&&ke.onerror(oe[le]):ke.onsuccess&&ke.onsuccess(R.type==="put"&&Q[le]?R.values[le]:_e)}return{failures:oe,results:ve,numFailures:xe,lastResult:te}}).catch(function(te){return H.forEach(function(oe){return oe.onerror&&oe.onerror(te)}),Promise.reject(te)})});throw new Error("Keys missing")}}})}})}};function Oa(l,u,m){try{if(!u||u.keys.length<l.length)return null;for(var g=[],b=0,w=0;b<u.keys.length&&w<l.length;++b)Ke(u.keys[b],l[w])===0&&(g.push(m?lt(u.values[b]):u.values[b]),++w);return g.length===l.length?g:null}catch{return null}}var nc={stack:"dbcore",level:-1,create:function(l){return{table:function(u){var m=l.table(u);return a(a({},m),{getMany:function(g){var b;return g.cache?(b=Oa(g.keys,g.trans._cache,g.cache==="clone"))?be.resolve(b):m.getMany(g).then(function(w){return g.trans._cache={keys:g.keys,values:g.cache==="clone"?lt(w):w},w}):m.getMany(g)},mutate:function(g){return g.type!=="add"&&(g.trans._cache=null),m.mutate(g)}})}}}};function Da(l,u){return l.trans.mode==="readonly"&&!!l.subscr&&!l.trans.explicit&&l.trans.db._options.cache!=="disabled"&&!u.schema.primaryKey.outbound}function Ia(l,u){switch(l){case"query":return u.values&&!u.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Do={stack:"dbcore",level:0,name:"Observability",create:function(l){var u=l.schema.name,m=new qt(l.MIN_KEY,l.MAX_KEY);return a(a({},l),{transaction:function(g,b,w){if(Ee.subscr&&b!=="readonly")throw new je.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ee.querier));return l.transaction(g,b,w)},table:function(g){function b(J){var D,J=J.query;return[D=J.index,new qt((D=(J=J.range).lower)!=null?D:l.MIN_KEY,(D=J.upper)!=null?D:l.MAX_KEY)]}var w=l.table(g),N=w.schema,S=N.primaryKey,L=N.indexes,K=S.extractKey,O=S.outbound,R=S.autoIncrement&&L.filter(function(I){return I.compound&&I.keyPath.includes(S.keyPath)}),B=a(a({},w),{mutate:function(I){function D(Ne){return Ne="idb://".concat(u,"/").concat(g,"/").concat(Ne),oe[Ne]||(oe[Ne]=new qt)}var J,Q,H,te=I.trans,oe=I.mutatedParts||(I.mutatedParts={}),ve=D(""),xe=D(":dels"),le=I.type,ke=I.type==="deleteRange"?[I.range]:I.type==="delete"?[I.keys]:I.values.length<50?[Oo(S,I).filter(function(Ne){return Ne}),I.values]:[],_e=ke[0],ke=ke[1],he=I.trans._cache;return v(_e)?(ve.addKeys(_e),(le=le==="delete"||_e.length===ke.length?Oa(_e,he):null)||xe.addKeys(_e),(le||ke)&&(J=D,Q=le,H=ke,N.indexes.forEach(function(Ne){var Xe=J(Ne.name||"");function rt(Je){return Je!=null?Ne.extractKey(Je):null}function Ie(Je){Ne.multiEntry&&v(Je)?Je.forEach(function(yt){return Xe.addKey(yt)}):Xe.addKey(Je)}(Q||H).forEach(function(Je,dt){var un=Q&&rt(Q[dt]),dt=H&&rt(H[dt]);Ke(un,dt)!==0&&(un!=null&&Ie(un),dt!=null)&&Ie(dt)})}))):_e?(ke={from:(he=_e.lower)!=null?he:l.MIN_KEY,to:(le=_e.upper)!=null?le:l.MAX_KEY},xe.add(ke),ve.add(ke)):(ve.add(m),xe.add(m),N.indexes.forEach(function(Ne){return D(Ne.name).add(m)})),w.mutate(I).then(function(Ne){return!_e||I.type!=="add"&&I.type!=="put"||(ve.addKeys(Ne.results),R&&R.forEach(function(Xe){for(var rt=I.values.map(function(un){return Xe.extractKey(un)}),Ie=Xe.keyPath.findIndex(function(un){return un===S.keyPath}),Je=0,yt=Ne.results.length;Je<yt;++Je)rt[Je][Ie]=Ne.results[Je];D(Xe.name).addKeys(rt)})),te.mutatedParts=Pi(te.mutatedParts||{},oe),Ne})}}),$={get:function(I){return[S,new qt(I.key)]},getMany:function(I){return[S,new qt().addKeys(I.keys)]},count:b,query:b,openCursor:b};return p($).forEach(function(I){B[I]=function(D){var J=Ee.subscr,Q=!!J,H=Da(Ee,w)&&Ia(I,D)?D.obsSet={}:J;if(Q){var te,J=function(ke){return ke="idb://".concat(u,"/").concat(g,"/").concat(ke),H[ke]||(H[ke]=new qt)},oe=J(""),ve=J(":dels"),Q=$[I](D),xe=Q[0],Q=Q[1];if((I==="query"&&xe.isPrimaryKey&&!D.values?ve:J(xe.name||"")).add(Q),!xe.isPrimaryKey){if(I!=="count")return te=I==="query"&&O&&D.values&&w.query(a(a({},D),{values:!1})),w[I].apply(this,arguments).then(function(ke){if(I==="query"){if(O&&D.values)return te.then(function(rt){return rt=rt.result,oe.addKeys(rt),ke});var he=D.values?ke.result.map(K):ke.result;(D.values?oe:ve).addKeys(he)}else{var Ne,Xe;if(I==="openCursor")return Xe=D.values,(Ne=ke)&&Object.create(Ne,{key:{get:function(){return ve.addKey(Ne.primaryKey),Ne.key}},primaryKey:{get:function(){var rt=Ne.primaryKey;return ve.addKey(rt),rt}},value:{get:function(){return Xe&&oe.addKey(Ne.primaryKey),Ne.value}}})}return ke});ve.add(m)}}return w[I].apply(this,arguments)}}),B}})}};function vs(l,u,m){var g;return m.numFailures===0?u:u.type==="deleteRange"||(g=u.keys?u.keys.length:"values"in u&&u.values?u.values.length:1,m.numFailures===g)?null:(g=a({},u),v(g.keys)&&(g.keys=g.keys.filter(function(b,w){return!(w in m.failures)})),"values"in g&&v(g.values)&&(g.values=g.values.filter(function(b,w){return!(w in m.failures)})),g)}function Io(l,u){return m=l,((g=u).lower===void 0||(g.lowerOpen?0<Ke(m,g.lower):0<=Ke(m,g.lower)))&&(m=l,(g=u).upper===void 0||(g.upperOpen?Ke(m,g.upper)<0:Ke(m,g.upper)<=0));var m,g}function Mo(l,u,m,g,b,w){var N,S,L,K,O,R;return!m||m.length===0||(N=u.query.index,S=N.multiEntry,L=u.query.range,K=g.schema.primaryKey.extractKey,O=N.extractKey,R=(N.lowLevelIndex||N).extractKey,(g=m.reduce(function(B,$){var I=B,D=[];if($.type==="add"||$.type==="put")for(var J=new qt,Q=$.values.length-1;0<=Q;--Q){var H,te=$.values[Q],oe=K(te);!J.hasKey(oe)&&(H=O(te),S&&v(H)?H.some(function(ke){return Io(ke,L)}):Io(H,L))&&(J.addKey(oe),D.push(te))}switch($.type){case"add":var ve=new qt().addKeys(u.values?B.map(function(he){return K(he)}):B),I=B.concat(u.values?D.filter(function(he){return he=K(he),!ve.hasKey(he)&&(ve.addKey(he),!0)}):D.map(function(he){return K(he)}).filter(function(he){return!ve.hasKey(he)&&(ve.addKey(he),!0)}));break;case"put":var xe=new qt().addKeys($.values.map(function(he){return K(he)}));I=B.filter(function(he){return!xe.hasKey(u.values?K(he):he)}).concat(u.values?D:D.map(function(he){return K(he)}));break;case"delete":var le=new qt().addKeys($.keys);I=B.filter(function(he){return!le.hasKey(u.values?K(he):he)});break;case"deleteRange":var _e=$.range;I=B.filter(function(he){return!Io(K(he),_e)})}return I},l))===l)?l:(g.sort(function(B,$){return Ke(R(B),R($))||Ke(K(B),K($))}),u.limit&&u.limit<1/0&&(g.length>u.limit?g.length=u.limit:l.length===u.limit&&g.length<u.limit&&(b.dirty=!0)),w?Object.freeze(g):g)}function Lo(l,u){return Ke(l.lower,u.lower)===0&&Ke(l.upper,u.upper)===0&&!!l.lowerOpen==!!u.lowerOpen&&!!l.upperOpen==!!u.upperOpen}function Ma(l,u){return((m,g,b,w)=>{if(m===void 0)return g!==void 0?-1:0;if(g===void 0)return 1;if((m=Ke(m,g))===0){if(b&&w)return 0;if(b)return 1;if(w)return-1}return m})(l.lower,u.lower,l.lowerOpen,u.lowerOpen)<=0&&0<=((m,g,b,w)=>{if(m===void 0)return g!==void 0?1:0;if(g===void 0)return-1;if((m=Ke(m,g))===0){if(b&&w)return 0;if(b)return-1;if(w)return 1}return m})(l.upper,u.upper,l.upperOpen,u.upperOpen)}function La(l,u,m,g){l.subscribers.add(m),g.addEventListener("abort",function(){var b,w;l.subscribers.delete(m),l.subscribers.size===0&&(b=l,w=u,setTimeout(function(){b.subscribers.size===0&&de(w,b)},3e3))})}var Ba={stack:"dbcore",level:0,name:"Cache",create:function(l){var u=l.schema.name;return a(a({},l),{transaction:function(m,g,b){var w,N,S=l.transaction(m,g,b);return g==="readwrite"&&(b=(w=new AbortController).signal,S.addEventListener("abort",(N=function(L){return function(){if(w.abort(),g==="readwrite"){for(var K=new Set,O=0,R=m;O<R.length;O++){var B=R[O],$=wr["idb://".concat(u,"/").concat(B)];if($){var I=l.table(B),D=$.optimisticOps.filter(function(Ne){return Ne.trans===S});if(S._explicit&&L&&S.mutatedParts)for(var J=0,Q=Object.values($.queries.query);J<Q.length;J++)for(var H=0,te=(xe=Q[J]).slice();H<te.length;H++)Fo((le=te[H]).obsSet,S.mutatedParts)&&(de(xe,le),le.subscribers.forEach(function(Ne){return K.add(Ne)}));else if(0<D.length){$.optimisticOps=$.optimisticOps.filter(function(Ne){return Ne.trans!==S});for(var oe=0,ve=Object.values($.queries.query);oe<ve.length;oe++)for(var xe,le,_e,ke=0,he=(xe=ve[oe]).slice();ke<he.length;ke++)(le=he[ke]).res!=null&&S.mutatedParts&&(L&&!le.dirty?(_e=Object.isFrozen(le.res),_e=Mo(le.res,le.req,D,I,le,_e),le.dirty?(de(xe,le),le.subscribers.forEach(function(Ne){return K.add(Ne)})):_e!==le.res&&(le.res=_e,le.promise=be.resolve({result:_e}))):(le.dirty&&de(xe,le),le.subscribers.forEach(function(Ne){return K.add(Ne)})))}}}K.forEach(function(Ne){return Ne()})}}})(!1),{signal:b}),S.addEventListener("error",N(!1),{signal:b}),S.addEventListener("complete",N(!0),{signal:b})),S},table:function(m){var g=l.table(m),b=g.schema.primaryKey;return a(a({},g),{mutate:function(w){var N,S=Ee.trans;return!b.outbound&&S.db._options.cache!=="disabled"&&!S.explicit&&S.idbtrans.mode==="readwrite"&&(N=wr["idb://".concat(u,"/").concat(m)])?(S=g.mutate(w),w.type!=="add"&&w.type!=="put"||!(50<=w.values.length||Oo(b,w).some(function(L){return L==null}))?(N.optimisticOps.push(w),w.mutatedParts&&Oi(w.mutatedParts),S.then(function(L){0<L.numFailures&&(de(N.optimisticOps,w),(L=vs(0,w,L))&&N.optimisticOps.push(L),w.mutatedParts)&&Oi(w.mutatedParts)}),S.catch(function(){de(N.optimisticOps,w),w.mutatedParts&&Oi(w.mutatedParts)})):S.then(function(L){var K=vs(0,a(a({},w),{values:w.values.map(function(O,R){var B;return L.failures[R]?O:(fe(B=(B=b.keyPath)!=null&&B.includes(".")?lt(O):a({},O),b.keyPath,L.results[R]),B)})}),L);N.optimisticOps.push(K),queueMicrotask(function(){return w.mutatedParts&&Oi(w.mutatedParts)})}),S):g.mutate(w)},query:function(w){var N,S,L,K,O,R,B;return Da(Ee,g)&&Ia("query",w)?(N=((L=Ee.trans)==null?void 0:L.db._options.cache)==="immutable",S=(L=Ee).requery,L=L.signal,R=(($,I,D,J)=>{var Q=wr["idb://".concat($,"/").concat(I)];if(!Q)return[];if(!($=Q.queries[D]))return[null,!1,Q,null];var H=$[(J.query?J.query.index.name:null)||""];if(!H)return[null,!1,Q,null];switch(D){case"query":var te=H.find(function(oe){return oe.req.limit===J.limit&&oe.req.values===J.values&&Lo(oe.req.query.range,J.query.range)});return te?[te,!0,Q,H]:[H.find(function(oe){return("limit"in oe.req?oe.req.limit:1/0)>=J.limit&&(!J.values||oe.req.values)&&Ma(oe.req.query.range,J.query.range)}),!1,Q,H];case"count":return te=H.find(function(oe){return Lo(oe.req.query.range,J.query.range)}),[te,!!te,Q,H]}})(u,m,"query",w),B=R[0],K=R[2],O=R[3],B&&R[1]?B.obsSet=w.obsSet:(R=g.query(w).then(function($){var I=$.result;if(B&&(B.res=I),N){for(var D=0,J=I.length;D<J;++D)Object.freeze(I[D]);Object.freeze(I)}else $.result=lt(I);return $}).catch(function($){return O&&B&&de(O,B),Promise.reject($)}),B={obsSet:w.obsSet,promise:R,subscribers:new Set,type:"query",req:w,dirty:!1},O?O.push(B):(O=[B],(K=K||(wr["idb://".concat(u,"/").concat(m)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[w.query.index.name||""]=O)),La(B,O,S,L),B.promise.then(function($){return{result:Mo($.result,w,K?.optimisticOps,g,B,N)}})):g.query(w)}})}})}};function Gn(l,u){return new Proxy(l,{get:function(m,g,b){return g==="db"?u:Reflect.get(m,g,b)}})}Ft.prototype.version=function(l){if(isNaN(l)||l<.1)throw new je.Type("Given version is not a positive number");if(l=Math.round(10*l)/10,this.idbdb||this._state.isBeingOpened)throw new je.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,l);var u=this._versions,m=u.filter(function(g){return g._cfg.version===l})[0];return m||(m=new this.Version(l),u.push(m),u.sort(So),m.stores({}),this._state.autoSchema=!1),m},Ft.prototype._whenReady=function(l){var u=this;return this.idbdb&&(this._state.openComplete||Ee.letThrough||this._vip)?l():new be(function(m,g){if(u._state.openComplete)return g(new je.DatabaseClosed(u._state.dbOpenError));if(!u._state.isBeingOpened){if(!u._state.autoOpen)return void g(new je.DatabaseClosed);u.open().catch(it)}u._state.dbReadyPromise.then(m,g)}).then(l)},Ft.prototype.use=function(b){var u=b.stack,m=b.create,g=b.level,b=b.name,w=(b&&this.unuse({stack:u,name:b}),this._middlewares[u]||(this._middlewares[u]=[]));return w.push({stack:u,create:m,level:g??10,name:b}),w.sort(function(N,S){return N.level-S.level}),this},Ft.prototype.unuse=function(l){var u=l.stack,m=l.name,g=l.create;return u&&this._middlewares[u]&&(this._middlewares[u]=this._middlewares[u].filter(function(b){return g?b.create!==g:!!m&&b.name!==m})),this},Ft.prototype.open=function(){var l=this;return pr(jn,function(){return ec(l)})},Ft.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var l=this._state,u=mr.indexOf(this);if(0<=u&&mr.splice(u,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}l.isBeingOpened||(l.dbReadyPromise=new be(function(m){l.dbReadyResolve=m}),l.openCanceller=new be(function(m,g){l.cancelOpen=g}))},Ft.prototype.close=function(u){var u=(u===void 0?{disableAutoOpen:!0}:u).disableAutoOpen,m=this._state;u?(m.isBeingOpened&&m.cancelOpen(new je.DatabaseClosed),this._close(),m.autoOpen=!1,m.dbOpenError=new je.DatabaseClosed):(this._close(),m.autoOpen=this._options.autoOpen||m.isBeingOpened,m.openComplete=!1,m.dbOpenError=null)},Ft.prototype.delete=function(l){var u=this,m=(l===void 0&&(l={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),g=this._state;return new be(function(b,w){function N(){u.close(l);var S=u._deps.indexedDB.deleteDatabase(u.name);S.onsuccess=ht(function(){var L,K,O;L=u._deps,K=u.name,Br(O=L.indexedDB)||K===Ws||ei(O,L.IDBKeyRange).delete(K).catch(it),b()}),S.onerror=Lt(w),S.onblocked=u._fireOnBlocked}if(m)throw new je.InvalidArgument("Invalid closeOptions argument to db.delete()");g.isBeingOpened?g.dbReadyPromise.then(N):N()})},Ft.prototype.backendDB=function(){return this.idbdb},Ft.prototype.isOpen=function(){return this.idbdb!==null},Ft.prototype.hasBeenClosed=function(){var l=this._state.dbOpenError;return l&&l.name==="DatabaseClosed"},Ft.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Ft.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Ft.prototype,"tables",{get:function(){var l=this;return p(this._allTables).map(function(u){return l._allTables[u]})},enumerable:!1,configurable:!0}),Ft.prototype.transaction=function(){var l=function(u,m,g){var b=arguments.length;if(b<2)throw new je.InvalidArgument("Too few arguments");for(var w=new Array(b-1);--b;)w[b-1]=arguments[b];return g=w.pop(),[u,Te(w),g]}.apply(this,arguments);return this._transaction.apply(this,l)},Ft.prototype._transaction=function(l,u,m){var g,b,w=this,N=Ee.trans,S=(N&&N.db===this&&l.indexOf("!")===-1||(N=null),l.indexOf("?")!==-1);l=l.replace("!","").replace("?","");try{if(b=u.map(function(K){if(K=K instanceof w.Table?K.name:K,typeof K!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return K}),l=="r"||l===ls)g=ls;else{if(l!="rw"&&l!=ko)throw new je.InvalidArgument("Invalid transaction mode: "+l);g=ko}if(N){if(N.mode===ls&&g===ko){if(!S)throw new je.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");N=null}N&&b.forEach(function(K){if(N&&N.storeNames.indexOf(K)===-1){if(!S)throw new je.SubTransaction("Table "+K+" not included in parent transaction.");N=null}}),S&&N&&!N.active&&(N=null)}}catch(K){return N?N._promise(null,function(O,R){R(K)}):Ct(K)}var L=function K(O,R,B,$,I){return be.resolve().then(function(){var H=Ee.transless||Ee,D=O._createTransaction(R,B,O._dbSchema,$),H=(D.explicit=!0,{trans:D,transless:H});if($)D.idbtrans=$.idbtrans;else try{D.create(),D.idbtrans._explicit=!0,O._state.PR1398_maxLoop=3}catch(te){return te.name===nt.InvalidState&&O.isOpen()&&0<--O._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),O.close({disableAutoOpen:!1}),O.open().then(function(){return K(O,R,B,null,I)})):Ct(te)}var J,Q=W(I),H=(Q&&as(),be.follow(function(){var te;(J=I.call(D,D))&&(Q?(te=nn.bind(null,null),J.then(te,te)):typeof J.next=="function"&&typeof J.throw=="function"&&(J=Ro(J)))},H));return(J&&typeof J.then=="function"?be.resolve(J).then(function(te){return D.active?te:Ct(new je.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):H.then(function(){return J})).then(function(te){return $&&D._resolve(),D._completion.then(function(){return te})}).catch(function(te){return D._reject(te),Ct(te)})})}.bind(null,this,g,b,N,m);return N?N._promise(g,L,"lock"):Ee.trans?pr(Ee.transless,function(){return w._whenReady(L)}):this._whenReady(L)},Ft.prototype.table=function(l){if(C(this._allTables,l))return this._allTables[l];throw new je.InvalidTable("Table ".concat(l," does not exist"))};var Jn=Ft;function Ft(l,u){var m,g,b,w,N,S=this,L=(this._middlewares={},this.verno=0,Ft.dependencies),L=(this._options=u=a({addons:Ft.addons,autoOpen:!0,indexedDB:L.indexedDB,IDBKeyRange:L.IDBKeyRange,cache:"cloned"},u),this._deps={indexedDB:u.indexedDB,IDBKeyRange:u.IDBKeyRange},u.addons),K=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:it,dbReadyPromise:null,cancelOpen:it,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:u.autoOpen}),O=(K.dbReadyPromise=new be(function(R){K.dbReadyResolve=R}),K.openCanceller=new be(function(R,B){K.cancelOpen=B}),this._state=K,this.name=l,this.on=Gs(this,"populate","blocked","versionchange","close",{ready:[$n,it]}),this.once=function(R,B){var $=function(){for(var I=[],D=0;D<arguments.length;D++)I[D]=arguments[D];S.on(R).unsubscribe($),B.apply(S,I)};return S.on(R,$)},this.on.ready.subscribe=ne(this.on.ready.subscribe,function(R){return function(B,$){Ft.vip(function(){var I,D=S._state;D.openComplete?(D.dbOpenError||be.resolve().then(B),$&&R(B)):D.onReadyBeingFired?(D.onReadyBeingFired.push(B),$&&R(B)):(R(B),I=S,$||R(function J(){I.on.ready.unsubscribe(B),I.on.ready.unsubscribe(J)}))})}}),this.Collection=(m=this,Or(Na.prototype,function(J,D){this.db=m;var $=Ks,I=null;if(D)try{$=D()}catch(H){I=H}var D=J._ctx,J=D.table,Q=J.hook.reading.fire;this._ctx={table:J,index:D.index,isPrimKey:!D.index||J.schema.primKey.keyPath&&D.index===J.schema.primKey.name,range:$,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:I,or:D.or,valueMapper:Q!==wn?Q:null}})),this.Table=(g=this,Or(Vs.prototype,function(R,B,$){this.db=g,this._tx=$,this.name=R,this.schema=B,this.hook=g._allTables[R]?g._allTables[R].hook:Gs(null,{creating:[Bs,it],reading:[es,wn],updating:[ns,it],deleting:[ts,it]})})),this.Transaction=(b=this,Or(Fa.prototype,function(R,B,$,I,D){var J=this;R!=="readonly"&&B.forEach(function(Q){Q=(Q=$[Q])==null?void 0:Q.yProps,Q&&(B=B.concat(Q.map(function(H){return H.updatesTable})))}),this.db=b,this.mode=R,this.storeNames=B,this.schema=$,this.chromeTransactionDurability=I,this.idbtrans=null,this.on=Gs(this,"complete","error","abort"),this.parent=D||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new be(function(Q,H){J._resolve=Q,J._reject=H}),this._completion.then(function(){J.active=!1,J.on.complete.fire()},function(Q){var H=J.active;return J.active=!1,J.on.error.fire(Q),J.parent?J.parent._reject(Q):H&&J.idbtrans&&J.idbtrans.abort(),Ct(Q)})})),this.Version=(w=this,Or(Zl.prototype,function(R){this.db=w,this._cfg={version:R,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(N=this,Or(us.prototype,function(R,B,$){if(this.db=N,this._ctx={table:R,index:B===":id"?null:B,or:$},this._cmp=this._ascending=Ke,this._descending=function(I,D){return Ke(D,I)},this._max=function(I,D){return 0<Ke(I,D)?I:D},this._min=function(I,D){return Ke(I,D)<0?I:D},this._IDBKeyRange=N._deps.IDBKeyRange,!this._IDBKeyRange)throw new je.MissingAPI})),this.on("versionchange",function(R){0<R.newVersion?console.warn("Another connection wants to upgrade database '".concat(S.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(S.name,"'. Closing db now to resume the delete request.")),S.close({disableAutoOpen:!1})}),this.on("blocked",function(R){!R.newVersion||R.newVersion<R.oldVersion?console.warn("Dexie.delete('".concat(S.name,"') was blocked")):console.warn("Upgrade '".concat(S.name,"' blocked by other connection holding version ").concat(R.oldVersion/10))}),this._maxKey=Hn(u.IDBKeyRange),this._createTransaction=function(R,B,$,I){return new S.Transaction(R,B,$,S._options.chromeTransactionDurability,I)},this._fireOnBlocked=function(R){S.on("blocked").fire(R),mr.filter(function(B){return B.name===S.name&&B!==S&&!B._state.vcFired}).map(function(B){return B.on("versionchange").fire(R)})},this.use(nc),this.use(Ba),this.use(Do),this.use(Pa),this.use(tc),new Proxy(this,{get:function(R,B,$){var I;return B==="_vip"||(B==="table"?function(D){return Gn(S.table(D),O)}:(I=Reflect.get(R,B,$))instanceof Vs?Gn(I,O):B==="tables"?I.map(function(D){return Gn(D,O)}):B==="_createTransaction"?function(){return Gn(I.apply(this,arguments),O)}:I)}}));this.vip=O,L.forEach(function(R){return R(S)})}var Mi,$r=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",$a=(Ur.prototype.subscribe=function(l,u,m){return this._subscribe(l&&typeof l!="function"?l:{next:l,error:u,complete:m})},Ur.prototype[$r]=function(){return this},Ur);function Ur(l){this._subscribe=l}try{Mi={indexedDB:h.indexedDB||h.mozIndexedDB||h.webkitIndexedDB||h.msIndexedDB,IDBKeyRange:h.IDBKeyRange||h.webkitIDBKeyRange}}catch{Mi={indexedDB:null,IDBKeyRange:null}}function xs(l){var u,m=!1,g=new $a(function(b){var w=W(l),N,S=!1,L={},K={},O={get closed(){return S},unsubscribe:function(){S||(S=!0,N&&N.abort(),R&&vr.storagemutated.unsubscribe($))}},R=(b.start&&b.start(O),!1),B=function(){return _i(I)},$=function(D){Pi(L,D),Fo(K,L)&&B()},I=function(){var D,J,Q;!S&&Mi.indexedDB&&(L={},D={},N&&N.abort(),N=new AbortController,Q=(H=>{var te=dr();try{w&&as();var oe=hr(l,H);return oe=w?oe.finally(nn):oe}finally{te&&Er()}})(J={subscr:D,signal:N.signal,requery:B,querier:l,trans:null}),Promise.resolve(Q).then(function(H){m=!0,u=H,S||J.signal.aborted||(L={},(te=>{for(var oe in te)if(C(te,oe))return;return 1})(K=D)||R||(vr(ds,$),R=!0),_i(function(){return!S&&b.next&&b.next(H)}))},function(H){m=!1,["DatabaseClosedError","AbortError"].includes(H?.name)||S||_i(function(){S||b.error&&b.error(H)})}))};return setTimeout(B,0),O});return g.hasValue=function(){return m},g.getValue=function(){return u},g}var zr=Jn;function bs(l){var u=Yn;try{Yn=!0,vr.storagemutated.fire(l),To(l,!0)}finally{Yn=u}}F(zr,a(a({},re),{delete:function(l){return new zr(l,{addons:[]}).delete()},exists:function(l){return new zr(l,{addons:[]}).open().then(function(u){return u.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(l){try{return u=zr.dependencies,m=u.indexedDB,u=u.IDBKeyRange,(Br(m)?Promise.resolve(m.databases()).then(function(g){return g.map(function(b){return b.name}).filter(function(b){return b!==Ws})}):ei(m,u).toCollection().primaryKeys()).then(l)}catch{return Ct(new je.MissingAPI)}var u,m},defineClass:function(){return function(l){x(this,l)}},ignoreTransaction:function(l){return Ee.trans?pr(Ee.transless,l):l()},vip:gs,async:function(l){return function(){try{var u=Ro(l.apply(this,arguments));return u&&typeof u.then=="function"?u:be.resolve(u)}catch(m){return Ct(m)}}},spawn:function(l,u,m){try{var g=Ro(l.apply(m,u||[]));return g&&typeof g.then=="function"?g:be.resolve(g)}catch(b){return Ct(b)}},currentTransaction:{get:function(){return Ee.trans||null}},waitFor:function(l,u){return l=be.resolve(typeof l=="function"?zr.ignoreTransaction(l):l).timeout(u||6e4),Ee.trans?Ee.trans.waitFor(l):l},Promise:be,debug:{get:function(){return Nt},set:function(l){$s(l)}},derive:q,extend:x,props:F,override:ne,Events:Gs,on:vr,liveQuery:xs,extendObservabilitySet:Pi,getByKeyPath:me,setByKeyPath:fe,delByKeyPath:function(l,u){typeof u=="string"?fe(l,u,void 0):"length"in u&&[].map.call(u,function(m){fe(l,m,void 0)})},shallowClone:ye,deepClone:lt,getObjectDiff:Po,cmp:Ke,asap:ee,minKey:-1/0,addons:[],connections:mr,errnames:nt,dependencies:Mi,cache:wr,semVer:"4.3.0",version:"4.3.0".split(".").map(function(l){return parseInt(l)}).reduce(function(l,u,m){return l+u/Math.pow(10,2*m)})})),zr.maxKey=Hn(zr.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(vr(ds,function(l){Yn||(l=new CustomEvent(Mr,{detail:l}),Yn=!0,dispatchEvent(l),Yn=!1)}),addEventListener(Mr,function(l){l=l.detail,Yn||bs(l)}));var ws,Yn=!1,Li=function(){};return typeof BroadcastChannel<"u"&&((Li=function(){(ws=new BroadcastChannel(Mr)).onmessage=function(l){return l.data&&bs(l.data)}})(),typeof ws.unref=="function"&&ws.unref(),vr(ds,function(l){Yn||ws.postMessage(l)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(l){if(!Jn.disableBfCache&&l.persisted){Nt&&console.debug("Dexie: handling persisted pagehide"),ws?.close();for(var u=0,m=mr;u<m.length;u++)m[u].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(l){!Jn.disableBfCache&&l.persisted&&(Nt&&console.debug("Dexie: handling persisted pageshow"),Li(),bs({all:new qt(-1/0,[[]])}))})),be.rejectionMapper=function(l,u){return!l||l instanceof Ue||l instanceof TypeError||l instanceof SyntaxError||!l.name||!or[l.name]?l:(u=new or[l.name](u||l.message,l),"stack"in l&&A(u,"stack",{get:function(){return this.inner.stack}}),u)},$s(Nt),a(Jn,Object.freeze({__proto__:null,Dexie:Jn,Entity:ka,PropModification:gr,RangeSet:qt,add:function(l){return new gr({add:l})},cmp:Ke,default:Jn,liveQuery:xs,mergeRanges:ni,rangesOverlap:Ti,remove:function(l){return new gr({remove:l})},replacePrefix:function(l,u){return new gr({replacePrefix:[l,u]})}}),{default:Jn}),Jn})})($l)),$l.exports}var ky=wy();const Au=jf(ky),Gh=Symbol.for("Dexie"),ql=globalThis[Gh]||(globalThis[Gh]=Au);if(Au.semVer!==ql.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Au.semVer} and ${ql.semVer}`);const{liveQuery:n0,mergeRanges:r0,rangesOverlap:s0,RangeSet:i0,cmp:o0,Entity:a0,PropModification:l0,replacePrefix:c0,add:u0,remove:d0,DexieYProvider:h0}=ql;class _y extends ql{meta;taxon;synonym;constructor(){super("col_taxonomy_v1"),this.version(2).stores({meta:"key",taxon:"id, scientific_name, kingdom, phylum, class, pack_id, [pack_id+scientific_name]",synonym:"pk, synonym_name, accepted_id, pack_id, [pack_id+synonym_name]"}),this.version(1).stores({meta:"key",taxon:"id, scientific_name, kingdom, phylum, class, pack_id",synonym:"pk, synonym_name, accepted_id, pack_id"})}async getMeta(n){return(await this.meta.get(n))?.value??null}async setMeta(n,r){await this.meta.put({key:n,value:r})}async getInstalledPacks(){return await this.getMeta("installed_packs")||[]}async getInstalledPacksWithMeta(){const n=await this.getInstalledPacks(),r=[];for(const a of n){const d=await this.getTaxonCountForPack(a),h=await this.getSynonymCountForPack(a);d>0&&r.push({pack_id:a,taxa_count:d,syn_count:h})}return r}async addInstalledPack(n){const r=await this.getInstalledPacks();r.includes(n)||(r.push(n),await this.setMeta("installed_packs",r))}async removeInstalledPack(n){const a=(await this.getInstalledPacks()).filter(d=>d!==n);await this.setMeta("installed_packs",a)}async removePack(n){await this.transaction("rw",[this.taxon,this.synonym,this.meta],async()=>{await this.taxon.where("pack_id").equals(n).delete(),await this.synonym.where("pack_id").equals(n).delete(),await this.meta.where("key").startsWith(`${n}:`).delete();const a=(await this.getMeta("installed_packs")||[]).filter(d=>d!==n);await this.setMeta("installed_packs",a)})}async resetPackCheckpoint(n){await this.transaction("rw",[this.taxon,this.synonym,this.meta],async()=>{await this.taxon.where("pack_id").equals(n).delete(),await this.synonym.where("pack_id").equals(n).delete(),await this.setMeta(`pack_${n}_taxon_last_id`,""),await this.setMeta(`pack_${n}_taxon_done`,!1),await this.setMeta(`pack_${n}_syn_last_pk`,0),await this.setMeta(`pack_${n}_syn_done`,!1),await this.setMeta(`pack_${n}_sync_lock`,!1),await this.setMeta(`pack_${n}_taxon_sync_lock`,!1),await this.setMeta(`pack_${n}_syn_sync_lock`,!1);const a=(await this.getMeta("installed_packs")||[]).filter(d=>d!==n);await this.setMeta("installed_packs",a),await this.meta.where("key").equals(`pack_${n}_taxon_synced_at`).delete(),await this.meta.where("key").equals(`pack_${n}_syn_synced_at`).delete(),await this.meta.where("key").equals(`${n}:synced_at`).delete()})}async resetPackTaxa(n){await this.transaction("rw",[this.taxon,this.meta],async()=>{await this.taxon.where("pack_id").equals(n).delete(),await this.setMeta(`pack_${n}_taxon_last_seq`,0),await this.setMeta(`pack_${n}_taxon_done`,!1),await this.setMeta(`pack_${n}_taxon_sync_lock`,!1),await this.meta.where("key").equals(`pack_${n}_taxon_synced_at`).delete()})}async resetPackSynonyms(n){await this.transaction("rw",[this.synonym,this.meta],async()=>{await this.synonym.where("pack_id").equals(n).delete(),await this.setMeta(`pack_${n}_syn_last_seq`,0),await this.setMeta(`pack_${n}_syn_done`,!1),await this.setMeta(`pack_${n}_syn_sync_lock`,!1),await this.meta.where("key").equals(`pack_${n}_syn_synced_at`).delete()})}async getTaxonCountForPack(n){return await this.taxon.where("pack_id").equals(n).count()}async getSynonymCountForPack(n){return await this.synonym.where("pack_id").equals(n).count()}async clearAll(){await this.transaction("rw",this.meta,this.taxon,this.synonym,async()=>{await this.meta.clear(),await this.taxon.clear(),await this.synonym.clear()})}}const we=new _y;function Jh({onDelete:i,children:n}){const[r,a]=V.useState(0),[d,h]=V.useState(!1),[p,v]=V.useState(!1),x=V.useRef(0),_=V.useRef(0),j=V.useRef(null),C=88,F=60,T=Z=>{x.current=Z.touches[0].clientX,_.current=Z.touches[0].clientX,h(!0)},A=Z=>{if(!d)return;_.current=Z.touches[0].clientX;const ne=x.current-_.current;if(ne>0){const ie=Math.min(ne,C);a(ie)}else a(0)},q=()=>{h(!1),r>=F?(a(C),v(!0)):(a(0),v(!1))},M=()=>{i(),a(0),v(!1)},U=Z=>{j.current&&!j.current.contains(Z.target)&&(a(0),v(!1))};return V.useEffect(()=>{if(p)return document.addEventListener("click",U),()=>document.removeEventListener("click",U)},[p]),s.jsxs("div",{ref:j,className:"relative overflow-hidden",style:{touchAction:"pan-y"},children:[s.jsx("div",{className:"absolute top-0 right-0 bottom-0 flex items-center justify-end px-4",style:{width:`${C}px`,background:"#D2110C",opacity:r>0?1:0,transition:d?"none":"opacity 200ms"},children:s.jsxs("button",{onClick:M,className:"flex flex-col items-center justify-center gap-1",style:{opacity:p?1:0,pointerEvents:p?"auto":"none",transition:"opacity 150ms"},children:[s.jsx(Ef,{className:"w-5 h-5",style:{color:"#FFFFFF"}}),s.jsx("span",{className:"text-xs font-semibold",style:{color:"#FFFFFF"},children:"Delete"})]})}),s.jsx("div",{onTouchStart:T,onTouchMove:A,onTouchEnd:q,style:{transform:`translateX(-${r}px)`,transition:d?"none":"transform 200ms cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",zIndex:1},children:n})]})}function jy({message:i,assessment:n,onUndo:r,onDismiss:a,duration:d=6e3}){const[h,p]=V.useState(100),v=i||"Assessment deleted";V.useEffect(()=>{const _=Date.now(),j=setInterval(()=>{const C=Date.now()-_,F=Math.max(0,100-C/d*100);p(F),F===0&&(clearInterval(j),a())},50);return()=>clearInterval(j)},[d,a]);const x=()=>{r(),a()};return s.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-[100] px-4 animate-slide-up",style:{paddingBottom:"calc(16px + env(safe-area-inset-bottom))"},children:s.jsxs("div",{className:"rounded-xl shadow-2xl overflow-hidden mx-auto",style:{background:"#1A1C22",border:"1px solid #242632",maxWidth:"480px"},children:[s.jsx("div",{className:"h-1 transition-all duration-50",style:{width:`${h}%`,background:"#D2110C"}}),s.jsxs("div",{className:"flex items-center justify-between p-4",children:[s.jsx("div",{className:"flex items-center gap-3 flex-1",children:s.jsx("span",{className:"text-sm font-medium",style:{color:"#FFFFFF"},children:v})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:x,className:"px-4 py-2 rounded-lg text-sm font-bold transition-all",style:{background:"#D2110C",color:"#FFFFFF"},children:"Undo"}),s.jsx("button",{onClick:a,className:"p-2 rounded-lg transition-all",style:{color:"#8E91A3"},children:s.jsx(Sr,{className:"w-4 h-4"})})]})]})]})})}function Ny({onStartAssessment:i}){const[n,r]=V.useState([]),[a,d]=V.useState(!1),[h,p]=V.useState(null);V.useEffect(()=>{const A=localStorage.getItem("assessments");if(A){const Z=JSON.parse(A).filter(ne=>!ne.pendingDelete);r(Z)}const q=()=>{const U=localStorage.getItem("assessments");if(U){const ne=JSON.parse(U).filter(ie=>!ie.pendingDelete);r(ne)}},M=()=>d(!0);return window.addEventListener("assessmentCompleted",q),window.addEventListener("openNewAssessment",M),()=>{window.removeEventListener("assessmentCompleted",q),window.removeEventListener("openNewAssessment",M)}},[]);const v=()=>{d(!0)},x=(A,q)=>{const M={id:`assessment-${Date.now()}`,taxonName:A,scientificName:q,status:"draft",currentStep:1,lastModified:new Date().toISOString()},U=[...n,M];r(U),localStorage.setItem("assessments",JSON.stringify(U)),d(!1),i(M.id)},_=A=>{const q=n.find(Z=>Z.id===A);if(!q)return;const M=n.filter(Z=>Z.id!==A);r(M),p({assessmentId:A,assessment:q,timestamp:Date.now()});const U=localStorage.getItem("assessments");if(U){const ne=JSON.parse(U).map(ie=>ie.id===A?{...ie,pendingDelete:!0,pendingDeleteAt:new Date().toISOString()}:ie);localStorage.setItem("assessments",JSON.stringify(ne))}},j=()=>{if(!h)return;const A=[...n,h.assessment];A.sort((M,U)=>new Date(U.lastModified).getTime()-new Date(M.lastModified).getTime()),r(A);const q=localStorage.getItem("assessments");if(q){const U=JSON.parse(q).map(Z=>Z.id===h.assessmentId?{...Z,pendingDelete:!1,pendingDeleteAt:void 0}:Z);localStorage.setItem("assessments",JSON.stringify(U))}p(null)},C=()=>{if(!h)return;const A=localStorage.getItem("assessments");if(A){const M=JSON.parse(A).filter(U=>U.id!==h.assessmentId);localStorage.setItem("assessments",JSON.stringify(M))}p(null)},F=n.filter(A=>A.status==="draft"),T=n.filter(A=>A.status==="completed");return s.jsxs("div",{className:"min-h-screen",style:{background:"linear-gradient(180deg, #0B0B0D 0%, #0F1013 100%)"},children:[s.jsxs("header",{className:"px-4 py-4 safe-area-top sticky top-0 z-20 backdrop-blur-sm bg-black/30",children:[s.jsx("h1",{className:"text-xl font-bold tracking-tight",style:{color:"#FFFFFF"},children:"Assessments"}),s.jsx("p",{className:"text-sm mt-1",style:{color:"#C9CBD6"},children:"Manage your draft and active assessments"})]}),s.jsxs("div",{className:"px-4 py-6 content-safe-bottom space-y-6",children:[s.jsxs("section",{className:"relative overflow-hidden rounded-[22px] card-shadow-raised",children:[s.jsx(ki,{src:"https://images.unsplash.com/photo-1768737829317-8458524c7053?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxlbmRhbmdlcmVkJTIwd2lsZGxpZmUlMjBjb25zZXJ2YXRpb24lMjBuYXR1cmV8ZW58MXx8fHwxNzcwNTk0MTc2fDA&ixlib=rb-4.1.0&q=80&w=1080",alt:"Wildlife conservation",className:"absolute inset-0 w-full h-full object-cover"}),s.jsx("div",{className:"absolute inset-0 image-overlay-dark"}),s.jsxs("div",{className:"relative z-10 p-6 min-h-[200px] flex flex-col justify-end",children:[s.jsx("h3",{className:"text-xl font-bold mb-2",style:{color:"#FFFFFF"},children:"Start New Assessment"}),s.jsx("p",{className:"text-sm mb-4",style:{color:"#C9CBD6"},children:"Begin a fresh regional assessment following the 3-step IUCN process"}),s.jsxs("button",{onClick:v,className:"btn-primary flex items-center justify-center gap-2",children:[s.jsx(Ff,{className:"w-5 h-5"}),"New Assessment"]})]})]}),F.length>0&&s.jsxs("section",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-bold",style:{color:"#FFFFFF"},children:"Draft Assessments"}),s.jsxs("span",{className:"text-sm",style:{color:"#8E91A3"},children:[F.length," active"]})]}),s.jsx("div",{className:"space-y-3",children:F.map(A=>s.jsx(Jh,{onDelete:()=>_(A.id),children:s.jsx(Sy,{assessment:A,onClick:()=>i(A.id)})},A.id))})]}),s.jsxs("section",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-bold",style:{color:"#FFFFFF"},children:"Completed Assessments"}),s.jsxs("span",{className:"text-sm",style:{color:"#8E91A3"},children:[T.length," completed"]})]}),T.length>0?s.jsx("div",{className:"space-y-3",children:T.map(A=>s.jsx(Jh,{onDelete:()=>_(A.id),children:s.jsx(Cy,{assessment:A,onClick:()=>i(A.id)})},A.id))}):s.jsxs("div",{className:"rounded-[18px] card-shadow p-6 text-center",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsx("p",{className:"text-sm font-semibold mb-1",style:{color:"#FFFFFF"},children:"No completed assessments yet"}),s.jsx("p",{className:"text-sm",style:{color:"#8E91A3"},children:"Finish a draft to see it here"})]})]})]}),h&&s.jsx(jy,{message:"Assessment deleted",assessment:h.assessment,onUndo:j,onDismiss:C,duration:6e3}),a&&s.jsx(Fy,{onClose:()=>d(!1),onCreate:x})]})}function Sy({assessment:i,onClick:n}){const r=["Eligibility","Preliminary","Adjustment","Complete"],a=new Date(i.lastModified),d=Ey(a);return s.jsxs("button",{onClick:n,className:"w-full rounded-[18px] card-shadow p-4 text-left transition-all active:scale-98",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"font-semibold truncate",style:{color:"#FFFFFF"},children:i.taxonName}),s.jsx("p",{className:"text-sm italic truncate",style:{color:"#C9CBD6"},children:i.scientificName})]}),s.jsx(Ls,{className:"w-5 h-5 flex-shrink-0 ml-2",style:{color:"#8E91A3"}})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"badge badge-neutral text-xs",children:["Step ",i.currentStep,": ",r[i.currentStep-1]]}),s.jsx("span",{className:"text-xs",style:{color:"#8E91A3"},children:d})]})]})}function Cy({assessment:i,onClick:n}){const r=i.completedAt||i.completedDate||i.lastModified,d=new Date(r).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),h=i.finalCategory||i.category||"DD",p=i.adjusted||i.isAdjusted||!1;return s.jsxs("button",{onClick:n,className:"w-full rounded-[18px] card-shadow p-4 text-left transition-all active:scale-98",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsxs("div",{className:"flex items-start justify-between gap-4 mb-3",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"font-semibold truncate",style:{color:"#FFFFFF"},children:i.taxonName}),s.jsx("p",{className:"text-sm italic truncate",style:{color:"#C9CBD6"},children:i.scientificName})]}),s.jsxs("div",{className:"text-right flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("p",{className:"text-2xl font-bold",style:{color:"#FFFFFF"},children:h}),p&&s.jsx("span",{className:"text-base font-bold",style:{color:"#A78BFA"},children:""})]}),i.criteriaString?s.jsx("p",{className:"text-xs mt-1",style:{color:"#8E91A3"},children:i.criteriaString}):s.jsx("p",{className:"text-xs mt-1",style:{color:"#8E91A3"},children:"Not determined"})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[p&&s.jsx("span",{className:"px-2 py-1 rounded-lg text-xs font-semibold",style:{background:"rgba(167, 139, 250, 0.15)",color:"#A78BFA"},children:"Adjusted"}),s.jsxs("span",{className:"text-xs",style:{color:"#8E91A3"},children:["Completed ",d]})]})]})}function Fy({onClose:i,onCreate:n}){const[r,a]=V.useState(""),[d,h]=V.useState(""),[p,v]=V.useState(""),[x,_]=V.useState([]),[j,C]=V.useState(!1),[F,T]=V.useState(null),[A,q]=V.useState(!1),[M,U]=V.useState(!1),Z=co.useRef(null);V.useEffect(()=>{ne();const ye=localStorage.getItem("selectedTaxonForAssessment");if(ye)try{const $e=JSON.parse(ye);h($e.scientificName||""),v($e.scientificName||""),T($e.id||null),U(!0),localStorage.removeItem("selectedTaxonForAssessment"),setTimeout(()=>{Z.current?.focus()},100)}catch($e){console.error("Failed to parse prefilled taxon:",$e)}},[]),V.useEffect(()=>{p.length>=2?ie():(_([]),C(!1))},[p]);const ne=async()=>{const ye=await we.getInstalledPacks();q(ye.length>0)},ie=async()=>{try{const ye=await we.taxon.where("scientific_name").startsWithIgnoreCase(p).limit(8).toArray();_(ye),C(ye.length>0)}catch(ye){console.error("Search error:",ye),_([])}},ee=ye=>{h(ye.scientific_name),v(ye.scientific_name),T(ye.id),U(!0),C(!1)},me=ye=>{v(ye),h(ye),F&&(T(null),U(!1))},fe=ye=>{ye.preventDefault(),r&&d&&n(r,d)};return s.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in",children:s.jsxs("div",{className:"rounded-[22px] card-shadow-raised max-w-md w-full p-6 animate-slide-up",style:{background:"#1A1C22"},children:[s.jsx("h2",{className:"text-xl font-bold mb-4",style:{color:"#FFFFFF"},children:"New Assessment"}),s.jsxs("form",{onSubmit:fe,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"taxonName",className:"block text-sm font-semibold mb-2",style:{color:"#C9CBD6"},children:"Common Name"}),s.jsx("input",{type:"text",id:"taxonName",value:r,onChange:ye=>a(ye.target.value),placeholder:"e.g., Mountain Bluebird",className:"w-full px-4 py-3 rounded-lg transition-all",style:{background:"#14151A",border:"1px solid #242632",color:"#FFFFFF"},required:!0,ref:Z})]}),s.jsxs("div",{className:"relative",children:[s.jsx("label",{htmlFor:"scientificName",className:"block text-sm font-semibold mb-2",style:{color:"#C9CBD6"},children:"Scientific Name"}),s.jsx("input",{type:"text",id:"scientificName",value:p,onChange:ye=>me(ye.target.value),onFocus:()=>{x.length>0&&C(!0)},placeholder:A?"Start typing to search Species Index":"e.g., Sialia currucoides",className:"w-full px-4 py-3 rounded-lg italic transition-all",style:{background:"#14151A",border:"1px solid #242632",color:"#FFFFFF"},required:!0}),!A&&p.length===0&&s.jsx("p",{className:"text-xs mt-2",style:{color:"#8E91A3"},children:"Download a taxonomy pack in Library  Species Index to enable search."}),F&&s.jsx("p",{className:"text-xs mt-2",style:{color:"#6EE7B7"},children:" Matched in Species Index"}),!F&&p.length>=2&&x.length===0&&s.jsx("p",{className:"text-xs mt-2",style:{color:"#8E91A3"},children:"No match found. You can continue with manual entry."}),j&&x.length>0&&s.jsx("div",{className:"absolute z-10 w-full mt-1 rounded-lg overflow-hidden",style:{background:"#14151A",border:"1px solid #242632",maxHeight:"240px",overflowY:"auto"},children:x.map((ye,$e)=>s.jsxs("button",{type:"button",onClick:()=>ee(ye),className:"w-full px-4 py-3 text-left transition-all hover:bg-white/5",style:{borderBottom:$e<x.length-1?"1px solid #242632":"none"},children:[s.jsx("p",{className:"font-semibold italic",style:{color:"#FFFFFF"},children:ye.scientific_name}),s.jsxs("div",{className:"flex items-center justify-between gap-2 mt-1",children:[s.jsxs("p",{className:"text-xs",style:{color:"#C9CBD6"},children:[ye.rank,"  ",ye.kingdom||"Unknown",ye.authorship&&`  ${ye.authorship}`]}),s.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-semibold",style:{background:"rgba(52, 211, 153, 0.15)",color:"#34D399"},children:"Accepted"})]})]},ye.id))})]}),s.jsxs("div",{className:"flex gap-3 mt-6",children:[s.jsx("button",{type:"button",onClick:i,className:"flex-1 btn-secondary py-3",children:"Cancel"}),s.jsx("button",{type:"submit",className:"flex-1 btn-primary py-3",children:"Create"})]})]})]})})}function Ey(i){const n=Math.floor((new Date().getTime()-i.getTime())/1e3);return n<60?"Just now":n<3600?`${Math.floor(n/60)}m ago`:n<86400?`${Math.floor(n/3600)}h ago`:`${Math.floor(n/86400)}d ago`}function Ay({data:i,onUpdate:n,onNext:r}){const[a,d]=V.useState(i.step1?.isNative??null),[h,p]=V.useState(i.step1?.hasBreeding??null),[v,x]=V.useState(i.step1?.hasVisiting??null),[_,j]=V.useState(i.step1?.isVagrant??null),[C,F]=V.useState(i.step1?.rationale||""),[T,A]=V.useState(null),q=a===!0&&_===!1&&(h===!0||v===!0),M=()=>{n({isNative:a,hasBreeding:h,hasVisiting:v,isVagrant:_,eligible:q,rationale:C}),q&&r()};return s.jsxs("div",{className:"px-4 py-6 space-y-6",children:[s.jsxs("div",{className:"rounded-[18px] px-4 py-3",style:{background:"rgba(96, 165, 250, 0.15)",border:"1px solid rgba(96, 165, 250, 0.3)"},children:[s.jsx("h2",{className:"font-semibold",style:{color:"#60A5FA"},children:"Step 1: Eligibility & Filtering"}),s.jsx("p",{className:"text-sm mt-1",style:{color:"#C9CBD6"},children:"Determine if the taxon should be assessed"})]}),s.jsxs("div",{className:"rounded-[18px] card-shadow p-4 flex items-start gap-3",style:{background:"#1A1C22",border:"1px solid #B45309"},children:[s.jsx(Ku,{className:"w-5 h-5 flex-shrink-0 mt-0.5",style:{color:"#FCD34D"}}),s.jsxs("div",{className:"text-sm",style:{color:"#FCD34D"},children:[s.jsx("strong",{children:"Critical:"})," Only assess wild populations within their natural range or benign introductions. Vagrants must NOT be assessed."]})]}),s.jsx(Tl,{title:"Is the population native or a benign introduction?",tooltip:"Native populations occur within the species' natural range. Benign introductions are formally authorized reintroductions. Other introduced taxa should be classified as NA (Not Applicable).",showTooltip:T==="native",onToggleTooltip:()=>A(T==="native"?null:"native"),children:s.jsxs("div",{className:"space-y-3",children:[s.jsx(Ds,{selected:a===!0,onClick:()=>{d(!0),a===!1&&(p(null),x(null),j(null))},title:"Yes, native or benign introduction",description:"Within natural range or authorized reintroduction"}),s.jsx(Ds,{selected:a===!1,onClick:()=>{d(!1),p(null),x(null),j(null)},title:"No, introduced (not benign)",description:"Results in NA (Not Applicable) classification"})]})}),a===!0&&s.jsx(Tl,{title:"Is this a vagrant occurrence?",tooltip:"Vagrants are individuals appearing occasionally or unpredictably outside their normal range. Vagrants should NOT be assessed and are classified as NA or NE.",showTooltip:T==="vagrant",onToggleTooltip:()=>A(T==="vagrant"?null:"vagrant"),children:s.jsxs("div",{className:"space-y-3",children:[s.jsx(Ds,{selected:_===!1,onClick:()=>j(!1),title:"No, regular occurrence",description:"Population present predictably or seasonally"}),s.jsx(Ds,{selected:_===!0,onClick:()=>{j(!0),p(null),x(null)},title:"Yes, vagrant/occasional",description:"Results in NA classification (not assessed)"})]})}),a===!0&&_===!1&&s.jsx(Tl,{title:"Is there a breeding population in the region?",tooltip:"A breeding population reproduces within the region and has done so for at least 10 consecutive years (or fewer if recolonizing after regional extinction).",showTooltip:T==="breeding",onToggleTooltip:()=>A(T==="breeding"?null:"breeding"),children:s.jsxs("div",{className:"space-y-3",children:[s.jsx(Ds,{selected:h===!0,onClick:()=>p(!0),title:"Yes, breeding population present",description:"Reproduction documented for 10+ years"}),s.jsx(Ds,{selected:h===!1,onClick:()=>p(!1),title:"No breeding population",description:"May have visiting population only"})]})}),a===!0&&_===!1&&h!==null&&s.jsx(Tl,{title:"Is there a visiting (non-breeding) population?",tooltip:"Visiting populations are present seasonally (e.g., wintering, migrating) but do not breed in the region. Must be distinguished from vagrants which are unpredictable.",showTooltip:T==="visiting",onToggleTooltip:()=>A(T==="visiting"?null:"visiting"),children:s.jsxs("div",{className:"space-y-3",children:[s.jsx(Ds,{selected:v===!0,onClick:()=>x(!0),title:"Yes, visiting population present",description:"Seasonal presence (e.g., wintering, migration)"}),s.jsx(Ds,{selected:v===!1,onClick:()=>x(!1),title:"No visiting population",description:"Breeding population only (if applicable)"})]})}),a!==null&&_!==null&&s.jsxs("div",{className:"rounded-[18px] card-shadow p-4",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsx("label",{className:"block text-sm font-semibold mb-2",style:{color:"#FFFFFF"},children:"Rationale & Evidence"}),s.jsx("textarea",{value:C,onChange:U=>F(U.target.value),placeholder:"Explain the basis for your eligibility decision, including data sources and evidence...",className:"w-full px-4 py-3 rounded-lg min-h-[100px]",style:{background:"#1A1C22",border:"1px solid #242632",color:"#FFFFFF"}}),s.jsx("p",{className:"text-xs mt-2",style:{color:"#8E91A3"},children:"Required: Document the evidence supporting your answers above"})]}),a!==null&&_!==null&&(h!==null||v!==null)&&s.jsxs("div",{className:"rounded-[18px] card-shadow p-4",style:{background:q?"rgba(52, 211, 153, 0.1)":"rgba(142, 145, 163, 0.1)",border:q?"2px solid #34D399":"2px solid #8E91A3"},children:[s.jsx("h3",{className:"font-semibold mb-2",style:{color:q?"#34D399":"#8E91A3"},children:q?" Eligible for Assessment":" Not Eligible (NA)"}),s.jsx("p",{className:"text-sm",style:{color:"#C9CBD6"},children:q?"This taxon meets eligibility criteria and should proceed to Step 2 (Preliminary Category).":_?"Vagrant occurrences should not be assessed. Classify as NA (Not Applicable) or NE (Not Evaluated).":a?"No breeding or visiting population identified. Cannot proceed with assessment.":"Introduced taxa outside benign reintroductions should be classified as NA (Not Applicable)."})]}),s.jsxs("button",{onClick:M,disabled:!q||!C.trim(),className:"w-full btn-primary flex items-center justify-center gap-2 py-4",children:["Continue to Step 2",s.jsx(Ls,{className:"w-5 h-5"})]})]})}function Tl({title:i,tooltip:n,showTooltip:r,onToggleTooltip:a,children:d}){return s.jsxs("div",{className:"rounded-[18px] card-shadow p-4",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsx("h3",{className:"font-semibold pr-2",style:{color:"#FFFFFF"},children:i}),s.jsx("button",{onClick:a,className:"flex-shrink-0",style:{color:"#60A5FA"},children:s.jsx(Nm,{className:"w-5 h-5"})})]}),r&&s.jsx("div",{className:"rounded-lg p-3 mb-4",style:{background:"rgba(96, 165, 250, 0.15)",border:"1px solid rgba(96, 165, 250, 0.3)"},children:s.jsx("p",{className:"text-sm",style:{color:"#C9CBD6"},children:n})}),d]})}function Ds({selected:i,onClick:n,title:r,description:a}){return s.jsxs("button",{onClick:n,className:"w-full px-4 py-4 rounded-lg text-left transition-all",style:{background:i?"rgba(210, 17, 12, 0.15)":"#1A1C22",border:i?"2px solid #D2110C":"1px solid #242632"},children:[s.jsx("div",{className:"font-semibold",style:{color:"#FFFFFF"},children:r}),s.jsx("div",{className:"text-sm mt-1",style:{color:"#8E91A3"},children:a})]})}function Ty({data:i,onUpdate:n,onNext:r,onBack:a}){const[d,h]=V.useState(i.step2?.populationSize||""),[p,v]=V.useState(i.step2?.populationTrend||""),[x,_]=V.useState(i.step2?.declinePercent||""),[j,C]=V.useState(i.step2?.eoo||""),[F,T]=V.useState(i.step2?.aoo||""),[A,q]=V.useState(i.step2?.locations||""),[M,U]=V.useState(i.step2?.severelyFragmented||!1),[Z,ne]=V.useState(i.step2?.threats||""),[ie,ee]=V.useState(i.step2?.preliminaryCategory||""),[me,fe]=V.useState(i.step2?.criteriaMet||""),[ye,$e]=V.useState(i.step2?.confidence||0);V.useEffect(()=>{const De=Ry({populationSize:parseFloat(d)||0,declinePercent:parseFloat(x)||0,eoo:parseFloat(j)||0,aoo:parseFloat(F)||0,locations:parseInt(A)||0,severelyFragmented:M});ee(De.category),fe(De.criteria),$e(Py({populationSize:d,declinePercent:x,eoo:j,aoo:F,locations:A,threats:Z}))},[d,x,j,F,A,M,Z]);const Te=()=>{n({populationSize:d,populationTrend:p,declinePercent:x,eoo:j,aoo:F,locations:A,severelyFragmented:M,threats:Z,preliminaryCategory:ie,criteriaMet:me,confidence:ye}),r()},st=d&&x&&Z.trim();return s.jsxs("div",{className:"px-4 py-6 space-y-6",children:[s.jsxs("div",{className:"rounded-[18px] px-4 py-3",style:{background:"rgba(52, 211, 153, 0.15)",border:"1px solid rgba(52, 211, 153, 0.3)"},children:[s.jsx("h2",{className:"font-semibold",style:{color:"#34D399"},children:"Step 2: Preliminary Category"}),s.jsx("p",{className:"text-sm mt-1",style:{color:"#C9CBD6"},children:"Apply IUCN Criteria to REGIONAL population data"})]}),s.jsxs("div",{className:"rounded-[18px] card-shadow p-4 flex items-start gap-3",style:{background:"#1A1C22",border:"1px solid #B45309"},children:[s.jsx(Ku,{className:"w-6 h-6 flex-shrink-0 mt-0.5",style:{color:"#FCD34D"}}),s.jsxs("div",{className:"text-sm",style:{color:"#FCD34D"},children:[s.jsx("strong",{children:"CRITICAL:"})," Use only ",s.jsx("strong",{children:"regional population"})," data in this step, NOT global data. Global data will be considered in Step 3 for adjustment purposes."]})]}),s.jsxs("section",{className:"rounded-[18px] card-shadow p-4 space-y-4",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(Ym,{className:"w-5 h-5",style:{color:"#60A5FA"}}),s.jsx("h3",{className:"font-semibold",style:{color:"#FFFFFF"},children:"Population Size & Trend"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold mb-2",style:{color:"#C9CBD6"},children:"Regional population size (mature individuals)"}),s.jsx("input",{type:"number",value:d,onChange:De=>h(De.target.value),placeholder:"e.g., 8000",className:"w-full px-4 py-3 rounded-lg",style:{background:"#1A1C22",border:"1px solid #242632",color:"#FFFFFF"}}),s.jsx("p",{className:"text-xs mt-1",style:{color:"#8E91A3"},children:"Enter number of mature (breeding) individuals in the region"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold mb-2",style:{color:"#C9CBD6"},children:"Population trend"}),s.jsxs("select",{value:p,onChange:De=>v(De.target.value),className:"w-full px-4 py-3 rounded-lg",style:{background:"#1A1C22",border:"1px solid #242632",color:"#FFFFFF"},children:[s.jsx("option",{value:"",children:"Select trend..."}),s.jsx("option",{value:"increasing",children:"Increasing"}),s.jsx("option",{value:"stable",children:"Stable"}),s.jsx("option",{value:"declining",children:"Declining"}),s.jsx("option",{value:"unknown",children:"Unknown"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold mb-2",style:{color:"#C9CBD6"},children:"Population decline (% over 10 years or 3 generations)"}),s.jsx("input",{type:"number",value:x,onChange:De=>_(De.target.value),placeholder:"e.g., 30",className:"w-full px-4 py-3 rounded-lg",style:{background:"#1A1C22",border:"1px solid #242632",color:"#FFFFFF"}}),s.jsx("p",{className:"text-xs mt-1",style:{color:"#8E91A3"},children:"Enter 0 if stable/increasing"})]})]}),s.jsxs("section",{className:"rounded-[18px] card-shadow p-4 space-y-4",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(Cf,{className:"w-5 h-5",style:{color:"#60A5FA"}}),s.jsx("h3",{className:"font-semibold",style:{color:"#FFFFFF"},children:"Geographic Range"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold mb-2",style:{color:"#C9CBD6"},children:"Extent of Occurrence (EOO) in km"}),s.jsx("input",{type:"number",value:j,onChange:De=>C(De.target.value),placeholder:"e.g., 18000",className:"w-full px-4 py-3 rounded-lg",style:{background:"#1A1C22",border:"1px solid #242632",color:"#FFFFFF"}}),s.jsxs("p",{className:"text-xs mt-1",style:{color:"#8E91A3"},children:[s.jsx("strong",{children:"CR:"})," ","<","100 km | ",s.jsx("strong",{children:"EN:"})," ","<","5,000 km | ",s.jsx("strong",{children:"VU:"})," ","<","20,000 km"]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold mb-2",style:{color:"#C9CBD6"},children:"Area of Occupancy (AOO) in km"}),s.jsx("input",{type:"number",value:F,onChange:De=>T(De.target.value),placeholder:"e.g., 2000",className:"w-full px-4 py-3 rounded-lg",style:{background:"#1A1C22",border:"1px solid #242632",color:"#FFFFFF"}}),s.jsxs("p",{className:"text-xs mt-1",style:{color:"#8E91A3"},children:[s.jsx("strong",{children:"CR:"})," ","<","10 km | ",s.jsx("strong",{children:"EN:"})," ","<","500 km | ",s.jsx("strong",{children:"VU:"})," ","<","2,000 km"]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold mb-2",style:{color:"#C9CBD6"},children:"Number of locations"}),s.jsx("input",{type:"number",value:A,onChange:De=>q(De.target.value),placeholder:"e.g., 5",className:"w-full px-4 py-3 rounded-lg",style:{background:"#1A1C22",border:"1px solid #242632",color:"#FFFFFF"}}),s.jsx("p",{className:"text-xs mt-1",style:{color:"#8E91A3"},children:"Locations defined by plausible threats (not subpopulations)"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",id:"severelyFragmented",checked:M,onChange:De=>U(De.target.checked),className:"w-5 h-5 rounded",style:{accentColor:"#D2110C"}}),s.jsx("label",{htmlFor:"severelyFragmented",className:"text-sm",style:{color:"#C9CBD6"},children:"Population is severely fragmented"})]})]}),s.jsxs("section",{className:"rounded-[18px] card-shadow p-4 space-y-4",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(Km,{className:"w-5 h-5",style:{color:"#60A5FA"}}),s.jsx("h3",{className:"font-semibold",style:{color:"#FFFFFF"},children:"Threats & Evidence"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold mb-2",style:{color:"#C9CBD6"},children:"Document threats and evidence for decline"}),s.jsx("textarea",{value:Z,onChange:De=>ne(De.target.value),placeholder:"Describe ongoing threats (e.g., habitat loss, climate change, invasive species) and evidence supporting the decline rate...",className:"w-full px-4 py-3 rounded-lg min-h-[120px]",style:{background:"#1A1C22",border:"1px solid #242632",color:"#FFFFFF"}})]})]}),ie&&s.jsxs("div",{className:"rounded-[18px] card-shadow p-4",style:{background:bu(ie).bg,border:`2px solid ${bu(ie).border}`},children:[s.jsxs("h3",{className:"font-semibold mb-2",style:{color:bu(ie).text},children:["Preliminary Category: ",ie]}),s.jsxs("p",{className:"text-sm mb-2",style:{color:"#C9CBD6"},children:[s.jsx("strong",{children:"Criteria met:"})," ",me||"None (Data Deficient)"]}),s.jsxs("p",{className:"text-sm",style:{color:"#C9CBD6"},children:[s.jsx("strong",{children:"Confidence:"})," ",ye,"%"]}),s.jsx("p",{className:"text-xs mt-2",style:{color:"#8E91A3"},children:"This is the preliminary category before Step 3 adjustments"})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{onClick:a,className:"flex-1 btn-secondary flex items-center justify-center gap-2 py-3",children:[s.jsx(go,{className:"w-5 h-5"}),"Back"]}),s.jsxs("button",{onClick:Te,disabled:!st,className:"flex-1 btn-primary flex items-center justify-center gap-2 py-3",children:["Continue to Step 3",s.jsx(Ls,{className:"w-5 h-5"})]})]})]})}function Ry(i){const{populationSize:n,declinePercent:r,eoo:a,aoo:d,locations:h,severelyFragmented:p}=i;let v="LC",x="";return r>=80?(v="CR",x="A"):r>=50?(v="EN",x="A"):r>=30&&(v="VU",x="A"),a<100&&(h<=1||p)?(v="CR",x=x?x+", B":"B"):a<5e3&&(h<=5||p)?v!=="CR"&&(v="EN",x=x?x+", B":"B"):a<2e4&&(h<=10||p)&&v!=="CR"&&v!=="EN"&&(v="VU",x=x?x+", B":"B"),n<250?(v="CR",x=x?x+", C":"C"):n<2500&&r>=25?v!=="CR"&&(v="EN",x=x?x+", C":"C"):n<1e4&&r>=10&&v!=="CR"&&v!=="EN"&&(v="VU",x=x?x+", C":"C"),!n&&!r&&!a&&!d?{category:"DD",criteria:"Insufficient data"}:{category:v,criteria:x||"None (Least Concern)"}}function Py(i){const{populationSize:n,declinePercent:r,eoo:a,aoo:d,locations:h,threats:p}=i;let v=0;return n&&(v+=20),r&&(v+=20),a&&(v+=15),d&&(v+=15),h&&(v+=10),p&&p.length>50&&(v+=20),Math.min(100,v)}function bu(i){const n={CR:{bg:"rgba(153, 27, 27, 0.2)",border:"#DC2626",text:"#FCA5A5"},EN:{bg:"rgba(194, 65, 12, 0.2)",border:"#EA580C",text:"#FDBA74"},VU:{bg:"rgba(161, 98, 7, 0.2)",border:"#D97706",text:"#FCD34D"},NT:{bg:"rgba(22, 163, 74, 0.2)",border:"#16A34A",text:"#86EFAC"},LC:{bg:"rgba(52, 211, 153, 0.2)",border:"#34D399",text:"#6EE7B7"},DD:{bg:"rgba(142, 145, 163, 0.2)",border:"#8E91A3",text:"#C9CBD6"}};return n[i]||n.LC}function Oy({data:i,onUpdate:n,onNext:r,onBack:a}){const[d,h]=V.useState(i.step3?.rescueEffect??null),[p,v]=V.useState(i.step3?.immigrationLikely??null),[x,_]=V.useState(i.step3?.sourceStable??null),[j,C]=V.useState(i.step3?.isSink??null),[F,T]=V.useState(i.step3?.adjustmentRationale||""),A=i.step2?.preliminaryCategory||"LC",[q,M]=V.useState(i.step3?.finalCategory||A),[U,Z]=V.useState(i.step3?.adjustmentSteps||0);V.useEffect(()=>{const me=Dy({preliminaryCategory:A,immigrationLikely:p,sourceStable:x,isSink:j});M(me.category),Z(me.steps)},[A,p,x,j]);const ne=()=>{n({rescueEffect:d,immigrationLikely:p,sourceStable:x,isSink:j,adjustmentSteps:U,adjustmentRationale:F,finalCategory:q}),r()},ie=d!==null&&F.trim().length>0,ee=q!==A;return s.jsxs("div",{className:"px-4 py-6 space-y-6",children:[s.jsxs("div",{className:"rounded-[18px] px-4 py-3",style:{background:"rgba(167, 139, 250, 0.15)",border:"1px solid rgba(167, 139, 250, 0.3)"},children:[s.jsx("h2",{className:"font-semibold",style:{color:"#A78BFA"},children:"Step 3: Adjustment via Extra-regional Populations"}),s.jsx("p",{className:"text-sm mt-1",style:{color:"#C9CBD6"},children:"Consider rescue effect and sink dynamics"})]}),s.jsxs("div",{className:"rounded-[18px] card-shadow p-4",style:{background:"#14151A",border:"1px solid #60A5FA"},children:[s.jsx("h3",{className:"font-semibold mb-2",style:{color:"#60A5FA"},children:"Preliminary Category (from Step 2)"}),s.jsx("p",{className:"text-2xl font-bold",style:{color:"#FFFFFF"},children:A}),i.step2?.criteriaMet&&s.jsxs("p",{className:"text-sm mt-1",style:{color:"#C9CBD6"},children:["Criteria: ",i.step2.criteriaMet]})]}),s.jsxs("div",{className:"rounded-[18px] card-shadow p-4 flex items-start gap-3",style:{background:"#1A1C22",border:"1px solid #B45309"},children:[s.jsx(Ku,{className:"w-5 h-5 flex-shrink-0 mt-0.5",style:{color:"#FCD34D"}}),s.jsxs("div",{className:"text-sm",style:{color:"#FCD34D"},children:[s.jsx("strong",{children:"Key Principle:"})," Rescue effect typically results in downlisting (lower risk). Uplisting is rare and only when the regional population is a sink dependent on immigration from sources expected to decrease."]})]}),s.jsxs("section",{className:"rounded-[18px] card-shadow p-4 space-y-4",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsx("h3",{className:"font-semibold",style:{color:"#FFFFFF"},children:"Is rescue effect likely from extra-regional populations?"}),s.jsx("p",{className:"text-sm",style:{color:"#C9CBD6"},children:"Rescue effect occurs when immigration from populations outside the region increases the viability of the regional population"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:()=>{h("yes"),v(null),_(null)},className:"w-full px-4 py-4 rounded-lg text-left transition-all",style:{background:d==="yes"?"rgba(210, 17, 12, 0.15)":"#1A1C22",border:d==="yes"?"2px solid #D2110C":"1px solid #242632"},children:[s.jsx("div",{className:"font-semibold",style:{color:"#FFFFFF"},children:"Yes, rescue effect likely"}),s.jsx("div",{className:"text-sm mt-1",style:{color:"#8E91A3"},children:"Immigration probable from stable sources"})]}),s.jsxs("button",{onClick:()=>{h("no"),v(!1),_(!1),C(null)},className:"w-full px-4 py-4 rounded-lg text-left transition-all",style:{background:d==="no"?"rgba(210, 17, 12, 0.15)":"#1A1C22",border:d==="no"?"2px solid #D2110C":"1px solid #242632"},children:[s.jsx("div",{className:"font-semibold",style:{color:"#FFFFFF"},children:"No rescue effect"}),s.jsx("div",{className:"text-sm mt-1",style:{color:"#8E91A3"},children:"Population is isolated or sources unstable"})]}),s.jsxs("button",{onClick:()=>{h("uncertain"),v(null),_(null),C(null)},className:"w-full px-4 py-4 rounded-lg text-left transition-all",style:{background:d==="uncertain"?"rgba(210, 17, 12, 0.15)":"#1A1C22",border:d==="uncertain"?"2px solid #D2110C":"1px solid #242632"},children:[s.jsx("div",{className:"font-semibold",style:{color:"#FFFFFF"},children:"Uncertain"}),s.jsx("div",{className:"text-sm mt-1",style:{color:"#8E91A3"},children:"Insufficient information"})]})]})]}),d==="yes"&&s.jsxs("section",{className:"rounded-[18px] card-shadow p-4 space-y-4",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsx("h3",{className:"font-semibold",style:{color:"#FFFFFF"},children:"Immigration and Source Population Details"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold mb-3",style:{color:"#C9CBD6"},children:"Is immigration of propagules likely?"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("button",{onClick:()=>v(!0),className:"w-full px-4 py-3 rounded-lg text-left transition-all",style:{background:p===!0?"rgba(210, 17, 12, 0.15)":"#1A1C22",border:p===!0?"2px solid #D2110C":"1px solid #242632"},children:s.jsx("div",{className:"font-semibold",style:{color:"#FFFFFF"},children:"Yes, immigration likely"})}),s.jsx("button",{onClick:()=>v(!1),className:"w-full px-4 py-3 rounded-lg text-left transition-all",style:{background:p===!1?"rgba(210, 17, 12, 0.15)":"#1A1C22",border:p===!1?"2px solid #D2110C":"1px solid #242632"},children:s.jsx("div",{className:"font-semibold",style:{color:"#FFFFFF"},children:"No, immigration unlikely"})})]})]}),p!==null&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold mb-3",style:{color:"#C9CBD6"},children:"Are source populations stable or increasing?"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("button",{onClick:()=>_(!0),className:"w-full px-4 py-3 rounded-lg text-left transition-all",style:{background:x===!0?"rgba(210, 17, 12, 0.15)":"#1A1C22",border:x===!0?"2px solid #D2110C":"1px solid #242632"},children:s.jsx("div",{className:"font-semibold",style:{color:"#FFFFFF"},children:"Yes, sources stable/increasing"})}),s.jsx("button",{onClick:()=>_(!1),className:"w-full px-4 py-3 rounded-lg text-left transition-all",style:{background:x===!1?"rgba(210, 17, 12, 0.15)":"#1A1C22",border:x===!1?"2px solid #D2110C":"1px solid #242632"},children:s.jsx("div",{className:"font-semibold",style:{color:"#FFFFFF"},children:"No, sources declining"})})]})]}),p===!0&&x===!0&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold mb-3",style:{color:"#C9CBD6"},children:"Is the regional population a demographic sink?"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("button",{onClick:()=>C(!1),className:"w-full px-4 py-3 rounded-lg text-left transition-all",style:{background:j===!1?"rgba(210, 17, 12, 0.15)":"#1A1C22",border:j===!1?"2px solid #D2110C":"1px solid #242632"},children:s.jsx("div",{className:"font-semibold",style:{color:"#FFFFFF"},children:"No, not a sink"})}),s.jsx("button",{onClick:()=>C(!0),className:"w-full px-4 py-3 rounded-lg text-left transition-all",style:{background:j===!0?"rgba(210, 17, 12, 0.15)":"#1A1C22",border:j===!0?"2px solid #D2110C":"1px solid #242632"},children:s.jsx("div",{className:"font-semibold",style:{color:"#FFFFFF"},children:"Yes, demographic sink"})})]})]})]}),d!==null&&s.jsxs("section",{className:"rounded-[18px] card-shadow p-4 space-y-3",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsx("label",{className:"block text-sm font-semibold",style:{color:"#FFFFFF"},children:"Adjustment Rationale & Evidence"}),s.jsx("textarea",{value:F,onChange:me=>T(me.target.value),placeholder:"Document the evidence and reasoning for adjustment (or no adjustment), including connectivity, source population status, and any sink dynamics...",className:"w-full px-4 py-3 rounded-lg min-h-[120px]",style:{background:"#1A1C22",border:"1px solid #242632",color:"#FFFFFF"}})]}),d!==null&&s.jsxs("div",{className:"rounded-[18px] card-shadow p-4",style:{background:ee?"rgba(167, 139, 250, 0.15)":"rgba(142, 145, 163, 0.1)",border:ee?"2px solid #A78BFA":"2px solid #8E91A3"},children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold",style:{color:"#FFFFFF"},children:"Final Regional Category"}),s.jsx("p",{className:"text-sm",style:{color:"#C9CBD6"},children:ee?"Category adjusted":"No adjustment applied"})]}),ee&&U!==0&&s.jsx("div",{className:"flex items-center gap-2",children:U>0?s.jsx(em,{className:"w-6 h-6",style:{color:"#10B981"}}):s.jsx(sm,{className:"w-6 h-6",style:{color:"#EF4444"}})})]}),s.jsxs("div",{className:"flex items-baseline gap-3",children:[s.jsxs("p",{className:"text-3xl font-bold",style:{color:"#FFFFFF"},children:[q,ee?"":""]}),ee&&s.jsxs("p",{className:"text-sm",style:{color:"#8E91A3"},children:["(was ",A,")"]})]}),ee&&s.jsx("p",{className:"text-xs mt-2",style:{color:"#8E91A3"},children:" Category notation indicates adjustment from preliminary category"})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{onClick:a,className:"flex-1 btn-secondary flex items-center justify-center gap-2 py-3",children:[s.jsx(go,{className:"w-5 h-5"}),"Back"]}),s.jsxs("button",{onClick:ne,disabled:!ie,className:"flex-1 btn-primary flex items-center justify-center gap-2 py-3",children:["Continue to Output",s.jsx(Ls,{className:"w-5 h-5"})]})]})]})}function Dy(i){const{preliminaryCategory:n,immigrationLikely:r,sourceStable:a,isSink:d}=i,h=["CR","EN","VU","NT","LC"],p=h.indexOf(n);if(p===-1)return{category:n,steps:0};if(r===!0&&a===!0&&d===!1){const v=Math.min(p+1,h.length-1);return{category:h[v],steps:1}}if(d===!0&&a===!1){const v=Math.max(p-1,0);return{category:h[v],steps:-1}}return{category:n,steps:0}}function Iy({data:i,onBack:n,onComplete:r}){const[a,d]=V.useState(!1),h=i.step3?.finalCategory||i.step2?.preliminaryCategory||"Unknown",p=i.step2?.criteriaMet||"Unknown",v=i.step2?.confidence||0,x=(i.step3?.adjustmentSteps||0)!==0,_=j=>{const C={taxon:{commonName:i.taxonName,scientificName:i.scientificName},assessment:{finalRegionalCategory:h+(x?"":""),criteriaMet:p,preliminaryCategory:i.step2?.preliminaryCategory,adjustmentSteps:i.step3?.adjustmentSteps||0,adjustmentRationale:i.step3?.adjustmentRationale,confidence:v},step1:i.step1,step2:i.step2,step3:i.step3,metadata:{assessmentDate:i.lastModified,assessmentId:i.id,region:localStorage.getItem("selectedRegion")}};if(j==="json"){const F=new Blob([JSON.stringify(C,null,2)],{type:"application/json"}),T=URL.createObjectURL(F),A=document.createElement("a");A.href=T,A.download=`assessment-${i.id}.json`,A.click()}else if(j==="csv"){const F=`Scientific Name,Common Name,Regional Category,Criteria,Preliminary Category,Adjustment Steps,Confidence
"${i.scientificName}","${i.taxonName}","${h}${x?"":""}","${p}","${i.step2?.preliminaryCategory||""}","${i.step3?.adjustmentSteps||0}","${v}%"`,T=new Blob([F],{type:"text/csv"}),A=URL.createObjectURL(T),q=document.createElement("a");q.href=A,q.download=`assessment-${i.id}.csv`,q.click()}else alert("PDF export would be generated here. This requires server-side rendering.");d(!1)};return s.jsxs("div",{className:"px-4 py-6 space-y-6",children:[s.jsxs("div",{className:"rounded-[18px] px-4 py-3",style:{background:"rgba(52, 211, 153, 0.15)",border:"1px solid rgba(52, 211, 153, 0.3)"},children:[s.jsx("h2",{className:"font-semibold",style:{color:"#34D399"},children:"Assessment Complete"}),s.jsx("p",{className:"text-sm mt-1",style:{color:"#C9CBD6"},children:"Review and export your results"})]}),s.jsxs("div",{className:"rounded-[18px] card-shadow p-6 text-center",style:{background:"#14151A",border:"2px solid #D2110C"},children:[s.jsx("p",{className:"text-sm font-semibold mb-2",style:{color:"#C9CBD6"},children:"Final Regional Category"}),s.jsxs("p",{className:"text-4xl font-bold mb-3",style:{color:"#FFFFFF"},children:[h,x?"":""]}),s.jsxs("p",{className:"text-sm",style:{color:"#C9CBD6"},children:["Criteria: ",p]}),x&&s.jsx("p",{className:"text-xs mt-2",style:{color:"#8E91A3"},children:" Category adjusted via Step 3"}),s.jsxs("p",{className:"text-sm mt-3 pt-3",style:{color:"#C9CBD6",borderTop:"1px solid #242632"},children:["Confidence: ",v,"%"]})]}),s.jsxs("div",{className:"rounded-[18px] card-shadow p-4",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsx("h3",{className:"font-semibold mb-3",style:{color:"#FFFFFF"},children:"Plain-Language Rationale"}),s.jsxs("div",{className:"space-y-3 text-sm",style:{color:"#C9CBD6"},children:[s.jsxs("p",{children:[s.jsx("strong",{style:{color:"#FFFFFF"},children:"Taxon:"})," ",i.taxonName," (",s.jsx("em",{children:i.scientificName}),")"]}),s.jsxs("p",{children:[s.jsx("strong",{style:{color:"#FFFFFF"},children:"Eligibility:"})," ",i.step1?.eligible?"Eligible for assessment. "+(i.step1.rationale||""):"Not eligible for assessment."]}),i.step2&&s.jsxs("p",{children:[s.jsx("strong",{style:{color:"#FFFFFF"},children:"Regional Population Assessment:"})," The regional population",i.step2.populationSize?` comprises approximately ${i.step2.populationSize} mature individuals`:"",".",i.step2.declinePercent?` A ${i.step2.declinePercent}% decline has been observed over 10 years.`:""," ","Based on IUCN criteria applied to regional data, the preliminary category is ",i.step2.preliminaryCategory,"."]}),i.step3&&i.step3.adjustmentRationale&&s.jsxs("p",{children:[s.jsx("strong",{style:{color:"#FFFFFF"},children:"Extra-regional Influence:"})," ",i.step3.adjustmentRationale]})]})]}),s.jsxs("div",{className:"rounded-[18px] card-shadow p-4",style:{background:"#14151A",border:"1px solid rgba(96, 165, 250, 0.3)"},children:[s.jsx("h3",{className:"font-semibold mb-3",style:{color:"#60A5FA"},children:"What to Do Next"}),s.jsxs("ul",{className:"space-y-2 text-sm",style:{color:"#C9CBD6"},children:[s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx(Xr,{className:"w-4 h-4 flex-shrink-0 mt-0.5",style:{color:"#34D399"}}),s.jsx("span",{children:"Review all sections for completeness and accuracy"})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx(Xr,{className:"w-4 h-4 flex-shrink-0 mt-0.5",style:{color:"#34D399"}}),s.jsx("span",{children:"Gather additional evidence to improve confidence score (if needed)"})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx(Xr,{className:"w-4 h-4 flex-shrink-0 mt-0.5",style:{color:"#34D399"}}),s.jsx("span",{children:"Export assessment for review by senior assessors"})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx(Xr,{className:"w-4 h-4 flex-shrink-0 mt-0.5",style:{color:"#34D399"}}),s.jsx("span",{children:"Seek extra-regional population data to reduce uncertainty (if unknown)"})]})]})]}),v<80&&s.jsxs("div",{className:"rounded-[18px] card-shadow p-4",style:{background:"#1A1C22",border:"1px solid #B45309"},children:[s.jsx("h3",{className:"font-semibold mb-3",style:{color:"#FCD34D"},children:"Improve Confidence"}),s.jsx("p",{className:"text-sm mb-2",style:{color:"#FCD34D"},children:"Consider collecting additional data on:"}),s.jsxs("ul",{className:"space-y-1 text-sm",style:{color:"#C9CBD6"},children:[!i.step2?.eoo&&s.jsx("li",{children:" Extent of Occurrence (EOO)"}),!i.step2?.aoo&&s.jsx("li",{children:" Area of Occupancy (AOO)"}),!i.step2?.locations&&s.jsx("li",{children:" Number of locations"}),(!i.step2?.threats||i.step2.threats.length<50)&&s.jsx("li",{children:" Detailed threat assessment"}),i.step3?.rescueEffect==="uncertain"&&s.jsx("li",{children:" Extra-regional population status"})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:()=>d(!0),className:"w-full btn-primary flex items-center justify-center gap-2 py-4",children:[s.jsx(zl,{className:"w-5 h-5"}),"Export Assessment"]}),s.jsx("button",{onClick:()=>{const j=localStorage.getItem("assessments");if(j){const C=JSON.parse(j),F=C.findIndex(T=>T.id===i.id);F!==-1&&(C[F]={...C[F],status:"completed",completedAt:new Date().toISOString(),finalCategory:h,criteriaString:p,adjusted:x,stepsChanged:i.step3?.adjustmentSteps||0,currentStep:4,lastModified:new Date().toISOString()},localStorage.setItem("assessments",JSON.stringify(C)),window.dispatchEvent(new CustomEvent("assessmentCompleted",{detail:{assessmentId:i.id}})))}r()},className:"w-full btn-secondary flex items-center justify-center gap-2 py-4",children:"Complete & Return Home"})]}),a&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{background:"rgba(0, 0, 0, 0.8)"},children:s.jsxs("div",{className:"rounded-[18px] max-w-md w-full p-6",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsx("h3",{className:"text-xl font-semibold mb-4",style:{color:"#FFFFFF"},children:"Export Assessment"}),s.jsx("p",{className:"text-sm mb-4",style:{color:"#C9CBD6"},children:"Choose export format. All exports include the full audit trail and meet IUCN documentation requirements."}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:()=>_("json"),className:"w-full px-4 py-3 rounded-lg text-left flex items-center gap-3 transition-all",style:{background:"#1A1C22",border:"2px solid #242632"},children:[s.jsx(mo,{className:"w-5 h-5",style:{color:"#60A5FA"}}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",style:{color:"#FFFFFF"},children:"JSON"}),s.jsx("div",{className:"text-xs",style:{color:"#8E91A3"},children:"Complete data export for archiving"})]})]}),s.jsxs("button",{onClick:()=>_("csv"),className:"w-full px-4 py-3 rounded-lg text-left flex items-center gap-3 transition-all",style:{background:"#1A1C22",border:"2px solid #242632"},children:[s.jsx(mo,{className:"w-5 h-5",style:{color:"#60A5FA"}}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",style:{color:"#FFFFFF"},children:"CSV"}),s.jsx("div",{className:"text-xs",style:{color:"#8E91A3"},children:"Spreadsheet format for Red List tables"})]})]}),s.jsxs("button",{onClick:()=>_("pdf"),className:"w-full px-4 py-3 rounded-lg text-left flex items-center gap-3 transition-all",style:{background:"#1A1C22",border:"2px solid #242632"},children:[s.jsx(mo,{className:"w-5 h-5",style:{color:"#60A5FA"}}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",style:{color:"#FFFFFF"},children:"PDF Report"}),s.jsx("div",{className:"text-xs",style:{color:"#8E91A3"},children:"Full narrative with appendices"})]})]})]}),s.jsx("div",{className:"mt-6",children:s.jsx("button",{onClick:()=>d(!1),className:"w-full btn-secondary py-3",children:"Cancel"})})]})})]})}function My({assessmentId:i,onBack:n}){const[r,a]=V.useState(null),[d,h]=V.useState(1);V.useEffect(()=>{if(i){const j=localStorage.getItem("assessments");if(j){const F=JSON.parse(j).find(T=>T.id===i);F&&(a(F),h(F.currentStep||1))}}else a({id:`new-${Date.now()}`,taxonName:"New Taxon",scientificName:"Species name",status:"draft",currentStep:1,lastModified:new Date().toISOString()})},[i]);const p=j=>{if(!r)return;const C={...r,...j,lastModified:new Date().toISOString()};a(C);const F=localStorage.getItem("assessments"),T=F?JSON.parse(F):[],A=T.findIndex(q=>q.id===C.id);A>=0?T[A]=C:T.push(C),localStorage.setItem("assessments",JSON.stringify(T))},v=j=>{p({step1:j,currentStep:2}),h(2)},x=j=>{p({step2:j,currentStep:3}),h(3)},_=j=>{p({step3:j,currentStep:4,status:"ready-for-review"}),h(4)};return r?s.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:"linear-gradient(180deg, #0B0B0D 0%, #0F1013 100%)"},children:[s.jsx("header",{className:"px-4 py-4 safe-area-top",style:{background:"#14151A",borderBottom:"1px solid #242632"},children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:n,className:"p-2 -ml-2 rounded-lg",style:{color:"#C9CBD6"},children:s.jsx(go,{className:"w-6 h-6"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h1",{className:"font-semibold truncate",style:{color:"#FFFFFF"},children:r?.taxonName||"New Assessment"}),s.jsx("p",{className:"text-sm italic truncate",style:{color:"#8E91A3"},children:r?.scientificName})]})]})}),s.jsxs("div",{className:"px-4 py-3",style:{background:"#14151A",borderBottom:"1px solid #242632"},children:[s.jsx("div",{className:"flex gap-2",children:[1,2,3,4].map(j=>s.jsx("div",{className:"flex-1 h-1 rounded-full transition-all",style:{background:d>=j?"#D2110C":"#242632"}},j))}),s.jsxs("p",{className:"text-xs mt-2 text-center",style:{color:"#8E91A3"},children:["Step ",d," of 4"]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto content-safe-bottom",children:[d===1&&r&&s.jsx(Ay,{data:r,onUpdate:v,onNext:()=>h(2)}),d===2&&r&&s.jsx(Ty,{data:r,onUpdate:x,onNext:()=>h(3),onBack:()=>h(1)}),d===3&&r&&s.jsx(Oy,{data:r,onUpdate:_,onNext:()=>h(4),onBack:()=>h(2)}),d===4&&r&&s.jsx(Iy,{data:r,onBack:()=>h(3),onComplete:n})]})]}):s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsx("p",{className:"text-gray-600",children:"Loading assessment..."})})}function Ly({moduleId:i,onClose:n,onComplete:r}){const[a,d]=V.useState(0),[h,p]=V.useState(!1),[v,x]=V.useState(null),_=By(i),j=_.pages[a],C=a===_.pages.length-1;V.useEffect(()=>{const M=localStorage.getItem(`module-${i}-progress`);if(M){const{currentPageIndex:U}=JSON.parse(M);d(U)}},[i]);const F=M=>{const U={currentPageIndex:M,completionPercent:Math.round((M+1)/_.pages.length*100),lastOpenedAt:new Date().toISOString()};localStorage.setItem(`module-${i}-progress`,JSON.stringify(U));const Z=JSON.parse(localStorage.getItem("moduleProgress")||'{"step1":0,"step2":0,"step3":0}'),ne=`step${i}`;Z[ne]=U.completionPercent,localStorage.setItem("moduleProgress",JSON.stringify(Z))},T=()=>{if(j.quickCheck&&!v){p(!0);return}if(C){F(_.pages.length-1);const M=JSON.parse(localStorage.getItem("moduleProgress")||'{"step1":0,"step2":0,"step3":0}'),U=`step${i}`;M[U]=100,localStorage.setItem("moduleProgress",JSON.stringify(M));const Z=new CustomEvent("moduleCompleted",{detail:{moduleId:i,step:U}});window.dispatchEvent(Z),r()}else{const M=a+1;d(M),F(M),p(!1),x(null)}},A=()=>{if(a>0){const M=a-1;d(M),p(!1),x(null)}},q=M=>{x(M?"correct":"wrong")};return s.jsxs("div",{className:"fixed inset-0 z-50 flex flex-col",style:{background:"linear-gradient(180deg, #0B0B0D 0%, #0F1013 100%)"},children:[s.jsxs("header",{className:"px-4 py-4 safe-area-top border-b",style:{borderColor:"#242632"},children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h1",{className:"text-lg font-bold",style:{color:"#FFFFFF"},children:_.title}),s.jsx("button",{onClick:n,className:"w-10 h-10 rounded-full flex items-center justify-center transition-all",style:{background:"#14151A"},children:s.jsx(Sr,{className:"w-5 h-5",style:{color:"#C9CBD6"}})})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"text-sm",style:{color:"#8E91A3"},children:["Page ",a+1," of ",_.pages.length]}),s.jsx("div",{className:"flex-1 h-1.5 rounded-full overflow-hidden",style:{background:"#14151A"},children:s.jsx("div",{className:"h-full transition-all duration-300",style:{width:`${(a+1)/_.pages.length*100}%`,background:"#D2110C"}})})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-6",children:s.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold mb-3",style:{color:"#FFFFFF"},children:j.heading}),s.jsx("p",{className:"text-base leading-relaxed",style:{color:"#C9CBD6"},children:j.body})]}),j.exampleCard&&s.jsxs("div",{className:"rounded-xl p-4 space-y-3",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsx("p",{className:"text-xs font-semibold",style:{color:"#60A5FA"},children:" Example (read-only)"}),j.exampleCard.fields.map((M,U)=>s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold mb-2",style:{color:"#C9CBD6"},children:M.label}),s.jsx("div",{className:"w-full px-4 py-3 rounded-lg",style:{background:"rgba(96, 165, 250, 0.1)",border:"1px solid rgba(96, 165, 250, 0.3)"},children:s.jsx("p",{className:"text-base font-semibold",style:{color:"#FFFFFF"},children:M.value})})]},U))]}),j.outputFields&&s.jsxs("div",{className:"rounded-xl p-4 space-y-3",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsx("p",{className:"text-xs font-semibold",style:{color:"#34D399"},children:" Output (example)"}),j.outputFields.map((M,U)=>s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold mb-2",style:{color:"#C9CBD6"},children:M.label}),s.jsx("div",{className:"w-full px-4 py-3 rounded-lg",style:{background:"rgba(52, 211, 153, 0.1)",border:"1px solid rgba(52, 211, 153, 0.3)"},children:s.jsx("p",{className:"text-base font-semibold",style:{color:"#FFFFFF"},children:M.value})})]},U))]}),j.importantCallout&&s.jsxs("div",{className:"rounded-xl p-4",style:{background:"rgba(210, 17, 12, 0.15)",border:"1px solid rgba(210, 17, 12, 0.4)"},children:[s.jsx("p",{className:"text-xs font-semibold mb-1",style:{color:"#D2110C"},children:" Important Rule"}),s.jsx("p",{className:"text-sm",style:{color:"#C9CBD6"},children:j.importantCallout})]}),j.callout&&s.jsxs("div",{className:"rounded-xl p-4",style:{background:"rgba(210, 17, 12, 0.1)",border:"1px solid rgba(210, 17, 12, 0.3)"},children:[s.jsx("p",{className:"text-xs font-semibold mb-1",style:{color:"#D2110C"},children:" Why This Matters"}),s.jsx("p",{className:"text-sm",style:{color:"#C9CBD6"},children:j.callout})]}),j.quickCheck&&h&&s.jsxs("div",{className:"rounded-xl p-4",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsx("p",{className:"text-xs font-semibold mb-3",style:{color:"#A78BFA"},children:" Quick Check"}),s.jsx("p",{className:"text-base font-semibold mb-4",style:{color:"#FFFFFF"},children:j.quickCheck.question}),v===null&&s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>q(j.quickCheck.correctAnswer==="Yes"),className:"flex-1 py-3 px-4 rounded-xl text-base font-semibold transition-all",style:{background:"#14151A",border:"2px solid #242632",color:"#FFFFFF"},children:"Yes"}),s.jsx("button",{onClick:()=>q(j.quickCheck.correctAnswer==="No"),className:"flex-1 py-3 px-4 rounded-xl text-base font-semibold transition-all",style:{background:"#14151A",border:"2px solid #242632",color:"#FFFFFF"},children:"No"})]}),v==="correct"&&s.jsx("div",{className:"rounded-lg p-3",style:{background:"rgba(16, 185, 129, 0.15)",border:"1px solid rgba(16, 185, 129, 0.3)"},children:s.jsxs("p",{className:"text-sm font-semibold",style:{color:"#10B981"},children:[" Correct! ",j.quickCheck.correctAnswer]})}),v==="wrong"&&s.jsxs("div",{className:"rounded-lg p-3",style:{background:"rgba(239, 68, 68, 0.15)",border:"1px solid rgba(239, 68, 68, 0.3)"},children:[s.jsx("p",{className:"text-sm font-semibold mb-1",style:{color:"#EF4444"},children:"Try again"}),s.jsx("p",{className:"text-sm",style:{color:"#C9CBD6"},children:j.quickCheck.wrongFeedback||`The correct answer is: ${j.quickCheck.correctAnswer}`}),s.jsx("button",{onClick:()=>x(null),className:"mt-3 py-2 px-4 rounded-lg text-sm font-semibold transition-all",style:{background:"#D2110C",color:"#FFFFFF"},children:"Retry"})]})]}),C&&j.finishMessage&&s.jsx("div",{className:"rounded-xl p-4",style:{background:"rgba(52, 211, 153, 0.1)",border:"1px solid rgba(52, 211, 153, 0.3)"},children:s.jsxs("p",{className:"text-sm font-semibold",style:{color:"#10B981"},children:[" ",j.finishMessage]})})]})}),s.jsx("div",{className:"px-4 py-4 border-t",style:{borderColor:"#242632",paddingBottom:"max(16px, calc(16px + env(safe-area-inset-bottom)))"},children:s.jsxs("div",{className:"flex gap-3 max-w-2xl mx-auto",children:[s.jsx("button",{onClick:A,disabled:a===0,className:"flex-1 py-3 px-4 rounded-xl text-base font-semibold transition-all",style:{background:"transparent",border:"2px solid #242632",color:"#FFFFFF",opacity:a===0?.5:1},children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx(go,{className:"w-5 h-5"}),"Back"]})}),s.jsx("button",{onClick:T,className:"flex-1 py-3 px-4 rounded-xl text-base font-semibold transition-all",style:{background:"#D2110C",color:"#FFFFFF"},children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[C?"Finish Module":"Next",!C&&s.jsx(Ls,{className:"w-5 h-5"})]})})]})})]})}function By(i){return{1:{title:"Step 1  Eligibility",pages:[{pageNumber:1,heading:"Step 1 decides what can be assessed",body:"Step 1 determines whether a taxon (and which population in your region) is eligible for a regional/national assessment. This prevents invalid cases from being forced into threat categories.",quickCheck:{question:"Does Step 1 assign a threat category?",correctAnswer:"No",wrongFeedback:"That's Step 2! Step 1 only determines eligibility."}},{pageNumber:2,heading:"Keep processes separate",body:"Red Listing measures extinction risk. Conservation priority-setting is a different process and must not be mixed into category assignment.",quickCheck:{question:'Is "high priority for funding" a Red List category input?',correctAnswer:"No",wrongFeedback:"Correct! Funding priority is separate from extinction risk."}},{pageNumber:3,heading:"Assess only eligible populations",body:"Regional assessment applies to wild populations in their natural range and certain benign introductions.",exampleCard:{fields:[{label:"Wild population",value:"yes"},{label:"Within natural range",value:"yes"}]},quickCheck:{question:"Introduced invasive populations are assessed as threatened?",correctAnswer:"No",wrongFeedback:"Correct! Invasive introductions typically receive NA."}},{pageNumber:4,heading:"Benign introductions are special",body:"A benign introduction is a conservation-driven establishment outside recorded distribution, in suitable habitat/ecogeographical area, usually when historic range is no longer available.",exampleCard:{fields:[{label:"Example",value:"Translocation to suitable habitat after habitat loss: benign introduction"}]},quickCheck:{question:"Benign introductions can be considered eligible if self-sustaining?",correctAnswer:"Yes",wrongFeedback:"Yes, but context-dependent and must be documented."}},{pageNumber:5,heading:"Identify what occurs in your region",body:"A breeding population reproduces in-region. A visiting population occurs regularly but doesn't reproduce in-region.",exampleCard:{fields:[{label:"Breeding",value:"confirmed nesting"},{label:"Visiting",value:"regular wintering only"}]},quickCheck:{question:"If breeding and visiting are distinguishable, assess separately?",correctAnswer:"Yes"}},{pageNumber:6,heading:"Vagrants cannot be assessed",body:"Vagrants occur only occasionally/accidentally in the region. They are not assessed. Regions must define the boundary between visitors and vagrants (e.g., predictability, % global pop).",quickCheck:{question:"A single accidental sighting = visitor?",correctAnswer:"No",wrongFeedback:"No  that's a vagrant and receives NA."}},{pageNumber:7,heading:"Don't assess too early",body:"Newly colonising taxa should not be assessed until reproduction in-region is sustained for several years (often ~10 consecutive years, per policy).",exampleCard:{fields:[{label:"Years of breeding",value:"3 years of breeding: wait"}]},quickCheck:{question:"Reproduction for 1 year is enough for a new coloniser?",correctAnswer:"No"}},{pageNumber:8,heading:"Filters are allowed (if documented)",body:'Some processes use a pre-filter (e.g., "<1% global population in-region"). If a filter is applied, below-threshold taxa become NA and the decision must be recorded transparently.',quickCheck:{question:"If filter excludes a taxon, do we still assign a threat category?",correctAnswer:"No",wrongFeedback:"No  excluded taxa receive NA."}},{pageNumber:9,heading:"RE is a strong claim",body:"RE means no reasonable doubt the last potentially reproductive individual in the region has disappeared/died. Time limits may be set regionally, but should not normally pre-date 1500 AD.",quickCheck:{question:"A few old individuals remain but no breeding: RE?",correctAnswer:"No",wrongFeedback:"Not necessarilydepends; document carefully."}},{pageNumber:10,heading:"Your Step 1 outcome",body:"Step 1 ends with one of these outcomes: Assess breeding only, Assess visiting only, Assess both separately, NA (Not Applicable), or RE (Regionally Extinct).",finishMessage:"You're ready for Step 2: preliminary category using regional data.",callout:"Step 1 is about inclusion/exclusion logic, not threat categories."}]},2:{title:"Step 2  Preliminary Category",pages:[{pageNumber:1,heading:"Assign a preliminary category (regional)",body:"Step 2 applies the IUCN Red List criteria to the regional population to produce a preliminary category.",importantCallout:"Regional data only.",callout:"Criteria AE thresholds and detailed rules come from external IUCN docs; this module trains workflow discipline and inputs."},{pageNumber:2,heading:"Do not substitute global estimates",body:"Your population size, trends, AOO/EOO, locations, and fragmentation inputs must describe the regional population. Global values belong only in metadata fields (e.g., global category).",quickCheck:{question:"Can you use global population size for Step 2 if regional is unknown?",correctAnswer:"No",wrongFeedback:"Use best regional estimate/uncertainty + document."}},{pageNumber:3,heading:"Every key number needs support",body:"Before entering values, identify evidence types: surveys, monitoring, expert elicitation, habitat models, published records.",exampleCard:{fields:[{label:"Example",value:"EOO from mapped occurrences + method note."}]},quickCheck:{question:`Is "I feel it's declining" enough without evidence notes?`,correctAnswer:"No"}},{pageNumber:4,heading:"Use mature individuals where required",body:"Capture regional estimate, uncertainty range, and basis (count, inference, model).",exampleCard:{fields:[{label:"Regional mature individuals",value:"1,200 (9001,600), survey 20242025."}]},quickCheck:{question:"Should you record uncertainty ranges?",correctAnswer:"Yes",wrongFeedback:"Yes, when uncertain."}},{pageNumber:5,heading:"Range metrics are regional, method matters",body:"Record how AOO/EOO were calculated and the spatial resolution assumptions.",exampleCard:{fields:[{label:"AOO",value:"120 km using 22 km grid (example)."}]},quickCheck:{question:"AOO/EOO should include areas outside the region boundary?",correctAnswer:"No",wrongFeedback:"No, for regional inputs."}},{pageNumber:6,heading:"Capture risk structure",body:"Record number of locations, severe fragmentation (if applicable), and what threats define locations.",quickCheck:{question:'Are "locations" the same as "sites"?',correctAnswer:"No",wrongFeedback:"Not necessarilylocations relate to threat-driven events."}},{pageNumber:7,heading:"Declines must be described",body:"Record observed/inferred/projected declines and what drives them (habitat loss, exploitation, invasive species, etc.).",quickCheck:{question:"Can declines be inferred?",correctAnswer:"Yes",wrongFeedback:"Yes, if justified."}},{pageNumber:8,heading:"Mechanism matters",body:"Capture major threats, habitat trend, and whether they are ongoing.",exampleCard:{fields:[{label:"Example",value:"Habitat quality declining due to land clearing (regional)."}]}},{pageNumber:9,heading:"Step 2 produces a preliminary category",body:"The system compiles your inputs into a preliminary category + criteria string (where supported).",callout:"This is not final until Step 3."},{pageNumber:10,heading:"What you still need externally",body:"Detailed criteria thresholds and full rules are from external IUCN docs (Categories & Criteria v3.1 + Using the Criteria).",finishMessage:"Now learn Step 3: adjustment via rescue/sink logic."}]},3:{title:"Step 3  Adjustment",pages:[{pageNumber:1,heading:"Adjust preliminary category (if justified)",body:"Step 3 considers conspecific populations outside the region and adjusts the Step 2 category only when extra-regional dynamics plausibly change extinction risk."},{pageNumber:2,heading:"Isolated or endemic populations",body:"If the regional population is essentially isolated (or the taxon is endemic to the region), Step 3 usually makes no change.",quickCheck:{question:"Endemic taxon  adjust down due to rescue?",correctAnswer:"No"}},{pageNumber:3,heading:"Immigration can reduce extinction risk",body:"If immigration of propagules is likely and habitat allows establishment, extinction risk may be lower than Step 2 suggests.",exampleCard:{fields:[{label:"Example",value:"Stable source populations + connectivity  rescue plausible."}]}},{pageNumber:4,heading:"If uncertain, keep Step 2",body:"If it is unknown whether extra-regional populations will influence extinction risk, keep the Step 2 category unchanged and document the uncertainty.",quickCheck:{question:"Unsure about immigration  downlist anyway?",correctAnswer:"No"}},{pageNumber:5,heading:"Usually one step",body:"A rescue effect typically leads to downlisting by one category step. Two-step downlisting is only for specific edge cases and must be justified.",quickCheck:{question:"Default downlisting is 3 steps?",correctAnswer:"No"}},{pageNumber:6,heading:"When risk is higher than it looks",body:"Uplisting is rare but can occur if the regional population is a sink and depends on immigration from a source population that is expected to decline.",exampleCard:{fields:[{label:"Example",value:"Sink + source declining  risk increases."}]}},{pageNumber:7,heading:"Don't count the same deterioration twice",body:"For visiting taxa, deterioration inside or outside the region should already be accounted for in Step 2. Step 3 adjustments are only made when rescue/extra-regional dynamics genuinely change risk.",quickCheck:{question:"Outside-region deterioration  adjust again in Step 3?",correctAnswer:"No",wrongFeedback:"Avoid double-counting."}},{pageNumber:8,heading:"If you adjust, explain it",body:"Any up/downlisting must include: rationale, evidence links, number of steps changed.",quickCheck:{question:"Can you adjust without documenting step change?",correctAnswer:"No"}},{pageNumber:9,heading:"Adjustments must be visible",body:'Adjusted categories should be clearly flagged in outputs (e.g., "adjusted" marker and step change recorded) so reviewers can audit decisions quickly.'},{pageNumber:10,heading:"You can now draft a complete assessment",body:"You've completed the 3-step regional workflow: 1) Eligibility, 2) Preliminary category (regional data), 3) Adjustment (extra-regional logic).",finishMessage:"You're ready to start your first complete regional assessment!"}]}}[i]}Nf();function $y(i){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",n.appendChild(r),r.styleSheet?r.styleSheet.cssText=i:r.appendChild(document.createTextNode(i))}Array(12).fill(0);let Tu=1;class Uy{constructor(){this.subscribe=n=>(this.subscribers.push(n),()=>{const r=this.subscribers.indexOf(n);this.subscribers.splice(r,1)}),this.publish=n=>{this.subscribers.forEach(r=>r(n))},this.addToast=n=>{this.publish(n),this.toasts=[...this.toasts,n]},this.create=n=>{var r;const{message:a,...d}=n,h=typeof n?.id=="number"||((r=n.id)==null?void 0:r.length)>0?n.id:Tu++,p=this.toasts.find(x=>x.id===h),v=n.dismissible===void 0?!0:n.dismissible;return this.dismissedToasts.has(h)&&this.dismissedToasts.delete(h),p?this.toasts=this.toasts.map(x=>x.id===h?(this.publish({...x,...n,id:h,title:a}),{...x,...n,id:h,dismissible:v,title:a}):x):this.addToast({title:a,...d,dismissible:v,id:h}),h},this.dismiss=n=>(n?(this.dismissedToasts.add(n),requestAnimationFrame(()=>this.subscribers.forEach(r=>r({id:n,dismiss:!0})))):this.toasts.forEach(r=>{this.subscribers.forEach(a=>a({id:r.id,dismiss:!0}))}),n),this.message=(n,r)=>this.create({...r,message:n}),this.error=(n,r)=>this.create({...r,message:n,type:"error"}),this.success=(n,r)=>this.create({...r,type:"success",message:n}),this.info=(n,r)=>this.create({...r,type:"info",message:n}),this.warning=(n,r)=>this.create({...r,type:"warning",message:n}),this.loading=(n,r)=>this.create({...r,type:"loading",message:n}),this.promise=(n,r)=>{if(!r)return;let a;r.loading!==void 0&&(a=this.create({...r,promise:n,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));const d=Promise.resolve(n instanceof Function?n():n);let h=a!==void 0,p;const v=d.then(async _=>{if(p=["resolve",_],co.isValidElement(_))h=!1,this.create({id:a,type:"default",message:_});else if(qy(_)&&!_.ok){h=!1;const C=typeof r.error=="function"?await r.error(`HTTP error! status: ${_.status}`):r.error,F=typeof r.description=="function"?await r.description(`HTTP error! status: ${_.status}`):r.description,A=typeof C=="object"&&!co.isValidElement(C)?C:{message:C};this.create({id:a,type:"error",description:F,...A})}else if(_ instanceof Error){h=!1;const C=typeof r.error=="function"?await r.error(_):r.error,F=typeof r.description=="function"?await r.description(_):r.description,A=typeof C=="object"&&!co.isValidElement(C)?C:{message:C};this.create({id:a,type:"error",description:F,...A})}else if(r.success!==void 0){h=!1;const C=typeof r.success=="function"?await r.success(_):r.success,F=typeof r.description=="function"?await r.description(_):r.description,A=typeof C=="object"&&!co.isValidElement(C)?C:{message:C};this.create({id:a,type:"success",description:F,...A})}}).catch(async _=>{if(p=["reject",_],r.error!==void 0){h=!1;const j=typeof r.error=="function"?await r.error(_):r.error,C=typeof r.description=="function"?await r.description(_):r.description,T=typeof j=="object"&&!co.isValidElement(j)?j:{message:j};this.create({id:a,type:"error",description:C,...T})}}).finally(()=>{h&&(this.dismiss(a),a=void 0),r.finally==null||r.finally.call(r)}),x=()=>new Promise((_,j)=>v.then(()=>p[0]==="reject"?j(p[1]):_(p[1])).catch(j));return typeof a!="string"&&typeof a!="number"?{unwrap:x}:Object.assign(a,{unwrap:x})},this.custom=(n,r)=>{const a=r?.id||Tu++;return this.create({jsx:n(a),id:a,...r}),a},this.getActiveToasts=()=>this.toasts.filter(n=>!this.dismissedToasts.has(n.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const Bn=new Uy,zy=(i,n)=>{const r=n?.id||Tu++;return Bn.addToast({title:i,...n,id:r}),r},qy=i=>i&&typeof i=="object"&&"ok"in i&&typeof i.ok=="boolean"&&"status"in i&&typeof i.status=="number",Wy=zy,Ky=()=>Bn.toasts,Hy=()=>Bn.getActiveToasts(),Yh=Object.assign(Wy,{success:Bn.success,info:Bn.info,warning:Bn.warning,error:Bn.error,custom:Bn.custom,message:Bn.message,promise:Bn.promise,dismiss:Bn.dismiss,loading:Bn.loading},{getHistory:Ky,getToasts:Hy});$y("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");const Vy={"north-america":{id:"north-america",name:"North America",authority:"NatureServe",visitorDefinition:"A taxon that occurs predictably and repeatedly in the region during some part of the year (breeding or non-breeding), documented across multiple years.",vagrantDefinition:"A taxon recorded only occasionally or accidentally, without a predictable pattern.",rePolicy:"RE (Regionally Extinct): No reasonable doubt the last potentially reproductive individual in the region has died or disappeared. Time-limit principle: RE should not normally be applied to extinctions that occurred before 1500 AD.",reEvidence:["Targeted surveys/search effort appropriate to detectability","Review of historical records","Expert consultation note"],coloniserRule:"Do not assess newly colonising taxa until reproduction is sustained over multiple yearsuse 10 consecutive years of confirmed reproduction as the default threshold.",filterEnabled:!0,filterRule:"Include only if 1% of global population occurs in the region; otherwise record as NA and document the method used to estimate %.",naturalRangeNote:"When natural range boundaries are unclear, document the reasoning and sources used to define the regional population, and apply the eligibility rules conservatively.",outputRequirements:["Regional category + criteria","Global category + criteria (if known)",'Estimated % of global population in region (or "?")',"Whether Step 3 adjusted the category, including number of steps changed"]},"central-america":{id:"central-america",name:"Central America",authority:"Regional Authority",visitorDefinition:"A taxon that occurs predictably and repeatedly in the region during some part of the year (breeding or non-breeding), documented across multiple years.",vagrantDefinition:"A taxon recorded only occasionally or accidentally, without a predictable pattern.",rePolicy:"RE (Regionally Extinct): No reasonable doubt the last potentially reproductive individual in the region has died or disappeared. Time-limit principle: RE should not normally be applied to extinctions that occurred before 1500 AD.",reEvidence:["Targeted surveys/search effort appropriate to detectability","Review of historical records","Expert consultation note"],coloniserRule:"Do not assess newly colonising taxa until reproduction is sustained over multiple yearsuse 10 consecutive years of confirmed reproduction as the default threshold.",filterEnabled:!1,naturalRangeNote:"When natural range boundaries are unclear, document the reasoning and sources used to define the regional population, and apply the eligibility rules conservatively.",outputRequirements:["Regional category + criteria","Global category + criteria (if known)",'Estimated % of global population in region (or "?")',"Whether Step 3 adjusted the category, including number of steps changed"]},"south-america":{id:"south-america",name:"South America",authority:"IUCN Americas",visitorDefinition:"A taxon that occurs predictably and repeatedly in the region during some part of the year (breeding or non-breeding), documented across multiple years.",vagrantDefinition:"A taxon recorded only occasionally or accidentally, without a predictable pattern.",rePolicy:"RE (Regionally Extinct): No reasonable doubt the last potentially reproductive individual in the region has died or disappeared. Time-limit principle: RE should not normally be applied to extinctions that occurred before 1500 AD.",reEvidence:["Targeted surveys/search effort appropriate to detectability","Review of historical records","Expert consultation note"],coloniserRule:"Do not assess newly colonising taxa until reproduction is sustained over multiple yearsuse 10 consecutive years of confirmed reproduction as the default threshold.",filterEnabled:!1,naturalRangeNote:"When natural range boundaries are unclear, document the reasoning and sources used to define the regional population, and apply the eligibility rules conservatively.",outputRequirements:["Regional category + criteria","Global category + criteria (if known)",'Estimated % of global population in region (or "?")',"Whether Step 3 adjusted the category, including number of steps changed"]},europe:{id:"europe",name:"Europe",authority:"European Red List",visitorDefinition:"A taxon that occurs predictably and repeatedly in the region during some part of the year (breeding or non-breeding), documented across multiple years.",vagrantDefinition:"A taxon recorded only occasionally or accidentally, without a predictable pattern.",rePolicy:"RE (Regionally Extinct): No reasonable doubt the last potentially reproductive individual in the region has died or disappeared. Time-limit principle: RE should not normally be applied to extinctions that occurred before 1500 AD.",reEvidence:["Targeted surveys/search effort appropriate to detectability","Review of historical records","Expert consultation note"],coloniserRule:"Do not assess newly colonising taxa until reproduction is sustained over multiple yearsuse 10 consecutive years of confirmed reproduction as the default threshold.",filterEnabled:!0,filterRule:"Include only if 1% of global population occurs in the region; otherwise record as NA and document the method used to estimate %.",naturalRangeNote:"When natural range boundaries are unclear, document the reasoning and sources used to define the regional population, and apply the eligibility rules conservatively.",outputRequirements:["Regional category + criteria","Global category + criteria (if known)",'Estimated % of global population in region (or "?")',"Whether Step 3 adjusted the category, including number of steps changed"]},africa:{id:"africa",name:"Africa",authority:"IUCN Africa",visitorDefinition:"A taxon that occurs predictably and repeatedly in the region during some part of the year (breeding or non-breeding), documented across multiple years.",vagrantDefinition:"A taxon recorded only occasionally or accidentally, without a predictable pattern.",rePolicy:"RE (Regionally Extinct): No reasonable doubt the last potentially reproductive individual in the region has died or disappeared. Time-limit principle: RE should not normally be applied to extinctions that occurred before 1500 AD.",reEvidence:["Targeted surveys/search effort appropriate to detectability","Review of historical records","Expert consultation note"],coloniserRule:"Do not assess newly colonising taxa until reproduction is sustained over multiple yearsuse 10 consecutive years of confirmed reproduction as the default threshold.",filterEnabled:!1,naturalRangeNote:"When natural range boundaries are unclear, document the reasoning and sources used to define the regional population, and apply the eligibility rules conservatively.",outputRequirements:["Regional category + criteria","Global category + criteria (if known)",'Estimated % of global population in region (or "?")',"Whether Step 3 adjusted the category, including number of steps changed"]},"middle-east":{id:"middle-east",name:"Middle East",authority:"Regional Authority",visitorDefinition:"A taxon that occurs predictably and repeatedly in the region during some part of the year (breeding or non-breeding), documented across multiple years.",vagrantDefinition:"A taxon recorded only occasionally or accidentally, without a predictable pattern.",rePolicy:"RE (Regionally Extinct): No reasonable doubt the last potentially reproductive individual in the region has died or disappeared. Time-limit principle: RE should not normally be applied to extinctions that occurred before 1500 AD.",reEvidence:["Targeted surveys/search effort appropriate to detectability","Review of historical records","Expert consultation note"],coloniserRule:"Do not assess newly colonising taxa until reproduction is sustained over multiple yearsuse 10 consecutive years of confirmed reproduction as the default threshold.",filterEnabled:!1,naturalRangeNote:"When natural range boundaries are unclear, document the reasoning and sources used to define the regional population, and apply the eligibility rules conservatively.",outputRequirements:["Regional category + criteria","Global category + criteria (if known)",'Estimated % of global population in region (or "?")',"Whether Step 3 adjusted the category, including number of steps changed"]},"central-asia":{id:"central-asia",name:"Central Asia",authority:"Regional Authority",visitorDefinition:"A taxon that occurs predictably and repeatedly in the region during some part of the year (breeding or non-breeding), documented across multiple years.",vagrantDefinition:"A taxon recorded only occasionally or accidentally, without a predictable pattern.",rePolicy:"RE (Regionally Extinct): No reasonable doubt the last potentially reproductive individual in the region has died or disappeared. Time-limit principle: RE should not normally be applied to extinctions that occurred before 1500 AD.",reEvidence:["Targeted surveys/search effort appropriate to detectability","Review of historical records","Expert consultation note"],coloniserRule:"Do not assess newly colonising taxa until reproduction is sustained over multiple yearsuse 10 consecutive years of confirmed reproduction as the default threshold.",filterEnabled:!1,naturalRangeNote:"When natural range boundaries are unclear, document the reasoning and sources used to define the regional population, and apply the eligibility rules conservatively.",outputRequirements:["Regional category + criteria","Global category + criteria (if known)",'Estimated % of global population in region (or "?")',"Whether Step 3 adjusted the category, including number of steps changed"]},"south-asia":{id:"south-asia",name:"South Asia",authority:"IUCN Asia",visitorDefinition:"A taxon that occurs predictably and repeatedly in the region during some part of the year (breeding or non-breeding), documented across multiple years.",vagrantDefinition:"A taxon recorded only occasionally or accidentally, without a predictable pattern.",rePolicy:"RE (Regionally Extinct): No reasonable doubt the last potentially reproductive individual in the region has died or disappeared. Time-limit principle: RE should not normally be applied to extinctions that occurred before 1500 AD.",reEvidence:["Targeted surveys/search effort appropriate to detectability","Review of historical records","Expert consultation note"],coloniserRule:"Do not assess newly colonising taxa until reproduction is sustained over multiple yearsuse 10 consecutive years of confirmed reproduction as the default threshold.",filterEnabled:!1,naturalRangeNote:"When natural range boundaries are unclear, document the reasoning and sources used to define the regional population, and apply the eligibility rules conservatively.",outputRequirements:["Regional category + criteria","Global category + criteria (if known)",'Estimated % of global population in region (or "?")',"Whether Step 3 adjusted the category, including number of steps changed"]},"southeast-asia":{id:"southeast-asia",name:"Southeast Asia",authority:"ASEAN Centre",visitorDefinition:"A taxon that occurs predictably and repeatedly in the region during some part of the year (breeding or non-breeding), documented across multiple years.",vagrantDefinition:"A taxon recorded only occasionally or accidentally, without a predictable pattern.",rePolicy:"RE (Regionally Extinct): No reasonable doubt the last potentially reproductive individual in the region has died or disappeared. Time-limit principle: RE should not normally be applied to extinctions that occurred before 1500 AD.",reEvidence:["Targeted surveys/search effort appropriate to detectability","Review of historical records","Expert consultation note"],coloniserRule:"Do not assess newly colonising taxa until reproduction is sustained over multiple yearsuse 10 consecutive years of confirmed reproduction as the default threshold.",filterEnabled:!1,naturalRangeNote:"When natural range boundaries are unclear, document the reasoning and sources used to define the regional population, and apply the eligibility rules conservatively.",outputRequirements:["Regional category + criteria","Global category + criteria (if known)",'Estimated % of global population in region (or "?")',"Whether Step 3 adjusted the category, including number of steps changed"]},"east-asia":{id:"east-asia",name:"East Asia",authority:"Regional Authority",visitorDefinition:"A taxon that occurs predictably and repeatedly in the region during some part of the year (breeding or non-breeding), documented across multiple years.",vagrantDefinition:"A taxon recorded only occasionally or accidentally, without a predictable pattern.",rePolicy:"RE (Regionally Extinct): No reasonable doubt the last potentially reproductive individual in the region has died or disappeared. Time-limit principle: RE should not normally be applied to extinctions that occurred before 1500 AD.",reEvidence:["Targeted surveys/search effort appropriate to detectability","Review of historical records","Expert consultation note"],coloniserRule:"Do not assess newly colonising taxa until reproduction is sustained over multiple yearsuse 10 consecutive years of confirmed reproduction as the default threshold.",filterEnabled:!1,naturalRangeNote:"When natural range boundaries are unclear, document the reasoning and sources used to define the regional population, and apply the eligibility rules conservatively.",outputRequirements:["Regional category + criteria","Global category + criteria (if known)",'Estimated % of global population in region (or "?")',"Whether Step 3 adjusted the category, including number of steps changed"]},"australia-nz":{id:"australia-nz",name:"Australia & New Zealand",authority:"EPBC Act / DOC NZ",visitorDefinition:"A taxon that occurs predictably and repeatedly in the region during some part of the year (breeding or non-breeding), documented across multiple years.",vagrantDefinition:"A taxon recorded only occasionally or accidentally, without a predictable pattern.",rePolicy:"RE (Regionally Extinct): No reasonable doubt the last potentially reproductive individual in the region has died or disappeared. Time-limit principle: RE should not normally be applied to extinctions that occurred before 1500 AD.",reEvidence:["Targeted surveys/search effort appropriate to detectability","Review of historical records","Expert consultation note"],coloniserRule:"Do not assess newly colonising taxa until reproduction is sustained over multiple yearsuse 10 consecutive years of confirmed reproduction as the default threshold.",filterEnabled:!1,naturalRangeNote:"When natural range boundaries are unclear, document the reasoning and sources used to define the regional population, and apply the eligibility rules conservatively.",outputRequirements:["Regional category + criteria","Global category + criteria (if known)",'Estimated % of global population in region (or "?")',"Whether Step 3 adjusted the category, including number of steps changed"]},"oceania-pacific":{id:"oceania-pacific",name:"Oceania & Pacific Islands",authority:"SPREP",visitorDefinition:"A taxon that occurs predictably and repeatedly in the region during some part of the year (breeding or non-breeding), documented across multiple years.",vagrantDefinition:"A taxon recorded only occasionally or accidentally, without a predictable pattern.",rePolicy:"RE (Regionally Extinct): No reasonable doubt the last potentially reproductive individual in the region has died or disappeared. Time-limit principle: RE should not normally be applied to extinctions that occurred before 1500 AD.",reEvidence:["Targeted surveys/search effort appropriate to detectability","Review of historical records","Expert consultation note"],coloniserRule:"Do not assess newly colonising taxa until reproduction is sustained over multiple yearsuse 10 consecutive years of confirmed reproduction as the default threshold.",filterEnabled:!1,naturalRangeNote:"When natural range boundaries are unclear, document the reasoning and sources used to define the regional population, and apply the eligibility rules conservatively.",outputRequirements:["Regional category + criteria","Global category + criteria (if known)",'Estimated % of global population in region (or "?")',"Whether Step 3 adjusted the category, including number of steps changed"]},arctic:{id:"arctic",name:"Arctic",authority:"CAFF",visitorDefinition:"A taxon that occurs predictably and repeatedly in the region during some part of the year (breeding or non-breeding), documented across multiple years.",vagrantDefinition:"A taxon recorded only occasionally or accidentally, without a predictable pattern.",rePolicy:"RE (Regionally Extinct): No reasonable doubt the last potentially reproductive individual in the region has died or disappeared. Time-limit principle: RE should not normally be applied to extinctions that occurred before 1500 AD.",reEvidence:["Targeted surveys/search effort appropriate to detectability","Review of historical records","Expert consultation note"],coloniserRule:"Do not assess newly colonising taxa until reproduction is sustained over multiple yearsuse 10 consecutive years of confirmed reproduction as the default threshold.",filterEnabled:!1,naturalRangeNote:"When natural range boundaries are unclear, document the reasoning and sources used to define the regional population, and apply the eligibility rules conservatively.",outputRequirements:["Regional category + criteria","Global category + criteria (if known)",'Estimated % of global population in region (or "?")',"Whether Step 3 adjusted the category, including number of steps changed"]},antarctica:{id:"antarctica",name:"Antarctica",authority:"SCAR",visitorDefinition:"A taxon that occurs predictably and repeatedly in the region during some part of the year (breeding or non-breeding), documented across multiple years.",vagrantDefinition:"A taxon recorded only occasionally or accidentally, without a predictable pattern.",rePolicy:"RE (Regionally Extinct): No reasonable doubt the last potentially reproductive individual in the region has died or disappeared. Time-limit principle: RE should not normally be applied to extinctions that occurred before 1500 AD.",reEvidence:["Targeted surveys/search effort appropriate to detectability","Review of historical records","Expert consultation note"],coloniserRule:"Do not assess newly colonising taxa until reproduction is sustained over multiple yearsuse 10 consecutive years of confirmed reproduction as the default threshold.",filterEnabled:!1,naturalRangeNote:"When natural range boundaries are unclear, document the reasoning and sources used to define the regional population, and apply the eligibility rules conservatively.",outputRequirements:["Regional category + criteria","Global category + criteria (if known)",'Estimated % of global population in region (or "?")',"Whether Step 3 adjusted the category, including number of steps changed"]}};function Gy({regionId:i,onClose:n}){const r=Vy[i],[a,d]=V.useState(!1),[h,p]=V.useState(null);if(V.useEffect(()=>{const j=localStorage.getItem(`regionPolicy_${i}_reviewed`);j&&(d(!0),p(j))},[i]),!r)return null;const v=()=>{const j=new Date().toISOString();localStorage.setItem(`regionPolicy_${i}_reviewed`,j),d(!0),p(j),Yh.success("Marked as reviewed");const C=new CustomEvent("regionModuleReviewed",{detail:{regionId:i}});window.dispatchEvent(C),setTimeout(()=>{n()},300)},x=()=>{localStorage.removeItem(`regionPolicy_${i}_reviewed`),d(!1),p(null),Yh.info("Region policy marked as not reviewed")},_=j=>new Date(j).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return s.jsxs("div",{className:"fixed inset-0 z-50 flex flex-col",style:{background:"linear-gradient(180deg, #0B0B0D 0%, #0F1013 100%)"},children:[s.jsxs("div",{className:"sticky top-0 z-20 px-4 py-4 safe-area-top backdrop-blur-sm bg-black/60",style:{borderBottom:"1px solid #242632"},children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("button",{onClick:n,className:"p-2 -ml-2",children:s.jsx(Sr,{className:"w-5 h-5",style:{color:"#8E91A3"}})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"px-2 py-1 rounded text-xs font-semibold",style:{background:"rgba(96, 165, 250, 0.15)",color:"#60A5FA"},children:"Policy"}),s.jsx("span",{className:"px-2 py-1 rounded text-xs font-semibold",style:{background:"rgba(142, 145, 163, 0.15)",color:"#8E91A3"},children:"Editable by Admin"})]})]}),s.jsx("h1",{className:"text-2xl font-bold mb-1",style:{color:"#FFFFFF"},children:r.name}),s.jsx("p",{className:"text-sm",style:{color:"#8E91A3"},children:r.authority})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-6 space-y-6",style:{paddingBottom:"100px"},children:[s.jsx(no,{icon:s.jsx(Kh,{className:"w-5 h-5",style:{color:"#60A5FA"}}),title:"What This Affects",items:["Eligibility (visitor vs vagrant boundary)","RE policy (what RE means + evidentiary expectations)",r.filterEnabled?"Optional filters (enabled)":"Optional filters (not used)","Natural range interpretation notes","Output requirements"]}),s.jsx(no,{icon:s.jsx(zm,{className:"w-5 h-5",style:{color:"#34D399"}}),title:"Visitor vs Vagrant",textBlocks:[{label:"Visitor",value:r.visitorDefinition},{label:"Vagrant",value:r.vagrantDefinition},{label:"Rule",value:"If vagrant  NA"}]}),s.jsx(no,{icon:s.jsx(mo,{className:"w-5 h-5",style:{color:"#A78BFA"}}),title:"RE (Regionally Extinct) Policy",textBlocks:[{label:"Definition",value:r.rePolicy}],items:r.reEvidence,itemsLabel:"Evidence checklist"}),s.jsx(no,{icon:s.jsx(mo,{className:"w-5 h-5",style:{color:"#F59E0B"}}),title:"Recent Coloniser Rule",textBlocks:[{label:"Standard",value:r.coloniserRule}]}),s.jsx(no,{icon:s.jsx(Xr,{className:"w-5 h-5",style:{color:r.filterEnabled?"#10B981":"#8E91A3"}}),title:"Pre-assessment Filters",textBlocks:[{label:"Filter enabled?",value:r.filterEnabled?"YES":"NO"},...r.filterEnabled&&r.filterRule?[{label:"Filter rule",value:r.filterRule}]:[]]}),s.jsx(no,{icon:s.jsx(Kh,{className:"w-5 h-5",style:{color:"#60A5FA"}}),title:"Natural Range & Introductions",textBlocks:[{label:"Guidance",value:r.naturalRangeNote}]}),s.jsxs("div",{className:"rounded-xl p-5",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:"rgba(210, 17, 12, 0.15)"},children:s.jsx(mo,{className:"w-5 h-5",style:{color:"#D2110C"}})}),s.jsx("h3",{className:"text-lg font-bold",style:{color:"#FFFFFF"},children:"What to Record in Outputs"})]}),s.jsx("div",{className:"space-y-2",children:r.outputRequirements.map((j,C)=>s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-1.5 h-1.5 rounded-full mt-2 flex-shrink-0",style:{background:"#D2110C"}}),s.jsx("p",{className:"text-sm flex-1",style:{color:"#C9CBD6"},children:j})]},C))})]}),s.jsx("div",{className:"rounded-xl p-4",style:{background:"rgba(142, 145, 163, 0.1)",border:"1px solid rgba(142, 145, 163, 0.3)"},children:s.jsx("p",{className:"text-xs",style:{color:"#8E91A3"},children:"These are working defaults for training and can be refined by the authority later. They represent method-aligned policy text, not legal authority."})})]}),s.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-20 px-4 py-4 safe-area-bottom backdrop-blur-sm bg-black/80",style:{borderTop:"1px solid #242632"},children:a&&h?s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"text-center",children:s.jsxs("p",{className:"text-sm font-semibold mb-1",style:{color:"#34D399"},children:["Reviewed on ",_(h)]})}),s.jsx("button",{onClick:x,className:"w-full py-3 px-4 rounded-xl text-base font-semibold transition-all",style:{background:"transparent",border:"2px solid #242632",color:"#8E91A3"},children:"Mark as Not Reviewed"})]}):s.jsx("button",{onClick:v,className:"w-full py-3 px-4 rounded-xl text-base font-semibold transition-all",style:{background:"transparent",border:"2px solid #242632",color:"#FFFFFF"},children:"Mark as Reviewed"})})]})}function no({icon:i,title:n,items:r,itemsLabel:a,textBlocks:d}){return s.jsxs("div",{className:"rounded-xl p-5",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:"rgba(96, 165, 250, 0.15)"},children:i}),s.jsx("h3",{className:"text-lg font-bold",style:{color:"#FFFFFF"},children:n})]}),s.jsxs("div",{className:"space-y-3",children:[d?.map((h,p)=>s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold mb-1",style:{color:"#8E91A3"},children:h.label}),s.jsx("p",{className:"text-sm",style:{color:"#C9CBD6"},children:h.value})]},p)),r&&s.jsxs("div",{children:[a&&s.jsx("label",{className:"block text-xs font-semibold mb-2",style:{color:"#8E91A3"},children:a}),s.jsx("div",{className:"space-y-1.5",children:r.map((h,p)=>s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-1.5 h-1.5 rounded-full mt-2 flex-shrink-0",style:{background:"#60A5FA"}}),s.jsx("p",{className:"text-sm flex-1",style:{color:"#C9CBD6"},children:h})]},p))})]})]})]})}function Vl(i,n){var r={};for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&n.indexOf(a)<0&&(r[a]=i[a]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,a=Object.getOwnPropertySymbols(i);d<a.length;d++)n.indexOf(a[d])<0&&Object.prototype.propertyIsEnumerable.call(i,a[d])&&(r[a[d]]=i[a[d]]);return r}function Jy(i,n,r,a){function d(h){return h instanceof r?h:new r(function(p){p(h)})}return new(r||(r=Promise))(function(h,p){function v(j){try{_(a.next(j))}catch(C){p(C)}}function x(j){try{_(a.throw(j))}catch(C){p(C)}}function _(j){j.done?h(j.value):d(j.value).then(v,x)}_((a=a.apply(i,n||[])).next())})}const Yy=i=>i?(...n)=>i(...n):(...n)=>fetch(...n);class Gu extends Error{constructor(n,r="FunctionsError",a){super(n),this.name=r,this.context=a}}class Qy extends Gu{constructor(n){super("Failed to send a request to the Edge Function","FunctionsFetchError",n)}}class Qh extends Gu{constructor(n){super("Relay Error invoking the Edge Function","FunctionsRelayError",n)}}class Xh extends Gu{constructor(n){super("Edge Function returned a non-2xx status code","FunctionsHttpError",n)}}var Ru;(function(i){i.Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2"})(Ru||(Ru={}));class Xy{constructor(n,{headers:r={},customFetch:a,region:d=Ru.Any}={}){this.url=n,this.headers=r,this.region=d,this.fetch=Yy(a)}setAuth(n){this.headers.Authorization=`Bearer ${n}`}invoke(n){return Jy(this,arguments,void 0,function*(r,a={}){var d;let h,p;try{const{headers:v,method:x,body:_,signal:j,timeout:C}=a;let F={},{region:T}=a;T||(T=this.region);const A=new URL(`${this.url}/${r}`);T&&T!=="any"&&(F["x-region"]=T,A.searchParams.set("forceFunctionRegion",T));let q;_&&(v&&!Object.prototype.hasOwnProperty.call(v,"Content-Type")||!v)?typeof Blob<"u"&&_ instanceof Blob||_ instanceof ArrayBuffer?(F["Content-Type"]="application/octet-stream",q=_):typeof _=="string"?(F["Content-Type"]="text/plain",q=_):typeof FormData<"u"&&_ instanceof FormData?q=_:(F["Content-Type"]="application/json",q=JSON.stringify(_)):_&&typeof _!="string"&&!(typeof Blob<"u"&&_ instanceof Blob)&&!(_ instanceof ArrayBuffer)&&!(typeof FormData<"u"&&_ instanceof FormData)?q=JSON.stringify(_):q=_;let M=j;C&&(p=new AbortController,h=setTimeout(()=>p.abort(),C),j?(M=p.signal,j.addEventListener("abort",()=>p.abort())):M=p.signal);const U=yield this.fetch(A.toString(),{method:x||"POST",headers:Object.assign(Object.assign(Object.assign({},F),this.headers),v),body:q,signal:M}).catch(ee=>{throw new Qy(ee)}),Z=U.headers.get("x-relay-error");if(Z&&Z==="true")throw new Qh(U);if(!U.ok)throw new Xh(U);let ne=((d=U.headers.get("Content-Type"))!==null&&d!==void 0?d:"text/plain").split(";")[0].trim(),ie;return ne==="application/json"?ie=yield U.json():ne==="application/octet-stream"||ne==="application/pdf"?ie=yield U.blob():ne==="text/event-stream"?ie=U:ne==="multipart/form-data"?ie=yield U.formData():ie=yield U.text(),{data:ie,error:null,response:U}}catch(v){return{data:null,error:v,response:v instanceof Xh||v instanceof Qh?v.context:void 0}}finally{h&&clearTimeout(h)}})}}var Zy=class extends Error{constructor(i){super(i.message),this.name="PostgrestError",this.details=i.details,this.hint=i.hint,this.code=i.code}},eg=class{constructor(i){var n,r,a;this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=new Headers(i.headers),this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=(n=i.shouldThrowOnError)!==null&&n!==void 0?n:!1,this.signal=i.signal,this.isMaybeSingle=(r=i.isMaybeSingle)!==null&&r!==void 0?r:!1,this.urlLengthLimit=(a=i.urlLengthLimit)!==null&&a!==void 0?a:8e3,i.fetch?this.fetch=i.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,n){return this.headers=new Headers(this.headers),this.headers.set(i,n),this}then(i,n){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let d=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async h=>{let p=null,v=null,x=null,_=h.status,j=h.statusText;if(h.ok){var C,F;if(r.method!=="HEAD"){var T;const U=await h.text();U===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((T=r.headers.get("Accept"))===null||T===void 0)&&T.includes("application/vnd.pgrst.plan+text"))?v=U:v=JSON.parse(U))}const q=(C=r.headers.get("Prefer"))===null||C===void 0?void 0:C.match(/count=(exact|planned|estimated)/),M=(F=h.headers.get("content-range"))===null||F===void 0?void 0:F.split("/");q&&M&&M.length>1&&(x=parseInt(M[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(v)&&(v.length>1?(p={code:"PGRST116",details:`Results contain ${v.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},v=null,x=null,_=406,j="Not Acceptable"):v.length===1?v=v[0]:v=null)}else{var A;const q=await h.text();try{p=JSON.parse(q),Array.isArray(p)&&h.status===404&&(v=[],p=null,_=200,j="OK")}catch{h.status===404&&q===""?(_=204,j="No Content"):p={message:q}}if(p&&r.isMaybeSingle&&(!(p==null||(A=p.details)===null||A===void 0)&&A.includes("0 rows"))&&(p=null,_=200,j="OK"),p&&r.shouldThrowOnError)throw new Zy(p)}return{error:p,data:v,count:x,status:_,statusText:j}});return this.shouldThrowOnError||(d=d.catch(h=>{var p;let v="",x="",_="";const j=h?.cause;if(j){var C,F,T,A;const U=(C=j?.message)!==null&&C!==void 0?C:"",Z=(F=j?.code)!==null&&F!==void 0?F:"";v=`${(T=h?.name)!==null&&T!==void 0?T:"FetchError"}: ${h?.message}`,v+=`

Caused by: ${(A=j?.name)!==null&&A!==void 0?A:"Error"}: ${U}`,Z&&(v+=` (${Z})`),j?.stack&&(v+=`
${j.stack}`)}else{var q;v=(q=h?.stack)!==null&&q!==void 0?q:""}const M=this.url.toString().length;return h?.name==="AbortError"||h?.code==="ABORT_ERR"?(_="",x="Request was aborted (timeout or manual cancellation)",M>this.urlLengthLimit&&(x+=`. Note: Your request URL is ${M} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):(j?.name==="HeadersOverflowError"||j?.code==="UND_ERR_HEADERS_OVERFLOW")&&(_="",x="HTTP headers exceeded server limits (typically 16KB)",M>this.urlLengthLimit&&(x+=`. Your request URL is ${M} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${(p=h?.name)!==null&&p!==void 0?p:"FetchError"}: ${h?.message}`,details:v,hint:x,code:_},data:null,count:null,status:0,statusText:""}})),d.then(i,n)}returns(){return this}overrideTypes(){return this}},tg=class extends eg{select(i){let n=!1;const r=(i??"*").split("").map(a=>/\s/.test(a)&&!n?"":(a==='"'&&(n=!n),a)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:n=!0,nullsFirst:r,foreignTable:a,referencedTable:d=a}={}){const h=d?`${d}.order`:"order",p=this.url.searchParams.get(h);return this.url.searchParams.set(h,`${p?`${p},`:""}${i}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:n,referencedTable:r=n}={}){const a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${i}`),this}range(i,n,{foreignTable:r,referencedTable:a=r}={}){const d=typeof a>"u"?"offset":`${a}.offset`,h=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(d,`${i}`),this.url.searchParams.set(h,`${n-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:n=!1,settings:r=!1,buffers:a=!1,wal:d=!1,format:h="text"}={}){var p;const v=[i?"analyze":null,n?"verbose":null,r?"settings":null,a?"buffers":null,d?"wal":null].filter(Boolean).join("|"),x=(p=this.headers.get("Accept"))!==null&&p!==void 0?p:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${h}; for="${x}"; options=${v};`),h==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}};const Zh=new RegExp("[,()]");var uo=class extends tg{eq(i,n){return this.url.searchParams.append(i,`eq.${n}`),this}neq(i,n){return this.url.searchParams.append(i,`neq.${n}`),this}gt(i,n){return this.url.searchParams.append(i,`gt.${n}`),this}gte(i,n){return this.url.searchParams.append(i,`gte.${n}`),this}lt(i,n){return this.url.searchParams.append(i,`lt.${n}`),this}lte(i,n){return this.url.searchParams.append(i,`lte.${n}`),this}like(i,n){return this.url.searchParams.append(i,`like.${n}`),this}likeAllOf(i,n){return this.url.searchParams.append(i,`like(all).{${n.join(",")}}`),this}likeAnyOf(i,n){return this.url.searchParams.append(i,`like(any).{${n.join(",")}}`),this}ilike(i,n){return this.url.searchParams.append(i,`ilike.${n}`),this}ilikeAllOf(i,n){return this.url.searchParams.append(i,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(i,n){return this.url.searchParams.append(i,`ilike(any).{${n.join(",")}}`),this}regexMatch(i,n){return this.url.searchParams.append(i,`match.${n}`),this}regexIMatch(i,n){return this.url.searchParams.append(i,`imatch.${n}`),this}is(i,n){return this.url.searchParams.append(i,`is.${n}`),this}isDistinct(i,n){return this.url.searchParams.append(i,`isdistinct.${n}`),this}in(i,n){const r=Array.from(new Set(n)).map(a=>typeof a=="string"&&Zh.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(i,`in.(${r})`),this}notIn(i,n){const r=Array.from(new Set(n)).map(a=>typeof a=="string"&&Zh.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(i,`not.in.(${r})`),this}contains(i,n){return typeof n=="string"?this.url.searchParams.append(i,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(i,`cs.{${n.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(n)}`),this}containedBy(i,n){return typeof n=="string"?this.url.searchParams.append(i,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(i,`cd.{${n.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(n)}`),this}rangeGt(i,n){return this.url.searchParams.append(i,`sr.${n}`),this}rangeGte(i,n){return this.url.searchParams.append(i,`nxl.${n}`),this}rangeLt(i,n){return this.url.searchParams.append(i,`sl.${n}`),this}rangeLte(i,n){return this.url.searchParams.append(i,`nxr.${n}`),this}rangeAdjacent(i,n){return this.url.searchParams.append(i,`adj.${n}`),this}overlaps(i,n){return typeof n=="string"?this.url.searchParams.append(i,`ov.${n}`):this.url.searchParams.append(i,`ov.{${n.join(",")}}`),this}textSearch(i,n,{config:r,type:a}={}){let d="";a==="plain"?d="pl":a==="phrase"?d="ph":a==="websearch"&&(d="w");const h=r===void 0?"":`(${r})`;return this.url.searchParams.append(i,`${d}fts${h}.${n}`),this}match(i){return Object.entries(i).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(i,n,r){return this.url.searchParams.append(i,`not.${n}.${r}`),this}or(i,{foreignTable:n,referencedTable:r=n}={}){const a=r?`${r}.or`:"or";return this.url.searchParams.append(a,`(${i})`),this}filter(i,n,r){return this.url.searchParams.append(i,`${n}.${r}`),this}},ng=class{constructor(i,{headers:n={},schema:r,fetch:a,urlLengthLimit:d=8e3}){this.url=i,this.headers=new Headers(n),this.schema=r,this.fetch=a,this.urlLengthLimit=d}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(i,n){const{head:r=!1,count:a}=n??{},d=r?"HEAD":"GET";let h=!1;const p=(i??"*").split("").map(_=>/\s/.test(_)&&!h?"":(_==='"'&&(h=!h),_)).join(""),{url:v,headers:x}=this.cloneRequestState();return v.searchParams.set("select",p),a&&x.append("Prefer",`count=${a}`),new uo({method:d,url:v,headers:x,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(i,{count:n,defaultToNull:r=!0}={}){var a;const d="POST",{url:h,headers:p}=this.cloneRequestState();if(n&&p.append("Prefer",`count=${n}`),r||p.append("Prefer","missing=default"),Array.isArray(i)){const v=i.reduce((x,_)=>x.concat(Object.keys(_)),[]);if(v.length>0){const x=[...new Set(v)].map(_=>`"${_}"`);h.searchParams.set("columns",x.join(","))}}return new uo({method:d,url:h,headers:p,schema:this.schema,body:i,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(i,{onConflict:n,ignoreDuplicates:r=!1,count:a,defaultToNull:d=!0}={}){var h;const p="POST",{url:v,headers:x}=this.cloneRequestState();if(x.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),n!==void 0&&v.searchParams.set("on_conflict",n),a&&x.append("Prefer",`count=${a}`),d||x.append("Prefer","missing=default"),Array.isArray(i)){const _=i.reduce((j,C)=>j.concat(Object.keys(C)),[]);if(_.length>0){const j=[...new Set(_)].map(C=>`"${C}"`);v.searchParams.set("columns",j.join(","))}}return new uo({method:p,url:v,headers:x,schema:this.schema,body:i,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch,urlLengthLimit:this.urlLengthLimit})}update(i,{count:n}={}){var r;const a="PATCH",{url:d,headers:h}=this.cloneRequestState();return n&&h.append("Prefer",`count=${n}`),new uo({method:a,url:d,headers:h,schema:this.schema,body:i,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:i}={}){var n;const r="DELETE",{url:a,headers:d}=this.cloneRequestState();return i&&d.append("Prefer",`count=${i}`),new uo({method:r,url:a,headers:d,schema:this.schema,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch,urlLengthLimit:this.urlLengthLimit})}};function ua(i){"@babel/helpers - typeof";return ua=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},ua(i)}function rg(i,n){if(ua(i)!="object"||!i)return i;var r=i[Symbol.toPrimitive];if(r!==void 0){var a=r.call(i,n);if(ua(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(i)}function sg(i){var n=rg(i,"string");return ua(n)=="symbol"?n:n+""}function ig(i,n,r){return(n=sg(n))in i?Object.defineProperty(i,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[n]=r,i}function ef(i,n){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);n&&(a=a.filter(function(d){return Object.getOwnPropertyDescriptor(i,d).enumerable})),r.push.apply(r,a)}return r}function Rl(i){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?ef(Object(r),!0).forEach(function(a){ig(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):ef(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}var og=class Tf{constructor(n,{headers:r={},schema:a,fetch:d,timeout:h,urlLengthLimit:p=8e3}={}){this.url=n,this.headers=new Headers(r),this.schemaName=a,this.urlLengthLimit=p;const v=d??globalThis.fetch;h!==void 0&&h>0?this.fetch=(x,_)=>{const j=new AbortController,C=setTimeout(()=>j.abort(),h),F=_?.signal;if(F){if(F.aborted)return clearTimeout(C),v(x,_);const T=()=>{clearTimeout(C),j.abort()};return F.addEventListener("abort",T,{once:!0}),v(x,Rl(Rl({},_),{},{signal:j.signal})).finally(()=>{clearTimeout(C),F.removeEventListener("abort",T)})}return v(x,Rl(Rl({},_),{},{signal:j.signal})).finally(()=>clearTimeout(C))}:this.fetch=v}from(n){if(!n||typeof n!="string"||n.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new ng(new URL(`${this.url}/${n}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(n){return new Tf(this.url,{headers:this.headers,schema:n,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(n,r={},{head:a=!1,get:d=!1,count:h}={}){var p;let v;const x=new URL(`${this.url}/rpc/${n}`);let _;const j=T=>T!==null&&typeof T=="object"&&(!Array.isArray(T)||T.some(j)),C=a&&Object.values(r).some(j);C?(v="POST",_=r):a||d?(v=a?"HEAD":"GET",Object.entries(r).filter(([T,A])=>A!==void 0).map(([T,A])=>[T,Array.isArray(A)?`{${A.join(",")}}`:`${A}`]).forEach(([T,A])=>{x.searchParams.append(T,A)})):(v="POST",_=r);const F=new Headers(this.headers);return C?F.set("Prefer",h?`count=${h},return=minimal`:"return=minimal"):h&&F.set("Prefer",`count=${h}`),new uo({method:v,url:x,headers:F,schema:this.schemaName,body:_,fetch:(p=this.fetch)!==null&&p!==void 0?p:fetch,urlLengthLimit:this.urlLengthLimit})}};class ag{constructor(){}static detectEnvironment(){var n;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((n=navigator.userAgent)===null||n===void 0)&&n.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const a=r.versions;if(a&&a.node){const d=a.node,h=parseInt(d.replace(/^v/,"").split(".")[0]);return h>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${h} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${h} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const n=this.detectEnvironment();if(n.constructor)return n.constructor;let r=n.error||"WebSocket not supported in this environment.";throw n.workaround&&(r+=`

Suggested solution: ${n.workaround}`),new Error(r)}static createWebSocket(n,r){const a=this.getWebSocketConstructor();return new a(n,r)}static isWebSocketSupported(){try{const n=this.detectEnvironment();return n.type==="native"||n.type==="ws"}catch{return!1}}}const lg="2.95.3",cg=`realtime-js/${lg}`,ug="1.0.0",Rf="2.0.0",tf=Rf,Pu=1e4,dg=1e3,hg=100;var Is;(function(i){i[i.connecting=0]="connecting",i[i.open=1]="open",i[i.closing=2]="closing",i[i.closed=3]="closed"})(Is||(Is={}));var Ut;(function(i){i.closed="closed",i.errored="errored",i.joined="joined",i.joining="joining",i.leaving="leaving"})(Ut||(Ut={}));var ir;(function(i){i.close="phx_close",i.error="phx_error",i.join="phx_join",i.reply="phx_reply",i.leave="phx_leave",i.access_token="access_token"})(ir||(ir={}));var Ou;(function(i){i.websocket="websocket"})(Ou||(Ou={}));var xi;(function(i){i.Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed"})(xi||(xi={}));class fg{constructor(n){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=n??[]}encode(n,r){if(n.event===this.BROADCAST_EVENT&&!(n.payload instanceof ArrayBuffer)&&typeof n.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(n));let a=[n.join_ref,n.ref,n.topic,n.event,n.payload];return r(JSON.stringify(a))}_binaryEncodeUserBroadcastPush(n){var r;return this._isArrayBuffer((r=n.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(n):this._encodeJsonUserBroadcastPush(n)}_encodeBinaryUserBroadcastPush(n){var r,a;const d=(a=(r=n.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:new ArrayBuffer(0);return this._encodeUserBroadcastPush(n,this.BINARY_ENCODING,d)}_encodeJsonUserBroadcastPush(n){var r,a;const d=(a=(r=n.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:{},p=new TextEncoder().encode(JSON.stringify(d)).buffer;return this._encodeUserBroadcastPush(n,this.JSON_ENCODING,p)}_encodeUserBroadcastPush(n,r,a){var d,h;const p=n.topic,v=(d=n.ref)!==null&&d!==void 0?d:"",x=(h=n.join_ref)!==null&&h!==void 0?h:"",_=n.payload.event,j=this.allowedMetadataKeys?this._pick(n.payload,this.allowedMetadataKeys):{},C=Object.keys(j).length===0?"":JSON.stringify(j);if(x.length>255)throw new Error(`joinRef length ${x.length} exceeds maximum of 255`);if(v.length>255)throw new Error(`ref length ${v.length} exceeds maximum of 255`);if(p.length>255)throw new Error(`topic length ${p.length} exceeds maximum of 255`);if(_.length>255)throw new Error(`userEvent length ${_.length} exceeds maximum of 255`);if(C.length>255)throw new Error(`metadata length ${C.length} exceeds maximum of 255`);const F=this.USER_BROADCAST_PUSH_META_LENGTH+x.length+v.length+p.length+_.length+C.length,T=new ArrayBuffer(this.HEADER_LENGTH+F);let A=new DataView(T),q=0;A.setUint8(q++,this.KINDS.userBroadcastPush),A.setUint8(q++,x.length),A.setUint8(q++,v.length),A.setUint8(q++,p.length),A.setUint8(q++,_.length),A.setUint8(q++,C.length),A.setUint8(q++,r),Array.from(x,U=>A.setUint8(q++,U.charCodeAt(0))),Array.from(v,U=>A.setUint8(q++,U.charCodeAt(0))),Array.from(p,U=>A.setUint8(q++,U.charCodeAt(0))),Array.from(_,U=>A.setUint8(q++,U.charCodeAt(0))),Array.from(C,U=>A.setUint8(q++,U.charCodeAt(0)));var M=new Uint8Array(T.byteLength+a.byteLength);return M.set(new Uint8Array(T),0),M.set(new Uint8Array(a),T.byteLength),M.buffer}decode(n,r){if(this._isArrayBuffer(n)){let a=this._binaryDecode(n);return r(a)}if(typeof n=="string"){const a=JSON.parse(n),[d,h,p,v,x]=a;return r({join_ref:d,ref:h,topic:p,event:v,payload:x})}return r({})}_binaryDecode(n){const r=new DataView(n),a=r.getUint8(0),d=new TextDecoder;switch(a){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(n,r,d)}}_decodeUserBroadcast(n,r,a){const d=r.getUint8(1),h=r.getUint8(2),p=r.getUint8(3),v=r.getUint8(4);let x=this.HEADER_LENGTH+4;const _=a.decode(n.slice(x,x+d));x=x+d;const j=a.decode(n.slice(x,x+h));x=x+h;const C=a.decode(n.slice(x,x+p));x=x+p;const F=n.slice(x,n.byteLength),T=v===this.JSON_ENCODING?JSON.parse(a.decode(F)):F,A={type:this.BROADCAST_EVENT,event:j,payload:T};return p>0&&(A.meta=JSON.parse(C)),{join_ref:null,ref:null,topic:_,event:this.BROADCAST_EVENT,payload:A}}_isArrayBuffer(n){var r;return n instanceof ArrayBuffer||((r=n?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(n,r){return!n||typeof n!="object"?{}:Object.fromEntries(Object.entries(n).filter(([a])=>r.includes(a)))}}class Pf{constructor(n,r){this.callback=n,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=n,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var vt;(function(i){i.abstime="abstime",i.bool="bool",i.date="date",i.daterange="daterange",i.float4="float4",i.float8="float8",i.int2="int2",i.int4="int4",i.int4range="int4range",i.int8="int8",i.int8range="int8range",i.json="json",i.jsonb="jsonb",i.money="money",i.numeric="numeric",i.oid="oid",i.reltime="reltime",i.text="text",i.time="time",i.timestamp="timestamp",i.timestamptz="timestamptz",i.timetz="timetz",i.tsrange="tsrange",i.tstzrange="tstzrange"})(vt||(vt={}));const nf=(i,n,r={})=>{var a;const d=(a=r.skipTypes)!==null&&a!==void 0?a:[];return n?Object.keys(n).reduce((h,p)=>(h[p]=pg(p,i,n,d),h),{}):{}},pg=(i,n,r,a)=>{const d=n.find(v=>v.name===i),h=d?.type,p=r[i];return h&&!a.includes(h)?Of(h,p):Du(p)},Of=(i,n)=>{if(i.charAt(0)==="_"){const r=i.slice(1,i.length);return vg(n,r)}switch(i){case vt.bool:return mg(n);case vt.float4:case vt.float8:case vt.int2:case vt.int4:case vt.int8:case vt.numeric:case vt.oid:return yg(n);case vt.json:case vt.jsonb:return gg(n);case vt.timestamp:return xg(n);case vt.abstime:case vt.date:case vt.daterange:case vt.int4range:case vt.int8range:case vt.money:case vt.reltime:case vt.text:case vt.time:case vt.timestamptz:case vt.timetz:case vt.tsrange:case vt.tstzrange:return Du(n);default:return Du(n)}},Du=i=>i,mg=i=>{switch(i){case"t":return!0;case"f":return!1;default:return i}},yg=i=>{if(typeof i=="string"){const n=parseFloat(i);if(!Number.isNaN(n))return n}return i},gg=i=>{if(typeof i=="string")try{return JSON.parse(i)}catch{return i}return i},vg=(i,n)=>{if(typeof i!="string")return i;const r=i.length-1,a=i[r];if(i[0]==="{"&&a==="}"){let h;const p=i.slice(1,r);try{h=JSON.parse("["+p+"]")}catch{h=p?p.split(","):[]}return h.map(v=>Of(n,v))}return i},xg=i=>typeof i=="string"?i.replace(" ","T"):i,Df=i=>{const n=new URL(i);return n.protocol=n.protocol.replace(/^ws/i,"http"),n.pathname=n.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),n.pathname===""||n.pathname==="/"?n.pathname="/api/broadcast":n.pathname=n.pathname+"/api/broadcast",n.href};class wu{constructor(n,r,a={},d=Pu){this.channel=n,this.event=r,this.payload=a,this.timeout=d,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(n){this.timeout=n,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(n){this.payload=Object.assign(Object.assign({},this.payload),n)}receive(n,r){var a;return this._hasReceived(n)&&r((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:n,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const n=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},n),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(n,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:n,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:n,response:r}){this.recHooks.filter(a=>a.status===n).forEach(a=>a.callback(r))}_hasReceived(n){return this.receivedResp&&this.receivedResp.status===n}}var rf;(function(i){i.SYNC="sync",i.JOIN="join",i.LEAVE="leave"})(rf||(rf={}));class la{constructor(n,r){this.channel=n,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},d=>{const{onJoin:h,onLeave:p,onSync:v}=this.caller;this.joinRef=this.channel._joinRef(),this.state=la.syncState(this.state,d,h,p),this.pendingDiffs.forEach(x=>{this.state=la.syncDiff(this.state,x,h,p)}),this.pendingDiffs=[],v()}),this.channel._on(a.diff,{},d=>{const{onJoin:h,onLeave:p,onSync:v}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(d):(this.state=la.syncDiff(this.state,d,h,p),v())}),this.onJoin((d,h,p)=>{this.channel._trigger("presence",{event:"join",key:d,currentPresences:h,newPresences:p})}),this.onLeave((d,h,p)=>{this.channel._trigger("presence",{event:"leave",key:d,currentPresences:h,leftPresences:p})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(n,r,a,d){const h=this.cloneDeep(n),p=this.transformState(r),v={},x={};return this.map(h,(_,j)=>{p[_]||(x[_]=j)}),this.map(p,(_,j)=>{const C=h[_];if(C){const F=j.map(M=>M.presence_ref),T=C.map(M=>M.presence_ref),A=j.filter(M=>T.indexOf(M.presence_ref)<0),q=C.filter(M=>F.indexOf(M.presence_ref)<0);A.length>0&&(v[_]=A),q.length>0&&(x[_]=q)}else v[_]=j}),this.syncDiff(h,{joins:v,leaves:x},a,d)}static syncDiff(n,r,a,d){const{joins:h,leaves:p}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return a||(a=()=>{}),d||(d=()=>{}),this.map(h,(v,x)=>{var _;const j=(_=n[v])!==null&&_!==void 0?_:[];if(n[v]=this.cloneDeep(x),j.length>0){const C=n[v].map(T=>T.presence_ref),F=j.filter(T=>C.indexOf(T.presence_ref)<0);n[v].unshift(...F)}a(v,j,x)}),this.map(p,(v,x)=>{let _=n[v];if(!_)return;const j=x.map(C=>C.presence_ref);_=_.filter(C=>j.indexOf(C.presence_ref)<0),n[v]=_,d(v,_,x),_.length===0&&delete n[v]}),n}static map(n,r){return Object.getOwnPropertyNames(n).map(a=>r(a,n[a]))}static transformState(n){return n=this.cloneDeep(n),Object.getOwnPropertyNames(n).reduce((r,a)=>{const d=n[a];return"metas"in d?r[a]=d.metas.map(h=>(h.presence_ref=h.phx_ref,delete h.phx_ref,delete h.phx_ref_prev,h)):r[a]=d,r},{})}static cloneDeep(n){return JSON.parse(JSON.stringify(n))}onJoin(n){this.caller.onJoin=n}onLeave(n){this.caller.onLeave=n}onSync(n){this.caller.onSync=n}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var sf;(function(i){i.ALL="*",i.INSERT="INSERT",i.UPDATE="UPDATE",i.DELETE="DELETE"})(sf||(sf={}));var ca;(function(i){i.BROADCAST="broadcast",i.PRESENCE="presence",i.POSTGRES_CHANGES="postgres_changes",i.SYSTEM="system"})(ca||(ca={}));var Qr;(function(i){i.SUBSCRIBED="SUBSCRIBED",i.TIMED_OUT="TIMED_OUT",i.CLOSED="CLOSED",i.CHANNEL_ERROR="CHANNEL_ERROR"})(Qr||(Qr={}));class po{constructor(n,r={config:{}},a){var d,h;if(this.topic=n,this.params=r,this.socket=a,this.bindings={},this.state=Ut.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=n.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new wu(this,ir.join,this.params,this.timeout),this.rejoinTimer=new Pf(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ut.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(p=>p.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ut.closed,this.socket._remove(this)}),this._onError(p=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,p),this.state=Ut.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ut.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",p=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,p),this.state=Ut.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ir.reply,{},(p,v)=>{this._trigger(this._replyEventName(v),p)}),this.presence=new la(this),this.broadcastEndpointURL=Df(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((h=(d=this.params.config)===null||d===void 0?void 0:d.broadcast)===null||h===void 0)&&h.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(n,r=this.timeout){var a,d,h;if(this.socket.isConnected()||this.socket.connect(),this.state==Ut.closed){const{config:{broadcast:p,presence:v,private:x}}=this.params,_=(d=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(T=>T.filter))!==null&&d!==void 0?d:[],j=!!this.bindings[ca.PRESENCE]&&this.bindings[ca.PRESENCE].length>0||((h=this.params.config.presence)===null||h===void 0?void 0:h.enabled)===!0,C={},F={broadcast:p,presence:Object.assign(Object.assign({},v),{enabled:j}),postgres_changes:_,private:x};this.socket.accessTokenValue&&(C.access_token=this.socket.accessTokenValue),this._onError(T=>n?.(Qr.CHANNEL_ERROR,T)),this._onClose(()=>n?.(Qr.CLOSED)),this.updateJoinPayload(Object.assign({config:F},C)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:T})=>{var A;if(this.socket._isManualToken()||this.socket.setAuth(),T===void 0){n?.(Qr.SUBSCRIBED);return}else{const q=this.bindings.postgres_changes,M=(A=q?.length)!==null&&A!==void 0?A:0,U=[];for(let Z=0;Z<M;Z++){const ne=q[Z],{filter:{event:ie,schema:ee,table:me,filter:fe}}=ne,ye=T&&T[Z];if(ye&&ye.event===ie&&po.isFilterValueEqual(ye.schema,ee)&&po.isFilterValueEqual(ye.table,me)&&po.isFilterValueEqual(ye.filter,fe))U.push(Object.assign(Object.assign({},ne),{id:ye.id}));else{this.unsubscribe(),this.state=Ut.errored,n?.(Qr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=U,n&&n(Qr.SUBSCRIBED);return}}).receive("error",T=>{this.state=Ut.errored,n?.(Qr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(T).join(", ")||"error")))}).receive("timeout",()=>{n?.(Qr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(n,r={}){return await this.send({type:"presence",event:"track",payload:n},r.timeout||this.timeout)}async untrack(n={}){return await this.send({type:"presence",event:"untrack"},n)}on(n,r,a){return this.state===Ut.joined&&n===ca.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(n,r,a)}async httpSend(n,r,a={}){var d;if(r==null)return Promise.reject("Payload is required for httpSend()");const h={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(h.Authorization=`Bearer ${this.socket.accessTokenValue}`);const p={method:"POST",headers:h,body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:r,private:this.private}]})},v=await this._fetchWithTimeout(this.broadcastEndpointURL,p,(d=a.timeout)!==null&&d!==void 0?d:this.timeout);if(v.status===202)return{success:!0};let x=v.statusText;try{const _=await v.json();x=_.error||_.message||x}catch{}return Promise.reject(new Error(x))}async send(n,r={}){var a,d;if(!this._canPush()&&n.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:h,payload:p}=n,v={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(v.Authorization=`Bearer ${this.socket.accessTokenValue}`);const x={method:"POST",headers:v,body:JSON.stringify({messages:[{topic:this.subTopic,event:h,payload:p,private:this.private}]})};try{const _=await this._fetchWithTimeout(this.broadcastEndpointURL,x,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return await((d=_.body)===null||d===void 0?void 0:d.cancel()),_.ok?"ok":"error"}catch(_){return _.name==="AbortError"?"timed out":"error"}}else return new Promise(h=>{var p,v,x;const _=this._push(n.type,n,r.timeout||this.timeout);n.type==="broadcast"&&!(!((x=(v=(p=this.params)===null||p===void 0?void 0:p.config)===null||v===void 0?void 0:v.broadcast)===null||x===void 0)&&x.ack)&&h("ok"),_.receive("ok",()=>h("ok")),_.receive("error",()=>h("error")),_.receive("timeout",()=>h("timed out"))})}updateJoinPayload(n){this.joinPush.updatePayload(n)}unsubscribe(n=this.timeout){this.state=Ut.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ir.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(d=>{a=new wu(this,ir.leave,{},n),a.receive("ok",()=>{r(),d("ok")}).receive("timeout",()=>{r(),d("timed out")}).receive("error",()=>{d("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a?.destroy()})}teardown(){this.pushBuffer.forEach(n=>n.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ut.closed,this.bindings={}}async _fetchWithTimeout(n,r,a){const d=new AbortController,h=setTimeout(()=>d.abort(),a),p=await this.socket.fetch(n,Object.assign(Object.assign({},r),{signal:d.signal}));return clearTimeout(h),p}_push(n,r,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${n}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let d=new wu(this,n,r,a);return this._canPush()?d.send():this._addToPushBuffer(d),d}_addToPushBuffer(n){if(n.startTimeout(),this.pushBuffer.push(n),this.pushBuffer.length>hg){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(n,r,a){return r}_isMember(n){return this.topic===n}_joinRef(){return this.joinPush.ref}_trigger(n,r,a){var d,h;const p=n.toLocaleLowerCase(),{close:v,error:x,leave:_,join:j}=ir;if(a&&[v,x,_,j].indexOf(p)>=0&&a!==this._joinRef())return;let F=this._onMessage(p,r,a);if(r&&!F)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(p)?(d=this.bindings.postgres_changes)===null||d===void 0||d.filter(T=>{var A,q,M;return((A=T.filter)===null||A===void 0?void 0:A.event)==="*"||((M=(q=T.filter)===null||q===void 0?void 0:q.event)===null||M===void 0?void 0:M.toLocaleLowerCase())===p}).map(T=>T.callback(F,a)):(h=this.bindings[p])===null||h===void 0||h.filter(T=>{var A,q,M,U,Z,ne;if(["broadcast","presence","postgres_changes"].includes(p))if("id"in T){const ie=T.id,ee=(A=T.filter)===null||A===void 0?void 0:A.event;return ie&&((q=r.ids)===null||q===void 0?void 0:q.includes(ie))&&(ee==="*"||ee?.toLocaleLowerCase()===((M=r.data)===null||M===void 0?void 0:M.type.toLocaleLowerCase()))}else{const ie=(Z=(U=T?.filter)===null||U===void 0?void 0:U.event)===null||Z===void 0?void 0:Z.toLocaleLowerCase();return ie==="*"||ie===((ne=r?.event)===null||ne===void 0?void 0:ne.toLocaleLowerCase())}else return T.type.toLocaleLowerCase()===p}).map(T=>{if(typeof F=="object"&&"ids"in F){const A=F.data,{schema:q,table:M,commit_timestamp:U,type:Z,errors:ne}=A;F=Object.assign(Object.assign({},{schema:q,table:M,commit_timestamp:U,eventType:Z,new:{},old:{},errors:ne}),this._getPayloadRecords(A))}T.callback(F,a)})}_isClosed(){return this.state===Ut.closed}_isJoined(){return this.state===Ut.joined}_isJoining(){return this.state===Ut.joining}_isLeaving(){return this.state===Ut.leaving}_replyEventName(n){return`chan_reply_${n}`}_on(n,r,a){const d=n.toLocaleLowerCase(),h={type:d,filter:r,callback:a};return this.bindings[d]?this.bindings[d].push(h):this.bindings[d]=[h],this}_off(n,r){const a=n.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(d=>{var h;return!(((h=d.type)===null||h===void 0?void 0:h.toLocaleLowerCase())===a&&po.isEqual(d.filter,r))})),this}static isEqual(n,r){if(Object.keys(n).length!==Object.keys(r).length)return!1;for(const a in n)if(n[a]!==r[a])return!1;return!0}static isFilterValueEqual(n,r){return(n??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(n){this._on(ir.close,{},n)}_onError(n){this._on(ir.error,{},r=>n(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(n=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ut.joining,this.joinPush.resend(n))}_getPayloadRecords(n){const r={new:{},old:{}};return(n.type==="INSERT"||n.type==="UPDATE")&&(r.new=nf(n.columns,n.record)),(n.type==="UPDATE"||n.type==="DELETE")&&(r.old=nf(n.columns,n.old_record)),r}}const ku=()=>{},Pl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},bg=[1e3,2e3,5e3,1e4],wg=1e4,kg=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class _g{constructor(n,r){var a;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Pu,this.transport=null,this.heartbeatIntervalMs=Pl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ku,this.ref=0,this.reconnectTimer=null,this.vsn=tf,this.logger=ku,this.conn=null,this.sendBuffer=[],this.serializer=new fg,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=d=>d?(...h)=>d(...h):(...h)=>fetch(...h),!(!((a=r?.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${n}/${Ou.websocket}`,this.httpEndpoint=Df(n),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=ag.createWebSocket(this.endpointURL())}catch(n){this._setConnectionState("disconnected");const r=n.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(n,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(n?this.conn.close(n,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(n){const r=await n.unsubscribe();return r==="ok"&&this._remove(n),this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const n=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),n}log(n,r,a){this.logger(n,r,a)}connectionState(){switch(this.conn&&this.conn.readyState){case Is.connecting:return xi.Connecting;case Is.open:return xi.Open;case Is.closing:return xi.Closing;default:return xi.Closed}}isConnected(){return this.connectionState()===xi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(n,r={config:{}}){const a=`realtime:${n}`,d=this.getChannels().find(h=>h.topic===a);if(d)return d;{const h=new po(`realtime:${n}`,r,this);return this.channels.push(h),h}}push(n){const{topic:r,event:a,payload:d,ref:h}=n,p=()=>{this.encode(n,v=>{var x;(x=this.conn)===null||x===void 0||x.send(v)})};this.log("push",`${r} ${a} (${h})`,d),this.isConnected()?p():this.sendBuffer.push(p)}async setAuth(n=null){this._authPromise=this._performAuth(n);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var n;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(n=this.conn)===null||n===void 0||n.close(dg,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Pl.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(n){this.heartbeatCallback=n}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(n=>n()),this.sendBuffer=[])}_makeRef(){let n=this.ref+1;return n===this.ref?this.ref=0:this.ref=n,this.ref.toString()}_leaveOpenTopic(n){let r=this.channels.find(a=>a.topic===n&&(a._isJoined()||a._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${n}"`),r.unsubscribe())}_remove(n){this.channels=this.channels.filter(r=>r.topic!==n.topic)}_onConnMessage(n){this.decode(n.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const _=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",_)}catch(j){this.log("error","error in heartbeat callback",j)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:a,event:d,payload:h,ref:p}=r,v=p?`(${p})`:"",x=h.status||"";this.log("receive",`${x} ${a} ${d} ${v}`.trim(),h),this.channels.filter(_=>_._isMember(a)).forEach(_=>_._trigger(d,h,p)),this._triggerStateCallbacks("message",r)})}_clearTimer(n){var r;n==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):n==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=n=>this._onConnError(n),this.conn.onmessage=n=>this._onConnMessage(n),this.conn.onclose=n=>this._onConnClose(n),this.conn.readyState===Is.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Is.open||this.conn.readyState===Is.connecting)try{this.conn.close()}catch(n){this.log("error","Error closing connection",n)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(n=>n.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const n=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(n),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(n){var r;this._setConnectionState("disconnected"),this.log("transport","close",n),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",n)}_onConnError(n){this._setConnectionState("disconnected"),this.log("transport",`${n}`),this._triggerChanError(),this._triggerStateCallbacks("error",n);try{this.heartbeatCallback("error")}catch(r){this.log("error","error in heartbeat callback",r)}}_triggerChanError(){this.channels.forEach(n=>n._trigger(ir.error))}_appendParams(n,r){if(Object.keys(r).length===0)return n;const a=n.match(/\?/)?"&":"?",d=new URLSearchParams(r);return`${n}${a}${d}`}_workerObjectUrl(n){let r;if(n)r=n;else{const a=new Blob([kg],{type:"application/javascript"});r=URL.createObjectURL(a)}return r}_setConnectionState(n,r=!1){this._connectionState=n,n==="connecting"?this._wasManualDisconnect=!1:n==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(n=null){let r,a=!1;if(n)r=n,a=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(d){this.log("error","Error fetching access token from callback",d),r=this.accessTokenValue}else r=this.accessTokenValue;a?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(d=>{const h={access_token:r,version:cg};r&&d.updateJoinPayload(h),d.joinedOnce&&d._isJoined()&&d._push(ir.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(n="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${n}`,r)})}_triggerStateCallbacks(n,r){try{this.stateChangeCallbacks[n].forEach(a=>{try{a(r)}catch(d){this.log("error",`error in ${n} callback`,d)}})}catch(a){this.log("error",`error triggering ${n} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new Pf(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Pl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(n){var r,a,d,h,p,v,x,_,j,C,F,T;switch(this.transport=(r=n?.transport)!==null&&r!==void 0?r:null,this.timeout=(a=n?.timeout)!==null&&a!==void 0?a:Pu,this.heartbeatIntervalMs=(d=n?.heartbeatIntervalMs)!==null&&d!==void 0?d:Pl.HEARTBEAT_INTERVAL,this.worker=(h=n?.worker)!==null&&h!==void 0?h:!1,this.accessToken=(p=n?.accessToken)!==null&&p!==void 0?p:null,this.heartbeatCallback=(v=n?.heartbeatCallback)!==null&&v!==void 0?v:ku,this.vsn=(x=n?.vsn)!==null&&x!==void 0?x:tf,n?.params&&(this.params=n.params),n?.logger&&(this.logger=n.logger),(n?.logLevel||n?.log_level)&&(this.logLevel=n.logLevel||n.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(_=n?.reconnectAfterMs)!==null&&_!==void 0?_:(A=>bg[A-1]||wg),this.vsn){case ug:this.encode=(j=n?.encode)!==null&&j!==void 0?j:((A,q)=>q(JSON.stringify(A))),this.decode=(C=n?.decode)!==null&&C!==void 0?C:((A,q)=>q(JSON.parse(A)));break;case Rf:this.encode=(F=n?.encode)!==null&&F!==void 0?F:this.serializer.encode.bind(this.serializer),this.decode=(T=n?.decode)!==null&&T!==void 0?T:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=n?.workerUrl}}}var da=class extends Error{constructor(i,n){super(i),this.name="IcebergError",this.status=n.status,this.icebergType=n.icebergType,this.icebergCode=n.icebergCode,this.details=n.details,this.isCommitStateUnknown=n.icebergType==="CommitStateUnknownException"||[500,502,504].includes(n.status)&&n.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function jg(i,n,r){const a=new URL(n,i);if(r)for(const[d,h]of Object.entries(r))h!==void 0&&a.searchParams.set(d,h);return a.toString()}async function Ng(i){return!i||i.type==="none"?{}:i.type==="bearer"?{Authorization:`Bearer ${i.token}`}:i.type==="header"?{[i.name]:i.value}:i.type==="custom"?await i.getHeaders():{}}function Sg(i){const n=i.fetchImpl??globalThis.fetch;return{async request({method:r,path:a,query:d,body:h,headers:p}){const v=jg(i.baseUrl,a,d),x=await Ng(i.auth),_=await n(v,{method:r,headers:{...h?{"Content-Type":"application/json"}:{},...x,...p},body:h?JSON.stringify(h):void 0}),j=await _.text(),C=(_.headers.get("content-type")||"").includes("application/json"),F=C&&j?JSON.parse(j):j;if(!_.ok){const T=C?F:void 0,A=T?.error;throw new da(A?.message??`Request failed with status ${_.status}`,{status:_.status,icebergType:A?.type,icebergCode:A?.code,details:T})}return{status:_.status,headers:_.headers,data:F}}}}function Ol(i){return i.join("")}var Cg=class{constructor(i,n=""){this.client=i,this.prefix=n}async listNamespaces(i){const n=i?{parent:Ol(i.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:n})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(i,n){const r={namespace:i.namespace,properties:n?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(i){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ol(i.namespace)}`})}async loadNamespaceMetadata(i){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ol(i.namespace)}`})).data.properties}}async namespaceExists(i){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ol(i.namespace)}`}),!0}catch(n){if(n instanceof da&&n.status===404)return!1;throw n}}async createNamespaceIfNotExists(i,n){try{return await this.createNamespace(i,n)}catch(r){if(r instanceof da&&r.status===409)return;throw r}}};function ro(i){return i.join("")}var Fg=class{constructor(i,n="",r){this.client=i,this.prefix=n,this.accessDelegation=r}async listTables(i){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ro(i.namespace)}/tables`})).data.identifiers}async createTable(i,n){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ro(i.namespace)}/tables`,body:n,headers:r})).data.metadata}async updateTable(i,n){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ro(i.namespace)}/tables/${i.name}`,body:n});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(i,n){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ro(i.namespace)}/tables/${i.name}`,query:{purgeRequested:String(n?.purge??!1)}})}async loadTable(i){const n={};return this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ro(i.namespace)}/tables/${i.name}`,headers:n})).data.metadata}async tableExists(i){const n={};this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ro(i.namespace)}/tables/${i.name}`,headers:n}),!0}catch(r){if(r instanceof da&&r.status===404)return!1;throw r}}async createTableIfNotExists(i,n){try{return await this.createTable(i,n)}catch(r){if(r instanceof da&&r.status===409)return await this.loadTable({namespace:i.namespace,name:n.name});throw r}}},Eg=class{constructor(i){let n="v1";i.catalogName&&(n+=`/${i.catalogName}`);const r=i.baseUrl.endsWith("/")?i.baseUrl:`${i.baseUrl}/`;this.client=Sg({baseUrl:r,auth:i.auth,fetchImpl:i.fetch}),this.accessDelegation=i.accessDelegation?.join(","),this.namespaceOps=new Cg(this.client,n),this.tableOps=new Fg(this.client,n,this.accessDelegation)}async listNamespaces(i){return this.namespaceOps.listNamespaces(i)}async createNamespace(i,n){return this.namespaceOps.createNamespace(i,n)}async dropNamespace(i){await this.namespaceOps.dropNamespace(i)}async loadNamespaceMetadata(i){return this.namespaceOps.loadNamespaceMetadata(i)}async listTables(i){return this.tableOps.listTables(i)}async createTable(i,n){return this.tableOps.createTable(i,n)}async updateTable(i,n){return this.tableOps.updateTable(i,n)}async dropTable(i,n){await this.tableOps.dropTable(i,n)}async loadTable(i){return this.tableOps.loadTable(i)}async namespaceExists(i){return this.namespaceOps.namespaceExists(i)}async tableExists(i){return this.tableOps.tableExists(i)}async createNamespaceIfNotExists(i,n){return this.namespaceOps.createNamespaceIfNotExists(i,n)}async createTableIfNotExists(i,n){return this.tableOps.createTableIfNotExists(i,n)}},Gl=class extends Error{constructor(i,n="storage",r,a){super(i),this.__isStorageError=!0,this.namespace=n,this.name=n==="vectors"?"StorageVectorsError":"StorageError",this.status=r,this.statusCode=a}};function Jl(i){return typeof i=="object"&&i!==null&&"__isStorageError"in i}var Dl=class extends Gl{constructor(i,n,r,a="storage"){super(i,a,n,r),this.name=a==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=n,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},If=class extends Gl{constructor(i,n,r="storage"){super(i,r),this.name=r==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=n}};const Ag=i=>i?(...n)=>i(...n):(...n)=>fetch(...n),Tg=i=>{if(typeof i!="object"||i===null)return!1;const n=Object.getPrototypeOf(i);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)},Iu=i=>{if(Array.isArray(i))return i.map(r=>Iu(r));if(typeof i=="function"||i!==Object(i))return i;const n={};return Object.entries(i).forEach(([r,a])=>{const d=r.replace(/([-_][a-z])/gi,h=>h.toUpperCase().replace(/[-_]/g,""));n[d]=Iu(a)}),n},Rg=i=>!i||typeof i!="string"||i.length===0||i.length>100||i.trim()!==i||i.includes("/")||i.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(i);function ha(i){"@babel/helpers - typeof";return ha=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},ha(i)}function Pg(i,n){if(ha(i)!="object"||!i)return i;var r=i[Symbol.toPrimitive];if(r!==void 0){var a=r.call(i,n);if(ha(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(i)}function Og(i){var n=Pg(i,"string");return ha(n)=="symbol"?n:n+""}function Dg(i,n,r){return(n=Og(n))in i?Object.defineProperty(i,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[n]=r,i}function of(i,n){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);n&&(a=a.filter(function(d){return Object.getOwnPropertyDescriptor(i,d).enumerable})),r.push.apply(r,a)}return r}function qe(i){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?of(Object(r),!0).forEach(function(a){Dg(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):of(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}const af=i=>{var n;return i.msg||i.message||i.error_description||(typeof i.error=="string"?i.error:(n=i.error)===null||n===void 0?void 0:n.message)||JSON.stringify(i)},Ig=async(i,n,r,a)=>{if(i&&typeof i=="object"&&"status"in i&&"ok"in i&&typeof i.status=="number"&&!r?.noResolveJson){const d=i,h=d.status||500;if(typeof d.json=="function")d.json().then(p=>{const v=p?.statusCode||p?.code||h+"";n(new Dl(af(p),h,v,a))}).catch(()=>{if(a==="vectors"){const p=h+"";n(new Dl(d.statusText||`HTTP ${h} error`,h,p,a))}else{const p=h+"";n(new Dl(d.statusText||`HTTP ${h} error`,h,p,a))}});else{const p=h+"";n(new Dl(d.statusText||`HTTP ${h} error`,h,p,a))}}else n(new If(af(i),i,a))},Mg=(i,n,r,a)=>{const d={method:i,headers:n?.headers||{}};return i==="GET"||i==="HEAD"||!a?qe(qe({},d),r):(Tg(a)?(d.headers=qe({"Content-Type":"application/json"},n?.headers),d.body=JSON.stringify(a)):d.body=a,n?.duplex&&(d.duplex=n.duplex),qe(qe({},d),r))};async function ia(i,n,r,a,d,h,p){return new Promise((v,x)=>{i(r,Mg(n,a,d,h)).then(_=>{if(!_.ok)throw _;if(a?.noResolveJson)return _;if(p==="vectors"){const j=_.headers.get("content-type");if(_.headers.get("content-length")==="0"||_.status===204)return{};if(!j||!j.includes("application/json"))return{}}return _.json()}).then(_=>v(_)).catch(_=>Ig(_,x,a,p))})}function Mf(i="storage"){return{get:async(n,r,a,d)=>ia(n,"GET",r,a,d,void 0,i),post:async(n,r,a,d,h)=>ia(n,"POST",r,d,h,a,i),put:async(n,r,a,d,h)=>ia(n,"PUT",r,d,h,a,i),head:async(n,r,a,d)=>ia(n,"HEAD",r,qe(qe({},a),{},{noResolveJson:!0}),d,void 0,i),remove:async(n,r,a,d,h)=>ia(n,"DELETE",r,d,h,a,i)}}const Lg=Mf("storage"),{get:fa,post:sr,put:Mu,head:Bg,remove:Ju}=Lg,An=Mf("vectors");var xo=class{constructor(i,n={},r,a="storage"){this.shouldThrowOnError=!1,this.url=i,this.headers=n,this.fetch=Ag(r),this.namespace=a}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(i){var n=this;try{return{data:await i(),error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(Jl(r))return{data:null,error:r};throw r}}},$g=class{constructor(i,n){this.downloadFn=i,this.shouldThrowOnError=n}then(i,n){return this.execute().then(i,n)}async execute(){var i=this;try{return{data:(await i.downloadFn()).body,error:null}}catch(n){if(i.shouldThrowOnError)throw n;if(Jl(n))return{data:null,error:n};throw n}}};let Lf;Lf=Symbol.toStringTag;var Ug=class{constructor(i,n){this.downloadFn=i,this.shouldThrowOnError=n,this[Lf]="BlobDownloadBuilder",this.promise=null}asStream(){return new $g(this.downloadFn,this.shouldThrowOnError)}then(i,n){return this.getPromise().then(i,n)}catch(i){return this.getPromise().catch(i)}finally(i){return this.getPromise().finally(i)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var i=this;try{return{data:await(await i.downloadFn()).blob(),error:null}}catch(n){if(i.shouldThrowOnError)throw n;if(Jl(n))return{data:null,error:n};throw n}}};const zg={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},lf={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var qg=class extends xo{constructor(i,n={},r,a){super(i,n,a,"storage"),this.bucketId=r}async uploadOrUpdate(i,n,r,a){var d=this;return d.handleOperation(async()=>{let h;const p=qe(qe({},lf),a);let v=qe(qe({},d.headers),i==="POST"&&{"x-upsert":String(p.upsert)});const x=p.metadata;typeof Blob<"u"&&r instanceof Blob?(h=new FormData,h.append("cacheControl",p.cacheControl),x&&h.append("metadata",d.encodeMetadata(x)),h.append("",r)):typeof FormData<"u"&&r instanceof FormData?(h=r,h.has("cacheControl")||h.append("cacheControl",p.cacheControl),x&&!h.has("metadata")&&h.append("metadata",d.encodeMetadata(x))):(h=r,v["cache-control"]=`max-age=${p.cacheControl}`,v["content-type"]=p.contentType,x&&(v["x-metadata"]=d.toBase64(d.encodeMetadata(x))),(typeof ReadableStream<"u"&&h instanceof ReadableStream||h&&typeof h=="object"&&"pipe"in h&&typeof h.pipe=="function")&&!p.duplex&&(p.duplex="half")),a?.headers&&(v=qe(qe({},v),a.headers));const _=d._removeEmptyFolders(n),j=d._getFinalPath(_),C=await(i=="PUT"?Mu:sr)(d.fetch,`${d.url}/object/${j}`,h,qe({headers:v},p?.duplex?{duplex:p.duplex}:{}));return{path:_,id:C.Id,fullPath:C.Key}})}async upload(i,n,r){return this.uploadOrUpdate("POST",i,n,r)}async uploadToSignedUrl(i,n,r,a){var d=this;const h=d._removeEmptyFolders(i),p=d._getFinalPath(h),v=new URL(d.url+`/object/upload/sign/${p}`);return v.searchParams.set("token",n),d.handleOperation(async()=>{let x;const _=qe({upsert:lf.upsert},a),j=qe(qe({},d.headers),{"x-upsert":String(_.upsert)});return typeof Blob<"u"&&r instanceof Blob?(x=new FormData,x.append("cacheControl",_.cacheControl),x.append("",r)):typeof FormData<"u"&&r instanceof FormData?(x=r,x.append("cacheControl",_.cacheControl)):(x=r,j["cache-control"]=`max-age=${_.cacheControl}`,j["content-type"]=_.contentType),{path:h,fullPath:(await Mu(d.fetch,v.toString(),x,{headers:j})).Key}})}async createSignedUploadUrl(i,n){var r=this;return r.handleOperation(async()=>{let a=r._getFinalPath(i);const d=qe({},r.headers);n?.upsert&&(d["x-upsert"]="true");const h=await sr(r.fetch,`${r.url}/object/upload/sign/${a}`,{},{headers:d}),p=new URL(r.url+h.url),v=p.searchParams.get("token");if(!v)throw new Gl("No token returned by API");return{signedUrl:p.toString(),path:i,token:v}})}async update(i,n,r){return this.uploadOrUpdate("PUT",i,n,r)}async move(i,n,r){var a=this;return a.handleOperation(async()=>await sr(a.fetch,`${a.url}/object/move`,{bucketId:a.bucketId,sourceKey:i,destinationKey:n,destinationBucket:r?.destinationBucket},{headers:a.headers}))}async copy(i,n,r){var a=this;return a.handleOperation(async()=>({path:(await sr(a.fetch,`${a.url}/object/copy`,{bucketId:a.bucketId,sourceKey:i,destinationKey:n,destinationBucket:r?.destinationBucket},{headers:a.headers})).Key}))}async createSignedUrl(i,n,r){var a=this;return a.handleOperation(async()=>{let d=a._getFinalPath(i),h=await sr(a.fetch,`${a.url}/object/sign/${d}`,qe({expiresIn:n},r?.transform?{transform:r.transform}:{}),{headers:a.headers});const p=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{signedUrl:encodeURI(`${a.url}${h.signedURL}${p}`)}})}async createSignedUrls(i,n,r){var a=this;return a.handleOperation(async()=>{const d=await sr(a.fetch,`${a.url}/object/sign/${a.bucketId}`,{expiresIn:n,paths:i},{headers:a.headers}),h=r?.download?`&download=${r.download===!0?"":r.download}`:"";return d.map(p=>qe(qe({},p),{},{signedUrl:p.signedURL?encodeURI(`${a.url}${p.signedURL}${h}`):null}))})}download(i,n,r){const a=typeof n?.transform<"u"?"render/image/authenticated":"object",d=this.transformOptsToQueryString(n?.transform||{}),h=d?`?${d}`:"",p=this._getFinalPath(i),v=()=>fa(this.fetch,`${this.url}/${a}/${p}${h}`,{headers:this.headers,noResolveJson:!0},r);return new Ug(v,this.shouldThrowOnError)}async info(i){var n=this;const r=n._getFinalPath(i);return n.handleOperation(async()=>Iu(await fa(n.fetch,`${n.url}/object/info/${r}`,{headers:n.headers})))}async exists(i){var n=this;const r=n._getFinalPath(i);try{return await Bg(n.fetch,`${n.url}/object/${r}`,{headers:n.headers}),{data:!0,error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Jl(a)&&a instanceof If){const d=a.originalError;if([400,404].includes(d?.status))return{data:!1,error:a}}throw a}}getPublicUrl(i,n){const r=this._getFinalPath(i),a=[],d=n?.download?`download=${n.download===!0?"":n.download}`:"";d!==""&&a.push(d);const h=typeof n?.transform<"u"?"render/image":"object",p=this.transformOptsToQueryString(n?.transform||{});p!==""&&a.push(p);let v=a.join("&");return v!==""&&(v=`?${v}`),{data:{publicUrl:encodeURI(`${this.url}/${h}/public/${r}${v}`)}}}async remove(i){var n=this;return n.handleOperation(async()=>await Ju(n.fetch,`${n.url}/object/${n.bucketId}`,{prefixes:i},{headers:n.headers}))}async list(i,n,r){var a=this;return a.handleOperation(async()=>{const d=qe(qe(qe({},zg),n),{},{prefix:i||""});return await sr(a.fetch,`${a.url}/object/list/${a.bucketId}`,d,{headers:a.headers},r)})}async listV2(i,n){var r=this;return r.handleOperation(async()=>{const a=qe({},i);return await sr(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,a,{headers:r.headers},n)})}encodeMetadata(i){return JSON.stringify(i)}toBase64(i){return typeof Buffer<"u"?Buffer.from(i).toString("base64"):btoa(i)}_getFinalPath(i){return`${this.bucketId}/${i.replace(/^\/+/,"")}`}_removeEmptyFolders(i){return i.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(i){const n=[];return i.width&&n.push(`width=${i.width}`),i.height&&n.push(`height=${i.height}`),i.resize&&n.push(`resize=${i.resize}`),i.format&&n.push(`format=${i.format}`),i.quality&&n.push(`quality=${i.quality}`),n.join("&")}};const Wg="2.95.3",ga={"X-Client-Info":`storage-js/${Wg}`};var Kg=class extends xo{constructor(i,n={},r,a){const d=new URL(i);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(d.hostname)&&!d.hostname.includes("storage.supabase.")&&(d.hostname=d.hostname.replace("supabase.","storage.supabase."));const h=d.href.replace(/\/$/,""),p=qe(qe({},ga),n);super(h,p,r,"storage")}async listBuckets(i){var n=this;return n.handleOperation(async()=>{const r=n.listBucketOptionsToQueryString(i);return await fa(n.fetch,`${n.url}/bucket${r}`,{headers:n.headers})})}async getBucket(i){var n=this;return n.handleOperation(async()=>await fa(n.fetch,`${n.url}/bucket/${i}`,{headers:n.headers}))}async createBucket(i,n={public:!1}){var r=this;return r.handleOperation(async()=>await sr(r.fetch,`${r.url}/bucket`,{id:i,name:i,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:r.headers}))}async updateBucket(i,n){var r=this;return r.handleOperation(async()=>await Mu(r.fetch,`${r.url}/bucket/${i}`,{id:i,name:i,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:r.headers}))}async emptyBucket(i){var n=this;return n.handleOperation(async()=>await sr(n.fetch,`${n.url}/bucket/${i}/empty`,{},{headers:n.headers}))}async deleteBucket(i){var n=this;return n.handleOperation(async()=>await Ju(n.fetch,`${n.url}/bucket/${i}`,{},{headers:n.headers}))}listBucketOptionsToQueryString(i){const n={};return i&&("limit"in i&&(n.limit=String(i.limit)),"offset"in i&&(n.offset=String(i.offset)),i.search&&(n.search=i.search),i.sortColumn&&(n.sortColumn=i.sortColumn),i.sortOrder&&(n.sortOrder=i.sortOrder)),Object.keys(n).length>0?"?"+new URLSearchParams(n).toString():""}},Hg=class extends xo{constructor(i,n={},r){const a=i.replace(/\/$/,""),d=qe(qe({},ga),n);super(a,d,r,"storage")}async createBucket(i){var n=this;return n.handleOperation(async()=>await sr(n.fetch,`${n.url}/bucket`,{name:i},{headers:n.headers}))}async listBuckets(i){var n=this;return n.handleOperation(async()=>{const r=new URLSearchParams;i?.limit!==void 0&&r.set("limit",i.limit.toString()),i?.offset!==void 0&&r.set("offset",i.offset.toString()),i?.sortColumn&&r.set("sortColumn",i.sortColumn),i?.sortOrder&&r.set("sortOrder",i.sortOrder),i?.search&&r.set("search",i.search);const a=r.toString(),d=a?`${n.url}/bucket?${a}`:`${n.url}/bucket`;return await fa(n.fetch,d,{headers:n.headers})})}async deleteBucket(i){var n=this;return n.handleOperation(async()=>await Ju(n.fetch,`${n.url}/bucket/${i}`,{},{headers:n.headers}))}from(i){var n=this;if(!Rg(i))throw new Gl("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new Eg({baseUrl:this.url,catalogName:i,auth:{type:"custom",getHeaders:async()=>n.headers},fetch:this.fetch}),a=this.shouldThrowOnError;return new Proxy(r,{get(d,h){const p=d[h];return typeof p!="function"?p:async(...v)=>{try{return{data:await p.apply(d,v),error:null}}catch(x){if(a)throw x;return{data:null,error:x}}}}})}},Vg=class extends xo{constructor(i,n={},r){const a=i.replace(/\/$/,""),d=qe(qe({},ga),{},{"Content-Type":"application/json"},n);super(a,d,r,"vectors")}async createIndex(i){var n=this;return n.handleOperation(async()=>await An.post(n.fetch,`${n.url}/CreateIndex`,i,{headers:n.headers})||{})}async getIndex(i,n){var r=this;return r.handleOperation(async()=>await An.post(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:i,indexName:n},{headers:r.headers}))}async listIndexes(i){var n=this;return n.handleOperation(async()=>await An.post(n.fetch,`${n.url}/ListIndexes`,i,{headers:n.headers}))}async deleteIndex(i,n){var r=this;return r.handleOperation(async()=>await An.post(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:i,indexName:n},{headers:r.headers})||{})}},Gg=class extends xo{constructor(i,n={},r){const a=i.replace(/\/$/,""),d=qe(qe({},ga),{},{"Content-Type":"application/json"},n);super(a,d,r,"vectors")}async putVectors(i){var n=this;if(i.vectors.length<1||i.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return n.handleOperation(async()=>await An.post(n.fetch,`${n.url}/PutVectors`,i,{headers:n.headers})||{})}async getVectors(i){var n=this;return n.handleOperation(async()=>await An.post(n.fetch,`${n.url}/GetVectors`,i,{headers:n.headers}))}async listVectors(i){var n=this;if(i.segmentCount!==void 0){if(i.segmentCount<1||i.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(i.segmentIndex!==void 0&&(i.segmentIndex<0||i.segmentIndex>=i.segmentCount))throw new Error(`segmentIndex must be between 0 and ${i.segmentCount-1}`)}return n.handleOperation(async()=>await An.post(n.fetch,`${n.url}/ListVectors`,i,{headers:n.headers}))}async queryVectors(i){var n=this;return n.handleOperation(async()=>await An.post(n.fetch,`${n.url}/QueryVectors`,i,{headers:n.headers}))}async deleteVectors(i){var n=this;if(i.keys.length<1||i.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return n.handleOperation(async()=>await An.post(n.fetch,`${n.url}/DeleteVectors`,i,{headers:n.headers})||{})}},Jg=class extends xo{constructor(i,n={},r){const a=i.replace(/\/$/,""),d=qe(qe({},ga),{},{"Content-Type":"application/json"},n);super(a,d,r,"vectors")}async createBucket(i){var n=this;return n.handleOperation(async()=>await An.post(n.fetch,`${n.url}/CreateVectorBucket`,{vectorBucketName:i},{headers:n.headers})||{})}async getBucket(i){var n=this;return n.handleOperation(async()=>await An.post(n.fetch,`${n.url}/GetVectorBucket`,{vectorBucketName:i},{headers:n.headers}))}async listBuckets(i={}){var n=this;return n.handleOperation(async()=>await An.post(n.fetch,`${n.url}/ListVectorBuckets`,i,{headers:n.headers}))}async deleteBucket(i){var n=this;return n.handleOperation(async()=>await An.post(n.fetch,`${n.url}/DeleteVectorBucket`,{vectorBucketName:i},{headers:n.headers})||{})}},Yg=class extends Jg{constructor(i,n={}){super(i,n.headers||{},n.fetch)}from(i){return new Qg(this.url,this.headers,i,this.fetch)}async createBucket(i){var n=()=>super.createBucket,r=this;return n().call(r,i)}async getBucket(i){var n=()=>super.getBucket,r=this;return n().call(r,i)}async listBuckets(i={}){var n=()=>super.listBuckets,r=this;return n().call(r,i)}async deleteBucket(i){var n=()=>super.deleteBucket,r=this;return n().call(r,i)}},Qg=class extends Vg{constructor(i,n,r,a){super(i,n,a),this.vectorBucketName=r}async createIndex(i){var n=()=>super.createIndex,r=this;return n().call(r,qe(qe({},i),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(i={}){var n=()=>super.listIndexes,r=this;return n().call(r,qe(qe({},i),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(i){var n=()=>super.getIndex,r=this;return n().call(r,r.vectorBucketName,i)}async deleteIndex(i){var n=()=>super.deleteIndex,r=this;return n().call(r,r.vectorBucketName,i)}index(i){return new Xg(this.url,this.headers,this.vectorBucketName,i,this.fetch)}},Xg=class extends Gg{constructor(i,n,r,a,d){super(i,n,d),this.vectorBucketName=r,this.indexName=a}async putVectors(i){var n=()=>super.putVectors,r=this;return n().call(r,qe(qe({},i),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(i){var n=()=>super.getVectors,r=this;return n().call(r,qe(qe({},i),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(i={}){var n=()=>super.listVectors,r=this;return n().call(r,qe(qe({},i),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(i){var n=()=>super.queryVectors,r=this;return n().call(r,qe(qe({},i),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(i){var n=()=>super.deleteVectors,r=this;return n().call(r,qe(qe({},i),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},Zg=class extends Kg{constructor(i,n={},r,a){super(i,n,r,a)}from(i){return new qg(this.url,this.headers,i,this.fetch)}get vectors(){return new Yg(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Hg(this.url+"/iceberg",this.headers,this.fetch)}};const Bf="2.95.3",ho=30*1e3,Lu=3,_u=Lu*ho,ev="http://localhost:9999",tv="supabase.auth.token",nv={"X-Client-Info":`gotrue-js/${Bf}`},Bu="X-Supabase-Api-Version",$f={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},rv=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,sv=600*1e3;class pa extends Error{constructor(n,r,a){super(n),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=a}}function Oe(i){return typeof i=="object"&&i!==null&&"__isAuthError"in i}class iv extends pa{constructor(n,r,a){super(n,r,a),this.name="AuthApiError",this.status=r,this.code=a}}function ov(i){return Oe(i)&&i.name==="AuthApiError"}class bi extends pa{constructor(n,r){super(n),this.name="AuthUnknownError",this.originalError=r}}class Zr extends pa{constructor(n,r,a,d){super(n,a,d),this.name=r,this.status=a}}class En extends Zr{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function ju(i){return Oe(i)&&i.name==="AuthSessionMissingError"}class so extends Zr{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Il extends Zr{constructor(n){super(n,"AuthInvalidCredentialsError",400,void 0)}}class Ml extends Zr{constructor(n,r=null){super(n,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function av(i){return Oe(i)&&i.name==="AuthImplicitGrantRedirectError"}class cf extends Zr{constructor(n,r=null){super(n,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class lv extends Zr{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class $u extends Zr{constructor(n,r){super(n,"AuthRetryableFetchError",r,void 0)}}function Nu(i){return Oe(i)&&i.name==="AuthRetryableFetchError"}class uf extends Zr{constructor(n,r,a){super(n,"AuthWeakPasswordError",r,"weak_password"),this.reasons=a}}class Uu extends Zr{constructor(n){super(n,"AuthInvalidJwtError",400,"invalid_jwt")}}const Wl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),df=` 	
\r=`.split(""),cv=(()=>{const i=new Array(128);for(let n=0;n<i.length;n+=1)i[n]=-1;for(let n=0;n<df.length;n+=1)i[df[n].charCodeAt(0)]=-2;for(let n=0;n<Wl.length;n+=1)i[Wl[n].charCodeAt(0)]=n;return i})();function hf(i,n,r){if(i!==null)for(n.queue=n.queue<<8|i,n.queuedBits+=8;n.queuedBits>=6;){const a=n.queue>>n.queuedBits-6&63;r(Wl[a]),n.queuedBits-=6}else if(n.queuedBits>0)for(n.queue=n.queue<<6-n.queuedBits,n.queuedBits=6;n.queuedBits>=6;){const a=n.queue>>n.queuedBits-6&63;r(Wl[a]),n.queuedBits-=6}}function Uf(i,n,r){const a=cv[i];if(a>-1)for(n.queue=n.queue<<6|a,n.queuedBits+=6;n.queuedBits>=8;)r(n.queue>>n.queuedBits-8&255),n.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(i)}"`)}}function ff(i){const n=[],r=p=>{n.push(String.fromCodePoint(p))},a={utf8seq:0,codepoint:0},d={queue:0,queuedBits:0},h=p=>{hv(p,a,r)};for(let p=0;p<i.length;p+=1)Uf(i.charCodeAt(p),d,h);return n.join("")}function uv(i,n){if(i<=127){n(i);return}else if(i<=2047){n(192|i>>6),n(128|i&63);return}else if(i<=65535){n(224|i>>12),n(128|i>>6&63),n(128|i&63);return}else if(i<=1114111){n(240|i>>18),n(128|i>>12&63),n(128|i>>6&63),n(128|i&63);return}throw new Error(`Unrecognized Unicode codepoint: ${i.toString(16)}`)}function dv(i,n){for(let r=0;r<i.length;r+=1){let a=i.charCodeAt(r);if(a>55295&&a<=56319){const d=(a-55296)*1024&65535;a=(i.charCodeAt(r+1)-56320&65535|d)+65536,r+=1}uv(a,n)}}function hv(i,n,r){if(n.utf8seq===0){if(i<=127){r(i);return}for(let a=1;a<6;a+=1)if((i>>7-a&1)===0){n.utf8seq=a;break}if(n.utf8seq===2)n.codepoint=i&31;else if(n.utf8seq===3)n.codepoint=i&15;else if(n.utf8seq===4)n.codepoint=i&7;else throw new Error("Invalid UTF-8 sequence");n.utf8seq-=1}else if(n.utf8seq>0){if(i<=127)throw new Error("Invalid UTF-8 sequence");n.codepoint=n.codepoint<<6|i&63,n.utf8seq-=1,n.utf8seq===0&&r(n.codepoint)}}function yo(i){const n=[],r={queue:0,queuedBits:0},a=d=>{n.push(d)};for(let d=0;d<i.length;d+=1)Uf(i.charCodeAt(d),r,a);return new Uint8Array(n)}function fv(i){const n=[];return dv(i,r=>n.push(r)),new Uint8Array(n)}function wi(i){const n=[],r={queue:0,queuedBits:0},a=d=>{n.push(d)};return i.forEach(d=>hf(d,r,a)),hf(null,r,a),n.join("")}function pv(i){return Math.round(Date.now()/1e3)+i}function mv(){return Symbol("auth-callback")}const Zt=()=>typeof window<"u"&&typeof document<"u",yi={tested:!1,writable:!1},zf=()=>{if(!Zt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(yi.tested)return yi.writable;const i=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(i,i),globalThis.localStorage.removeItem(i),yi.tested=!0,yi.writable=!0}catch{yi.tested=!0,yi.writable=!1}return yi.writable};function yv(i){const n={},r=new URL(i);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((d,h)=>{n[h]=d})}catch{}return r.searchParams.forEach((a,d)=>{n[d]=a}),n}const qf=i=>i?(...n)=>i(...n):(...n)=>fetch(...n),gv=i=>typeof i=="object"&&i!==null&&"status"in i&&"ok"in i&&"json"in i&&typeof i.json=="function",fo=async(i,n,r)=>{await i.setItem(n,JSON.stringify(r))},gi=async(i,n)=>{const r=await i.getItem(n);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Xt=async(i,n)=>{await i.removeItem(n)};class Yl{constructor(){this.promise=new Yl.promiseConstructor((n,r)=>{this.resolve=n,this.reject=r})}}Yl.promiseConstructor=Promise;function Ll(i){const n=i.split(".");if(n.length!==3)throw new Uu("Invalid JWT structure");for(let a=0;a<n.length;a++)if(!rv.test(n[a]))throw new Uu("JWT not in base64url format");return{header:JSON.parse(ff(n[0])),payload:JSON.parse(ff(n[1])),signature:yo(n[2]),raw:{header:n[0],payload:n[1]}}}async function vv(i){return await new Promise(n=>{setTimeout(()=>n(null),i)})}function xv(i,n){return new Promise((a,d)=>{(async()=>{for(let h=0;h<1/0;h++)try{const p=await i(h);if(!n(h,null,p)){a(p);return}}catch(p){if(!n(h,p)){d(p);return}}})()})}function bv(i){return("0"+i.toString(16)).substr(-2)}function wv(){const n=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=r.length;let d="";for(let h=0;h<56;h++)d+=r.charAt(Math.floor(Math.random()*a));return d}return crypto.getRandomValues(n),Array.from(n,bv).join("")}async function kv(i){const r=new TextEncoder().encode(i),a=await crypto.subtle.digest("SHA-256",r),d=new Uint8Array(a);return Array.from(d).map(h=>String.fromCharCode(h)).join("")}async function _v(i){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),i;const r=await kv(i);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function io(i,n,r=!1){const a=wv();let d=a;r&&(d+="/PASSWORD_RECOVERY"),await fo(i,`${n}-code-verifier`,d);const h=await _v(a);return[h,a===h?"plain":"s256"]}const jv=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Nv(i){const n=i.headers.get(Bu);if(!n||!n.match(jv))return null;try{return new Date(`${n}T00:00:00.0Z`)}catch{return null}}function Sv(i){if(!i)throw new Error("Missing exp claim");const n=Math.floor(Date.now()/1e3);if(i<=n)throw new Error("JWT has expired")}function Cv(i){switch(i){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Fv=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function oo(i){if(!Fv.test(i))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Su(){const i={};return new Proxy(i,{get:(n,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(n,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(n,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Ev(i,n){return new Proxy(i,{get:(r,a,d)=>{if(a==="__isInsecureUserWarningProxy")return!0;if(typeof a=="symbol"){const h=a.toString();if(h==="Symbol(Symbol.toPrimitive)"||h==="Symbol(Symbol.toStringTag)"||h==="Symbol(util.inspect.custom)"||h==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,a,d)}return!n.value&&typeof a=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),n.value=!0),Reflect.get(r,a,d)}})}function pf(i){return JSON.parse(JSON.stringify(i))}const vi=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),Av=[502,503,504];async function mf(i){var n;if(!gv(i))throw new $u(vi(i),0);if(Av.includes(i.status))throw new $u(vi(i),i.status);let r;try{r=await i.json()}catch(h){throw new bi(vi(h),h)}let a;const d=Nv(i);if(d&&d.getTime()>=$f["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?a=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(a=r.error_code),a){if(a==="weak_password")throw new uf(vi(r),i.status,((n=r.weak_password)===null||n===void 0?void 0:n.reasons)||[]);if(a==="session_not_found")throw new En}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((h,p)=>h&&typeof p=="string",!0))throw new uf(vi(r),i.status,r.weak_password.reasons);throw new iv(vi(r),i.status||500,a)}const Tv=(i,n,r,a)=>{const d={method:i,headers:n?.headers||{}};return i==="GET"?d:(d.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},n?.headers),d.body=JSON.stringify(a),Object.assign(Object.assign({},d),r))};async function ze(i,n,r,a){var d;const h=Object.assign({},a?.headers);h[Bu]||(h[Bu]=$f["2024-01-01"].name),a?.jwt&&(h.Authorization=`Bearer ${a.jwt}`);const p=(d=a?.query)!==null&&d!==void 0?d:{};a?.redirectTo&&(p.redirect_to=a.redirectTo);const v=Object.keys(p).length?"?"+new URLSearchParams(p).toString():"",x=await Rv(i,n,r+v,{headers:h,noResolveJson:a?.noResolveJson},{},a?.body);return a?.xform?a?.xform(x):{data:Object.assign({},x),error:null}}async function Rv(i,n,r,a,d,h){const p=Tv(n,a,d,h);let v;try{v=await i(r,Object.assign({},p))}catch(x){throw console.error(x),new $u(vi(x),0)}if(v.ok||await mf(v),a?.noResolveJson)return v;try{return await v.json()}catch(x){await mf(x)}}function rr(i){var n;let r=null;Dv(i)&&(r=Object.assign({},i),i.expires_at||(r.expires_at=pv(i.expires_in)));const a=(n=i.user)!==null&&n!==void 0?n:i;return{data:{session:r,user:a},error:null}}function yf(i){const n=rr(i);return!n.error&&i.weak_password&&typeof i.weak_password=="object"&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.message&&typeof i.weak_password.message=="string"&&i.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0)&&(n.data.weak_password=i.weak_password),n}function Ms(i){var n;return{data:{user:(n=i.user)!==null&&n!==void 0?n:i},error:null}}function Pv(i){return{data:i,error:null}}function Ov(i){const{action_link:n,email_otp:r,hashed_token:a,redirect_to:d,verification_type:h}=i,p=Vl(i,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),v={action_link:n,email_otp:r,hashed_token:a,redirect_to:d,verification_type:h},x=Object.assign({},p);return{data:{properties:v,user:x},error:null}}function gf(i){return i}function Dv(i){return i.access_token&&i.refresh_token&&i.expires_in}const Cu=["global","local","others"];class Iv{constructor({url:n="",headers:r={},fetch:a}){this.url=n,this.headers=r,this.fetch=qf(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(n,r=Cu[0]){if(Cu.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Cu.join(", ")}`);try{return await ze(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:n,noResolveJson:!0}),{data:null,error:null}}catch(a){if(Oe(a))return{data:null,error:a};throw a}}async inviteUserByEmail(n,r={}){try{return await ze(this.fetch,"POST",`${this.url}/invite`,{body:{email:n,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Ms})}catch(a){if(Oe(a))return{data:{user:null},error:a};throw a}}async generateLink(n){try{const{options:r}=n,a=Vl(n,["options"]),d=Object.assign(Object.assign({},a),r);return"newEmail"in a&&(d.new_email=a?.newEmail,delete d.newEmail),await ze(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:d,headers:this.headers,xform:Ov,redirectTo:r?.redirectTo})}catch(r){if(Oe(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(n){try{return await ze(this.fetch,"POST",`${this.url}/admin/users`,{body:n,headers:this.headers,xform:Ms})}catch(r){if(Oe(r))return{data:{user:null},error:r};throw r}}async listUsers(n){var r,a,d,h,p,v,x;try{const _={nextPage:null,lastPage:0,total:0},j=await ze(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=n?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(h=(d=n?.perPage)===null||d===void 0?void 0:d.toString())!==null&&h!==void 0?h:""},xform:gf});if(j.error)throw j.error;const C=await j.json(),F=(p=j.headers.get("x-total-count"))!==null&&p!==void 0?p:0,T=(x=(v=j.headers.get("link"))===null||v===void 0?void 0:v.split(","))!==null&&x!==void 0?x:[];return T.length>0&&(T.forEach(A=>{const q=parseInt(A.split(";")[0].split("=")[1].substring(0,1)),M=JSON.parse(A.split(";")[1].split("=")[1]);_[`${M}Page`]=q}),_.total=parseInt(F)),{data:Object.assign(Object.assign({},C),_),error:null}}catch(_){if(Oe(_))return{data:{users:[]},error:_};throw _}}async getUserById(n){oo(n);try{return await ze(this.fetch,"GET",`${this.url}/admin/users/${n}`,{headers:this.headers,xform:Ms})}catch(r){if(Oe(r))return{data:{user:null},error:r};throw r}}async updateUserById(n,r){oo(n);try{return await ze(this.fetch,"PUT",`${this.url}/admin/users/${n}`,{body:r,headers:this.headers,xform:Ms})}catch(a){if(Oe(a))return{data:{user:null},error:a};throw a}}async deleteUser(n,r=!1){oo(n);try{return await ze(this.fetch,"DELETE",`${this.url}/admin/users/${n}`,{headers:this.headers,body:{should_soft_delete:r},xform:Ms})}catch(a){if(Oe(a))return{data:{user:null},error:a};throw a}}async _listFactors(n){oo(n.userId);try{const{data:r,error:a}=await ze(this.fetch,"GET",`${this.url}/admin/users/${n.userId}/factors`,{headers:this.headers,xform:d=>({data:{factors:d},error:null})});return{data:r,error:a}}catch(r){if(Oe(r))return{data:null,error:r};throw r}}async _deleteFactor(n){oo(n.userId),oo(n.id);try{return{data:await ze(this.fetch,"DELETE",`${this.url}/admin/users/${n.userId}/factors/${n.id}`,{headers:this.headers}),error:null}}catch(r){if(Oe(r))return{data:null,error:r};throw r}}async _listOAuthClients(n){var r,a,d,h,p,v,x;try{const _={nextPage:null,lastPage:0,total:0},j=await ze(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=n?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(h=(d=n?.perPage)===null||d===void 0?void 0:d.toString())!==null&&h!==void 0?h:""},xform:gf});if(j.error)throw j.error;const C=await j.json(),F=(p=j.headers.get("x-total-count"))!==null&&p!==void 0?p:0,T=(x=(v=j.headers.get("link"))===null||v===void 0?void 0:v.split(","))!==null&&x!==void 0?x:[];return T.length>0&&(T.forEach(A=>{const q=parseInt(A.split(";")[0].split("=")[1].substring(0,1)),M=JSON.parse(A.split(";")[1].split("=")[1]);_[`${M}Page`]=q}),_.total=parseInt(F)),{data:Object.assign(Object.assign({},C),_),error:null}}catch(_){if(Oe(_))return{data:{clients:[]},error:_};throw _}}async _createOAuthClient(n){try{return await ze(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:n,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Oe(r))return{data:null,error:r};throw r}}async _getOAuthClient(n){try{return await ze(this.fetch,"GET",`${this.url}/admin/oauth/clients/${n}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Oe(r))return{data:null,error:r};throw r}}async _updateOAuthClient(n,r){try{return await ze(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${n}`,{body:r,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(Oe(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(n){try{return await ze(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${n}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Oe(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(n){try{return await ze(this.fetch,"POST",`${this.url}/admin/oauth/clients/${n}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Oe(r))return{data:null,error:r};throw r}}}function vf(i={}){return{getItem:n=>i[n]||null,setItem:(n,r)=>{i[n]=r},removeItem:n=>{delete i[n]}}}const ao={debug:!!(globalThis&&zf()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Wf extends Error{constructor(n){super(n),this.isAcquireTimeout=!0}}class Mv extends Wf{}async function Lv(i,n,r){ao.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",i,n);const a=new globalThis.AbortController;return n>0&&setTimeout(()=>{a.abort(),ao.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",i)},n),await Promise.resolve().then(()=>globalThis.navigator.locks.request(i,n===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async d=>{if(d){ao.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",i,d.name);try{return await r()}finally{ao.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",i,d.name)}}else{if(n===0)throw ao.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",i),new Mv(`Acquiring an exclusive Navigator LockManager lock "${i}" immediately failed`);if(ao.debug)try{const h=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(h,null,"  "))}catch(h){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",h)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function Bv(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Kf(i){if(!/^0x[a-fA-F0-9]{40}$/.test(i))throw new Error(`@supabase/auth-js: Address "${i}" is invalid.`);return i.toLowerCase()}function $v(i){return parseInt(i,16)}function Uv(i){const n=new TextEncoder().encode(i);return"0x"+Array.from(n,a=>a.toString(16).padStart(2,"0")).join("")}function zv(i){var n;const{chainId:r,domain:a,expirationTime:d,issuedAt:h=new Date,nonce:p,notBefore:v,requestId:x,resources:_,scheme:j,uri:C,version:F}=i;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(p&&p.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${p}`);if(!C)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(F!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${F}`);if(!((n=i.statement)===null||n===void 0)&&n.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${i.statement}`)}const T=Kf(i.address),A=j?`${j}://${a}`:a,q=i.statement?`${i.statement}
`:"",M=`${A} wants you to sign in with your Ethereum account:
${T}

${q}`;let U=`URI: ${C}
Version: ${F}
Chain ID: ${r}${p?`
Nonce: ${p}`:""}
Issued At: ${h.toISOString()}`;if(d&&(U+=`
Expiration Time: ${d.toISOString()}`),v&&(U+=`
Not Before: ${v.toISOString()}`),x&&(U+=`
Request ID: ${x}`),_){let Z=`
Resources:`;for(const ne of _){if(!ne||typeof ne!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${ne}`);Z+=`
- ${ne}`}U+=Z}return`${M}
${U}`}class Mt extends Error{constructor({message:n,code:r,cause:a,name:d}){var h;super(n,{cause:a}),this.__isWebAuthnError=!0,this.name=(h=d??(a instanceof Error?a.name:void 0))!==null&&h!==void 0?h:"Unknown Error",this.code=r}}class Kl extends Mt{constructor(n,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:n}),this.name="WebAuthnUnknownError",this.originalError=r}}function qv({error:i,options:n}){var r,a,d;const{publicKey:h}=n;if(!h)throw Error("options was missing required publicKey property");if(i.name==="AbortError"){if(n.signal instanceof AbortSignal)return new Mt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:i})}else if(i.name==="ConstraintError"){if(((r=h.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Mt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:i});if(n.mediation==="conditional"&&((a=h.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Mt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:i});if(((d=h.authenticatorSelection)===null||d===void 0?void 0:d.userVerification)==="required")return new Mt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:i})}else{if(i.name==="InvalidStateError")return new Mt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:i});if(i.name==="NotAllowedError")return new Mt({message:i.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i});if(i.name==="NotSupportedError")return h.pubKeyCredParams.filter(v=>v.type==="public-key").length===0?new Mt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:i}):new Mt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:i});if(i.name==="SecurityError"){const p=window.location.hostname;if(Hf(p)){if(h.rp.id!==p)return new Mt({message:`The RP ID "${h.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:i})}else return new Mt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:i})}else if(i.name==="TypeError"){if(h.user.id.byteLength<1||h.user.id.byteLength>64)return new Mt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:i})}else if(i.name==="UnknownError")return new Mt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:i})}return new Mt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i})}function Wv({error:i,options:n}){const{publicKey:r}=n;if(!r)throw Error("options was missing required publicKey property");if(i.name==="AbortError"){if(n.signal instanceof AbortSignal)return new Mt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:i})}else{if(i.name==="NotAllowedError")return new Mt({message:i.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i});if(i.name==="SecurityError"){const a=window.location.hostname;if(Hf(a)){if(r.rpId!==a)return new Mt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:i})}else return new Mt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:i})}else if(i.name==="UnknownError")return new Mt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:i})}return new Mt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i})}class Kv{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const n=new AbortController;return this.controller=n,n.signal}cancelCeremony(){if(this.controller){const n=new Error("Manually cancelling existing WebAuthn API call");n.name="AbortError",this.controller.abort(n),this.controller=void 0}}}const Hv=new Kv;function Vv(i){if(!i)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(i);const{challenge:n,user:r,excludeCredentials:a}=i,d=Vl(i,["challenge","user","excludeCredentials"]),h=yo(n).buffer,p=Object.assign(Object.assign({},r),{id:yo(r.id).buffer}),v=Object.assign(Object.assign({},d),{challenge:h,user:p});if(a&&a.length>0){v.excludeCredentials=new Array(a.length);for(let x=0;x<a.length;x++){const _=a[x];v.excludeCredentials[x]=Object.assign(Object.assign({},_),{id:yo(_.id).buffer,type:_.type||"public-key",transports:_.transports})}}return v}function Gv(i){if(!i)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(i);const{challenge:n,allowCredentials:r}=i,a=Vl(i,["challenge","allowCredentials"]),d=yo(n).buffer,h=Object.assign(Object.assign({},a),{challenge:d});if(r&&r.length>0){h.allowCredentials=new Array(r.length);for(let p=0;p<r.length;p++){const v=r[p];h.allowCredentials[p]=Object.assign(Object.assign({},v),{id:yo(v.id).buffer,type:v.type||"public-key",transports:v.transports})}}return h}function Jv(i){var n;if("toJSON"in i&&typeof i.toJSON=="function")return i.toJSON();const r=i;return{id:i.id,rawId:i.id,response:{attestationObject:wi(new Uint8Array(i.response.attestationObject)),clientDataJSON:wi(new Uint8Array(i.response.clientDataJSON))},type:"public-key",clientExtensionResults:i.getClientExtensionResults(),authenticatorAttachment:(n=r.authenticatorAttachment)!==null&&n!==void 0?n:void 0}}function Yv(i){var n;if("toJSON"in i&&typeof i.toJSON=="function")return i.toJSON();const r=i,a=i.getClientExtensionResults(),d=i.response;return{id:i.id,rawId:i.id,response:{authenticatorData:wi(new Uint8Array(d.authenticatorData)),clientDataJSON:wi(new Uint8Array(d.clientDataJSON)),signature:wi(new Uint8Array(d.signature)),userHandle:d.userHandle?wi(new Uint8Array(d.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(n=r.authenticatorAttachment)!==null&&n!==void 0?n:void 0}}function Hf(i){return i==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(i)}function xf(){var i,n;return!!(Zt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((i=navigator?.credentials)===null||i===void 0?void 0:i.create)=="function"&&typeof((n=navigator?.credentials)===null||n===void 0?void 0:n.get)=="function")}async function Qv(i){try{const n=await navigator.credentials.create(i);return n?n instanceof PublicKeyCredential?{data:n,error:null}:{data:null,error:new Kl("Browser returned unexpected credential type",n)}:{data:null,error:new Kl("Empty credential response",n)}}catch(n){return{data:null,error:qv({error:n,options:i})}}}async function Xv(i){try{const n=await navigator.credentials.get(i);return n?n instanceof PublicKeyCredential?{data:n,error:null}:{data:null,error:new Kl("Browser returned unexpected credential type",n)}:{data:null,error:new Kl("Empty credential response",n)}}catch(n){return{data:null,error:Wv({error:n,options:i})}}}const Zv={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},ex={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Hl(...i){const n=d=>d!==null&&typeof d=="object"&&!Array.isArray(d),r=d=>d instanceof ArrayBuffer||ArrayBuffer.isView(d),a={};for(const d of i)if(d)for(const h in d){const p=d[h];if(p!==void 0)if(Array.isArray(p))a[h]=p;else if(r(p))a[h]=p;else if(n(p)){const v=a[h];n(v)?a[h]=Hl(v,p):a[h]=Hl(p)}else a[h]=p}return a}function tx(i,n){return Hl(Zv,i,n||{})}function nx(i,n){return Hl(ex,i,n||{})}class rx{constructor(n){this.client=n,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(n){return this.client.mfa.enroll(Object.assign(Object.assign({},n),{factorType:"webauthn"}))}async _challenge({factorId:n,webauthn:r,friendlyName:a,signal:d},h){var p;try{const{data:v,error:x}=await this.client.mfa.challenge({factorId:n,webauthn:r});if(!v)return{data:null,error:x};const _=d??Hv.createNewAbortSignal();if(v.webauthn.type==="create"){const{user:j}=v.webauthn.credential_options.publicKey;if(!j.name){const C=a;if(C)j.name=`${j.id}:${C}`;else{const T=(await this.client.getUser()).data.user,A=((p=T?.user_metadata)===null||p===void 0?void 0:p.name)||T?.email||T?.id||"User";j.name=`${j.id}:${A}`}}j.displayName||(j.displayName=j.name)}switch(v.webauthn.type){case"create":{const j=tx(v.webauthn.credential_options.publicKey,h?.create),{data:C,error:F}=await Qv({publicKey:j,signal:_});return C?{data:{factorId:n,challengeId:v.id,webauthn:{type:v.webauthn.type,credential_response:C}},error:null}:{data:null,error:F}}case"request":{const j=nx(v.webauthn.credential_options.publicKey,h?.request),{data:C,error:F}=await Xv(Object.assign(Object.assign({},v.webauthn.credential_options),{publicKey:j,signal:_}));return C?{data:{factorId:n,challengeId:v.id,webauthn:{type:v.webauthn.type,credential_response:C}},error:null}:{data:null,error:F}}}}catch(v){return Oe(v)?{data:null,error:v}:{data:null,error:new bi("Unexpected error in challenge",v)}}}async _verify({challengeId:n,factorId:r,webauthn:a}){return this.client.mfa.verify({factorId:r,challengeId:n,webauthn:a})}async _authenticate({factorId:n,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:d}={}},h){if(!r)return{data:null,error:new pa("rpId is required for WebAuthn authentication")};try{if(!xf())return{data:null,error:new bi("Browser does not support WebAuthn",null)};const{data:p,error:v}=await this.challenge({factorId:n,webauthn:{rpId:r,rpOrigins:a},signal:d},{request:h});if(!p)return{data:null,error:v};const{webauthn:x}=p;return this._verify({factorId:n,challengeId:p.challengeId,webauthn:{type:x.type,rpId:r,rpOrigins:a,credential_response:x.credential_response}})}catch(p){return Oe(p)?{data:null,error:p}:{data:null,error:new bi("Unexpected error in authenticate",p)}}}async _register({friendlyName:n,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:d}={}},h){if(!r)return{data:null,error:new pa("rpId is required for WebAuthn registration")};try{if(!xf())return{data:null,error:new bi("Browser does not support WebAuthn",null)};const{data:p,error:v}=await this._enroll({friendlyName:n});if(!p)return await this.client.mfa.listFactors().then(j=>{var C;return(C=j.data)===null||C===void 0?void 0:C.all.find(F=>F.factor_type==="webauthn"&&F.friendly_name===n&&F.status!=="unverified")}).then(j=>j?this.client.mfa.unenroll({factorId:j?.id}):void 0),{data:null,error:v};const{data:x,error:_}=await this._challenge({factorId:p.id,friendlyName:p.friendly_name,webauthn:{rpId:r,rpOrigins:a},signal:d},{create:h});return x?this._verify({factorId:p.id,challengeId:x.challengeId,webauthn:{rpId:r,rpOrigins:a,type:x.webauthn.type,credential_response:x.webauthn.credential_response}}):{data:null,error:_}}catch(p){return Oe(p)?{data:null,error:p}:{data:null,error:new bi("Unexpected error in register",p)}}}}Bv();const sx={url:ev,storageKey:tv,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:nv,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function bf(i,n,r){return await r()}const lo={};class ma{get jwks(){var n,r;return(r=(n=lo[this.storageKey])===null||n===void 0?void 0:n.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(n){lo[this.storageKey]=Object.assign(Object.assign({},lo[this.storageKey]),{jwks:n})}get jwks_cached_at(){var n,r;return(r=(n=lo[this.storageKey])===null||n===void 0?void 0:n.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(n){lo[this.storageKey]=Object.assign(Object.assign({},lo[this.storageKey]),{cachedAt:n})}constructor(n){var r,a,d;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const h=Object.assign(Object.assign({},sx),n);if(this.storageKey=h.storageKey,this.instanceID=(r=ma.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,ma.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!h.debug,typeof h.debug=="function"&&(this.logger=h.debug),this.instanceID>0&&Zt()){const p=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(p),this.logDebugMessages&&console.trace(p)}if(this.persistSession=h.persistSession,this.autoRefreshToken=h.autoRefreshToken,this.admin=new Iv({url:h.url,headers:h.headers,fetch:h.fetch}),this.url=h.url,this.headers=h.headers,this.fetch=qf(h.fetch),this.lock=h.lock||bf,this.detectSessionInUrl=h.detectSessionInUrl,this.flowType=h.flowType,this.hasCustomAuthorizationHeader=h.hasCustomAuthorizationHeader,this.throwOnError=h.throwOnError,this.lockAcquireTimeout=h.lockAcquireTimeout,h.lock?this.lock=h.lock:this.persistSession&&Zt()&&(!((a=globalThis?.navigator)===null||a===void 0)&&a.locks)?this.lock=Lv:this.lock=bf,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new rx(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(h.storage?this.storage=h.storage:zf()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=vf(this.memoryStorage)),h.userStorage&&(this.userStorage=h.userStorage)):(this.memoryStorage={},this.storage=vf(this.memoryStorage)),Zt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(p){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",p)}(d=this.broadcastChannel)===null||d===void 0||d.addEventListener("message",async p=>{this._debug("received broadcast notification from other tab or client",p);try{await this._notifyAllSubscribers(p.data.event,p.data.session,!1)}catch(v){this._debug("#broadcastChannel","error",v)}})}this.initialize().catch(p=>{this._debug("#initialize()","error",p)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(n){if(this.throwOnError&&n&&n.error)throw n.error;return n}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Bf}) ${new Date().toISOString()}`}_debug(...n){return this.logDebugMessages&&this.logger(this._logPrefix(),...n),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var n;try{let r={},a="none";if(Zt()&&(r=yv(window.location.href),this._isImplicitGrantCallback(r)?a="implicit":await this._isPKCECallback(r)&&(a="pkce")),Zt()&&this.detectSessionInUrl&&a!=="none"){const{data:d,error:h}=await this._getSessionFromURL(r,a);if(h){if(this._debug("#_initialize()","error detecting session from URL",h),av(h)){const x=(n=h.details)===null||n===void 0?void 0:n.code;if(x==="identity_already_exists"||x==="identity_not_found"||x==="single_identity_not_deletable")return{error:h}}return{error:h}}const{session:p,redirectType:v}=d;return this._debug("#_initialize()","detected session in URL",p,"redirect type",v),await this._saveSession(p),setTimeout(async()=>{v==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",p):await this._notifyAllSubscribers("SIGNED_IN",p)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Oe(r)?this._returnResult({error:r}):this._returnResult({error:new bi("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(n){var r,a,d;try{const h=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(r=n?.options)===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(d=n?.options)===null||d===void 0?void 0:d.captchaToken}},xform:rr}),{data:p,error:v}=h;if(v||!p)return this._returnResult({data:{user:null,session:null},error:v});const x=p.session,_=p.user;return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",x)),this._returnResult({data:{user:_,session:x},error:null})}catch(h){if(Oe(h))return this._returnResult({data:{user:null,session:null},error:h});throw h}}async signUp(n){var r,a,d;try{let h;if("email"in n){const{email:j,password:C,options:F}=n;let T=null,A=null;this.flowType==="pkce"&&([T,A]=await io(this.storage,this.storageKey)),h=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:F?.emailRedirectTo,body:{email:j,password:C,data:(r=F?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:F?.captchaToken},code_challenge:T,code_challenge_method:A},xform:rr})}else if("phone"in n){const{phone:j,password:C,options:F}=n;h=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:j,password:C,data:(a=F?.data)!==null&&a!==void 0?a:{},channel:(d=F?.channel)!==null&&d!==void 0?d:"sms",gotrue_meta_security:{captcha_token:F?.captchaToken}},xform:rr})}else throw new Il("You must provide either an email or phone number and a password");const{data:p,error:v}=h;if(v||!p)return await Xt(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:v});const x=p.session,_=p.user;return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",x)),this._returnResult({data:{user:_,session:x},error:null})}catch(h){if(await Xt(this.storage,`${this.storageKey}-code-verifier`),Oe(h))return this._returnResult({data:{user:null,session:null},error:h});throw h}}async signInWithPassword(n){try{let r;if("email"in n){const{email:h,password:p,options:v}=n;r=await ze(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:h,password:p,gotrue_meta_security:{captcha_token:v?.captchaToken}},xform:yf})}else if("phone"in n){const{phone:h,password:p,options:v}=n;r=await ze(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:h,password:p,gotrue_meta_security:{captcha_token:v?.captchaToken}},xform:yf})}else throw new Il("You must provide either an email or phone number and a password");const{data:a,error:d}=r;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!a||!a.session||!a.user){const h=new so;return this._returnResult({data:{user:null,session:null},error:h})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:d})}catch(r){if(Oe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(n){var r,a,d,h;return await this._handleProviderSignIn(n.provider,{redirectTo:(r=n.options)===null||r===void 0?void 0:r.redirectTo,scopes:(a=n.options)===null||a===void 0?void 0:a.scopes,queryParams:(d=n.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:(h=n.options)===null||h===void 0?void 0:h.skipBrowserRedirect})}async exchangeCodeForSession(n){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(n))}async signInWithWeb3(n){const{chain:r}=n;switch(r){case"ethereum":return await this.signInWithEthereum(n);case"solana":return await this.signInWithSolana(n);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(n){var r,a,d,h,p,v,x,_,j,C,F;let T,A;if("message"in n)T=n.message,A=n.signature;else{const{chain:q,wallet:M,statement:U,options:Z}=n;let ne;if(Zt())if(typeof M=="object")ne=M;else{const $e=window;if("ethereum"in $e&&typeof $e.ethereum=="object"&&"request"in $e.ethereum&&typeof $e.ethereum.request=="function")ne=$e.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof M!="object"||!Z?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");ne=M}const ie=new URL((r=Z?.url)!==null&&r!==void 0?r:window.location.href),ee=await ne.request({method:"eth_requestAccounts"}).then($e=>$e).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!ee||ee.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const me=Kf(ee[0]);let fe=(a=Z?.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!fe){const $e=await ne.request({method:"eth_chainId"});fe=$v($e)}const ye={domain:ie.host,address:me,statement:U,uri:ie.href,version:"1",chainId:fe,nonce:(d=Z?.signInWithEthereum)===null||d===void 0?void 0:d.nonce,issuedAt:(p=(h=Z?.signInWithEthereum)===null||h===void 0?void 0:h.issuedAt)!==null&&p!==void 0?p:new Date,expirationTime:(v=Z?.signInWithEthereum)===null||v===void 0?void 0:v.expirationTime,notBefore:(x=Z?.signInWithEthereum)===null||x===void 0?void 0:x.notBefore,requestId:(_=Z?.signInWithEthereum)===null||_===void 0?void 0:_.requestId,resources:(j=Z?.signInWithEthereum)===null||j===void 0?void 0:j.resources};T=zv(ye),A=await ne.request({method:"personal_sign",params:[Uv(T),me]})}try{const{data:q,error:M}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:T,signature:A},!((C=n.options)===null||C===void 0)&&C.captchaToken?{gotrue_meta_security:{captcha_token:(F=n.options)===null||F===void 0?void 0:F.captchaToken}}:null),xform:rr});if(M)throw M;if(!q||!q.session||!q.user){const U=new so;return this._returnResult({data:{user:null,session:null},error:U})}return q.session&&(await this._saveSession(q.session),await this._notifyAllSubscribers("SIGNED_IN",q.session)),this._returnResult({data:Object.assign({},q),error:M})}catch(q){if(Oe(q))return this._returnResult({data:{user:null,session:null},error:q});throw q}}async signInWithSolana(n){var r,a,d,h,p,v,x,_,j,C,F,T;let A,q;if("message"in n)A=n.message,q=n.signature;else{const{chain:M,wallet:U,statement:Z,options:ne}=n;let ie;if(Zt())if(typeof U=="object")ie=U;else{const me=window;if("solana"in me&&typeof me.solana=="object"&&("signIn"in me.solana&&typeof me.solana.signIn=="function"||"signMessage"in me.solana&&typeof me.solana.signMessage=="function"))ie=me.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof U!="object"||!ne?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");ie=U}const ee=new URL((r=ne?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in ie&&ie.signIn){const me=await ie.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},ne?.signInWithSolana),{version:"1",domain:ee.host,uri:ee.href}),Z?{statement:Z}:null));let fe;if(Array.isArray(me)&&me[0]&&typeof me[0]=="object")fe=me[0];else if(me&&typeof me=="object"&&"signedMessage"in me&&"signature"in me)fe=me;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in fe&&"signature"in fe&&(typeof fe.signedMessage=="string"||fe.signedMessage instanceof Uint8Array)&&fe.signature instanceof Uint8Array)A=typeof fe.signedMessage=="string"?fe.signedMessage:new TextDecoder().decode(fe.signedMessage),q=fe.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in ie)||typeof ie.signMessage!="function"||!("publicKey"in ie)||typeof ie!="object"||!ie.publicKey||!("toBase58"in ie.publicKey)||typeof ie.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");A=[`${ee.host} wants you to sign in with your Solana account:`,ie.publicKey.toBase58(),...Z?["",Z,""]:[""],"Version: 1",`URI: ${ee.href}`,`Issued At: ${(d=(a=ne?.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&d!==void 0?d:new Date().toISOString()}`,...!((h=ne?.signInWithSolana)===null||h===void 0)&&h.notBefore?[`Not Before: ${ne.signInWithSolana.notBefore}`]:[],...!((p=ne?.signInWithSolana)===null||p===void 0)&&p.expirationTime?[`Expiration Time: ${ne.signInWithSolana.expirationTime}`]:[],...!((v=ne?.signInWithSolana)===null||v===void 0)&&v.chainId?[`Chain ID: ${ne.signInWithSolana.chainId}`]:[],...!((x=ne?.signInWithSolana)===null||x===void 0)&&x.nonce?[`Nonce: ${ne.signInWithSolana.nonce}`]:[],...!((_=ne?.signInWithSolana)===null||_===void 0)&&_.requestId?[`Request ID: ${ne.signInWithSolana.requestId}`]:[],...!((C=(j=ne?.signInWithSolana)===null||j===void 0?void 0:j.resources)===null||C===void 0)&&C.length?["Resources",...ne.signInWithSolana.resources.map(fe=>`- ${fe}`)]:[]].join(`
`);const me=await ie.signMessage(new TextEncoder().encode(A),"utf8");if(!me||!(me instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");q=me}}try{const{data:M,error:U}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:A,signature:wi(q)},!((F=n.options)===null||F===void 0)&&F.captchaToken?{gotrue_meta_security:{captcha_token:(T=n.options)===null||T===void 0?void 0:T.captchaToken}}:null),xform:rr});if(U)throw U;if(!M||!M.session||!M.user){const Z=new so;return this._returnResult({data:{user:null,session:null},error:Z})}return M.session&&(await this._saveSession(M.session),await this._notifyAllSubscribers("SIGNED_IN",M.session)),this._returnResult({data:Object.assign({},M),error:U})}catch(M){if(Oe(M))return this._returnResult({data:{user:null,session:null},error:M});throw M}}async _exchangeCodeForSession(n){const r=await gi(this.storage,`${this.storageKey}-code-verifier`),[a,d]=(r??"").split("/");try{if(!a&&this.flowType==="pkce")throw new lv;const{data:h,error:p}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:n,code_verifier:a},xform:rr});if(await Xt(this.storage,`${this.storageKey}-code-verifier`),p)throw p;if(!h||!h.session||!h.user){const v=new so;return this._returnResult({data:{user:null,session:null,redirectType:null},error:v})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:Object.assign(Object.assign({},h),{redirectType:d??null}),error:p})}catch(h){if(await Xt(this.storage,`${this.storageKey}-code-verifier`),Oe(h))return this._returnResult({data:{user:null,session:null,redirectType:null},error:h});throw h}}async signInWithIdToken(n){try{const{options:r,provider:a,token:d,access_token:h,nonce:p}=n,v=await ze(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:d,access_token:h,nonce:p,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:rr}),{data:x,error:_}=v;if(_)return this._returnResult({data:{user:null,session:null},error:_});if(!x||!x.session||!x.user){const j=new so;return this._returnResult({data:{user:null,session:null},error:j})}return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),this._returnResult({data:x,error:_})}catch(r){if(Oe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(n){var r,a,d,h,p;try{if("email"in n){const{email:v,options:x}=n;let _=null,j=null;this.flowType==="pkce"&&([_,j]=await io(this.storage,this.storageKey));const{error:C}=await ze(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:v,data:(r=x?.data)!==null&&r!==void 0?r:{},create_user:(a=x?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:x?.captchaToken},code_challenge:_,code_challenge_method:j},redirectTo:x?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:C})}if("phone"in n){const{phone:v,options:x}=n,{data:_,error:j}=await ze(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:v,data:(d=x?.data)!==null&&d!==void 0?d:{},create_user:(h=x?.shouldCreateUser)!==null&&h!==void 0?h:!0,gotrue_meta_security:{captcha_token:x?.captchaToken},channel:(p=x?.channel)!==null&&p!==void 0?p:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:_?.message_id},error:j})}throw new Il("You must provide either an email or phone number.")}catch(v){if(await Xt(this.storage,`${this.storageKey}-code-verifier`),Oe(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async verifyOtp(n){var r,a;try{let d,h;"options"in n&&(d=(r=n.options)===null||r===void 0?void 0:r.redirectTo,h=(a=n.options)===null||a===void 0?void 0:a.captchaToken);const{data:p,error:v}=await ze(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},n),{gotrue_meta_security:{captcha_token:h}}),redirectTo:d,xform:rr});if(v)throw v;if(!p)throw new Error("An error occurred on token verification.");const x=p.session,_=p.user;return x?.access_token&&(await this._saveSession(x),await this._notifyAllSubscribers(n.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",x)),this._returnResult({data:{user:_,session:x},error:null})}catch(d){if(Oe(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signInWithSSO(n){var r,a,d,h,p;try{let v=null,x=null;this.flowType==="pkce"&&([v,x]=await io(this.storage,this.storageKey));const _=await ze(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in n?{provider_id:n.providerId}:null),"domain"in n?{domain:n.domain}:null),{redirect_to:(a=(r=n.options)===null||r===void 0?void 0:r.redirectTo)!==null&&a!==void 0?a:void 0}),!((d=n?.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:n.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:v,code_challenge_method:x}),headers:this.headers,xform:Pv});return!((h=_.data)===null||h===void 0)&&h.url&&Zt()&&!(!((p=n.options)===null||p===void 0)&&p.skipBrowserRedirect)&&window.location.assign(_.data.url),this._returnResult(_)}catch(v){if(await Xt(this.storage,`${this.storageKey}-code-verifier`),Oe(v))return this._returnResult({data:null,error:v});throw v}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async n=>{const{data:{session:r},error:a}=n;if(a)throw a;if(!r)throw new En;const{error:d}=await ze(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:d})})}catch(n){if(Oe(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async resend(n){try{const r=`${this.url}/resend`;if("email"in n){const{email:a,type:d,options:h}=n,{error:p}=await ze(this.fetch,"POST",r,{headers:this.headers,body:{email:a,type:d,gotrue_meta_security:{captcha_token:h?.captchaToken}},redirectTo:h?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:p})}else if("phone"in n){const{phone:a,type:d,options:h}=n,{data:p,error:v}=await ze(this.fetch,"POST",r,{headers:this.headers,body:{phone:a,type:d,gotrue_meta_security:{captcha_token:h?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:p?.message_id},error:v})}throw new Il("You must provide either an email or phone number and a type")}catch(r){if(Oe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(n,r){this._debug("#_acquireLock","begin",n);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),d=(async()=>(await a,await r()))();return this.pendingInLock.push((async()=>{try{await d}catch{}})()),d}return await this.lock(`lock:${this.storageKey}`,n,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=r();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const d=[...this.pendingInLock];await Promise.all(d),this.pendingInLock.splice(0,d.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(n){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await n(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let n=null;const r=await gi(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?n=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!n)return{data:{session:null},error:null};const a=n.expires_at?n.expires_at*1e3-Date.now()<_u:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",n.expires_at),!a){if(this.userStorage){const p=await gi(this.userStorage,this.storageKey+"-user");p?.user?n.user=p.user:n.user=Su()}if(this.storage.isServer&&n.user&&!n.user.__isUserNotAvailableProxy){const p={value:this.suppressGetSessionWarning};n.user=Ev(n.user,p),p.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:n},error:null}}const{data:d,error:h}=await this._callRefreshToken(n.refresh_token);return h?this._returnResult({data:{session:null},error:h}):this._returnResult({data:{session:d},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(n){if(n)return await this._getUser(n);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(n){try{return n?await ze(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:n,xform:Ms}):await this._useSession(async r=>{var a,d,h;const{data:p,error:v}=r;if(v)throw v;return!(!((a=p.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new En}:await ze(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(h=(d=p.session)===null||d===void 0?void 0:d.access_token)!==null&&h!==void 0?h:void 0,xform:Ms})})}catch(r){if(Oe(r))return ju(r)&&(await this._removeSession(),await Xt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(n,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(n,r))}async _updateUser(n,r={}){try{return await this._useSession(async a=>{const{data:d,error:h}=a;if(h)throw h;if(!d.session)throw new En;const p=d.session;let v=null,x=null;this.flowType==="pkce"&&n.email!=null&&([v,x]=await io(this.storage,this.storageKey));const{data:_,error:j}=await ze(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},n),{code_challenge:v,code_challenge_method:x}),jwt:p.access_token,xform:Ms});if(j)throw j;return p.user=_.user,await this._saveSession(p),await this._notifyAllSubscribers("USER_UPDATED",p),this._returnResult({data:{user:p.user},error:null})})}catch(a){if(await Xt(this.storage,`${this.storageKey}-code-verifier`),Oe(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(n){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(n))}async _setSession(n){try{if(!n.access_token||!n.refresh_token)throw new En;const r=Date.now()/1e3;let a=r,d=!0,h=null;const{payload:p}=Ll(n.access_token);if(p.exp&&(a=p.exp,d=a<=r),d){const{data:v,error:x}=await this._callRefreshToken(n.refresh_token);if(x)return this._returnResult({data:{user:null,session:null},error:x});if(!v)return{data:{user:null,session:null},error:null};h=v}else{const{data:v,error:x}=await this._getUser(n.access_token);if(x)return this._returnResult({data:{user:null,session:null},error:x});h={access_token:n.access_token,refresh_token:n.refresh_token,user:v.user,token_type:"bearer",expires_in:a-r,expires_at:a},await this._saveSession(h),await this._notifyAllSubscribers("SIGNED_IN",h)}return this._returnResult({data:{user:h.user,session:h},error:null})}catch(r){if(Oe(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(n){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(n))}async _refreshSession(n){try{return await this._useSession(async r=>{var a;if(!n){const{data:p,error:v}=r;if(v)throw v;n=(a=p.session)!==null&&a!==void 0?a:void 0}if(!n?.refresh_token)throw new En;const{data:d,error:h}=await this._callRefreshToken(n.refresh_token);return h?this._returnResult({data:{user:null,session:null},error:h}):d?this._returnResult({data:{user:d.user,session:d},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Oe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(n,r){try{if(!Zt())throw new Ml("No browser detected.");if(n.error||n.error_description||n.error_code)throw new Ml(n.error_description||"Error in URL with unspecified error_description",{error:n.error||"unspecified_error",code:n.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new cf("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ml("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!n.code)throw new cf("No code detected.");const{data:Z,error:ne}=await this._exchangeCodeForSession(n.code);if(ne)throw ne;const ie=new URL(window.location.href);return ie.searchParams.delete("code"),window.history.replaceState(window.history.state,"",ie.toString()),{data:{session:Z.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:d,access_token:h,refresh_token:p,expires_in:v,expires_at:x,token_type:_}=n;if(!h||!v||!p||!_)throw new Ml("No session defined in URL");const j=Math.round(Date.now()/1e3),C=parseInt(v);let F=j+C;x&&(F=parseInt(x));const T=F-j;T*1e3<=ho&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${T}s, should have been closer to ${C}s`);const A=F-C;j-A>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",A,F,j):j-A<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",A,F,j);const{data:q,error:M}=await this._getUser(h);if(M)throw M;const U={provider_token:a,provider_refresh_token:d,access_token:h,expires_in:C,expires_at:F,refresh_token:p,token_type:_,user:q.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:U,redirectType:n.type},error:null})}catch(a){if(Oe(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(n){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),n):!!(n.access_token||n.error_description)}async _isPKCECallback(n){const r=await gi(this.storage,`${this.storageKey}-code-verifier`);return!!(n.code&&r)}async signOut(n={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(n))}async _signOut({scope:n}={scope:"global"}){return await this._useSession(async r=>{var a;const{data:d,error:h}=r;if(h&&!ju(h))return this._returnResult({error:h});const p=(a=d.session)===null||a===void 0?void 0:a.access_token;if(p){const{error:v}=await this.admin.signOut(p,n);if(v&&!(ov(v)&&(v.status===404||v.status===401||v.status===403)||ju(v)))return this._returnResult({error:v})}return n!=="others"&&(await this._removeSession(),await Xt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(n){const r=mv(),a={id:r,callback:n,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,a),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:a}}}async _emitInitialSession(n){return await this._useSession(async r=>{var a,d;try{const{data:{session:h},error:p}=r;if(p)throw p;await((a=this.stateChangeEmitters.get(n))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",h)),this._debug("INITIAL_SESSION","callback id",n,"session",h)}catch(h){await((d=this.stateChangeEmitters.get(n))===null||d===void 0?void 0:d.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",n,"error",h),console.error(h)}})}async resetPasswordForEmail(n,r={}){let a=null,d=null;this.flowType==="pkce"&&([a,d]=await io(this.storage,this.storageKey,!0));try{return await ze(this.fetch,"POST",`${this.url}/recover`,{body:{email:n,code_challenge:a,code_challenge_method:d,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(h){if(await Xt(this.storage,`${this.storageKey}-code-verifier`),Oe(h))return this._returnResult({data:null,error:h});throw h}}async getUserIdentities(){var n;try{const{data:r,error:a}=await this.getUser();if(a)throw a;return this._returnResult({data:{identities:(n=r.user.identities)!==null&&n!==void 0?n:[]},error:null})}catch(r){if(Oe(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(n){return"token"in n?this.linkIdentityIdToken(n):this.linkIdentityOAuth(n)}async linkIdentityOAuth(n){var r;try{const{data:a,error:d}=await this._useSession(async h=>{var p,v,x,_,j;const{data:C,error:F}=h;if(F)throw F;const T=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,n.provider,{redirectTo:(p=n.options)===null||p===void 0?void 0:p.redirectTo,scopes:(v=n.options)===null||v===void 0?void 0:v.scopes,queryParams:(x=n.options)===null||x===void 0?void 0:x.queryParams,skipBrowserRedirect:!0});return await ze(this.fetch,"GET",T,{headers:this.headers,jwt:(j=(_=C.session)===null||_===void 0?void 0:_.access_token)!==null&&j!==void 0?j:void 0})});if(d)throw d;return Zt()&&!(!((r=n.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(a?.url),this._returnResult({data:{provider:n.provider,url:a?.url},error:null})}catch(a){if(Oe(a))return this._returnResult({data:{provider:n.provider,url:null},error:a});throw a}}async linkIdentityIdToken(n){return await this._useSession(async r=>{var a;try{const{error:d,data:{session:h}}=r;if(d)throw d;const{options:p,provider:v,token:x,access_token:_,nonce:j}=n,C=await ze(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=h?.access_token)!==null&&a!==void 0?a:void 0,body:{provider:v,id_token:x,access_token:_,nonce:j,link_identity:!0,gotrue_meta_security:{captcha_token:p?.captchaToken}},xform:rr}),{data:F,error:T}=C;return T?this._returnResult({data:{user:null,session:null},error:T}):!F||!F.session||!F.user?this._returnResult({data:{user:null,session:null},error:new so}):(F.session&&(await this._saveSession(F.session),await this._notifyAllSubscribers("USER_UPDATED",F.session)),this._returnResult({data:F,error:T}))}catch(d){if(await Xt(this.storage,`${this.storageKey}-code-verifier`),Oe(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}})}async unlinkIdentity(n){try{return await this._useSession(async r=>{var a,d;const{data:h,error:p}=r;if(p)throw p;return await ze(this.fetch,"DELETE",`${this.url}/user/identities/${n.identity_id}`,{headers:this.headers,jwt:(d=(a=h.session)===null||a===void 0?void 0:a.access_token)!==null&&d!==void 0?d:void 0})})}catch(r){if(Oe(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(n){const r=`#_refreshAccessToken(${n.substring(0,5)}...)`;this._debug(r,"begin");try{const a=Date.now();return await xv(async d=>(d>0&&await vv(200*Math.pow(2,d-1)),this._debug(r,"refreshing attempt",d),await ze(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:n},headers:this.headers,xform:rr})),(d,h)=>{const p=200*Math.pow(2,d);return h&&Nu(h)&&Date.now()+p-a<ho})}catch(a){if(this._debug(r,"error",a),Oe(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(r,"end")}}_isValidSession(n){return typeof n=="object"&&n!==null&&"access_token"in n&&"refresh_token"in n&&"expires_at"in n}async _handleProviderSignIn(n,r){const a=await this._getUrlForProvider(`${this.url}/authorize`,n,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",n,"options",r,"url",a),Zt()&&!r.skipBrowserRedirect&&window.location.assign(a),{data:{provider:n,url:a},error:null}}async _recoverAndRefresh(){var n,r;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const d=await gi(this.storage,this.storageKey);if(d&&this.userStorage){let p=await gi(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!p&&(p={user:d.user},await fo(this.userStorage,this.storageKey+"-user",p)),d.user=(n=p?.user)!==null&&n!==void 0?n:Su()}else if(d&&!d.user&&!d.user){const p=await gi(this.storage,this.storageKey+"-user");p&&p?.user?(d.user=p.user,await Xt(this.storage,this.storageKey+"-user"),await fo(this.storage,this.storageKey,d)):d.user=Su()}if(this._debug(a,"session from storage",d),!this._isValidSession(d)){this._debug(a,"session is not valid"),d!==null&&await this._removeSession();return}const h=((r=d.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<_u;if(this._debug(a,`session has${h?"":" not"} expired with margin of ${_u}s`),h){if(this.autoRefreshToken&&d.refresh_token){const{error:p}=await this._callRefreshToken(d.refresh_token);p&&(console.error(p),Nu(p)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",p),await this._removeSession()))}}else if(d.user&&d.user.__isUserNotAvailableProxy===!0)try{const{data:p,error:v}=await this._getUser(d.access_token);!v&&p?.user?(d.user=p.user,await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(p){console.error("Error getting user data:",p),this._debug(a,"error getting user data, skipping SIGNED_IN notification",p)}else await this._notifyAllSubscribers("SIGNED_IN",d)}catch(d){this._debug(a,"error",d),console.error(d);return}finally{this._debug(a,"end")}}async _callRefreshToken(n){var r,a;if(!n)throw new En;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const d=`#_callRefreshToken(${n.substring(0,5)}...)`;this._debug(d,"begin");try{this.refreshingDeferred=new Yl;const{data:h,error:p}=await this._refreshAccessToken(n);if(p)throw p;if(!h.session)throw new En;await this._saveSession(h.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",h.session);const v={data:h.session,error:null};return this.refreshingDeferred.resolve(v),v}catch(h){if(this._debug(d,"error",h),Oe(h)){const p={data:null,error:h};return Nu(h)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(p),p}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(h),h}finally{this.refreshingDeferred=null,this._debug(d,"end")}}async _notifyAllSubscribers(n,r,a=!0){const d=`#_notifyAllSubscribers(${n})`;this._debug(d,"begin",r,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:n,session:r});const h=[],p=Array.from(this.stateChangeEmitters.values()).map(async v=>{try{await v.callback(n,r)}catch(x){h.push(x)}});if(await Promise.all(p),h.length>0){for(let v=0;v<h.length;v+=1)console.error(h[v]);throw h[0]}}finally{this._debug(d,"end")}}async _saveSession(n){this._debug("#_saveSession()",n),this.suppressGetSessionWarning=!0,await Xt(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},n),a=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&r.user&&await fo(this.userStorage,this.storageKey+"-user",{user:r.user});const d=Object.assign({},r);delete d.user;const h=pf(d);await fo(this.storage,this.storageKey,h)}else{const d=pf(r);await fo(this.storage,this.storageKey,d)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Xt(this.storage,this.storageKey),await Xt(this.storage,this.storageKey+"-code-verifier"),await Xt(this.storage,this.storageKey+"-user"),this.userStorage&&await Xt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const n=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{n&&Zt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",n)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const n=setInterval(()=>this._autoRefreshTokenTick(),ho);this.autoRefreshTicker=n,n&&typeof n=="object"&&typeof n.unref=="function"?n.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(n);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const n=this.autoRefreshTicker;this.autoRefreshTicker=null,n&&clearInterval(n);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const n=Date.now();try{return await this._useSession(async r=>{const{data:{session:a}}=r;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const d=Math.floor((a.expires_at*1e3-n)/ho);this._debug("#_autoRefreshTokenTick()",`access token expires in ${d} ticks, a tick lasts ${ho}ms, refresh threshold is ${Lu} ticks`),d<=Lu&&await this._callRefreshToken(a.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(n){if(n.isAcquireTimeout||n instanceof Wf)this._debug("auto refresh token tick lock not available");else throw n}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Zt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(n){this._debug("#visibilityChangedCallback","error",n)}},window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(n){console.error("_handleVisibilityChange",n)}}async _onVisibilityChanged(n){const r=`#_onVisibilityChanged(${n})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),n||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(n,r,a){const d=[`provider=${encodeURIComponent(r)}`];if(a?.redirectTo&&d.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a?.scopes&&d.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[h,p]=await io(this.storage,this.storageKey),v=new URLSearchParams({code_challenge:`${encodeURIComponent(h)}`,code_challenge_method:`${encodeURIComponent(p)}`});d.push(v.toString())}if(a?.queryParams){const h=new URLSearchParams(a.queryParams);d.push(h.toString())}return a?.skipBrowserRedirect&&d.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${n}?${d.join("&")}`}async _unenroll(n){try{return await this._useSession(async r=>{var a;const{data:d,error:h}=r;return h?this._returnResult({data:null,error:h}):await ze(this.fetch,"DELETE",`${this.url}/factors/${n.factorId}`,{headers:this.headers,jwt:(a=d?.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(Oe(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(n){try{return await this._useSession(async r=>{var a,d;const{data:h,error:p}=r;if(p)return this._returnResult({data:null,error:p});const v=Object.assign({friendly_name:n.friendlyName,factor_type:n.factorType},n.factorType==="phone"?{phone:n.phone}:n.factorType==="totp"?{issuer:n.issuer}:{}),{data:x,error:_}=await ze(this.fetch,"POST",`${this.url}/factors`,{body:v,headers:this.headers,jwt:(a=h?.session)===null||a===void 0?void 0:a.access_token});return _?this._returnResult({data:null,error:_}):(n.factorType==="totp"&&x.type==="totp"&&(!((d=x?.totp)===null||d===void 0)&&d.qr_code)&&(x.totp.qr_code=`data:image/svg+xml;utf-8,${x.totp.qr_code}`),this._returnResult({data:x,error:null}))})}catch(r){if(Oe(r))return this._returnResult({data:null,error:r});throw r}}async _verify(n){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var a;const{data:d,error:h}=r;if(h)return this._returnResult({data:null,error:h});const p=Object.assign({challenge_id:n.challengeId},"webauthn"in n?{webauthn:Object.assign(Object.assign({},n.webauthn),{credential_response:n.webauthn.type==="create"?Jv(n.webauthn.credential_response):Yv(n.webauthn.credential_response)})}:{code:n.code}),{data:v,error:x}=await ze(this.fetch,"POST",`${this.url}/factors/${n.factorId}/verify`,{body:p,headers:this.headers,jwt:(a=d?.session)===null||a===void 0?void 0:a.access_token});return x?this._returnResult({data:null,error:x}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+v.expires_in},v)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",v),this._returnResult({data:v,error:x}))})}catch(r){if(Oe(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(n){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var a;const{data:d,error:h}=r;if(h)return this._returnResult({data:null,error:h});const p=await ze(this.fetch,"POST",`${this.url}/factors/${n.factorId}/challenge`,{body:n,headers:this.headers,jwt:(a=d?.session)===null||a===void 0?void 0:a.access_token});if(p.error)return p;const{data:v}=p;if(v.type!=="webauthn")return{data:v,error:null};switch(v.webauthn.type){case"create":return{data:Object.assign(Object.assign({},v),{webauthn:Object.assign(Object.assign({},v.webauthn),{credential_options:Object.assign(Object.assign({},v.webauthn.credential_options),{publicKey:Vv(v.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},v),{webauthn:Object.assign(Object.assign({},v.webauthn),{credential_options:Object.assign(Object.assign({},v.webauthn.credential_options),{publicKey:Gv(v.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Oe(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(n){const{data:r,error:a}=await this._challenge({factorId:n.factorId});return a?this._returnResult({data:null,error:a}):await this._verify({factorId:n.factorId,challengeId:r.id,code:n.code})}async _listFactors(){var n;const{data:{user:r},error:a}=await this.getUser();if(a)return{data:null,error:a};const d={all:[],phone:[],totp:[],webauthn:[]};for(const h of(n=r?.factors)!==null&&n!==void 0?n:[])d.all.push(h),h.status==="verified"&&d[h.factor_type].push(h);return{data:d,error:null}}async _getAuthenticatorAssuranceLevel(n){var r,a,d,h;if(n)try{const{payload:T}=Ll(n);let A=null;T.aal&&(A=T.aal);let q=A;const{data:{user:M},error:U}=await this.getUser(n);if(U)return this._returnResult({data:null,error:U});((a=(r=M?.factors)===null||r===void 0?void 0:r.filter(ie=>ie.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(q="aal2");const ne=T.amr||[];return{data:{currentLevel:A,nextLevel:q,currentAuthenticationMethods:ne},error:null}}catch(T){if(Oe(T))return this._returnResult({data:null,error:T});throw T}const{data:{session:p},error:v}=await this.getSession();if(v)return this._returnResult({data:null,error:v});if(!p)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:x}=Ll(p.access_token);let _=null;x.aal&&(_=x.aal);let j=_;((h=(d=p.user.factors)===null||d===void 0?void 0:d.filter(T=>T.status==="verified"))!==null&&h!==void 0?h:[]).length>0&&(j="aal2");const F=x.amr||[];return{data:{currentLevel:_,nextLevel:j,currentAuthenticationMethods:F},error:null}}async _getAuthorizationDetails(n){try{return await this._useSession(async r=>{const{data:{session:a},error:d}=r;return d?this._returnResult({data:null,error:d}):a?await ze(this.fetch,"GET",`${this.url}/oauth/authorizations/${n}`,{headers:this.headers,jwt:a.access_token,xform:h=>({data:h,error:null})}):this._returnResult({data:null,error:new En})})}catch(r){if(Oe(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(n,r){try{return await this._useSession(async a=>{const{data:{session:d},error:h}=a;if(h)return this._returnResult({data:null,error:h});if(!d)return this._returnResult({data:null,error:new En});const p=await ze(this.fetch,"POST",`${this.url}/oauth/authorizations/${n}/consent`,{headers:this.headers,jwt:d.access_token,body:{action:"approve"},xform:v=>({data:v,error:null})});return p.data&&p.data.redirect_url&&Zt()&&!r?.skipBrowserRedirect&&window.location.assign(p.data.redirect_url),p})}catch(a){if(Oe(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(n,r){try{return await this._useSession(async a=>{const{data:{session:d},error:h}=a;if(h)return this._returnResult({data:null,error:h});if(!d)return this._returnResult({data:null,error:new En});const p=await ze(this.fetch,"POST",`${this.url}/oauth/authorizations/${n}/consent`,{headers:this.headers,jwt:d.access_token,body:{action:"deny"},xform:v=>({data:v,error:null})});return p.data&&p.data.redirect_url&&Zt()&&!r?.skipBrowserRedirect&&window.location.assign(p.data.redirect_url),p})}catch(a){if(Oe(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async n=>{const{data:{session:r},error:a}=n;return a?this._returnResult({data:null,error:a}):r?await ze(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:d=>({data:d,error:null})}):this._returnResult({data:null,error:new En})})}catch(n){if(Oe(n))return this._returnResult({data:null,error:n});throw n}}async _revokeOAuthGrant(n){try{return await this._useSession(async r=>{const{data:{session:a},error:d}=r;return d?this._returnResult({data:null,error:d}):a?(await ze(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:a.access_token,query:{client_id:n.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new En})})}catch(r){if(Oe(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(n,r={keys:[]}){let a=r.keys.find(v=>v.kid===n);if(a)return a;const d=Date.now();if(a=this.jwks.keys.find(v=>v.kid===n),a&&this.jwks_cached_at+sv>d)return a;const{data:h,error:p}=await ze(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(p)throw p;return!h.keys||h.keys.length===0||(this.jwks=h,this.jwks_cached_at=d,a=h.keys.find(v=>v.kid===n),!a)?null:a}async getClaims(n,r={}){try{let a=n;if(!a){const{data:T,error:A}=await this.getSession();if(A||!T.session)return this._returnResult({data:null,error:A});a=T.session.access_token}const{header:d,payload:h,signature:p,raw:{header:v,payload:x}}=Ll(a);r?.allowExpired||Sv(h.exp);const _=!d.alg||d.alg.startsWith("HS")||!d.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(d.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!_){const{error:T}=await this.getUser(a);if(T)throw T;return{data:{claims:h,header:d,signature:p},error:null}}const j=Cv(d.alg),C=await crypto.subtle.importKey("jwk",_,j,!0,["verify"]);if(!await crypto.subtle.verify(j,C,p,fv(`${v}.${x}`)))throw new Uu("Invalid JWT signature");return{data:{claims:h,header:d,signature:p},error:null}}catch(a){if(Oe(a))return this._returnResult({data:null,error:a});throw a}}}ma.nextInstanceID={};const ix=ma,ox="2.95.3";let aa="";typeof Deno<"u"?aa="deno":typeof document<"u"?aa="web":typeof navigator<"u"&&navigator.product==="ReactNative"?aa="react-native":aa="node";const ax={"X-Client-Info":`supabase-js-${aa}/${ox}`},lx={headers:ax},cx={schema:"public"},ux={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},dx={};function ya(i){"@babel/helpers - typeof";return ya=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},ya(i)}function hx(i,n){if(ya(i)!="object"||!i)return i;var r=i[Symbol.toPrimitive];if(r!==void 0){var a=r.call(i,n);if(ya(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(i)}function fx(i){var n=hx(i,"string");return ya(n)=="symbol"?n:n+""}function px(i,n,r){return(n=fx(n))in i?Object.defineProperty(i,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[n]=r,i}function wf(i,n){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);n&&(a=a.filter(function(d){return Object.getOwnPropertyDescriptor(i,d).enumerable})),r.push.apply(r,a)}return r}function Pt(i){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?wf(Object(r),!0).forEach(function(a){px(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):wf(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}const mx=i=>i?(...n)=>i(...n):(...n)=>fetch(...n),yx=()=>Headers,gx=(i,n,r)=>{const a=mx(r),d=yx();return async(h,p)=>{var v;const x=(v=await n())!==null&&v!==void 0?v:i;let _=new d(p?.headers);return _.has("apikey")||_.set("apikey",i),_.has("Authorization")||_.set("Authorization",`Bearer ${x}`),a(h,Pt(Pt({},p),{},{headers:_}))}};function vx(i){return i.endsWith("/")?i:i+"/"}function xx(i,n){var r,a;const{db:d,auth:h,realtime:p,global:v}=i,{db:x,auth:_,realtime:j,global:C}=n,F={db:Pt(Pt({},x),d),auth:Pt(Pt({},_),h),realtime:Pt(Pt({},j),p),storage:{},global:Pt(Pt(Pt({},C),v),{},{headers:Pt(Pt({},(r=C?.headers)!==null&&r!==void 0?r:{}),(a=v?.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return i.accessToken?F.accessToken=i.accessToken:delete F.accessToken,F}function bx(i){const n=i?.trim();if(!n)throw new Error("supabaseUrl is required.");if(!n.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(vx(n))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var wx=class extends ix{constructor(i){super(i)}},kx=class{constructor(i,n,r){var a,d;this.supabaseUrl=i,this.supabaseKey=n;const h=bx(i);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",h),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",h),this.storageUrl=new URL("storage/v1",h),this.functionsUrl=new URL("functions/v1",h);const p=`sb-${h.hostname.split(".")[0]}-auth-token`,v={db:cx,realtime:dx,auth:Pt(Pt({},ux),{},{storageKey:p}),global:lx},x=xx(r??{},v);if(this.storageKey=(a=x.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(d=x.global.headers)!==null&&d!==void 0?d:{},x.accessToken)this.accessToken=x.accessToken,this.auth=new Proxy({},{get:(j,C)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(C)} is not possible`)}});else{var _;this.auth=this._initSupabaseAuthClient((_=x.auth)!==null&&_!==void 0?_:{},this.headers,x.global.fetch)}this.fetch=gx(n,this._getAccessToken.bind(this),x.global.fetch),this.realtime=this._initRealtimeClient(Pt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},x.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(j=>this.realtime.setAuth(j)).catch(j=>console.warn("Failed to set initial Realtime auth token:",j)),this.rest=new og(new URL("rest/v1",h).href,{headers:this.headers,schema:x.db.schema,fetch:this.fetch,timeout:x.db.timeout,urlLengthLimit:x.db.urlLengthLimit}),this.storage=new Zg(this.storageUrl.href,this.headers,this.fetch,r?.storage),x.accessToken||this._listenForAuthEvents()}get functions(){return new Xy(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(i){return this.rest.from(i)}schema(i){return this.rest.schema(i)}rpc(i,n={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(i,n,r)}channel(i,n={config:{}}){return this.realtime.channel(i,n)}getChannels(){return this.realtime.getChannels()}removeChannel(i){return this.realtime.removeChannel(i)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var i=this,n,r;if(i.accessToken)return await i.accessToken();const{data:a}=await i.auth.getSession();return(n=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&n!==void 0?n:i.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:i,persistSession:n,detectSessionInUrl:r,storage:a,userStorage:d,storageKey:h,flowType:p,lock:v,debug:x,throwOnError:_},j,C){const F={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new wx({url:this.authUrl.href,headers:Pt(Pt({},F),j),storageKey:h,autoRefreshToken:i,persistSession:n,detectSessionInUrl:r,storage:a,userStorage:d,flowType:p,lock:v,debug:x,throwOnError:_,fetch:C,hasCustomAuthorizationHeader:Object.keys(this.headers).some(T=>T.toLowerCase()==="authorization")})}_initRealtimeClient(i){return new _g(this.realtimeUrl.href,Pt(Pt({},i),{},{params:Pt(Pt({},{apikey:this.supabaseKey}),i?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((i,n)=>{this._handleTokenChanged(i,"CLIENT",n?.access_token)})}_handleTokenChanged(i,n,r){(i==="TOKEN_REFRESHED"||i==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):i==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const _x=(i,n,r)=>new kx(i,n,r);function jx(){if(typeof window<"u")return!1;const i=globalThis.process;if(!i)return!1;const n=i.version;if(n==null)return!1;const r=n.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}jx()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Nx="kbkakrbxbvylwwiwkbfm",Sx="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imtia2FrcmJ4YnZ5bHd3aXdrYmZtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA2MDA0NDMsImV4cCI6MjA4NjE3NjQ0M30.GdUWTi2vfnMXXLlkGLrare6gnid5f29DTZ4anM6_2Ms",Cx=`https://${Nx}.supabase.co`,Fx=Sx,Ul=_x(Cx,Fx,{auth:{persistSession:!1,autoRefreshToken:!1}});async function Vf(){try{const{data:i,error:n}=await Ul.from("taxonomy_packs").select(`
        id,
        kingdom,
        phylum,
        class,
        label,
        description,
        sort_order,
        min_taxa,
        taxonomy_pack_counts!inner (
          taxa_count
        )
      `).order("phylum",{ascending:!0}).order("sort_order",{ascending:!0});return n?(console.error("Failed to fetch taxonomy packs:",n),kf()):(i||[]).map(a=>{const d=a.taxonomy_pack_counts?.taxa_count??null;return{id:a.id,kingdom:a.kingdom,phylum:a.phylum,class:a.class,label:a.label,description:a.description,sort_order:a.sort_order,min_taxa:a.min_taxa,taxa_count:d}})}catch(i){return console.error("Exception fetching taxonomy packs:",i),kf()}}function kf(){return[{id:"auto_animalia_annelida_other",kingdom:"Animalia",phylum:"Annelida",class:null,label:"Other Annelida",description:"Animalia  Annelida  Other classes",sort_order:1,min_taxa:3500,taxa_count:3500},{id:"auto_animalia_arthropoda_insecta",kingdom:"Animalia",phylum:"Arthropoda",class:"Insecta",label:"Insecta",description:"Animalia  Arthropoda  Insecta",sort_order:1,min_taxa:535249,taxa_count:535249},{id:"auto_animalia_arthropoda_arachnida",kingdom:"Animalia",phylum:"Arthropoda",class:"Arachnida",label:"Arachnida",description:"Animalia  Arthropoda  Arachnida",sort_order:2,min_taxa:45123,taxa_count:45123},{id:"auto_animalia_arthropoda_malacostraca",kingdom:"Animalia",phylum:"Arthropoda",class:"Malacostraca",label:"Malacostraca",description:"Animalia  Arthropoda  Malacostraca",sort_order:3,min_taxa:22e3,taxa_count:22e3},{id:"auto_animalia_arthropoda_ostracoda",kingdom:"Animalia",phylum:"Arthropoda",class:"Ostracoda",label:"Ostracoda",description:"Animalia  Arthropoda  Ostracoda",sort_order:4,min_taxa:8e3,taxa_count:8e3},{id:"auto_animalia_arthropoda_other",kingdom:"Animalia",phylum:"Arthropoda",class:null,label:"Other Arthropoda",description:"Animalia  Arthropoda  Other classes",sort_order:5,min_taxa:15e3,taxa_count:15e3},{id:"auto_animalia_bryozoa_other",kingdom:"Animalia",phylum:"Bryozoa",class:null,label:"Other Bryozoa",description:"Animalia  Bryozoa  Other classes",sort_order:1,min_taxa:2100,taxa_count:2100},{id:"auto_animalia_chordata_teleostei",kingdom:"Animalia",phylum:"Chordata",class:"Teleostei",label:"Teleostei",description:"Animalia  Chordata  Teleostei",sort_order:1,min_taxa:28e3,taxa_count:28e3},{id:"auto_animalia_chordata_aves",kingdom:"Animalia",phylum:"Chordata",class:"Aves",label:"Aves",description:"Animalia  Chordata  Aves",sort_order:2,min_taxa:1e4,taxa_count:1e4},{id:"auto_animalia_chordata_other",kingdom:"Animalia",phylum:"Chordata",class:null,label:"Other Chordata",description:"Animalia  Chordata  Other classes",sort_order:3,min_taxa:12e3,taxa_count:12e3},{id:"auto_animalia_cnidaria_other",kingdom:"Animalia",phylum:"Cnidaria",class:null,label:"Other Cnidaria",description:"Animalia  Cnidaria  Other classes",sort_order:1,min_taxa:9e3,taxa_count:9e3},{id:"auto_animalia_echinodermata_other",kingdom:"Animalia",phylum:"Echinodermata",class:null,label:"Other Echinodermata",description:"Animalia  Echinodermata  Other classes",sort_order:1,min_taxa:6500,taxa_count:6500},{id:"auto_animalia_mollusca_gastropoda",kingdom:"Animalia",phylum:"Mollusca",class:"Gastropoda",label:"Gastropoda",description:"Animalia  Mollusca  Gastropoda",sort_order:1,min_taxa:62e3,taxa_count:62e3},{id:"auto_animalia_mollusca_bivalvia",kingdom:"Animalia",phylum:"Mollusca",class:"Bivalvia",label:"Bivalvia",description:"Animalia  Mollusca  Bivalvia",sort_order:2,min_taxa:9200,taxa_count:9200},{id:"auto_animalia_mollusca_other",kingdom:"Animalia",phylum:"Mollusca",class:null,label:"Other Mollusca",description:"Animalia  Mollusca  Other classes",sort_order:3,min_taxa:8e3,taxa_count:8e3},{id:"auto_animalia_nematoda_other",kingdom:"Animalia",phylum:"Nematoda",class:null,label:"Other Nematoda",description:"Animalia  Nematoda  Other classes",sort_order:1,min_taxa:15e3,taxa_count:15e3},{id:"auto_animalia_platyhelminthes_other",kingdom:"Animalia",phylum:"Platyhelminthes",class:null,label:"Other Platyhelminthes",description:"Animalia  Platyhelminthes  Other classes",sort_order:1,min_taxa:8e3,taxa_count:8e3},{id:"auto_animalia_porifera_other",kingdom:"Animalia",phylum:"Porifera",class:null,label:"Other Porifera",description:"Animalia  Porifera  Other classes",sort_order:1,min_taxa:5302,taxa_count:5302},{id:"auto_fungi_ascomycota_dothideomycetes",kingdom:"Fungi",phylum:"Ascomycota",class:"Dothideomycetes",label:"Dothideomycetes",description:"Fungi  Ascomycota  Dothideomycetes",sort_order:1,min_taxa:19e3,taxa_count:19e3},{id:"auto_fungi_ascomycota_sordariomycetes",kingdom:"Fungi",phylum:"Ascomycota",class:"Sordariomycetes",label:"Sordariomycetes",description:"Fungi  Ascomycota  Sordariomycetes",sort_order:2,min_taxa:10500,taxa_count:10500},{id:"auto_fungi_ascomycota_other",kingdom:"Fungi",phylum:"Ascomycota",class:null,label:"Other Ascomycota",description:"Fungi  Ascomycota  Other classes",sort_order:3,min_taxa:25e3,taxa_count:25e3},{id:"auto_fungi_basidiomycota_agaricomycetes",kingdom:"Fungi",phylum:"Basidiomycota",class:"Agaricomycetes",label:"Agaricomycetes",description:"Fungi  Basidiomycota  Agaricomycetes",sort_order:1,min_taxa:21e3,taxa_count:21e3},{id:"auto_fungi_basidiomycota_other",kingdom:"Fungi",phylum:"Basidiomycota",class:null,label:"Other Basidiomycota",description:"Fungi  Basidiomycota  Other classes",sort_order:2,min_taxa:8e3,taxa_count:8e3},{id:"auto_plantae_bryophyta_other",kingdom:"Plantae",phylum:"Bryophyta",class:null,label:"Other Bryophyta",description:"Plantae  Bryophyta  Other classes",sort_order:1,min_taxa:13e3,taxa_count:13e3},{id:"auto_plantae_tracheophyta_magnoliopsida",kingdom:"Plantae",phylum:"Tracheophyta",class:"Magnoliopsida",label:"Magnoliopsida",description:"Plantae  Tracheophyta  Magnoliopsida",sort_order:1,min_taxa:244e3,taxa_count:244e3},{id:"auto_plantae_tracheophyta_liliopsida",kingdom:"Plantae",phylum:"Tracheophyta",class:"Liliopsida",label:"Liliopsida",description:"Plantae  Tracheophyta  Liliopsida",sort_order:2,min_taxa:59e3,taxa_count:59e3},{id:"auto_plantae_tracheophyta_other",kingdom:"Plantae",phylum:"Tracheophyta",class:null,label:"Other Tracheophyta",description:"Plantae  Tracheophyta  Other classes",sort_order:3,min_taxa:15e3,taxa_count:15e3}]}function Ex(i){const n=new Map;for(const r of i){const a=n.get(r.phylum)||[];a.push(r),n.set(r.phylum,a)}for(const[r,a]of n.entries())a.sort((d,h)=>d.sort_order-h.sort_order),n.set(r,a);return n}class Ax{syncingPacks=new Set;abortControllers=new Map;async listPacks(){const{data:n,error:r}=await Ul.rpc("list_taxonomy_groups_and_packs");if(r)throw new Error(`Failed to list packs: ${r.message}`);return n||[]}async isPackSyncing(n){const r=this.syncingPacks.has(n),a=await we.getMeta(`pack_${n}_sync_lock`);return r||a===!0}async acquireSyncLock(n){return await this.isPackSyncing(n)?!1:(this.syncingPacks.add(n),await we.setMeta(`pack_${n}_sync_lock`,!0),!0)}async releaseSyncLock(n){this.syncingPacks.delete(n),await we.setMeta(`pack_${n}_sync_lock`,!1)}async syncTaxonData(n,r,a){const h=a?Math.ceil(a/2e3):1e3,p=h+25;console.log(`[Sync ${n}] Expected chunks: ${h}, Max chunks: ${p}, Chunk size: 2000`);const v=`pack_${n}_taxon_last_seq`,x=await we.meta.get(v);let _=Number(x?.value??0);console.log(`[Sync ${n}] Starting from sequence checkpoint: ${_}`),await we.taxon.where("pack_id").equals(n).count()===0&&_>0&&(console.warn(`[Sync ${n}]  INCONSISTENT STATE DETECTED: stored=0 but last_seq=${_}`),console.warn(`[Sync ${n}] Auto-repairing: resetting checkpoint to 0`),await we.setMeta(v,0),await we.setMeta(`pack_${n}_taxon_done`,!1),_=0,r({taxonCount:0,synonymCount:0,isComplete:!1,progressPercent:0,wasRepaired:!0}),console.log(`[Sync ${n}] Checkpoint repaired, starting from 0`));let C=0,F="";for(;;){if(C++,console.log(`[Sync ${n}] Loop ${C}/${p}, lastSeq: ${_}`),C>p)throw new Error(`Too many chunks; aborting to prevent infinite loop
Chunks completed: ${C}
Current checkpoint: ${_}
`);if(this.abortControllers.get(n)?.signal.aborted)throw new Error("Sync aborted");const A={pack_id:n,last_seq:_,lim:2e3};console.log(`[Sync ${n}] Calling RPC export_taxon_pack_seq_chunk with`,A);const{data:q,error:M}=await Ul.rpc("export_taxon_pack_seq_chunk",A);let U=[];if(M){console.log(` RPC failed for ${n}:`,M);const Te=await this.generateMockTaxonData(n,_);if(!Te||Te.length===0){console.log(`[Sync ${n}] Mock data exhausted, taxon sync complete`);break}U=Te}else U=q||[];if(!U||U.length===0){console.log(`[Sync ${n}] Received 0 rows, taxon sync complete`),C===1&&(console.warn(`[Sync ${n}]  First RPC call returned 0 rows!`),console.warn(`  Pack ID: ${n}`),console.warn("  RPC args:",A),console.warn("  This suggests the pack_id doesn't match any data in the database,"),console.warn("  or the RPC function has a bug."));break}console.log(`[Sync ${n}] Processing ${U.length} records`);const Z=U.map(Te=>({...Te,pack_id:n})),ne=Z[0]?.seq||0,ie=Z[Z.length-1]?.seq||0,ee=Z.length,me=new Date().toISOString();await we.setMeta(`pack_${n}_last_seq_sent`,_),await we.setMeta(`pack_${n}_first_seq_received`,ne),await we.setMeta(`pack_${n}_last_seq_received`,ie),await we.setMeta(`pack_${n}_rows_count`,ee),await we.setMeta(`pack_${n}_last_updated_at`,me);const fe=U.map(Te=>Te.seq).join(",");if(fe===F){const Te=await we.taxon.where("pack_id").equals(n).count();throw new Error(`Sync stalled: server returned the same page repeatedly
Pack: ${n}
Stored taxa: ${Te} / Taxa in pack: ${a||"unknown"}
Current checkpoint: ${_}
Page signature: ${fe.substring(0,50)}...`)}F=fe;const ye=U[U.length-1]?.seq;if(console.log(`[Sync ${n}] Checkpoint extraction: lastSeq=${_}, newLastSeq=${ye}, rows.length=${U.length}`),!ye)throw new Error(`Missing checkpoint from server response
Pack: ${n}
Rows received: ${U.length}
Last row: ${JSON.stringify(U[U.length-1])}`);if(ye===_){const Te=await we.taxon.where("pack_id").equals(n).count();throw console.error(`[Sync ${n}] Checkpoint not advancing!`),console.error(`  Current lastSeq: ${_}`),console.error(`  New lastSeq: ${ye}`),console.error(`  Rows received: ${U.length}`),console.error(`  First row id: ${U[0]?.id}`),console.error(`  Last row id: ${U[U.length-1]?.id}`),new Error(`Sync stalled: checkpoint not advancing
Pack: ${n}
Stored taxa: ${Te} / Taxa in pack: ${a||"unknown"}
Current checkpoint: ${_}
New checkpoint: ${ye}
Rows in this page: ${U.length}
First row id: ${U[0]?.id}
Last row id: ${U[U.length-1]?.id}`)}console.log(`[Sync ${n}] Checkpoint advance: ${_}  ${ye} (${U.length} rows)`),await we.transaction("rw",[we.taxon,we.meta],async()=>{await we.taxon.bulkPut(Z),await we.setMeta(v,ye),console.log(`[Sync ${n}]  Stored ${U.length} rows, checkpoint persisted: ${ye}`)});const $e=await we.taxon.where("pack_id").equals(n).count();if(console.log(`[Sync ${n}] Live count update: ${$e} taxa stored`),Z.length>0&&$e===0)throw new Error(`Pack key mismatch detected!\\nInserted ${Z.length} rows but Dexie count is 0.\\nThis means pack_id field is not being set correctly.\\nPack ID: ${n}\\nFirst row pack_id: ${Z[0]?.pack_id||"MISSING"}`);r({taxonCount:$e,synonymCount:0,isComplete:!1,progressPercent:a?Math.round($e/a*100):0,lastCheckpoint:String(ye),rowsReceived:U.length,rowsMatched:U.length}),_=ye,console.log(`[Sync ${n}] Updated checkpoint for next iteration: ${_}`),await new Promise(Te=>setTimeout(Te,100))}const T=await we.taxon.where("pack_id").equals(n).count();console.log(`[Sync ${n}] Taxa sync complete - actual stored: ${T}`),await we.meta.put({key:`pack_${n}_taxon_done`,value:!0})}async generateMockTaxonData(n,r){const a=await we.taxon.where("pack_id").equals(n).count(),d=n.split("_");if(d.length<2)return[];const h=100;if(a>=h)return console.log(`[Mock] Already have ${a} rows, mock sync complete`),[];const p=d[0],v=d[1],x=U=>U.charAt(0).toUpperCase()+U.slice(1),_=x(p),j=v==="other"?"Demospongiae":x(v),C=["communis","vulgaris","elegans","robusta","gracilis","marinus","littoralis","profunda","cavernosa","tubulosa","major","minor","tenuis","crassus","brevis","longus","latus","angustus","rectus","flexuosus"],F=Math.min(50,h-a),T=[],A=["Spongia","Haliclona","Cliona","Suberites","Tethya","Axinella","Dysidea"],q=["(Linnaeus, 1758)","(Pallas, 1766)","Schmidt, 1862","Gray, 1867","de Laubenfels, 1936"],M=U=>{const Z="0123456789ABCDEFGHJKLMNPQRSTUVWXYZ",ne=4+U%2;let ie="";for(let ee=0;ee<ne;ee++)ie+=Z.charAt(Math.floor(Math.random()*Z.length));return ie};for(let U=0;U<F;U++){const Z=A[(a+U)%A.length],ne=C[(a+U)%C.length],ie=q[(a+U)%q.length];T.push({seq:r+U+1,id:M(a+U),parent_id:M(1e3+a+U),rank:"species",scientific_name:`${Z} ${ne}`,authorship:ie,status:"accepted",kingdom:"Animalia",phylum:_,class:j,order:v==="other"?"Dictyoceratida":`Order${U%3}`,family:`${Z}idae`,genus:Z})}return console.log(`[Mock] Generated ${F} records (${a+F}/${h} total) for ${n}`),T}async syncSynonymChunks(n,r){const a=`pack_${n}_syn_last_seq`,d=await we.meta.get(a);let h=Number(d?.value??0);console.log(`[Sync ${n}] Synonyms starting from sequence checkpoint: ${h}`),await we.synonym.where("pack_id").equals(n).count()===0&&h>0&&(console.warn(`[Sync ${n}]  INCONSISTENT STATE DETECTED (synonyms): stored=0 but last_seq=${h}`),console.warn(`[Sync ${n}] Auto-repairing: resetting synonym checkpoint to 0`),await we.setMeta(a,0),await we.setMeta(`pack_${n}_syn_done`,!1),h=0,r({taxonCount:0,synonymCount:0,isComplete:!1,progressPercent:0,wasRepaired:!0}),console.log(`[Sync ${n}] Synonym checkpoint repaired, starting from 0`));const v=2e3,x=200;let _=0;for(;;){if(_++,_>x)throw new Error("Too many synonym chunks; aborting to prevent infinite loop");if(this.abortControllers.get(n)?.signal.aborted)throw new Error("Sync aborted");const j={pack_id:n,last_seq:h,lim:v};console.log(`[Sync ${n}] Calling RPC export_synonym_pack_seq_chunk with`,j);const{data:C,error:F}=await Ul.rpc("export_synonym_pack_seq_chunk",j);let T=[];if(!F&&C&&Array.isArray(C)&&C.length>0)T=C,console.log(` RPC export_synonym_pack_seq_chunk returned ${T.length} rows for ${n}`);else{console.log(` RPC failed or returned no data for ${n}, using mock data`);const ee=await this.generateMockSynonymData(n);if(_===1&&ee.length>0)T=ee;else break}if(T.length===0){console.log(`[Sync ${n}] Received 0 synonym rows, synonym sync complete`);break}const A=T[T.length-1]?.seq||0;if(!A)throw new Error("Sync error: Server returned synonym rows with empty pk");if(A===h)throw new Error("Sync stalled (checkpoint not advancing)");const q=T.map(ee=>({pk:ee.pk,accepted_id:ee.accepted_id||ee.acceptedId||"",synonym_name:ee.synonym_name||ee.synonymName||"",authorship:ee.authorship||ee.author||null,status:ee.status||"synonym",rank:ee.rank||"species",pack_id:n}));await we.transaction("rw",[we.synonym,we.meta],async()=>{await we.synonym.bulkPut(q),await we.setMeta(`pack_${n}_syn_last_seq`,A)}),h=A;const M=await we.taxon.where("pack_id").equals(n).count(),U=await we.synonym.where("pack_id").equals(n).count();console.log(`[Sync ${n}] Actual stored: ${M} taxa, ${U} synonyms`);const ne=70+Math.min(30,_*3),ie=h.toString();r({taxonCount:M,synonymCount:U,isComplete:!1,stage:"synonyms",progressPercent:Math.round(ne),lastCheckpoint:ie}),await new Promise(ee=>setTimeout(ee,100))}console.log(`[Sync ${n}] Synonym sync complete`),await we.setMeta(`pack_${n}_syn_synced_at`,new Date().toISOString())}async generateMockSynonymData(n){const r=[],a=["Spongia","Haliclona","Cliona"];for(let d=1;d<=10;d++){const h=a[d%a.length];r.push({pk:d,accepted_id:`mock_${n}_${d*2}`,synonym_name:`${h} obsoleta${d}`,authorship:"(Smith, 1900)",status:"synonym",rank:"species"})}return r}async downloadPack(n,r,a){if(!await this.acquireSyncLock(n))throw new Error("This pack is currently syncing. Please wait for it to complete.");this.syncingPacks.add(n);const h=new AbortController;this.abortControllers.set(n,h);try{await this.syncTaxonData(n,r,a);const p=await we.taxon.where("pack_id").equals(n).count();let v=0;if(p>0&&(await this.syncSynonymChunks(n,r),v=await we.synonym.where("pack_id").equals(n).count()),p>0)await we.addInstalledPack(n),await we.setMeta(`${n}:synced_at`,new Date().toISOString()),console.log(`[Sync ${n}]  Complete - ${p} taxa, ${v} synonyms stored`),r({taxonCount:p,synonymCount:v,isComplete:!0,stage:"finalizing",progressPercent:100,lastCheckpoint:""});else throw await we.removePack(n),new Error("Download completed but no taxa were stored. The pack may be empty or the filter criteria may be incorrect.")}catch(p){throw this.syncingPacks.delete(n),this.abortControllers.delete(n),p}finally{await this.releaseSyncLock(n),this.syncingPacks.delete(n),this.abortControllers.delete(n)}}async downloadTaxaOnly(n,r,a){if(await we.getMeta(`pack_${n}_taxon_sync_lock`)===!0)throw new Error("Taxa is currently syncing. Please wait for it to complete.");await we.setMeta(`pack_${n}_taxon_sync_lock`,!0);const h=new AbortController;this.abortControllers.set(`${n}_taxa`,h);try{await this.syncTaxonData(n,r,a);const p=await we.taxon.where("pack_id").equals(n).count();if(p>0)await we.addInstalledPack(n),await we.setMeta(`pack_${n}_taxon_synced_at`,new Date().toISOString()),console.log(`[Sync ${n}]  Taxa complete - ${p} taxa stored`),r({taxonCount:p,synonymCount:0,isComplete:!0,stage:"taxa",progressPercent:100,lastCheckpoint:""});else throw new Error("Download completed but no taxa were stored. The pack may be empty or the filter criteria may be incorrect.")}catch(p){throw this.abortControllers.delete(`${n}_taxa`),p}finally{await we.setMeta(`pack_${n}_taxon_sync_lock`,!1),this.abortControllers.delete(`${n}_taxa`)}}async downloadSynonymsOnly(n,r){if(await we.getMeta(`pack_${n}_syn_sync_lock`)===!0)throw new Error("Synonyms is currently syncing. Please wait for it to complete.");await we.setMeta(`pack_${n}_syn_sync_lock`,!0);const d=new AbortController;this.abortControllers.set(`${n}_syn`,d);try{await this.syncSynonymChunks(n,r);const h=await we.synonym.where("pack_id").equals(n).count();await we.setMeta(`pack_${n}_syn_synced_at`,new Date().toISOString()),await we.setMeta(`pack_${n}_syn_done`,!0),console.log(`[Sync ${n}]  Synonyms complete - ${h} synonyms stored`),r({taxonCount:0,synonymCount:h,isComplete:!0,stage:"synonyms",progressPercent:100,lastCheckpoint:""})}catch(h){throw this.abortControllers.delete(`${n}_syn`),h}finally{await we.setMeta(`pack_${n}_syn_sync_lock`,!1),this.abortControllers.delete(`${n}_syn`)}}async isTaxaSyncing(n){return await we.getMeta(`pack_${n}_taxon_sync_lock`)===!0}async isSynonymsSyncing(n){return await we.getMeta(`pack_${n}_syn_sync_lock`)===!0}async removePack(n){await we.removePack(n)}abort(n){this.abortControllers.get(n)?.abort()}isInProgress(n){return this.syncingPacks.has(n)}}const oa=new Ax,_f={Arthropoda:"https://images.unsplash.com/photo-1658004354495-2877ace1c158?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&q=80&w=1080",Mollusca:"https://images.unsplash.com/photo-1761472317146-126f02f8b5ee?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&q=80&w=1080",Chordata:"https://images.unsplash.com/photo-1603217758698-3b285489b12a?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&q=80&w=1080",Porifera:"https://images.unsplash.com/photo-1640107517554-be8d5e9d63c2?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&q=80&w=1080",Cnidaria:"https://images.unsplash.com/photo-1674785511474-231880067d4f?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&q=80&w=1080",Echinodermata:"https://images.unsplash.com/photo-1686672983786-ecba3822b7ce?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&q=80&w=1080",Bryozoa:"https://images.unsplash.com/photo-1567001847230-ed5da95bd055?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxrZWxwJTIwZm9yZXN0JTIwdW5kZXJ3YXRlcnxlbnwxfHx8fDE3NzA3MDYyNDN8MA&ixlib=rb-4.1.0&q=80&w=1080",Annelida:"https://images.unsplash.com/photo-1579717511944-a9a4b1724da9?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxzb2lsJTIwc2VkaW1lbnQlMjBiZW50aG9zJTIwbWFjcm98ZW58MXx8fHwxNzcwNzA2MjQ4fDA&ixlib=rb-4.1.0&q=80&w=1080",Nematoda:"https://images.unsplash.com/photo-1649583747374-78f3c6803ded?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxyb3VuZHdvcm0lMjBtaWNyb3Njb3BlJTIwbWljcm9ncmFwaHxlbnwxfHx8fDE3NzA3MDYyNDN8MA&ixlib=rb-4.1.0&q=80&w=1080",Platyhelminthes:"https://images.unsplash.com/photo-1584269134560-44d8145b7e9d?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxmbGF0d29ybSUyMHVuZGVyd2F0ZXIlMjBtYWNyb3xlbnwxfHx8fDE3NzA3MDYyNDN8MA&ixlib=rb-4.1.0&q=80&w=1080",Tracheophyta:"https://images.unsplash.com/photo-1685250385544-1a931f0a2a31?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&q=80&w=1080",Bryophyta:"https://images.unsplash.com/photo-1737688952619-36749a93bd1a?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&q=80&w=1080",Ascomycota:"https://images.unsplash.com/photo-1761024590874-7d212079a623?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxsaWNoZW4lMjBjcnVzdCUyMHRleHR1cmUlMjBtYWNyb3xlbnwxfHx8fDE3NzA3MDYyNDR8MA&ixlib=rb-4.1.0&q=80&w=1080",Basidiomycota:"https://images.unsplash.com/photo-1702833215572-ccf1b0e33395?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxicmFja2V0JTIwZnVuZ2klMjBtdXNocm9vbSUyMGNsdXN0ZXJ8ZW58MXx8fHwxNzcwNzA2MjQ0fDA&ixlib=rb-4.1.0&q=80&w=1080",default:"https://images.unsplash.com/photo-1589527387410-0df9abad018e?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxtaWNyb3Njb3BlJTIwY2VsbCUyMHRleHR1cmUlMjBzY2llbnRpZmljfGVufDF8fHx8MTc3MDcwNjI0OHww&ixlib=rb-4.1.0&q=80&w=1080"};function Gf(i){return _f[i]||_f.default}function Tx({packId:i,onBack:n}){const[r,a]=V.useState(null),[d,h]=V.useState(!1),[p,v]=V.useState(0),[x,_]=V.useState(0),[j,C]=V.useState(!1),[F,T]=V.useState(!1),[A,q]=V.useState({taxonCount:0,synonymCount:0,isComplete:!1}),[M,U]=V.useState({taxonCount:0,synonymCount:0,isComplete:!1}),[Z,ne]=V.useState(!1),[ie,ee]=V.useState(!1),[me,fe]=V.useState(null),[ye,$e]=V.useState(!1),[Te,st]=V.useState(!1),[De,lt]=V.useState([]),[jt,Tt]=V.useState(!1),[ft,Me]=V.useState(""),[de,Ce]=V.useState([]),[se,W]=V.useState(null),[re,Ve]=V.useState(void 0),[Ue,We]=V.useState(!1),[Ge,et]=V.useState(!1),[nt,pt]=V.useState(""),[je,or]=V.useState(null),[it,wn]=V.useState(null),[es,kn]=V.useState(null),[Bs,ts]=V.useState(null),[ns,rs]=V.useState(null),$n=r&&r.taxa_count&&p>=r.taxa_count;d&&!j&&!F&&r&&r.taxa_count&&p<r.taxa_count;const Nt=j||F,ar=Nt?{label:"Syncing",color:"#60A5FA",bg:"rgba(96, 165, 250, 0.15)"}:p===0?{label:"Not downloaded",color:"#8E91A3",bg:"rgba(142, 145, 163, 0.15)"}:$n?{label:"Up to date",color:"#34D399",bg:"rgba(52, 211, 153, 0.15)"}:{label:"Downloaded",color:"#FBB024",bg:"rgba(251, 176, 36, 0.15)"};V.useEffect(()=>{Us(),en(),tn()},[i]),V.useEffect(()=>{wt()},[i,d]),V.useEffect(()=>{d&&!Nt&&_n()},[d,Nt,i]),V.useEffect(()=>{ft.length>=2&&d?lr():Ce([])},[ft,d]);const Us=async()=>{const Ye=(await Vf()).find(Vt=>Vt.id===i);a(Ye||null)},en=async()=>{const ge=await we.getInstalledPacks();h(ge.includes(i));const Ye=await oa.isTaxaSyncing(i),Vt=await oa.isSynonymsSyncing(i);C(Ye),T(Vt);const Fr=await we.getMeta(`pack_${i}_taxon_done`),ur=await we.getMeta(`pack_${i}_syn_done`);ne(Fr===!0),ee(ur===!0)},wt=async()=>{if(d){const ge=await we.taxon.where("pack_id").equals(i).count(),Ye=await we.synonym.where("pack_id").equals(i).count();v(ge),_(Ye)}else v(0),_(0)},_n=async()=>{Tt(!0);try{const ge=await we.taxon.where("pack_id").equals(i).sortBy("scientific_name");lt(ge.slice(0,30))}catch(ge){console.error("Index list error:",ge),lt([])}finally{Tt(!1)}},lr=async()=>{try{const Ye=(await we.taxon.where("pack_id").equals(i).and(Vt=>Vt.scientific_name.toLowerCase().includes(ft.toLowerCase())).limit(20).toArray()).map(Vt=>({taxon:Vt,matchType:Vt.status==="accepted"?"accepted":"synonym"}));Ce(Ye)}catch(ge){console.error("Search error:",ge),Ce([])}},cr=async()=>{if(!Nt){C(!0),fe(null),q({taxonCount:0,synonymCount:0,isComplete:!1});try{await oa.downloadPack(i,ge=>{q(ge)},r?.taxa_count),await en(),await wt(),await tn()}catch(ge){const Ye=ge instanceof Error?ge.message:"Download failed";fe(Ye),console.error("Pack download error:",ge),await tn()}finally{C(!1)}}},Un=async()=>{if(!j){C(!0),fe(null),q({taxonCount:0,synonymCount:0,isComplete:!1});try{p===0&&await we.resetPackTaxa(i),await oa.downloadTaxaOnly(i,ge=>{q(ge),ge.wasRepaired&&St("Checkpoint repaired")},r?.taxa_count),await en(),await wt(),await tn()}catch(ge){const Ye=ge instanceof Error?ge.message:"Taxa download failed";fe(Ye),console.error("Taxa download error:",ge),await tn()}finally{C(!1)}}},Tn=async()=>{if(!F){T(!0),fe(null),U({taxonCount:0,synonymCount:0,isComplete:!1});try{x===0&&await we.resetPackSynonyms(i),await oa.downloadSynonymsOnly(i,ge=>{U(ge)}),await en(),await wt(),await tn()}catch(ge){const Ye=ge instanceof Error?ge.message:"Synonyms download failed";fe(Ye),console.error("Synonyms download error:",ge),await tn()}finally{T(!1)}}},zn=async()=>{try{await we.resetPackTaxa(i),await en(),await wt(),fe(null),St("Taxa reset")}catch(ge){console.error("Failed to reset taxa:",ge),St("Failed to reset taxa")}},Cr=async()=>{try{await we.resetPackSynonyms(i),await en(),await wt(),fe(null),St("Synonyms reset")}catch(ge){console.error("Failed to reset synonyms:",ge),St("Failed to reset synonyms")}},ss=async()=>{if(r)try{await we.removePack(i),await en(),await wt(),$e(!1),St(`${r.label} removed`)}catch(ge){console.error("Remove error:",ge),St("Failed to remove pack")}},jn=ge=>{W(ge.taxon),Ve(ge.synonymName),We(!0)},Ee=()=>{if(!se)return;const ge={id:se.id,scientificName:se.scientific_name,rank:se.rank,kingdom:se.kingdom,authorship:se.authorship,selectedAt:new Date().toISOString()};localStorage.setItem("selectedTaxonForAssessment",JSON.stringify(ge)),We(!1),setTimeout(()=>{const Ye=new CustomEvent("openNewAssessment");window.dispatchEvent(Ye)},100)},qn=async()=>{if(se)try{await navigator.clipboard.writeText(se.scientific_name),St("Name copied")}catch(ge){try{const Ye=document.createElement("textarea");Ye.value=se.scientific_name,Ye.style.position="fixed",Ye.style.opacity="0",document.body.appendChild(Ye),Ye.select(),document.execCommand("copy"),document.body.removeChild(Ye),St("Name copied")}catch(Ye){St("Copy failed - please copy manually"),console.error("Copy failed:",ge,Ye)}}},St=ge=>{pt(ge),et(!0),setTimeout(()=>et(!1),2e3)},tn=async()=>{const ge=await we.getMeta(`pack_${i}_last_seq_sent`),Ye=await we.getMeta(`pack_${i}_first_seq_received`),Vt=await we.getMeta(`pack_${i}_last_seq_received`),Fr=await we.getMeta(`pack_${i}_rows_count`),ur=await we.getMeta(`pack_${i}_last_updated_at`);or(ge),wn(Ye),kn(Vt),ts(Fr),rs(ur)},be=async()=>{await we.meta.where("key").equals(`pack_${i}_last_seq_sent`).delete(),await we.meta.where("key").equals(`pack_${i}_first_seq_received`).delete(),await we.meta.where("key").equals(`pack_${i}_last_seq_received`).delete(),await we.meta.where("key").equals(`pack_${i}_rows_count`).delete(),await we.meta.where("key").equals(`pack_${i}_last_updated_at`).delete(),or(null),wn(null),kn(null),ts(null),rs(null),St("Debug data cleared")};return r?s.jsxs("div",{className:"space-y-4",style:{paddingBottom:"140px"},children:[s.jsx("div",{className:"px-4 pt-4",children:s.jsx("button",{onClick:n,className:"w-10 h-10 rounded-full flex items-center justify-center transition-all",style:{background:"#1A1C22"},children:s.jsx(nm,{className:"w-5 h-5",style:{color:"#FFFFFF"}})})}),s.jsx("div",{className:"px-4",children:s.jsxs("div",{className:"rounded-[22px] overflow-hidden relative",style:{background:"#14151A",border:"1px solid #242632",minHeight:"180px"},children:[s.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:`url(${Gf(r.phylum)})`,filter:"brightness(1.15) contrast(1.05) saturate(1.08)"}}),s.jsxs("div",{className:"absolute inset-0",children:[s.jsx("div",{className:"absolute inset-0",style:{background:"rgba(0, 0, 0, 0.25)"}}),s.jsx("div",{className:"absolute inset-0",style:{background:"linear-gradient(to bottom, rgba(0,0,0,0.10) 0%, rgba(0,0,0,0.55) 70%, rgba(0,0,0,0.70) 100%)"}})]}),s.jsxs("div",{className:"relative p-4",children:[s.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h2",{className:"text-2xl font-bold",style:{color:"#FFFFFF"},children:r.label}),s.jsx("p",{className:"text-sm mt-1",style:{color:"#C9CBD6"},children:"Catalogue of Life taxonomy pack"})]}),s.jsxs("div",{className:"relative flex-shrink-0",style:{width:"100px",height:"44px"},children:[s.jsx("div",{className:"absolute inset-0 rounded-full",style:{background:"linear-gradient(to bottom, rgba(0,0,0,0.0), rgba(0,0,0,0.35))"}}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("span",{className:"px-3 py-2 rounded-full text-xs font-semibold whitespace-nowrap",style:{background:"rgba(0, 0, 0, 0.55)",backdropFilter:"blur(16px)",WebkitBackdropFilter:"blur(16px)",border:"1px solid rgba(255, 255, 255, 0.18)",color:"#FFFFFF",fontSize:"13px",boxShadow:"0 6px 18px rgba(0, 0, 0, 0.35)"},children:ar.label})})]})]}),s.jsx("p",{className:"text-sm mb-2",style:{color:"#C9CBD6"},children:r.description}),s.jsx("p",{className:"text-xs",style:{color:"#8E91A3"},children:(()=>{const ge=r.taxa_count??null;return typeof ge=="number"&&ge>0?s.jsxs(s.Fragment,{children:["Taxa in pack: ",s.jsx("strong",{style:{color:"#FFFFFF"},children:ge.toLocaleString()})]}):s.jsxs(s.Fragment,{children:["Taxa in pack: ",s.jsx("strong",{style:{color:"#FFFFFF"},children:"Count unavailable"})]})})()})]})]})}),s.jsxs("div",{className:"px-4 space-y-3",children:[s.jsxs("div",{className:"rounded-[18px] overflow-hidden relative p-4 space-y-3",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-1",style:{color:"#FFFFFF"},children:"Taxa"}),s.jsx("p",{className:"text-sm",style:{color:"#C9CBD6"},children:j?"Syncing":p===0?"Not downloaded":r&&r.taxa_count&&p>=r.taxa_count?"Up to date":"Download incomplete"}),s.jsxs("p",{className:"text-xs mt-1",style:{color:"#8E91A3"},children:["Stored taxa: ",s.jsx("strong",{style:{color:"#FFFFFF"},children:j?(A.taxonCount||0).toLocaleString():p.toLocaleString()}),r&&r.taxa_count&&s.jsxs(s.Fragment,{children:[" of ",s.jsx("strong",{style:{color:"#FFFFFF"},children:r.taxa_count.toLocaleString()})]})]})]}),(j||p>0&&r&&r.taxa_count&&p<r.taxa_count)&&s.jsx("div",{className:"h-2 rounded-full overflow-hidden",style:{background:"#1A1C22"},children:s.jsx("div",{className:"h-full transition-all duration-500",style:{width:j?`${A.progressPercent||0}%`:r&&r.taxa_count?`${Math.round(p/r.taxa_count*100)}%`:"0%",background:"linear-gradient(90deg, #D2110C, #FF4136)",boxShadow:"0 0 8px rgba(210, 17, 12, 0.5)"}})}),(je!==null||ns!==null)&&s.jsxs("div",{className:"p-3 rounded-lg space-y-2",style:{background:"rgba(251, 176, 36, 0.08)",border:"1px solid rgba(251, 176, 36, 0.25)"},children:[s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsx("p",{className:"text-xs font-semibold",style:{color:"#FBB024"},children:"Debug"}),s.jsx("button",{onClick:be,className:"text-xs underline",style:{color:"#FBB024"},children:"Clear debug"})]}),s.jsxs("div",{className:"text-xs font-mono space-y-1",style:{color:"#FBB024"},children:[s.jsxs("p",{children:["Debug  sending last_seq: ",je||0]}),it!==null&&es!==null&&Bs!==null&&s.jsxs("p",{children:["Debug  received page: first_seq=",it," last_seq=",es," rows=",Bs]})]}),ns&&s.jsxs("p",{className:"text-xs",style:{color:"#8E91A3"},children:["Last updated: ",new Date(ns).toLocaleString()]})]}),j&&s.jsxs("div",{className:"text-xs font-mono p-2 rounded",style:{background:"rgba(251, 176, 36, 0.1)",border:"1px solid rgba(251, 176, 36, 0.3)",color:"#FBB024"},children:["Debug  sending last_seq: ",A.lastCheckpoint||0]}),j&&s.jsxs("div",{className:"text-xs space-y-1",style:{color:"#8E91A3"},children:[s.jsxs("p",{children:["Progress: ",s.jsxs("strong",{style:{color:"#FFFFFF"},children:[A.progressPercent||0,"%"]})]}),A.lastCheckpoint&&s.jsxs("p",{children:["Last checkpoint: ",s.jsx("strong",{style:{color:"#C9CBD6"},children:A.lastCheckpoint})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:Un,disabled:j,className:"flex-1 btn-primary py-2.5 flex items-center justify-center gap-2 text-sm",style:{opacity:j?.5:1,cursor:j?"not-allowed":"pointer"},children:j?s.jsxs(s.Fragment,{children:[s.jsx(Hh,{className:"w-4 h-4 animate-spin"}),"Running"]}):s.jsxs(s.Fragment,{children:[s.jsx(zl,{className:"w-4 h-4"}),p===0?"Download taxa":"Update taxa"]})}),p>0&&s.jsx("button",{onClick:zn,disabled:j,className:"px-4 py-2.5 rounded-xl text-sm font-semibold transition-all",style:{background:"transparent",border:"1px solid #D2110C",color:"#D2110C",opacity:j?.5:1,cursor:j?"not-allowed":"pointer"},children:"Reset taxa"})]})]}),s.jsxs("div",{className:"rounded-[18px] overflow-hidden relative p-4 space-y-3",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-1",style:{color:"#FFFFFF"},children:"Synonyms"}),s.jsx("p",{className:"text-sm",style:{color:"#C9CBD6"},children:F?"Syncing":x===0?"Not downloaded":ie?"Up to date":"Download incomplete"}),s.jsxs("p",{className:"text-xs mt-1",style:{color:"#8E91A3"},children:["Stored synonyms: ",s.jsx("strong",{style:{color:"#FFFFFF"},children:x.toLocaleString()})]}),x>0&&p===0&&s.jsx("p",{className:"text-xs mt-1",style:{color:"#FBB024"},children:"Download taxa to resolve accepted names for synonym matches."})]}),F&&s.jsx("div",{className:"h-2 rounded-full overflow-hidden",style:{background:"#1A1C22"},children:s.jsx("div",{className:"h-full transition-all duration-500",style:{width:`${M.progressPercent||0}%`,background:"linear-gradient(90deg, #D2110C, #FF4136)",boxShadow:"0 0 8px rgba(210, 17, 12, 0.5)"}})}),F&&s.jsxs("div",{className:"text-xs space-y-1",style:{color:"#8E91A3"},children:[s.jsxs("p",{children:["Progress: ",s.jsxs("strong",{style:{color:"#FFFFFF"},children:[M.progressPercent||0,"%"]})]}),M.lastCheckpoint&&s.jsxs("p",{children:["Last checkpoint: ",s.jsx("strong",{style:{color:"#C9CBD6"},children:M.lastCheckpoint})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:Tn,disabled:F,className:"flex-1 btn-primary py-2.5 flex items-center justify-center gap-2 text-sm",style:{opacity:F?.5:1,cursor:F?"not-allowed":"pointer"},children:F?s.jsxs(s.Fragment,{children:[s.jsx(Hh,{className:"w-4 h-4 animate-spin"}),"Running"]}):s.jsxs(s.Fragment,{children:[s.jsx(zl,{className:"w-4 h-4"}),x===0?"Download synonyms":"Update synonyms"]})}),x>0&&s.jsx("button",{onClick:Cr,disabled:F,className:"px-4 py-2.5 rounded-xl text-sm font-semibold transition-all",style:{background:"transparent",border:"1px solid #D2110C",color:"#D2110C",opacity:F?.5:1,cursor:F?"not-allowed":"pointer"},children:"Reset synonyms"})]})]}),d&&s.jsx("button",{onClick:()=>$e(!0),className:"w-full py-3 px-4 rounded-xl text-sm font-semibold transition-all",style:{background:"transparent",border:"1px solid #D2110C",color:"#D2110C"},children:"Remove pack"})]}),me&&!Nt&&s.jsxs("div",{className:"rounded-[18px] card-shadow p-4 space-y-3",style:{background:"rgba(210, 17, 12, 0.1)",border:"1px solid rgba(210, 17, 12, 0.3)"},children:[s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-semibold mb-1",style:{color:"#D2110C"},children:me.includes("stalled")?"Sync stalled":"Download failed"}),s.jsx("p",{className:"text-sm",style:{color:"#D2110C"},children:me.includes("stalled")?"The server returned the same page repeatedly. Tap Update pack to retry. If it persists, remove and download again.":me})]}),s.jsx("button",{onClick:()=>fe(null),children:s.jsx(Sr,{className:"w-4 h-4",style:{color:"#D2110C"}})})]}),A.rowsReceived!==void 0&&s.jsxs("div",{className:"text-xs space-y-1 pt-2 border-t",style:{borderColor:"rgba(210, 17, 12, 0.2)",color:"#C9CBD6"},children:[s.jsxs("p",{children:["Rows received from server: ",s.jsx("strong",{style:{color:"#FFFFFF"},children:A.rowsReceived})]}),s.jsxs("p",{children:["Rows matched this pack: ",s.jsx("strong",{style:{color:"#FFFFFF"},children:A.rowsMatched||0})]})]})]}),d&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"relative",children:[s.jsx(Hu,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5",style:{color:"#8E91A3"}}),s.jsx("input",{type:"text",placeholder:"Search species",value:ft,onChange:ge=>Me(ge.target.value),className:"w-full pl-12 pr-4 py-3 rounded-xl",style:{background:"#14151A",border:"1px solid #242632",color:"#FFFFFF"}})]}),ft.length>=2?s.jsx("div",{className:"space-y-2",children:de.length>0?de.map((ge,Ye)=>s.jsx("button",{onClick:()=>jn(ge),className:"w-full rounded-[18px] card-shadow p-4 text-left transition-all active:scale-98",style:{background:"#14151A",border:"1px solid #242632"},children:s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-semibold italic truncate",style:{color:"#FFFFFF"},children:ge.matchType==="synonym"&&ge.synonymName?ge.synonymName:ge.taxon.scientific_name}),s.jsxs("p",{className:"text-sm truncate",style:{color:"#C9CBD6"},children:[ge.taxon.rank,"  ",ge.taxon.kingdom||"Unknown",ge.taxon.authorship&&`  ${ge.taxon.authorship}`]})]}),s.jsx("span",{className:"px-2 py-1 rounded text-xs font-semibold flex-shrink-0",style:{background:ge.matchType==="accepted"?"rgba(52, 211, 153, 0.15)":"rgba(251, 191, 36, 0.15)",color:ge.matchType==="accepted"?"#34D399":"#FBB024"},children:ge.matchType==="accepted"?"Accepted":"Synonym"})]})},`${ge.taxon.id}-${Ye}`)):s.jsx("div",{className:"text-center py-8",children:s.jsx("p",{className:"text-sm",style:{color:"#8E91A3"},children:"No results found"})})}):s.jsxs("div",{children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h3",{className:"font-semibold",style:{color:"#FFFFFF"},children:"Index"}),s.jsx("p",{className:"text-xs",style:{color:"#8E91A3"},children:p>0?`Showing 30 of ${p.toLocaleString()} stored taxa`:"Recently added"})]}),jt?s.jsx("div",{className:"text-center py-8",children:s.jsx("p",{className:"text-sm",style:{color:"#8E91A3"},children:"Loading..."})}):De.length>0?s.jsx("div",{className:"space-y-2",children:De.map((ge,Ye)=>s.jsx("button",{onClick:()=>jn({taxon:ge}),className:"w-full rounded-[18px] card-shadow p-4 text-left transition-all active:scale-98",style:{background:"#14151A",border:"1px solid #242632"},children:s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-semibold italic truncate",style:{color:"#FFFFFF"},children:ge.scientific_name}),s.jsxs("p",{className:"text-sm truncate",style:{color:"#C9CBD6"},children:[ge.rank,"  ",ge.kingdom||"Unknown",ge.authorship&&`  ${ge.authorship}`]})]}),s.jsx("span",{className:"px-2 py-1 rounded text-xs font-semibold flex-shrink-0",style:{background:"rgba(52, 211, 153, 0.15)",color:"#34D399"},children:"Accepted"})]})},`${ge.id}-${Ye}`))}):s.jsxs("div",{className:"rounded-[18px] card-shadow p-6 text-center space-y-4",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-1",style:{color:"#FFFFFF"},children:"No taxa found in this pack"}),s.jsx("p",{className:"text-sm",style:{color:"#C9CBD6"},children:"The download finished but no rows were stored. Try Update pack. If it persists, remove and download again."})]}),s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx("button",{onClick:cr,className:"btn-primary py-2.5",children:"Update pack"}),s.jsx("button",{onClick:()=>$e(!0),className:"py-2.5 px-4 rounded-xl text-sm font-semibold transition-all",style:{background:"transparent",border:"1px solid #D2110C",color:"#D2110C"},children:"Remove pack"})]})]})]})]}),ye&&s.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in",children:s.jsxs("div",{className:"rounded-[22px] card-shadow-raised max-w-md w-full p-6 animate-slide-up",style:{background:"#1A1C22"},children:[s.jsx("h2",{className:"text-xl font-bold mb-2",style:{color:"#FFFFFF"},children:"Remove this pack?"}),s.jsx("p",{className:"text-sm mb-6",style:{color:"#C9CBD6"},children:"This deletes both taxa and synonyms for this pack from on-device storage. You can download them again anytime."}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>$e(!1),className:"flex-1 btn-secondary py-3",children:"Cancel"}),s.jsx("button",{onClick:ss,className:"flex-1 py-3 px-4 rounded-xl text-base font-semibold",style:{background:"#D2110C",color:"#FFFFFF"},children:"Remove"})]})]})}),Ue&&se&&s.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-end justify-center z-50 animate-fade-in",children:s.jsxs("div",{className:"rounded-t-[22px] card-shadow-raised w-full max-w-2xl max-h-[80vh] overflow-y-auto animate-slide-up",style:{background:"#1A1C22"},children:[s.jsx("div",{className:"px-6 py-4 border-b",style:{borderColor:"#242632"},children:s.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-xl font-bold italic",style:{color:"#FFFFFF"},children:re||se.scientific_name}),re&&s.jsxs("p",{className:"text-sm italic mt-1",style:{color:"#8E91A3"},children:["Accepted: ",se.scientific_name]})]}),s.jsx("button",{onClick:()=>We(!1),children:s.jsx(Sr,{className:"w-6 h-6",style:{color:"#C9CBD6"}})})]})}),s.jsxs("div",{className:"px-6 py-4 space-y-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-semibold mb-1",style:{color:"#8E91A3"},children:"Rank"}),s.jsx("p",{className:"text-sm capitalize",style:{color:"#FFFFFF"},children:se.rank})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-semibold mb-1",style:{color:"#8E91A3"},children:"Kingdom"}),s.jsx("p",{className:"text-sm",style:{color:"#FFFFFF"},children:se.kingdom||"Unknown"})]}),se.authorship&&s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-semibold mb-1",style:{color:"#8E91A3"},children:"Authorship"}),s.jsx("p",{className:"text-sm",style:{color:"#FFFFFF"},children:se.authorship})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx("button",{onClick:Ee,className:"flex-1 btn-primary py-3",children:"Use in assessment"}),s.jsx("button",{onClick:qn,className:"px-4 py-3 rounded-xl transition-all",style:{background:"#14151A",border:"1px solid #242632"},children:s.jsx(vm,{className:"w-5 h-5",style:{color:"#FFFFFF"}})})]}),s.jsx("p",{className:"text-xs text-center pt-2",style:{color:"#8E91A3"},children:"Taxonomy source: Catalogue of Life. IUCN SIS taxonomy may differ."})]})]})}),Ge&&s.jsxs("div",{className:"fixed bottom-24 left-1/2 -translate-x-1/2 z-[60] px-6 py-3 rounded-xl shadow-2xl animate-slide-up flex items-center gap-2",style:{background:"#1A1C22",border:"1px solid #242632"},children:[s.jsx(Wu,{className:"w-4 h-4",style:{color:"#6EE7B7"}}),s.jsx("p",{className:"text-sm font-semibold",style:{color:"#FFFFFF"},children:nt})]})]}):s.jsxs("div",{className:"p-6 text-center",children:[s.jsx("p",{style:{color:"#8E91A3"},children:"Pack not found"}),s.jsx("button",{onClick:n,className:"btn-secondary mt-4",children:"Go back"})]})}function Rx(){const[i,n]=V.useState([]),[r,a]=V.useState(!0),[d,h]=V.useState(""),[p,v]=V.useState("all"),[x,_]=V.useState(new Map),[j,C]=V.useState(null),[F,T]=V.useState("not-downloaded");V.useEffect(()=>{A(),q()},[]);const A=async()=>{a(!0);try{const ee=await Vf();n(ee)}catch(ee){console.error("Failed to load packs:",ee)}finally{a(!1)}},q=async()=>{const ee=await we.getInstalledPacksWithMeta(),me=new Map;ee.forEach(fe=>{me.set(fe.pack_id,{taxaCount:fe.taxa_count,synCount:fe.syn_count})}),_(me),me.size>0?T("ready"):T("not-downloaded")};if(V.useEffect(()=>{j||q()},[j]),j)return s.jsx(Tx,{packId:j,onBack:()=>C(null)});const M=Ex(i),Z=Array.from(M.keys()).sort().filter(ee=>(M.get(ee)||[]).some(fe=>{if(!(d.length===0||fe.label.toLowerCase().includes(d.toLowerCase())||fe.phylum.toLowerCase().includes(d.toLowerCase())||fe.description.toLowerCase().includes(d.toLowerCase())))return!1;const $e=x.has(fe.id);return!(p==="downloaded"&&!$e||p==="not-downloaded"&&$e)})),ne=ee=>ee.toLocaleString(),ie=ee=>x.get(ee)?{label:"Downloaded",color:"#34D399",bg:"rgba(52, 211, 153, 0.15)"}:{label:"Not downloaded",color:"#8E91A3",bg:"rgba(142, 145, 163, 0.15)"};return s.jsxs("div",{className:"space-y-4",style:{paddingBottom:"120px"},children:[s.jsx("div",{className:"px-4 pt-4",children:s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h2",{className:"text-xl font-bold",style:{color:"#FFFFFF"},children:"Species Index"}),s.jsx("p",{className:"text-sm mt-1",style:{color:"#8E91A3"},children:"Catalogue of Life packs on this device"})]}),s.jsx("span",{className:"px-3 py-1.5 rounded-full text-xs font-semibold flex-shrink-0",style:{background:F==="ready"?"rgba(52, 211, 153, 0.15)":"rgba(142, 145, 163, 0.15)",color:F==="ready"?"#34D399":"#8E91A3"},children:F==="ready"?"Ready":"Not downloaded"})]})}),s.jsxs("div",{className:"px-4 space-y-3",children:[s.jsxs("div",{className:"relative",children:[s.jsx(Hu,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5",style:{color:"#8E91A3"}}),s.jsx("input",{type:"text",placeholder:"Search packs",value:d,onChange:ee=>h(ee.target.value),className:"w-full pl-12 pr-4 py-3 rounded-xl",style:{background:"#14151A",border:"1px solid #242632",color:"#FFFFFF"}})]}),s.jsx("div",{className:"flex gap-2",children:["all","downloaded","not-downloaded"].map(ee=>s.jsx("button",{onClick:()=>v(ee),className:"px-4 py-2 rounded-lg text-sm font-semibold transition-all",style:{background:p===ee?"rgba(210, 17, 12, 0.15)":"#14151A",border:`1px solid ${p===ee?"#D2110C":"#242632"}`,color:p===ee?"#D2110C":"#8E91A3"},children:ee==="all"?"All":ee==="downloaded"?"Downloaded":"Not downloaded"},ee))})]}),r&&s.jsxs("div",{className:"px-4 py-12 text-center",children:[s.jsx(Em,{className:"w-8 h-8 animate-spin mx-auto mb-3",style:{color:"#8E91A3"}}),s.jsx("p",{className:"text-sm",style:{color:"#8E91A3"},children:"Loading packs..."})]}),!r&&Z.length===0&&s.jsx("div",{className:"px-4 py-12 text-center",children:s.jsx("p",{className:"text-sm",style:{color:"#8E91A3"},children:"No packs found"})}),!r&&Z.map(ee=>{const me=(M.get(ee)||[]).filter(Te=>{if(!(d.length===0||Te.label.toLowerCase().includes(d.toLowerCase())||Te.phylum.toLowerCase().includes(d.toLowerCase())||Te.description.toLowerCase().includes(d.toLowerCase())))return!1;const De=x.has(Te.id);return!(p==="downloaded"&&!De||p==="not-downloaded"&&De)}),fe=me.filter(Te=>x.has(Te.id)).length,ye=me.length,$e=Gf(ee);return s.jsx("div",{className:"px-4",children:s.jsxs("div",{className:"rounded-[22px] overflow-hidden relative",style:{background:"#14151A",border:"1px solid #242632",minHeight:"160px"},children:[s.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:`url(${$e})`,filter:"brightness(1.15) contrast(1.05) saturate(1.08)"}}),s.jsxs("div",{className:"absolute inset-0",children:[s.jsx("div",{className:"absolute inset-0",style:{background:"rgba(0, 0, 0, 0.25)"}}),s.jsx("div",{className:"absolute inset-0",style:{background:"linear-gradient(to bottom, rgba(0,0,0,0.10) 0%, rgba(0,0,0,0.55) 70%, rgba(0,0,0,0.70) 100%)"}})]}),s.jsxs("div",{className:"relative p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-bold",style:{color:"#FFFFFF"},children:ee}),s.jsxs("p",{className:"text-xs mt-0.5",style:{color:"#C9CBD6"},children:[ye," ",ye===1?"pack":"packs"," available"]})]}),s.jsxs("div",{className:"relative flex-shrink-0",style:{width:"120px",height:"44px"},children:[s.jsx("div",{className:"absolute inset-0 rounded-full",style:{background:"linear-gradient(to bottom, rgba(0,0,0,0.0), rgba(0,0,0,0.35))"}}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsxs("span",{className:"px-3 py-2 rounded-full text-xs font-semibold whitespace-nowrap",style:{background:"rgba(0, 0, 0, 0.55)",backdropFilter:"blur(16px)",WebkitBackdropFilter:"blur(16px)",border:"1px solid rgba(255, 255, 255, 0.18)",color:"#FFFFFF",fontSize:"13px",boxShadow:"0 6px 18px rgba(0, 0, 0, 0.35)"},children:["Downloaded ",fe," / ",ye]})})]})]}),me.map(Te=>{const st=ie(Te.id);return s.jsxs("button",{onClick:()=>C(Te.id),className:"w-full rounded-[18px] p-4 text-left transition-all active:scale-98",style:{background:"rgba(20, 21, 26, 0.72)",border:"1px solid rgba(255, 255, 255, 0.06)",backdropFilter:"blur(12px)"},children:[s.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"font-bold truncate",style:{color:"#FFFFFF"},children:Te.label}),s.jsx("p",{className:"text-xs truncate mt-0.5",style:{color:"#C9CBD6"},children:Te.description})]}),s.jsx("span",{className:"px-2 py-1 rounded text-xs font-semibold flex-shrink-0",style:{background:st.bg,color:st.color},children:st.label})]}),s.jsxs("p",{className:"text-xs",style:{color:"#8E91A3"},children:["Taxa in pack: ",s.jsx("strong",{style:{color:"#FFFFFF"},children:ne(Te.taxa_count||0)})]})]},Te.id)})]})]})},ee)})]})}function Px(){const[i,n]=V.useState("modules"),[r,a]=V.useState(""),[d,h]=V.useState([]),[p,v]=V.useState({step1:0,step2:0,step3:0}),[x,_]=V.useState(null),[j,C]=V.useState(""),[F,T]=V.useState(null),[A,q]=V.useState(!1),[M,U]=V.useState(null);V.useEffect(()=>{const ee=localStorage.getItem("assessments");if(ee){const st=JSON.parse(ee).map(De=>({id:De.id,commonName:De.taxonName,scientificName:De.scientificName,regionalCategory:De.step3?.finalCategory||De.step2?.preliminaryCategory,lastAssessed:De.lastModified}));h(st)}const me=localStorage.getItem("moduleProgress");me&&v(JSON.parse(me));const fe=Te=>{const{moduleId:st}=Te.detail;T(st)},ye=()=>{n("modules"),setTimeout(()=>{const Te=document.querySelector('h3:contains("Region Modules")');Te&&Te.scrollIntoView({behavior:"smooth",block:"start"})},100)},$e=()=>{n("glossary"),setTimeout(()=>{const Te=document.querySelector('input[type="text"]');Te&&Te.focus()},100)};return window.addEventListener("openModule",fe),window.addEventListener("scrollToRegionModules",ye),window.addEventListener("openGlossary",$e),()=>{window.removeEventListener("openModule",fe),window.removeEventListener("scrollToRegionModules",ye),window.removeEventListener("openGlossary",$e)}},[]),d.filter(ee=>ee.commonName.toLowerCase().includes(r.toLowerCase())||ee.scientificName.toLowerCase().includes(r.toLowerCase()));const ne=[{term:"Benign introduction",definition:"Establishing a taxon for conservation outside its recorded distribution but in appropriate habitat/ecogeographical area; used when no remaining area in historic range.",usedIn:["Step 1"]},{term:"Breeding population",definition:"A (sub)population that reproduces within the region (entire or essential part of cycle).",usedIn:["Step 1"]},{term:"Conspecific population",definition:"Populations of the same species (unit at or below species level).",usedIn:["Step 3"]},{term:"Downlisting / Uplisting",definition:"Adjusting regional category down/up based on decreased/increased extinction risk.",usedIn:["Step 3"]},{term:"Endemic taxon",definition:"Naturally found in a specific area and nowhere else (relative term).",usedIn:["Step 1","Step 2"]},{term:"Global population",definition:"Total number of individuals of a taxon.",usedIn:["Step 2","Step 3"]},{term:"Metapopulation",definition:"Collection of subpopulations in habitat patches; survival depends on extinction vs (re)colonization rates.",usedIn:["Step 2"]},{term:"Natural range",definition:"Range excluding parts resulting from introductions; delimitation decisions are left to regional authority.",usedIn:["Step 1"]},{term:"Not Applicable (NA)",definition:"Ineligible for regional assessment (not wild/natural range, vagrant, very low numbers under a filter, or below eligible taxonomic level).",usedIn:["Step 1"]},{term:"Population",definition:'In IUCN sense: total number of individuals of the taxon; in regional context, "global population" may be used for clarity.',usedIn:["Step 2"]},{term:"Propagule",definition:"Dispersal-capable entity producing a new mature individual (spore/seed/egg/larva/etc.); not gametes/pollen.",usedIn:["Step 3"]},{term:"Region",definition:"Subglobal area (continent/country/state/province).",usedIn:["Step 1","Step 2","Step 3"]},{term:"Regional assessment",definition:"Determining relative extinction risk of a regional population per these guidelines.",usedIn:["Step 1","Step 2","Step 3"]},{term:"Regionally Extinct (RE)",definition:"No reasonable doubt last potentially reproductive individual in region has died/disappeared; time limit is region-defined but should not normally pre-date 1500 AD.",usedIn:["Step 1"]},{term:"Regional population",definition:"Portion of the global population within the region (may include multiple subpopulations).",usedIn:["Step 2","Step 3"]},{term:"Rescue effect",definition:"Immigrating propagules reduce extinction risk of target population.",usedIn:["Step 3"]},{term:"Sink",definition:"Area where reproduction < mortality; often maintained by immigration from a source.",usedIn:["Step 3"]},{term:"Subpopulations",definition:"Distinct groups with little demographic/genetic exchange (typically 1 successful migrant per year).",usedIn:["Step 2"]},{term:"Taxon",definition:"Species or infraspecific entity being assessed.",usedIn:["Step 1","Step 2","Step 3"]},{term:"Vagrant",definition:"Taxon found only occasionally within a region's boundaries.",usedIn:["Step 1"]},{term:"Visitor (visiting taxon)",definition:"Does not reproduce in region but regularly occurs now or during some period of last century; regions define boundary between visitors and vagrants (e.g., % global pop or predictability).",usedIn:["Step 1"]},{term:"Wild population",definition:"Within natural range; individuals result of natural reproduction (benign introductions can be considered wild if self-sustaining).",usedIn:["Step 1"]}].filter(ee=>{const me=ee.term.toLowerCase().includes(r.toLowerCase())||ee.definition.toLowerCase().includes(r.toLowerCase()),fe=!j||ee.term.charAt(0).toUpperCase()===j;return me&&fe}),ie="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");return s.jsxs("div",{className:"min-h-screen",style:{background:"linear-gradient(180deg, #0B0B0D 0%, #0F1013 100%)"},children:[s.jsxs("header",{className:"px-4 py-4 safe-area-top",style:{background:"#14151A",borderBottom:"1px solid #242632"},children:[s.jsx("h1",{className:"text-xl font-semibold",style:{color:"#FFFFFF"},children:"Library"}),s.jsx("p",{className:"text-sm mt-1",style:{color:"#C9CBD6"},children:"Modules and glossary"})]}),s.jsx("div",{className:"sticky top-0 z-10",style:{background:"#14151A",borderBottom:"1px solid #242632"},children:s.jsx("div",{className:"overflow-x-auto hide-scrollbar",style:{height:"54px"},children:s.jsxs("div",{className:"flex gap-[18px] px-4 h-full",style:{whiteSpace:"nowrap"},children:[s.jsxs("button",{onClick:()=>n("modules"),className:"relative font-semibold transition-colors flex-shrink-0 pb-3 pt-4",style:{fontSize:"15px",color:i==="modules"?"#D2110C":"rgba(255, 255, 255, 0.6)"},children:["Modules",i==="modules"&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 transition-all duration-200",style:{height:"3px",background:"#D2110C",borderRadius:"3px 3px 0 0"}})]}),s.jsxs("button",{onClick:()=>n("glossary"),className:"relative font-semibold transition-colors flex-shrink-0 pb-3 pt-4",style:{fontSize:"15px",color:i==="glossary"?"#D2110C":"rgba(255, 255, 255, 0.6)"},children:["Glossary",i==="glossary"&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 transition-all duration-200",style:{height:"3px",background:"#D2110C",borderRadius:"3px 3px 0 0"}})]}),s.jsxs("button",{onClick:()=>n("species"),className:"relative font-semibold transition-colors flex-shrink-0 pb-3 pt-4",style:{fontSize:"15px",color:i==="species"?"#D2110C":"rgba(255, 255, 255, 0.6)"},children:["Species Index",i==="species"&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 transition-all duration-200",style:{height:"3px",background:"#D2110C",borderRadius:"3px 3px 0 0"}})]})]})})}),(i==="modules"||i==="glossary")&&s.jsx("div",{className:"px-4 py-4",children:s.jsxs("div",{className:"relative",children:[s.jsx(Hu,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5",style:{color:"#8E91A3"}}),s.jsx("input",{type:"text",value:r,onChange:ee=>a(ee.target.value),placeholder:i==="modules"?"Search modules...":"Search terms...",className:"w-full pl-12 pr-4 py-3 rounded-lg",style:{background:"#14151A",border:"1px solid #242632",color:"#FFFFFF"}})]})}),i==="glossary"&&s.jsx("div",{className:"px-4 pb-4",children:s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx("button",{onClick:()=>C(""),className:"px-3 py-1.5 rounded-lg text-xs font-semibold transition-all",style:{background:j===""?"#D2110C":"transparent",border:`1px solid ${j===""?"#D2110C":"#242632"}`,color:j===""?"#FFFFFF":"#8E91A3"},children:"All"}),ie.map(ee=>s.jsx("button",{onClick:()=>C(ee),className:"px-3 py-1.5 rounded-lg text-xs font-semibold transition-all",style:{background:j===ee?"#D2110C":"transparent",border:`1px solid ${j===ee?"#D2110C":"#242632"}`,color:j===ee?"#FFFFFF":"#8E91A3"},children:ee},ee))]})}),s.jsxs("div",{className:"px-4 pb-6 content-safe-bottom",children:[i==="modules"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx(Fu,{step:1,title:"Step 1  Eligibility",subtitle:"Taxon & population inclusion rules",progress:p.step1,onActivate:()=>T(1),isActive:F===1}),s.jsx(Fu,{step:2,title:"Step 2  Preliminary Category",subtitle:"Apply criteria using regional data",progress:p.step2,onActivate:()=>T(2),isActive:F===2}),s.jsx(Fu,{step:3,title:"Step 3  Adjustment",subtitle:"Rescue effect & sink logic",progress:p.step3,onActivate:()=>T(3),isActive:F===3})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"text-lg font-bold mb-1",style:{color:"#FFFFFF"},children:"Region Modules"}),s.jsx("p",{className:"text-sm",style:{color:"#8E91A3"},children:"Region-specific definitions and policies that affect assessments"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(xn,{regionId:"north-america",name:"North America",authority:"NatureServe",onOpen:()=>U("north-america")}),s.jsx(xn,{regionId:"central-america",name:"Central America",authority:"Regional Authority",onOpen:()=>U("central-america")}),s.jsx(xn,{regionId:"south-america",name:"South America",authority:"IUCN Americas",onOpen:()=>U("south-america")}),s.jsx(xn,{regionId:"europe",name:"Europe",authority:"European Red List",onOpen:()=>U("europe")}),s.jsx(xn,{regionId:"africa",name:"Africa",authority:"IUCN Africa",onOpen:()=>U("africa")}),s.jsx(xn,{regionId:"middle-east",name:"Middle East",authority:"Regional Authority",onOpen:()=>U("middle-east")}),s.jsx(xn,{regionId:"central-asia",name:"Central Asia",authority:"Regional Authority",onOpen:()=>U("central-asia")}),s.jsx(xn,{regionId:"south-asia",name:"South Asia",authority:"IUCN Asia",onOpen:()=>U("south-asia")}),s.jsx(xn,{regionId:"southeast-asia",name:"Southeast Asia",authority:"ASEAN Centre",onOpen:()=>U("southeast-asia")}),s.jsx(xn,{regionId:"east-asia",name:"East Asia",authority:"Regional Authority",onOpen:()=>U("east-asia")}),s.jsx(xn,{regionId:"australia-nz",name:"Australia & New Zealand",authority:"EPBC Act / DOC NZ",onOpen:()=>U("australia-nz")}),s.jsx(xn,{regionId:"oceania-pacific",name:"Oceania & Pacific Islands",authority:"SPREP",onOpen:()=>U("oceania-pacific")}),s.jsx(xn,{regionId:"arctic",name:"Arctic",authority:"CAFF",onOpen:()=>U("arctic")}),s.jsx(xn,{regionId:"antarctica",name:"Antarctica",authority:"SCAR",onOpen:()=>U("antarctica")})]})]})]}),i==="glossary"&&s.jsxs("div",{className:"space-y-2",children:[ne.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(qu,{className:"w-12 h-12 mx-auto mb-3",style:{color:"#8E91A3"}}),s.jsx("p",{style:{color:"#C9CBD6"},children:"No terms found"})]}),ne.map(ee=>s.jsx(Ox,{term:ee.term,definition:ee.definition,usedIn:ee.usedIn,isExpanded:x===ee.term,onToggle:()=>_(x===ee.term?null:ee.term)},ee.term))]}),i==="species"&&s.jsx(Rx,{})]}),F&&s.jsx(Ly,{moduleId:F,onClose:()=>T(null),onComplete:()=>{T(null),q(!0),setTimeout(()=>q(!1),3e3);const ee=localStorage.getItem("moduleProgress");ee&&v(JSON.parse(ee))}}),M&&s.jsx(Gy,{regionId:M,onClose:()=>U(null)}),A&&s.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 z-[60] px-6 py-3 rounded-full shadow-lg animate-slide-down",style:{background:"#10B981",color:"#FFFFFF"},children:s.jsx("p",{className:"text-sm font-semibold",children:" Module completed!"})})]})}function Fu({step:i,title:n,subtitle:r,progress:a,onActivate:d,isActive:h}){const p=a>=100,x={1:"#60A5FA",2:"#34D399",3:"#A78BFA"}[i];return s.jsxs("div",{className:"rounded-[18px] card-shadow p-5",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-bold mb-1",style:{color:"#FFFFFF"},children:n}),s.jsx("p",{className:"text-sm",style:{color:"#8E91A3"},children:r})]}),p&&s.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1 rounded-full",style:{background:"rgba(16, 185, 129, 0.15)"},children:[s.jsx(Wu,{className:"w-3.5 h-3.5",style:{color:"#10B981"}}),s.jsx("span",{className:"text-xs font-semibold",style:{color:"#10B981"},children:"Completed"})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-xs font-semibold",style:{color:"#C9CBD6"},children:"Progress"}),s.jsxs("span",{className:"text-xs font-semibold",style:{color:x},children:[a,"%"]})]}),s.jsx("div",{className:"w-full h-2 rounded-full overflow-hidden",style:{background:"#1A1C22"},children:s.jsx("div",{className:"h-full transition-all duration-300 rounded-full",style:{width:`${a}%`,background:x}})})]}),s.jsx("button",{onClick:d,className:"w-full py-3 px-4 rounded-xl text-base font-semibold transition-all",style:{background:"#D2110C",color:"#FFFFFF"},children:a===0?"Start Module":a>=100?"Review Module":"Continue Module"})]})}function Ox({term:i,definition:n,usedIn:r,isExpanded:a,onToggle:d}){return s.jsx("button",{onClick:d,className:"w-full rounded-[18px] card-shadow p-4 text-left transition-all",style:{background:"#14151A",border:"1px solid #242632"},children:s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-bold",style:{color:"#FFFFFF"},children:i}),a&&s.jsxs("div",{className:"mt-3 space-y-3",children:[s.jsx("p",{className:"text-sm",style:{color:"#C9CBD6"},children:n}),s.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(h=>s.jsx("span",{className:"px-2.5 py-1 rounded-lg text-xs font-semibold",style:{background:h==="Step 1"?"rgba(96, 165, 250, 0.15)":h==="Step 2"?"rgba(52, 211, 153, 0.15)":"rgba(167, 139, 250, 0.15)",color:h==="Step 1"?"#60A5FA":h==="Step 2"?"#34D399":"#A78BFA"},children:h},h))})]})]}),a?s.jsx(hm,{className:"w-5 h-5 flex-shrink-0",style:{color:"#8E91A3"}}):s.jsx(lm,{className:"w-5 h-5 flex-shrink-0",style:{color:"#8E91A3"}})]})})}function xn({regionId:i,name:n,authority:r,onOpen:a}){const[d,h]=V.useState(!1);return V.useEffect(()=>{const p=()=>{const x=localStorage.getItem(`regionPolicy_${i}_reviewed`);h(!!x)};p();const v=x=>{x.detail.regionId===i&&p()};return window.addEventListener("regionModuleReviewed",v),()=>{window.removeEventListener("regionModuleReviewed",v)}},[i]),s.jsx("button",{onClick:a,className:"w-full rounded-[18px] card-shadow p-4 text-left transition-all relative",style:{background:"#14151A",border:"1px solid #242632",borderLeft:d?"3px solid #34D399":"1px solid #242632"},children:s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h4",{className:"font-bold",style:{color:"#FFFFFF"},children:n}),d&&s.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-semibold",style:{background:"rgba(52, 211, 153, 0.15)",color:"#34D399"},children:"Reviewed"})]}),s.jsxs("p",{className:"text-sm",style:{color:"#8E91A3"},children:["Authority: ",r]})]}),s.jsx(Ls,{className:"w-5 h-5 flex-shrink-0",style:{color:"#8E91A3"}})]})})}function Dx({className:i,style:n}){return s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",className:i,style:n,children:[s.jsx("rect",{x:"18",y:"14",width:"28",height:"38",rx:"6",stroke:"currentColor",strokeWidth:"2.5"}),s.jsx("path",{d:"M25 14.5c0-2.5 2-4.5 4.5-4.5h5c2.5 0 4.5 2 4.5 4.5",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"}),s.jsx("path",{d:"M26 35l4 4 9-10",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}function Ix({className:i,style:n}){return s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",className:i,style:n,children:[s.jsx("path",{d:"M18 20h28",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"}),s.jsx("circle",{cx:"38",cy:"20",r:"4",stroke:"currentColor",strokeWidth:"2.5"}),s.jsx("path",{d:"M18 32h28",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"}),s.jsx("circle",{cx:"26",cy:"32",r:"4",stroke:"currentColor",strokeWidth:"2.5"}),s.jsx("path",{d:"M18 44h28",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"}),s.jsx("circle",{cx:"34",cy:"44",r:"4",stroke:"currentColor",strokeWidth:"2.5"})]})}function Mx({className:i,style:n}){return s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",className:i,style:n,children:[s.jsx("circle",{cx:"32",cy:"32",r:"18",stroke:"currentColor",strokeWidth:"2.5"}),s.jsx("circle",{cx:"32",cy:"32",r:"8",stroke:"currentColor",strokeWidth:"2.5"}),s.jsx("path",{d:"M32 14v6",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"}),s.jsx("path",{d:"M32 44v6",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"}),s.jsx("path",{d:"M14 32h6",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"}),s.jsx("path",{d:"M44 32h6",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"})]})}function Lx({className:i,style:n}){return s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",className:i,style:n,children:[s.jsx("circle",{cx:"32",cy:"32",r:"18",stroke:"currentColor",strokeWidth:"2.5"}),s.jsx("path",{d:"M14 32h36",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"}),s.jsx("path",{d:"M32 14c6 6 6 30 0 36",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"}),s.jsx("path",{d:"M32 14c-6 6-6 30 0 36",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"})]})}function Bx({className:i,style:n}){return s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",className:i,style:n,children:[s.jsx("path",{d:"M32 52s14-12 14-24a14 14 0 1 0-28 0c0 12 14 24 14 24z",stroke:"currentColor",strokeWidth:"2.5",strokeLinejoin:"round"}),s.jsx("circle",{cx:"32",cy:"28",r:"5",stroke:"currentColor",strokeWidth:"2.5"})]})}function $x({className:i,style:n}){return s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",className:i,style:n,children:[s.jsx("circle",{cx:"32",cy:"32",r:"18",stroke:"currentColor",strokeWidth:"2.5"}),s.jsx("path",{d:"M40 24l-5 15-11 5 5-15 11-5z",stroke:"currentColor",strokeWidth:"2.5",strokeLinejoin:"round"}),s.jsx("path",{d:"M32 10v6",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"}),s.jsx("path",{d:"M32 48v6",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"})]})}function Ux({className:i,style:n}){return s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",className:i,style:n,children:[s.jsx("path",{d:"M20 44V28c0-6 5-10 12-10s12 4 12 10v16",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"}),s.jsx("path",{d:"M18 44h28",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"}),s.jsx("path",{d:"M26 44V30",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"}),s.jsx("path",{d:"M38 44V30",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"})]})}function zx({className:i,style:n}){return s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",className:i,style:n,children:s.jsx("path",{d:"M32 12l16 6v14c0 12-8 20-16 24-8-4-16-12-16-24V18l16-6z",stroke:"currentColor",strokeWidth:"2.5",strokeLinejoin:"round"})})}function qx({className:i,style:n}){return s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",className:i,style:n,children:s.jsx("path",{d:"M40 18c-8 0-14 6-14 14s6 14 14 14c2 0 4-.4 6-1.2-3.6 3.6-8.6 5.8-14 5.8-11 0-20-9-20-20s9-20 20-20c5.4 0 10.4 2.2 14 5.8-2-.8-4-1.2-6-1.2z",stroke:"currentColor",strokeWidth:"2.5",strokeLinejoin:"round"})})}function Wx({className:i,style:n}){return s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",className:i,style:n,children:[s.jsx("path",{d:"M14 46l14-22 8 12 6-8 14 18",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M14 46h36",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"})]})}function Kx({className:i,style:n}){return s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",className:i,style:n,children:[s.jsx("circle",{cx:"32",cy:"32",r:"9",stroke:"currentColor",strokeWidth:"2.5"}),s.jsx("path",{d:"M32 12v6M32 46v6M12 32h6M46 32h6",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"}),s.jsx("path",{d:"M18.5 18.5l4.2 4.2M41.3 41.3l4.2 4.2M45.5 18.5l-4.2 4.2M22.7 41.3l-4.2 4.2",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"})]})}function Hx({className:i,style:n}){return s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",className:i,style:n,children:[s.jsx("path",{d:"M14 40c6 0 6-6 12-6s6 6 12 6 6-6 12-6 6 6 12 6",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"}),s.jsx("path",{d:"M14 46c6 0 6-6 12-6s6 6 12 6 6-6 12-6 6 6 12 6",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"})]})}function Vx({className:i,style:n}){return s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",className:i,style:n,children:[s.jsx("path",{d:"M32 14v36",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"}),s.jsx("path",{d:"M32 22h10M32 34h10",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"}),s.jsx("path",{d:"M32 28h-10M32 40h-10",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"}),s.jsx("path",{d:"M42 22c2 0 4 2 4 4",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"}),s.jsx("path",{d:"M22 28c-2 0-4 2-4 4",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"})]})}function Gx({className:i,style:n}){return s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",className:i,style:n,children:[s.jsx("path",{d:"M22 24l2 6 6 2-6 2-2 6-2-6-6-2 6-2 2-6z",stroke:"currentColor",strokeWidth:"2.5",strokeLinejoin:"round"}),s.jsx("path",{d:"M42 18l1.6 4.8 4.8 1.6-4.8 1.6-1.6 4.8-1.6-4.8-4.8-1.6 4.8-1.6L42 18z",stroke:"currentColor",strokeWidth:"2.5",strokeLinejoin:"round"}),s.jsx("path",{d:"M44 36l1.6 4.8 4.8 1.6-4.8 1.6-1.6 4.8-1.6-4.8-4.8-1.6 4.8-1.6L44 36z",stroke:"currentColor",strokeWidth:"2.5",strokeLinejoin:"round"})]})}function Jx({className:i,style:n}){return s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",className:i,style:n,children:[s.jsx("path",{d:"M32 48c0-10 2-18 6-26",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"}),s.jsx("path",{d:"M38 22c4-4 10-4 12 0-6 2-10 4-12 0z",stroke:"currentColor",strokeWidth:"2.5",strokeLinejoin:"round"}),s.jsx("path",{d:"M36 24c0-6-6-10-12-8 2 6 6 10 12 8z",stroke:"currentColor",strokeWidth:"2.5",strokeLinejoin:"round"}),s.jsx("path",{d:"M20 50h24",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"})]})}function Yx({className:i,style:n}){return s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",className:i,style:n,children:[s.jsx("path",{d:"M32 14v36",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"}),s.jsx("path",{d:"M18 22l28 16",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"}),s.jsx("path",{d:"M46 22L18 38",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"}),s.jsx("path",{d:"M32 14l-4 4M32 14l4 4M32 50l-4-4M32 50l4-4",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"})]})}function Qx({className:i,style:n}){return s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",className:i,style:n,children:[s.jsx("path",{d:"M14 46l10-14 8 10 6-8 12 12",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M14 46h36",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"}),s.jsx("path",{d:"M28 32l4 4",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"})]})}const Xx={"eligibility-ace":Dx,"criteria-crafter":Ix,"rescue-strategist":Mx,"north-america":Lx,"central-america":Bx,"south-america":$x,europe:Ux,africa:zx,"middle-east":qx,"central-asia":Wx,"south-asia":Kx,"southeast-asia":Hx,"east-asia":Vx,"australia-nz":Gx,"oceania-pacific":Jx,arctic:Yx,antarctica:Qx};function Zx({onResetToOnboarding:i,onNavigateHome:n}){const[r,a]=V.useState(localStorage.getItem("userName")||""),[d,h]=V.useState(localStorage.getItem("userEmail")||"user@example.org"),[p,v]=V.useState(localStorage.getItem("selectedRegion")||"Unknown"),[x,_]=V.useState(!1),[j,C]=V.useState(!1),[F,T]=V.useState(r),[A,q]=V.useState(d),[M,U]=V.useState([]),[Z,ne]=V.useState(null),[ie,ee]=V.useState(!1),[me,fe]=V.useState(!1);V.useEffect(()=>{ye();const Me=()=>ye(),de=()=>ye();return window.addEventListener("moduleCompleted",Me),window.addEventListener("regionModuleReviewed",de),()=>{window.removeEventListener("moduleCompleted",Me),window.removeEventListener("regionModuleReviewed",de)}},[]);const ye=()=>{const Me=JSON.parse(localStorage.getItem("moduleProgress")||'{"step1":0,"step2":0,"step3":0}'),de=[{id:"eligibility-ace",name:"Eligibility Ace",type:"core",earned:Me.step1>=100,earnedAt:Me.step1>=100?localStorage.getItem("badge_eligibility-ace_date")||new Date().toISOString():void 0},{id:"criteria-crafter",name:"Criteria Crafter",type:"core",earned:Me.step2>=100,earnedAt:Me.step2>=100?localStorage.getItem("badge_criteria-crafter_date")||new Date().toISOString():void 0},{id:"rescue-strategist",name:"Rescue Strategist",type:"core",earned:Me.step3>=100,earnedAt:Me.step3>=100?localStorage.getItem("badge_rescue-strategist_date")||new Date().toISOString():void 0},{id:"north-america",name:"North America",type:"region",earned:!!localStorage.getItem("regionPolicy_north-america_reviewed"),earnedAt:localStorage.getItem("regionPolicy_north-america_reviewed")||void 0},{id:"central-america",name:"Central America",type:"region",earned:!!localStorage.getItem("regionPolicy_central-america_reviewed"),earnedAt:localStorage.getItem("regionPolicy_central-america_reviewed")||void 0},{id:"south-america",name:"South America",type:"region",earned:!!localStorage.getItem("regionPolicy_south-america_reviewed"),earnedAt:localStorage.getItem("regionPolicy_south-america_reviewed")||void 0},{id:"europe",name:"Europe",type:"region",earned:!!localStorage.getItem("regionPolicy_europe_reviewed"),earnedAt:localStorage.getItem("regionPolicy_europe_reviewed")||void 0},{id:"africa",name:"Africa",type:"region",earned:!!localStorage.getItem("regionPolicy_africa_reviewed"),earnedAt:localStorage.getItem("regionPolicy_africa_reviewed")||void 0},{id:"middle-east",name:"Middle East",type:"region",earned:!!localStorage.getItem("regionPolicy_middle-east_reviewed"),earnedAt:localStorage.getItem("regionPolicy_middle-east_reviewed")||void 0},{id:"central-asia",name:"Central Asia",type:"region",earned:!!localStorage.getItem("regionPolicy_central-asia_reviewed"),earnedAt:localStorage.getItem("regionPolicy_central-asia_reviewed")||void 0},{id:"south-asia",name:"South Asia",type:"region",earned:!!localStorage.getItem("regionPolicy_south-asia_reviewed"),earnedAt:localStorage.getItem("regionPolicy_south-asia_reviewed")||void 0},{id:"southeast-asia",name:"Southeast Asia",type:"region",earned:!!localStorage.getItem("regionPolicy_southeast-asia_reviewed"),earnedAt:localStorage.getItem("regionPolicy_southeast-asia_reviewed")||void 0},{id:"east-asia",name:"East Asia",type:"region",earned:!!localStorage.getItem("regionPolicy_east-asia_reviewed"),earnedAt:localStorage.getItem("regionPolicy_east-asia_reviewed")||void 0},{id:"australia-nz",name:"Australia & NZ",type:"region",earned:!!localStorage.getItem("regionPolicy_australia-nz_reviewed"),earnedAt:localStorage.getItem("regionPolicy_australia-nz_reviewed")||void 0},{id:"oceania-pacific",name:"Oceania & Pacific",type:"region",earned:!!localStorage.getItem("regionPolicy_oceania-pacific_reviewed"),earnedAt:localStorage.getItem("regionPolicy_oceania-pacific_reviewed")||void 0},{id:"arctic",name:"Arctic",type:"region",earned:!!localStorage.getItem("regionPolicy_arctic_reviewed"),earnedAt:localStorage.getItem("regionPolicy_arctic_reviewed")||void 0},{id:"antarctica",name:"Antarctica",type:"region",earned:!!localStorage.getItem("regionPolicy_antarctica_reviewed"),earnedAt:localStorage.getItem("regionPolicy_antarctica_reviewed")||void 0}];U(de)},$e=()=>{a(F),h(A),localStorage.setItem("userName",F),localStorage.setItem("userEmail",A),C(!1)},Te=()=>{T(r),q(d),C(!1)},st=()=>{const Me=localStorage.getItem("assessments"),de=localStorage.getItem("moduleProgress"),Ce={};["north-america","central-america","south-america","europe","africa","middle-east","central-asia","south-asia","southeast-asia","east-asia","australia-nz","oceania-pacific","arctic","antarctica"].forEach(We=>{const Ge=localStorage.getItem(`regionPolicy_${We}_reviewed`);Ge&&(Ce[We]=Ge)});const W={schemaVersion:"1.0",exportedAt:new Date().toISOString(),profile:{displayName:r,email:d,region:p},moduleProgress:de?JSON.parse(de):{step1:0,step2:0,step3:0},regionReviewed:Ce,assessments:Me?JSON.parse(Me):[],badges:M.filter(We=>We.earned).map(We=>({id:We.id,name:We.name,earnedAt:We.earnedAt}))},re=new Blob([JSON.stringify(W,null,2)],{type:"application/json"}),Ve=URL.createObjectURL(re),Ue=document.createElement("a");Ue.href=Ve,Ue.download=`redlist-buddy-export-${Date.now()}.json`,Ue.click(),URL.revokeObjectURL(Ve)},De=async Me=>{const de=Me.target.files?.[0];if(de){fe(!0),ne(null),ee(!1);try{const Ce=await de.text(),se=JSON.parse(Ce);if(!se.schemaVersion)throw new Error("Missing schema version");if(se.schemaVersion!=="1.0")throw new Error(`Unsupported schema version: ${se.schemaVersion}`);if(!se.exportedAt||!se.profile)throw new Error("Missing required fields");se.profile.displayName&&(localStorage.setItem("userName",se.profile.displayName),a(se.profile.displayName)),se.profile.email&&(localStorage.setItem("userEmail",se.profile.email),h(se.profile.email)),se.profile.region&&(localStorage.setItem("selectedRegion",se.profile.region),v(se.profile.region)),se.moduleProgress&&localStorage.setItem("moduleProgress",JSON.stringify(se.moduleProgress)),se.regionReviewed&&Object.entries(se.regionReviewed).forEach(([W,re])=>{re&&localStorage.setItem(`regionPolicy_${W}_reviewed`,re)}),se.assessments&&Array.isArray(se.assessments)&&localStorage.setItem("assessments",JSON.stringify(se.assessments)),ye(),ee(!0),fe(!1),setTimeout(()=>{n()},1500)}catch(Ce){fe(!1),Ce instanceof SyntaxError?ne("Invalid JSON file"):Ce instanceof Error?ne(Ce.message):ne("Failed to import data")}Me.target.value=""}},lt=()=>{localStorage.removeItem("onboardingComplete"),_(!1),i()},jt=()=>{confirm("Are you sure? This will delete all your data and cannot be undone.")&&(localStorage.clear(),i())},Tt=M.filter(Me=>Me.earned),ft=M.length;return s.jsxs("div",{className:"min-h-screen",style:{background:"linear-gradient(180deg, #0B0B0D 0%, #0F1013 100%)"},children:[s.jsxs("header",{className:"px-4 py-4 safe-area-top",style:{background:"#14151A",borderBottom:"1px solid #242632"},children:[s.jsx("h1",{className:"text-xl font-semibold",style:{color:"#FFFFFF"},children:"Profile"}),s.jsx("p",{className:"text-sm mt-1",style:{color:"#C9CBD6"},children:"Account, badges, and data management"})]}),s.jsxs("div",{className:"px-4 py-6 content-safe-bottom space-y-6",children:[s.jsxs("section",{className:"rounded-[18px] card-shadow p-4",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"font-semibold",style:{color:"#FFFFFF"},children:"Account Information"}),!j&&s.jsx("button",{onClick:()=>C(!0),className:"text-sm px-3 py-1.5 rounded-lg transition-all",style:{background:"#1A1C22",border:"1px solid #242632",color:"#60A5FA"},children:"Edit"})]}),j?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold mb-2",style:{color:"#C9CBD6"},children:"Full Name"}),s.jsx("input",{type:"text",value:F,onChange:Me=>T(Me.target.value),className:"w-full px-4 py-3 rounded-lg",style:{background:"#1A1C22",border:"1px solid #242632",color:"#FFFFFF"}})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold mb-2",style:{color:"#C9CBD6"},children:"Email Address"}),s.jsx("input",{type:"email",value:A,onChange:Me=>q(Me.target.value),className:"w-full px-4 py-3 rounded-lg",style:{background:"#1A1C22",border:"1px solid #242632",color:"#FFFFFF"}})]}),s.jsxs("div",{className:"flex gap-3 pt-2",children:[s.jsx("button",{onClick:Te,className:"flex-1 btn-secondary py-3",children:"Cancel"}),s.jsx("button",{onClick:$e,className:"flex-1 btn-primary py-3",children:"Save"})]})]}):s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Vu,{className:"w-5 h-5",style:{color:"#8E91A3"}}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm",style:{color:"#8E91A3"},children:"Name"}),s.jsx("p",{className:"font-medium",style:{color:"#FFFFFF"},children:r})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Pm,{className:"w-5 h-5",style:{color:"#8E91A3"}}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm",style:{color:"#8E91A3"},children:"Email"}),s.jsx("p",{className:"font-medium",style:{color:"#FFFFFF"},children:d})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Cf,{className:"w-5 h-5",style:{color:"#8E91A3"}}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm",style:{color:"#8E91A3"},children:"Region"}),s.jsx("p",{className:"font-medium capitalize",style:{color:"#FFFFFF"},children:p.replace("-"," ")})]})]})]})]}),s.jsxs("section",{className:"rounded-[18px] card-shadow p-5",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsxs("div",{className:"flex items-center justify-between mb-5",children:[s.jsx("h2",{className:"font-semibold",style:{color:"#FFFFFF"},children:"Badges"}),s.jsxs("span",{className:"text-sm font-semibold",style:{color:"#D9B24C"},children:[Tt.length,"/",ft]})]}),s.jsx("div",{className:"grid grid-cols-2 gap-4",children:M.map(Me=>s.jsx(e0,{badge:Me},Me.id))})]}),s.jsxs("section",{className:"rounded-[18px] card-shadow p-4",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsx("h2",{className:"font-semibold mb-4",style:{color:"#FFFFFF"},children:"Data"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:st,className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left transition-all font-semibold",style:{background:"#D2110C",color:"#FFFFFF"},children:[s.jsx(zl,{className:"w-5 h-5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:"Export Data (JSON)"}),s.jsx("p",{className:"text-xs font-normal opacity-90",children:"Download complete assessment archive"})]})]}),s.jsxs("label",{className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left transition-all cursor-pointer",style:{background:"transparent",border:"1px solid #D2110C",color:"#D2110C"},children:[s.jsx(Vm,{className:"w-5 h-5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:"Import Data (JSON)"}),s.jsx("p",{className:"text-xs font-normal opacity-90",children:"Restore from backup file"})]}),s.jsx("input",{type:"file",accept:".json,application/json",onChange:De,className:"hidden"})]})]})]}),s.jsxs("section",{className:"rounded-[18px] card-shadow p-4",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsx("h2",{className:"font-semibold mb-4",style:{color:"#FFFFFF"},children:"Settings"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:()=>_(!0),className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left transition-all",style:{background:"#1A1C22",border:"1px solid #242632"},children:[s.jsx($m,{className:"w-5 h-5",style:{color:"#60A5FA"}}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",style:{color:"#FFFFFF"},children:"Reset Onboarding"}),s.jsx("p",{className:"text-xs",style:{color:"#8E91A3"},children:"Restart the tutorial"})]})]}),s.jsxs("button",{onClick:jt,className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left transition-all",style:{background:"#1A1C22",border:"1px solid rgba(210, 17, 12, 0.2)"},children:[s.jsx(Ef,{className:"w-5 h-5",style:{color:"#D2110C"}}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",style:{color:"#D2110C"},children:"Clear All Data"}),s.jsx("p",{className:"text-xs",style:{color:"#8E91A3"},children:"Delete all assessments and reset app"})]})]})]})]}),s.jsxs("section",{className:"rounded-[18px] card-shadow p-4",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsx("h2",{className:"font-semibold mb-4",style:{color:"#FFFFFF"},children:"About"}),s.jsxs("div",{className:"space-y-2 text-sm",style:{color:"#C9CBD6"},children:[s.jsx("p",{children:s.jsx("strong",{style:{color:"#FFFFFF"},children:"RedList Buddy"})}),s.jsx("p",{children:"Version 1.0.0"}),s.jsx("p",{className:"text-xs mt-4",style:{color:"#8E91A3"},children:"This app implements the IUCN Regional/National Red List Guidelines for educational and assessment drafting purposes. All assessments require expert review before publication."})]})]})]}),x&&s.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in",children:s.jsxs("div",{className:"rounded-[22px] card-shadow-raised max-w-md w-full p-6 animate-slide-up",style:{background:"#1A1C22"},children:[s.jsx("h2",{className:"text-xl font-bold mb-3",style:{color:"#FFFFFF"},children:"Reset Onboarding?"}),s.jsx("p",{className:"text-sm mb-6",style:{color:"#C9CBD6"},children:"This will restart the tutorial from the beginning. Your assessments and progress will not be affected."}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>_(!1),className:"flex-1 btn-secondary py-3",children:"Cancel"}),s.jsx("button",{onClick:lt,className:"flex-1 btn-primary py-3",children:"Reset"})]})]})}),ie&&s.jsxs("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 z-[60] px-6 py-3 rounded-xl shadow-2xl animate-slide-down flex items-center gap-2",style:{background:"#10B981",color:"#FFFFFF"},children:[s.jsx(Wu,{className:"w-5 h-5"}),s.jsx("p",{className:"text-sm font-semibold",children:"Import successful! Returning to Home..."})]}),Z&&s.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 z-[60] px-6 py-4 rounded-xl shadow-2xl max-w-md animate-slide-down",style:{background:"#1A1C22",border:"2px solid #D2110C"},children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-semibold mb-1",style:{color:"#D2110C"},children:"Import Failed"}),s.jsx("p",{className:"text-xs",style:{color:"#C9CBD6"},children:Z})]}),s.jsx("button",{onClick:()=>ne(null),className:"text-xs font-semibold px-3 py-1.5 rounded-lg",style:{background:"#D2110C",color:"#FFFFFF"},children:"Dismiss"})]})}),me&&s.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 animate-fade-in",children:s.jsxs("div",{className:"rounded-[22px] card-shadow-raised p-8 text-center",style:{background:"#1A1C22"},children:[s.jsx("div",{className:"w-12 h-12 border-4 border-t-transparent rounded-full animate-spin mx-auto mb-4",style:{borderColor:"#D2110C",borderTopColor:"transparent"}}),s.jsx("p",{className:"text-sm font-semibold",style:{color:"#FFFFFF"},children:"Validating import..."})]})})]})}function e0({badge:i}){const n=Xx[i.id];return s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("div",{className:"relative mb-3",style:{width:"96px",height:"96px",opacity:i.earned?1:.35},children:s.jsx("div",{className:"absolute inset-0 rounded-full",style:{background:i.earned?"linear-gradient(135deg, #D9B24C 0%, #8C6B1F 100%)":"#242632",padding:"3px",filter:i.earned?"drop-shadow(0 0 12px rgba(217, 178, 76, 0.2))":"none"},children:s.jsxs("div",{className:"w-full h-full rounded-full flex items-center justify-center",style:{background:i.earned?"radial-gradient(circle at 40% 40%, #1A1C22 0%, #0F1013 60%)":"#0F1013"},children:[n&&s.jsx(n,{className:"w-10 h-10",style:{color:i.earned?"#D9B24C":"#8E91A3",opacity:i.earned?1:.5}}),!i.earned&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("div",{className:"w-7 h-7 rounded-full flex items-center justify-center",style:{background:"rgba(15, 16, 19, 0.9)"},children:s.jsx(Tm,{className:"w-4 h-4",style:{color:"#8E91A3"}})})})]})})}),s.jsx("p",{className:"text-xs font-semibold text-center",style:{color:i.earned?"#D9B24C":"#8E91A3",opacity:i.earned?1:.6},children:i.name}),i.earned?s.jsx("span",{className:"text-[10px] font-semibold mt-1 px-2 py-0.5 rounded",style:{background:"rgba(217, 178, 76, 0.15)",color:"#D9B24C"},children:"Completed"}):s.jsx("span",{className:"text-[10px] font-semibold mt-1",style:{color:"#8E91A3",opacity:.5},children:"Locked"})]})}function t0(){const[i,n]=V.useState("home"),[r,a]=V.useState(!1),[d,h]=V.useState(null),[p,v]=V.useState(!1);V.useEffect(()=>{const A=localStorage.getItem("onboardingComplete");a(A==="true")},[]);const x=()=>{localStorage.setItem("onboardingComplete","true"),a(!0),n("home")},_=A=>{h(A),n("assess")},j=()=>{n("home"),setTimeout(()=>{const A=new CustomEvent("openNewAssessment");window.dispatchEvent(A)},100)},C=()=>{v(!1),n("home"),setTimeout(()=>{const A=new CustomEvent("openNewAssessment");window.dispatchEvent(A)},100)},F=()=>{v(!1),n("library"),setTimeout(()=>{const A=new CustomEvent("navigateToEvidence");window.dispatchEvent(A)},100)},T=()=>{v(!1),n("library"),setTimeout(()=>{const A=new CustomEvent("navigateToTaxa");window.dispatchEvent(A)},100)};return r?s.jsxs("div",{className:"flex flex-col h-screen",style:{background:"linear-gradient(180deg, #0B0B0D 0%, #0F1013 100%)"},children:[s.jsxs("main",{className:"flex-1 overflow-y-auto",children:[i==="home"&&s.jsx(dy,{onStartAssessment:_,onNavigate:A=>n(A)}),i==="assess"&&d&&s.jsx(My,{assessmentId:d,onBack:()=>{h(null),n("assess")}}),i==="assess"&&!d&&s.jsx(Ny,{onStartAssessment:_}),i==="library"&&s.jsx(Px,{}),i==="profile"&&s.jsx(Zx,{onResetToOnboarding:()=>a(!1),onNavigateHome:()=>n("home")})]}),p&&s.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 animate-fade-in",onClick:()=>v(!1),children:s.jsxs("div",{className:"fixed bottom-0 left-0 right-0 rounded-t-[24px] p-6 animate-slide-up",style:{background:"#1A1C22",paddingBottom:"max(24px, calc(24px + env(safe-area-inset-bottom)))"},onClick:A=>A.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h3",{className:"text-xl font-bold",style:{color:"#FFFFFF"},children:"Create New"}),s.jsx("button",{onClick:()=>v(!1),className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:"#14151A"},children:s.jsx(Sr,{className:"w-5 h-5",style:{color:"#C9CBD6"}})})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(Eu,{title:"New Assessment",description:"Start a guided regional assessment",onClick:C}),s.jsx(Eu,{title:"Add Evidence",description:"Upload attachments or citations",onClick:F}),s.jsx(Eu,{title:"New Taxon (draft)",description:"Create a taxon entry",onClick:T})]})]})}),s.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-40",style:{paddingBottom:"env(safe-area-inset-bottom)"},children:s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:j,className:"absolute left-1/2 -translate-x-1/2 w-16 h-16 rounded-full shadow-lg flex items-center justify-center transition-transform active:scale-95 z-50",style:{background:"#D2110C",top:"-32px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)"},"aria-label":"Create new",children:s.jsx(Ff,{className:"w-7 h-7",style:{color:"#FFFFFF"},strokeWidth:3})}),s.jsx("div",{className:"backdrop-blur-md",style:{background:"rgba(20, 21, 26, 0.95)",borderTop:"1px solid #242632",height:"80px"},children:s.jsxs("div",{className:"flex items-center justify-around h-full px-2",children:[s.jsx(Bl,{icon:s.jsx(_m,{className:"w-6 h-6"}),label:"Home",active:i==="home",onClick:()=>n("home")}),s.jsx(Bl,{icon:s.jsx(ym,{className:"w-6 h-6"}),label:"Assess",active:i==="assess",onClick:()=>n("assess")}),s.jsx("div",{className:"w-16"}),s.jsx(Bl,{icon:s.jsx(qu,{className:"w-6 h-6"}),label:"Library",active:i==="library",onClick:()=>n("library")}),s.jsx(Bl,{icon:s.jsx(Vu,{className:"w-6 h-6"}),label:"Profile",active:i==="profile",onClick:()=>n("profile")})]})})]})})]}):s.jsx(yy,{onComplete:x})}function Bl({icon:i,label:n,active:r,onClick:a}){return s.jsxs("button",{onClick:a,className:"flex flex-col items-center justify-center min-w-[64px] px-3 py-2 rounded-lg transition-all relative",style:{color:r?"#FFFFFF":"rgba(255, 255, 255, 0.6)"},children:[s.jsx("div",{style:{color:r?"#D2110C":"rgba(255, 255, 255, 0.6)"},children:i}),s.jsx("span",{className:"text-xs mt-1 font-semibold",children:n}),r&&s.jsx("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 h-0.5 rounded-full",style:{width:"24px",background:"#D2110C"}})]})}function Eu({title:i,description:n,onClick:r}){return s.jsxs("button",{onClick:r,className:"w-full text-left p-4 rounded-[18px] transition-all active:scale-98",style:{background:"#14151A",border:"1px solid #242632"},children:[s.jsx("h4",{className:"font-bold mb-1",style:{color:"#FFFFFF"},children:i}),s.jsx("p",{className:"text-sm",style:{color:"#8E91A3"},children:n})]})}Gp.createRoot(document.getElementById("root")).render(s.jsx(t0,{}));
